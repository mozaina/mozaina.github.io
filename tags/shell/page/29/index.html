<!doctype html>
<html lang="en-us">
<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">


    <title>shell | 开发者问答集锦</title>
    <meta property="og:title" content="shell - 开发者问答集锦">
    <meta property="og:type" content="article">
        
        
    <meta name="Keywords" content="">
    <meta name="description" content="shell">
        
    <meta name="author" content="">
    <meta property="og:url" content="https://zaina.newban.cn/tags/shell/">
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">

    <link rel="stylesheet" href='/css/normalize.css'>
    <link rel="stylesheet" href='/css/style.css'>
    <link rel="alternate" type="application/rss+xml+xml" href="https://zaina.newban.cn/tags/shell/index.xml" title="开发者问答集锦" />
    <script type="text/javascript" src="//cdn.bootcdn.net/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

    
    
    
    
    
    
</head>


<body>
    <header id="header" class="clearfix">
    <div class="container">
        <div class="col-group">
            <div class="site-name ">
                
                    <a id="logo" href="https://zaina.newban.cn">
                        开发者问答集锦
                    </a>
                
                
            </div>
            <div>
                <nav id="nav-menu" class="clearfix">
                    <a class="" href="https://zaina.newban.cn">首页</a>
                    
                </nav>
            </div>
        </div>
    </div>
</header>

    <div id="body">
        <div class="container">
            <div class="col-group">

                <div class="col-8" id="main">
                    
<div class="res-cons">
    
    <h3 class="archive-title">
        包含标签
        <span class="keyword">shell</span>
        的文章
    </h3>
    

    
    <article class="post">
        <header>
            <h1 class="post-title">
                <a href="https://zaina.newban.cn/posts/adbshellamstart%E6%8A%A5securityexceptionpermissiondenial/">adbshellamstart报SecurityExceptionPermissionDenial</a>
            </h1>
        </header>
        <date class="post-meta meta-date">
            2020年9月2日
        </date>
        
        <div class="post-content">
            使用 am start -n example.com.aidl/example.com.aidl.ItemDetailActiv
ity命令启动activity时，偶尔（某些activity）会碰到报此错误：
java.lang.SecurityException: Permission Denial: starting Intent { flg=0x10000000 cmp=example.com.aidl/.ItemDetailActivity } from null (pid=14917, uid=2000) not exported from uid 10201 at android.os.Parcel.readException(Parcel.java:1465) at android.os.Parcel.readException(Parcel.java:1419) at android.app.ActivityManagerProxy.startActivityAsUser(ActivityManagerN ative.java:2306) at com.android.commands.am.Am.runStart(Am.java:680) at com.android.commands.am.Am.onRun(Am.java:270) at com.android.internal.os.BaseCommand.run(BaseCommand.java:47) at com.android.commands.am.Am.main(Am.java:76) at com.android.internal.os.RuntimeInit.nativeFinishInit(Native Method) at com.android.internal.os.RuntimeInit.main(RuntimeInit.java:243) at dalvik.system.NativeStart.main(Native Method)  我对比了情况，
ItemDetailActivity可以，LoginActivity则报错，两者区别是是否定义了intent-filter action，现象很奇怪。  百度google了许久，竟然没有答案，难道都没有朋友碰到过这种情况吗。。。。
花了一下午研究这个问题，终于找到了问题所在。
Android组件中有个 exported 属性，见官方文档描述：
Flag indicating whether the given application component is available to other applications. If false, it can only be accessed by applications with its same user id (which usually means only by code in its own package).……
            <p class="readmore"><a href="https://zaina.newban.cn/posts/adbshellamstart%E6%8A%A5securityexceptionpermissiondenial/">阅读全文</a></p>
        </div>
    </article>
    
    <article class="post">
        <header>
            <h1 class="post-title">
                <a href="https://zaina.newban.cn/posts/adbshellamstart%E6%9D%83%E9%99%90%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3/">adbshellamstart权限问题解决</a>
            </h1>
        </header>
        <date class="post-meta meta-date">
            2020年9月2日
        </date>
        
        <div class="post-content">
            Starting: Intent { cmp=com.zui.factorymode/.ManualTestActivity }
java.lang.SecurityException: Permission Denial: starting Intent { flg=0x10000000
cmp=com.zui.factorymode/.ManualTestActivity } from null (pid=20257, uid=2000) n
ot exported from uid 1000
at android.os.Parcel.readException(Parcel.java:1620)
at android.os.Parcel.readException(Parcel.java:1573)
at android.app.ActivityManagerProxy.startActivityAsUser(ActivityManagerN
ative.java:2738)
at com.android.commands.am.Am.runStart(Am.java:875)
at com.android.commands.am.Am.onRun(Am.java:359)
at com.android.internal.os.BaseCommand.run(BaseCommand.java:47)
at com.android.commands.am.Am.main(Am.java:100)
at com.android.internal.os.RuntimeInit.nativeFinishInit(Native Method)
at com.android.internal.os.RuntimeInit.main(RuntimeInit.java:258)
user版本下遇到权限异常，在androidmanifest.xml文件中需要确认需要打开的类名增加action动作
adb shell am start -a android.intent.action.MAIN -n com.xxx.factorymode/com.xxx.factorymode.ManualTestActivity
http://blog.csdn.net/annkie/article/details/7896559
adb shell am restart 可以重启android 系统.……
            <p class="readmore"><a href="https://zaina.newban.cn/posts/adbshellamstart%E6%9D%83%E9%99%90%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3/">阅读全文</a></p>
        </div>
    </article>
    
    <article class="post">
        <header>
            <h1 class="post-title">
                <a href="https://zaina.newban.cn/posts/adbshellam%E5%91%BD%E4%BB%A4%E4%B9%8Bdebug%E6%8A%80%E5%B7%A7/">adbshellam命令之debug技巧</a>
            </h1>
        </header>
        <date class="post-meta meta-date">
            2020年9月2日
        </date>
        
        <div class="post-content">
            ……
            <p class="readmore"><a href="https://zaina.newban.cn/posts/adbshellam%E5%91%BD%E4%BB%A4%E4%B9%8Bdebug%E6%8A%80%E5%B7%A7/">阅读全文</a></p>
        </div>
    </article>
    
    <article class="post">
        <header>
            <h1 class="post-title">
                <a href="https://zaina.newban.cn/posts/adbshellam%E5%91%BD%E4%BB%A4%E5%90%AF%E5%8A%A8activity/">adbshellam命令启动activity</a>
            </h1>
        </header>
        <date class="post-meta meta-date">
            2020年9月2日
        </date>
        
        <div class="post-content">
            adb shell am start-activity -n com.chaozh.iReader/com.zhangyue.iReader.read.ui.Activity_BookBrowser_TXT -e FilePath /storage/emulated/0/abc.txt  -n 表示用名称启动，/ 前面是包名，后面是全类名。否则就会启动失败。
我们看下源码：
android.content.Intent#parseCommandArgs public static Intent parseCommandArgs(ShellCommand cmd, CommandOptionHandler optionHandler) throws URISyntaxException { Intent intent = new Intent(); Intent baseIntent = intent; boolean hasIntentInfo = false; Uri data = null; String type = null; String opt; while ((opt=cmd.getNextOption()) != null) { 。。。。。 case &quot;-n&quot;: { String str = cmd.getNextArgRequired(); ComponentName cn = ComponentName.unflattenFromString(str); if (cn == null) throw new IllegalArgumentException(&quot;Bad component name: &quot; + str); intent.……
            <p class="readmore"><a href="https://zaina.newban.cn/posts/adbshellam%E5%91%BD%E4%BB%A4%E5%90%AF%E5%8A%A8activity/">阅读全文</a></p>
        </div>
    </article>
    
    <article class="post">
        <header>
            <h1 class="post-title">
                <a href="https://zaina.newban.cn/posts/adbshellam%E5%91%BD%E4%BB%A4%E6%B4%BB%E5%8A%A8%E7%AE%A1%E7%90%86/">adbshellam命令活动管理</a>
            </h1>
        </header>
        <date class="post-meta meta-date">
            2020年9月2日
        </date>
        
        <div class="post-content">
            adb shell am 1.概述
 am这个指令是 activity manager的缩写。这个命令可以启动Activity、打开或关闭进程、发送广播等操作。 am命令格式如下 adb shell am   根据Intent启动 *Activity start [options] INTENT *
options参数如下：
-D :开启debug模式
-W ：等待启动完成
–start-profiler：将profiler中的结果输出到指定文件中
-P ：和–start-profiler一样，区别在于，在app进入idle状态时profiler结束
-R ： 重复启动Activity，但每次重复启动都会关闭掉最上面的Activity
-S :关闭Activity所属的App进程后再启动Activity
–opengl-trace :开启OpenGL tracing
–user ：使用指定的用户来启动 activity ，如果不输入，则使用当前用户执行
 命令样例：  //使用Action方式打开系统设置-输入法设置 adb shell am start -a android.settings.INPUT_METHOD_SETTINGS //使用组件名方式启动照相机功能 adb shell am start -n com.android.camera/.Camera //打开拨号界面，并传递一个DATA_URI数据给拨号界面 am start -a android.intent.action.CALL -d tel:10086
 根据Intent 启动Service startservice [options] INTENT……
            <p class="readmore"><a href="https://zaina.newban.cn/posts/adbshellam%E5%91%BD%E4%BB%A4%E6%B4%BB%E5%8A%A8%E7%AE%A1%E7%90%86/">阅读全文</a></p>
        </div>
    </article>
    
    <article class="post">
        <header>
            <h1 class="post-title">
                <a href="https://zaina.newban.cn/posts/adbshellam%E7%9A%84%E7%94%A8%E6%B3%95/">adbshellam的用法</a>
            </h1>
        </header>
        <date class="post-meta meta-date">
            2020年9月2日
        </date>
        
        <div class="post-content">
            adb shell am instrument [options]
作用：启动对instrument实例的监视。
参数[options]：
-e // -e选项需要放在-w选项之前
作用：提供了以键值对形式存在的测试选项。Android中提供了多种键值对，具体参见下表。
举例：-e class com.android.phone.FIncomingCallTests#testRejectCall
-r
作用：以原始形式输出测试结果。该选项通常是在性能测试时与-e perf true一起使用。
参数 ：
-w ///和在测试工程的AndroidManifest.xml中查找
作用：保持adb shell打开直至测试完成
举例：-w com.android.phone.tests/com.android.phone.runners.FunctionalTestRunner
参考表
   Key Value Description     package  The fully-qualified Java package name for one of the    packages in the test application. Any test case class that uses this package name is executed. Notice that this is not an Android package name; a test package has a single Android package name but may have several Java packages within it.……
            <p class="readmore"><a href="https://zaina.newban.cn/posts/adbshellam%E7%9A%84%E7%94%A8%E6%B3%95/">阅读全文</a></p>
        </div>
    </article>
    
    <article class="post">
        <header>
            <h1 class="post-title">
                <a href="https://zaina.newban.cn/posts/adbshellbugreport%E5%88%86%E6%9E%90/">adbshellbugreport分析</a>
            </h1>
        </header>
        <date class="post-meta meta-date">
            2020年9月2日
        </date>
        
        <div class="post-content">
            BugReport格式分析 BugReport设置 bugreport本身并没有什么选项，主要是通过dumpsys等命令配合完成：
1. 重置电池统计信息
adb shell dumpsys batterystats --reset  2. Wakelock analysis全部wakelock信息
adb shell dumpsys batterystats --enable full-wake-history  3. Kernel trace analysis分析内核，主要分析wakeup source和wakeup activities，首先使能kernel分析
$ adb shell # Set the events to trace. $ echo &quot;power:wakeup_source_activate&quot; &gt;&gt; /d/tracing/set_event $ echo &quot;power:wakeup_source_deactivate&quot; &gt;&gt; /d/tracing/set_event # The default trace size for most devices is 1MB, which is relatively low and might cause the logs to overflow. # 8MB to 10MB should be a decent size for 5-6 hours of logging.……
            <p class="readmore"><a href="https://zaina.newban.cn/posts/adbshellbugreport%E5%88%86%E6%9E%90/">阅读全文</a></p>
        </div>
    </article>
    
    <article class="post">
        <header>
            <h1 class="post-title">
                <a href="https://zaina.newban.cn/posts/adbshellcommandsqlite/">adbshellcommandSQLite</a>
            </h1>
        </header>
        <date class="post-meta meta-date">
            2020年9月2日
        </date>
        
        <div class="post-content">
            ……
            <p class="readmore"><a href="https://zaina.newban.cn/posts/adbshellcommandsqlite/">阅读全文</a></p>
        </div>
    </article>
    
    <article class="post">
        <header>
            <h1 class="post-title">
                <a href="https://zaina.newban.cn/posts/adbshelldumpsys/">adbshelldumpsys</a>
            </h1>
        </header>
        <date class="post-meta meta-date">
            2020年9月2日
        </date>
        
        <div class="post-content">
            # 命令集合  adb shell dumpsys命令是用于打印出当前系统信息(更切确的说是dumpsys命令,因为adb shell只是为了进入手机或模拟器的shell内核,使其能够执行dumpsys命令),可以在命令后面加指定的service name(比如activity,location),如果不加则默认打印出设备中所有service的信息.
下面列举使用最多的命令：
 # 列出最近使用过的任务栈，按时间从近到远排序： adb shell dumpsys activity # 查看Activity的相关信息 adb shell dumpsys activity [包名] # 查看最上层的activity的View布局 adb shell dumpsys activity top # 查看battery相关信息 adb shell dumpsys batterystats [包名] # 查看Location相关信息:最近请求过定位的app和最近请求定位的地址 adb shell dumpsys location # 导出GPU 呈现模式分析结果，最近大约100帧的渲染情况，直接在控制台打印 adb shell dumpsys gfxinfo # 导出GPU 呈现模式分析结果，最近大约100帧的渲染情况，输出到文件 adb shell dumpsys gfxinfo &gt; test.txt  adb shell dumpsys activity 列出最近使用过的任务栈，按时间从近到远排序：
* intent列表 * 广播列表 * 内容提供者列表 * 权限请求列表 * 服务列表 * 任务列表（activity活动栈列表），同一个项目可能有多个activity_stack,也就是task * activity列表 * 进程列表 # 广播列表 ACTIVITY MANAGER BROADCAST STATE (dumpsys activity broadcasts) Historical broadcasts [foreground]: #0: BroadcastRecord{70d1854 u-1 android.……
            <p class="readmore"><a href="https://zaina.newban.cn/posts/adbshelldumpsys/">阅读全文</a></p>
        </div>
    </article>
    
    <article class="post">
        <header>
            <h1 class="post-title">
                <a href="https://zaina.newban.cn/posts/adbshelldumpsysactivityactivities%E8%B0%83%E7%94%A8%E4%BF%A1%E6%81%AF%E7%AE%80%E6%9E%90/">adbshelldumpsysactivityactivities调用信息简析</a>
            </h1>
        </header>
        <date class="post-meta meta-date">
            2020年9月2日
        </date>
        
        <div class="post-content">
            活动栈 通过执行上面命令，可以得到类似如下格式的信息：
Stack #45: type=standard mode=fullscreen
isSleeping=false
mBounds=Rect(0, 0 - 0, 0)
&hellip;&hellip;
Stack #0: type=home mode=fullscreen
isSleeping=false
mBounds=Rect(0, 0 - 0, 0)
&hellip;&hellip;
Stack #1: type=recents mode=fullscreen
isSleeping=false
mBounds=Rect(0, 0 - 0, 0)
&hellip;&hellip;
其中每个Stack开始代表一个App的活动栈，每个活动栈有一个id，如上所示的Stack #45中的45。
android系统中目前定义了两种类型的Stack，系统预定义的静态栈，总共有五种，如下所示：
0 HOME_STACK_ID：Home应用以及recents app所在的栈
1 FULLSCREEN_WORKSPACE_STACK_ID：一般应用所在的栈
2 FREEFORM_WORKSPACE_STACK_ID：类似桌面操作系统
3 DOCKED_STACK_ID：分屏
4 PINNED_STACK_ID：画中画栈
另一种栈，是系统动态生成的，它的id就是大于4
Stack信息分析 我们抽取dump出的一个stack进行分析:
Stack #4: type=standard mode=fullscreen //Stack信息
isSleeping=false
mBounds=Rect(0, 0 - 0, 0)
Task id #51 //Task信息
mBounds=Rect(0, 0 - 0, 0)……
            <p class="readmore"><a href="https://zaina.newban.cn/posts/adbshelldumpsysactivityactivities%E8%B0%83%E7%94%A8%E4%BF%A1%E6%81%AF%E7%AE%80%E6%9E%90/">阅读全文</a></p>
        </div>
    </article>
    

    



<ol class="page-navigator">
    
    <li class="prev">
        <a href="https://zaina.newban.cn/tags/shell/page/28/">上一页</a>
    </li>
    

    

    
        
        
    
    

    
        
        
        <li >
            <a href="https://zaina.newban.cn/tags/shell/">1</a>
        </li>
        
    
        
        <li>
            <span>...</span>
        </li>
        
    
        
        
        <li >
            <a href="https://zaina.newban.cn/tags/shell/page/27/">27</a>
        </li>
        
    
        
        
        <li >
            <a href="https://zaina.newban.cn/tags/shell/page/28/">28</a>
        </li>
        
    
        
        
        <li  class="current">
            <a href="https://zaina.newban.cn/tags/shell/page/29/">29</a>
        </li>
        
    
        
        
        <li >
            <a href="https://zaina.newban.cn/tags/shell/page/30/">30</a>
        </li>
        
    
        
        
        <li >
            <a href="https://zaina.newban.cn/tags/shell/page/31/">31</a>
        </li>
        
    
        
        <li>
            <span>...</span>
        </li>
        
    
        
        
        <li >
            <a href="https://zaina.newban.cn/tags/shell/page/1621/">1621</a>
        </li>
        
    

    
    

    <li class="next">
        <a href="https://zaina.newban.cn/tags/shell/page/30/">下一页</a>
    </li>
    
</ol>




</div>

                    <footer id="footer">
    <div>
        &copy; 2020 <a href="https://zaina.newban.cn">开发者问答集锦 By </a>
        
    </div>
    <br />
    <div>
        <div class="github-badge">
            <a href="https://gohugo.io/" target="_black" rel="nofollow"><span class="badge-subject">Powered by</span><span class="badge-value bg-blue">Hugo</span></a>
        </div>
        <div class="github-badge">
            <a href="https://www.flysnow.org/" target="_black"><span class="badge-subject">Design by</span><span class="badge-value bg-brightgreen">飞雪无情</span></a>
        </div>
        <div class="github-badge">
            <a href="https://github.com/flysnow-org/maupassant-hugo" target="_black"><span class="badge-subject">Theme</span><span class="badge-value bg-yellowgreen">Maupassant</span></a>
        </div>
    </div>
</footer>



<a id="rocket" href="#top"></a>
<script type="text/javascript" src='/js/totop.js?v=0.0.0' async=""></script>



    <script type="text/javascript" src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script>




                </div>

                <div id="secondary">
    <section class="widget">
        <form id="search" action='https://zaina.newban.cn/search/' method="get" accept-charset="utf-8" target="_blank" _lpchecked="1">
      
      <input type="text" name="q" maxlength="20" placeholder="Search">
      <input type="hidden" name="sitesearch" value="https://zaina.newban.cn">
      <button type="submit" class="submit icon-search"></button>
</form>
    </section>
    
    <section class="widget">
        <h3 class="widget-title">最近文章</h3>
<ul class="widget-list">
    
    <li>
        <a href="https://zaina.newban.cn/posts/001rubyruby%E4%B8%AD%E5%85%A8%E5%B1%80%E5%8F%98%E9%87%8F%E5%AE%9E%E4%BE%8B%E5%8F%98%E9%87%8F%E5%B1%80%E9%83%A8%E5%8F%98%E9%87%8F%E7%B1%BB%E5%8F%98%E9%87%8Fsymbol%E5%AF%B9%E6%AF%94/" title="001rubyRuby中全局变量实例变量局部变量类变量Symbol对比">001rubyRuby中全局变量实例变量局部变量类变量Symbol对比</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/007hadoop%E9%9B%86%E7%BE%A4%E9%85%8D%E7%BD%AEhadoop%E9%9B%86%E7%BE%A4%E7%9A%84%E5%90%AF%E5%8A%A8%E5%92%8C%E6%B5%8B%E8%AF%95ssh%E5%85%8D%E7%99%BB%E9%99%86%E9%85%8D%E7%BD%AEstartallshhdfs%E5%B8%B8%E7%94%A8%E7%9A%84shell/" title="007Hadoop集群配置Hadoop集群的启动和测试SSH免登陆配置startallshhdfs常用的shell">007Hadoop集群配置Hadoop集群的启动和测试SSH免登陆配置startallshhdfs常用的shell</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/009shell%E8%84%9A%E6%9C%AC%E4%B8%8B%E6%9D%A1%E4%BB%B6%E6%B5%8B%E8%AF%95eqne/" title="009Shell脚本下条件测试eqne">009Shell脚本下条件测试eqne</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/00pythonmanagepyshell%E5%92%8Cpython%E7%9A%84%E5%88%86%E6%9E%90/" title="00Pythonmanagepyshell和Python的分析">00Pythonmanagepyshell和Python的分析</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/010zookeeper%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5zookeeper%E7%9A%84%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BAzookeeper%E7%9A%84shell%E5%91%BD%E4%BB%A4/" title="010Zookeeper的基本概念Zookeeper的集群搭建Zookeeper的shell命令">010Zookeeper的基本概念Zookeeper的集群搭建Zookeeper的shell命令</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/018dockerfileshell/" title="018DockerfileSHELL">018DockerfileSHELL</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/01shell%E5%85%A5%E9%97%A801bashshell%E7%89%B9%E6%80%A7/" title="01Shell入门01bashShell特性">01Shell入门01bashShell特性</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/01shell%E5%8F%98%E9%87%8F/" title="01Shell变量">01Shell变量</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/01shell%E5%9F%BA%E7%A1%80%E6%A6%82%E8%BF%B0%E8%84%9A%E6%9C%AC%E6%89%A7%E8%A1%8C%E6%96%B9%E5%BC%8Fbash%E5%9F%BA%E6%9C%AC%E5%8A%9F%E8%83%BD/" title="01Shell基础概述脚本执行方式Bash基本功能">01Shell基础概述脚本执行方式Bash基本功能</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/01shell%E7%BC%96%E7%A8%8Bhelloworld/" title="01shell编程helloworld">01shell编程helloworld</a>
    </li>
    
</ul>
    </section>

    

    <section class="widget">
        <h3 class="widget-title"><a href="/categories">分类</a></h3>
<ul class="widget-list">
    
</ul>
    </section>

    <section class="widget">
        <h3 class="widget-title"><a href="/tags">标签</a></h3>
<div class="tagcloud">
    
    <a href="https://zaina.newban.cn/tags/ruby/">ruby</a>
    
    <a href="https://zaina.newban.cn/tags/shell/">shell</a>
    
</div>
    </section>

    

    <section class="widget">
        <h3 class="widget-title">其它</h3>
        <ul class="widget-list">
            <li><a href="https://zaina.newban.cn/index.xml">文章 RSS</a></li>
        </ul>
    </section>
</div>
            </div>
        </div>
    </div>
</body>

</html>