<!doctype html>
<html lang="en-us">
<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">


    <title>Shell助力开发效率提升 | 开发者问答集锦</title>
    <meta property="og:title" content="Shell助力开发效率提升 - 开发者问答集锦">
    <meta property="og:type" content="article">
        
    <meta property="article:published_time" content='2020-09-02T00:00:00&#43;08:00'>
        
        
    <meta property="article:modified_time" content='2020-09-02T00:00:00&#43;08:00'>
        
    <meta name="Keywords" content="">
    <meta name="description" content="Shell助力开发效率提升">
        
    <meta name="author" content="">
    <meta property="og:url" content="https://zaina.newban.cn/posts/shell%E5%8A%A9%E5%8A%9B%E5%BC%80%E5%8F%91%E6%95%88%E7%8E%87%E6%8F%90%E5%8D%87/">
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">

    <link rel="stylesheet" href='/css/normalize.css'>
    <link rel="stylesheet" href='/css/style.css'>
    <script type="text/javascript" src="//cdn.bootcdn.net/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

    
    
    
    
    
    
</head>


<body>
    <header id="header" class="clearfix">
    <div class="container">
        <div class="col-group">
            <div class="site-name ">
                
                    <a id="logo" href="https://zaina.newban.cn">
                        开发者问答集锦
                    </a>
                
                
            </div>
            <div>
                <nav id="nav-menu" class="clearfix">
                    <a class="" href="https://zaina.newban.cn">首页</a>
                    
                </nav>
            </div>
        </div>
    </div>
</header>

    <div id="body">
        <div class="container">
            <div class="col-group">

                <div class="col-8" id="main">
                    
<div class="res-cons">
    
    <article class="post">
        <header>
            <h1 class="post-title">Shell助力开发效率提升</h1>
        </header>
        <date class="post-meta meta-date">
            2020年9月2日
        </date>
        
        
        <div class="post-meta">
            <span id="busuanzi_container_page_pv">|<span id="busuanzi_value_page_pv"></span><span>
                    阅读</span></span>
        </div>
        
        
        <div class="post-content">
            

<p>(题图:毕业旅行之决战青海湖)</p>

<p>本文主要来源于小组内部的一个小的分享, 这里整理成一篇文章po出来. 题目叫 “Shell 助力开发效率提升”, 更切题的应该是叫 “命令行”
提升开发效率, 这里并没有讲到Shell编程, 而是主要介绍Linux 或者 Mac下常用的一些基本工具命令来帮助处理一些日常事务.
(其实之前这篇文章Mac 软件推荐(续)之程序猿篇也大致提到了本文中的大部分内容)</p>

<p>通过本文的介绍, 你应该对相关命令有一个初步的了解, 知道比如用什么命令可以完成怎样的操作,<br />
至于具体的参数, 你不用去刻意地记, 等到你用到的时候, 你再去 <code>cmd --help</code> 或者 <code>man cmd</code>去看, 用熟悉了, 常用的你也就记住了.</p>

<p>本文首先介绍了Linux/Mac下一些常用的命令行工具, 然后介绍了一些常用的命令, 最后通过一两个案例来说明这些工具的强大之处:<br />
比如给定一个nginx日志文件, 能够找出HTTP 404 请求最多的top 10 是什么? 比如能找到请求耗时最多的top 10是什么?
再比如能够简单的得到每小时的”PV”是多少?<br />
再比如拿到一篇文章, 能否简单统计一下这篇文章单次词频最高的10个词语是什么?</p>

<h2 id="mac-环境">Mac 环境</h2>

<ul>
<li><p>zsh</p></li>

<li><p>on-my-zsh</p></li>

<li><p>plugin</p>

<ul>
<li><p>git</p></li>

<li><p>autojump</p></li>

<li><p>osx(man-preview/quick-look/pfd(print Finder director)/cdf(cd Finder))</p></li>
</ul></li>

<li><p>常用快捷键(<code>bindkey</code>)</p></li>

<li><p>演示: 高亮/git/智能补全/跳转(j,d)…</p></li>
</ul>

<p>关于Mac相关的技巧, 更多的可以参考以下三篇文章: Mac 软件推荐, Mac 软件推荐(续) &ndash; !程序猿篇, 和 Mac 软件推荐(续)之程序猿篇</p>

<h2 id="shell-基础命令">Shell 基础命令</h2>

<ul>
<li><p>which/whereis, 常用 <code>whatis</code>, <code>man</code>, <code>--help</code></p>

<pre><code>  ➜  .oh-my-zsh git:(master)$ whereis ls
</code></pre>

<p> /bin/ls
  ➜  .oh-my-zsh git:(master)$ which ls
  ls: aliased to ls -G</p></li>

<li><p>基本文件目录操作</p>

<pre><code>  rm, mkdir, mv, cp, cd, ls, ln, file, stat, wc(-l/w/c), head, more, tail, cat...
</code></pre></li>

<li><p>利器 管道: <code>|</code></p></li>
</ul>

<h2 id="shell-文本处理">Shell 文本处理</h2>

<p>这里就是通过案例讲了一下12个命令的大致用法和参数, 可以通过点击右边的目录直达你想要了解的命令.</p>

<pre><code>find, grep, xargs, cut, paste, comm
join, sort, uniq, tr, sed, awk
</code></pre>

<h3 id="find">find</h3>

<ul>
<li><p>常用参数</p>

<ul>
<li><p>文件名 <code>-name</code>, 文件类型<code>-type</code>, 查找最大深度<code>-maxdepth</code></p></li>

<li><p>时间过滤(create/access/modify) <code>-[cam]time</code></p></li>

<li><p>执行动作 <code>-exec</code></p></li>
</ul></li>

<li><p>示例</p>

<pre><code>  find ./ -name &quot;*.json&quot;
</code></pre>

<p> find . -maxdepth 7 -name &ldquo;<em>.json&rdquo; -type f
  find . -name &ldquo;</em>.log.gz&rdquo; -ctime +7 -size +1M -delete (atime/ctime/mtime)
  find . -name &ldquo;*.scala&rdquo; -atime -7 -exec du -h {} \;</p></li>
</ul>

<h3 id="grep">grep</h3>

<ul>
<li><p>常用参数</p>

<ul>
<li><p>-v(invert-match),</p></li>

<li><p>-c(count),</p></li>

<li><p>-n(line-number),</p></li>

<li><p>-i(ignore-case),</p></li>

<li><p>-l, -L, -R(-r, —recursive), -e</p></li>
</ul></li>

<li><p>示例</p>

<pre><code>  grep 'partner' ./*.scala -l
</code></pre>

<p> grep -e &lsquo;World&rsquo; -e &lsquo;first&rsquo; -i -R ./  (-e: or)</p></li>

<li><p>相关命令: <code>grep -z / zgrep / zcat xx | grep</code></p></li>
</ul>

<h3 id="xargs">xargs</h3>

<ul>
<li><p>常用参数</p>

<ul>
<li><p>-n(每行列数),</p></li>

<li><p>-I(变量替换)</p></li>

<li><p>-d(分隔符), Mac 不支持, 注意与GNU版本的区别</p></li>
</ul></li>

<li><p>示例</p>

<pre><code>  find . -type f -name &quot;*.jpg&quot; | xargs -n1 -I {} du -sh {}
</code></pre></li>
</ul>

<h3 id="cut">cut</h3>

<ul>
<li><p>常用参数</p>

<ul>
<li><p>-b(字节)</p></li>

<li><p>-c(字符)</p></li>

<li><p>-f(第几列), -d(分隔符), f范围: <code>n, n-, -m, n-m</code></p></li>
</ul></li>

<li><p>示例</p>

<pre><code> echo &quot;helloworldhellp&quot; | cut -c1-10
</code></pre>

<p>cut -d, -f2-8 csu.db.export.csv</p></li>
</ul>

<h3 id="paste">paste</h3>

<ul>
<li><p>常用参数</p>

<ul>
<li><p>-d 分隔符</p></li>

<li><p>-s 列转行</p></li>
</ul></li>

<li><p>示例</p>

<pre><code> ➜  Documents$ cat file1 1 11
</code></pre>

<p>2 22
 3 33
 4 44
 ➜  Documents$ cat file2
 one     1
 two     2
 three   3
 one1    4</p>

<p>➜  Documents$ paste -d, file1 file2 1 11,one     1
 2 22,two     2
 3 33,three   3
 4 44,one1    4
 ➜  Documents$ paste -s -d: file1 file2
 a 11:b bb:3 33:4 44
 one     1:two     2:three   3:one1    4</p></li>
</ul>

<h3 id="join">join</h3>

<p>类似sql中的 <code>...inner join ...on ...</code>, <code>-t</code> 分隔符, 默认为空格或tab</p>

<pre><code>➜  Documents$ cat j11 112 223 334 445 55➜  Documents$ cat j2
one     1   0one     2   1two     4   2three   5   3one1    5   4➜  Documents$ join -1 1 -2 3 j1 j21 11 one 22 22 two 43 33 three 54 44 one1 5
</code></pre>

<h3 id="comm">comm</h3>

<ul>
<li><p>常用参数</p>

<ul>
<li><p>用法 <code>comm [-123i] file1 file2</code></p></li>

<li><p><strong>字典序列</strong> , 3列: 只在file1/file2/both</p></li>

<li><p><code>-</code> 去掉某列, <code>i</code> 忽略大小写</p></li>
</ul></li>

<li><p>示例</p>

<pre><code>  ➜  Documents$ seq 1 5 &gt;file11
</code></pre>

<p> ➜  Documents$ seq 2 6 &gt;file22
  ➜  Documents$ cat file11  1
  2
  3
  4
  5
  ➜  Documents$ cat file22  2
  3
  4
  5
  6
  ➜  Documents$ comm file11 file22  1
          2
          3
          4
          5
      6
  ➜  Documents$ comm -1 file11 file22      2
      3
      4
      5
  6
  ➜  Documents$ comm -2 file11 file22  1
      2
      3
      4
      5
  ➜  Documents$ comm -23 file11 file22  1</p></li>
</ul>

<p>相关命令 <strong>diff</strong> (类似 <em>git diff</em> )</p>

<h3 id="sort">sort</h3>

<ul>
<li><p>常用参数</p>

<ul>
<li><p>-d, —dictionary-order</p></li>

<li><p>-n, —numeric-sort</p></li>

<li><p>-r, —reverse</p></li>

<li><p>-b, —ignore-leading-blanks</p></li>

<li><p>-k, —key</p></li>
</ul></li>

<li><p>示例</p>

<pre><code> ➜  Documents$ cat file2
</code></pre>

<p>one     1
 two     2
 three   3
 one1    4
 ➜  Documents$ sort file2
 one     1
 one1    4
 three   3
 two     2
 ➜  Documents$ sort -b -k2 -r file2
 one1    4
 three   3
 two     2
 one     1</p></li>
</ul>

<h3 id="uniq">uniq</h3>

<ul>
<li><p>常用参数</p>

<ul>
<li><p>-c 重复次数</p></li>

<li><p>-d 重复的</p></li>

<li><p>-u 没重复的</p></li>

<li><p>-f 忽略前几列</p></li>
</ul></li>

<li><p>示例</p>

<pre><code> ➜  Documents$ cat file4 11
</code></pre>

<p>22
 33
 11
 11
 ➜  Documents$ sort file4 | uniq -c    3 11
    1 22
    1 33
 ➜  Documents$ sort file4 | uniq -d
 11
 ➜  Documents$ sort file4 | uniq -u 22
 33
 ➜  Documents$ cat file3
 one     1
 two     1
 three   3
 one1    4
 ➜  Documents$ uniq -c -f 1 file3    2 one     1
    1 three   3
    1 one1    4</p></li>
</ul>

<p>注意: uniq比较相邻的是否重复, 一般与sort联用</p>

<h3 id="tr">tr</h3>

<ul>
<li><p>常用参数</p>

<ul>
<li><p>-c 补集</p></li>

<li><p>-d 删除</p></li>

<li><p>-s 压缩相邻重复的</p></li>
</ul></li>

<li><p>示例</p>

<pre><code> ➜  Documents$ echo '1111234444533hello' | tr  '[1-3]' '[a-c]'
</code></pre>

<p>aaaabc44445cchello
 ➜  Documents$ echo &lsquo;1111234444533hello&rsquo; | tr -d &lsquo;[1-3]&rsquo;
 44445hello
 ➜  Documents$ echo &lsquo;1111234444533hello&rsquo; | tr -dc &lsquo;[1-3]&rsquo;
 11112333
 ➜  Documents$ echo &lsquo;1111234444533hello&rsquo; | tr -s &lsquo;[0-9]&rsquo;
 123453hello
 ➜  Documents$ echo &lsquo;helloworld&rsquo; | tr &lsquo;[:lower:]&rsquo; &lsquo;[:upper:]&rsquo;
 HELLOWORLD</p></li>
</ul>

<h3 id="sed">sed</h3>

<ul>
<li><p>常用参数</p>

<ul>
<li><p>-d 删除</p></li>

<li><p>-s 替换, g 全局</p></li>

<li><p>-e 多个命令叠加</p></li>

<li><p>-i 修改原文件(Mac下加参数 “”, 备份)</p></li>
</ul></li>

<li><p>示例</p>

<pre><code> ➜  Documents$ cat file2
</code></pre>

<p>one     1
 two     2
 three   3
 one1    4
 ➜  Documents$ sed &ldquo;2,3d&rdquo; file2
 one     1
 one1    4
 ➜  Documents$ sed &lsquo;/one/d&rsquo; file2
 two     2
 three   3
 ➜  Documents$ sed &rsquo;s/one/111/g&rsquo; file2 111     1
 two     2
 three   3
 1111    4
 #将one替换成111 并将含有two的行删除
 ➜  Documents$ sed -e &rsquo;s/one/111/g&rsquo; -e &lsquo;/two/d&rsquo; file2 111     1
 three   3
 1111    4
 # ()标记(转义), \1 引用
 ➜  Documents$ sed &rsquo;s/([0-9])/\1.html/g&rsquo; file2
 one     1.html
 two     2.html
 three   3.html
 one1.html    4.html # 与上面一样 &amp; 标记匹配的字符
 ➜  Documents$ sed &rsquo;s/[0-9]/&amp;.html/g&rsquo; file2
 one     1.html
 two     2.html
 three   3.html
 one1.html    4.html
 ➜  Documents$ cat mobile.csv &ldquo;13090246026&rdquo;
 &ldquo;18020278026&rdquo;
 &ldquo;18520261021&rdquo;
 &ldquo;13110221022&rdquo;
 ➜  Documents$ sed &rsquo;s/([0-9]{3})[0-9]{4}/\1xxxx/g&rsquo; mobile.csv &ldquo;130xxxx6026&rdquo;
 &ldquo;180xxxx8026&rdquo;
 &ldquo;185xxxx1021&rdquo;
 &ldquo;131xxxx1022&rdquo;</p></li>
</ul>

<h3 id="awk">awk</h3>

<ul>
<li><p>基本参数和语法</p>

<ul>
<li><p>NR 行号, NF 列数量</p></li>

<li><p><code>$1</code> 第1列, <code>$2, $3</code>…</p></li>

<li><p>-F fs fs分隔符，字符串或正则</p></li>

<li><p>语法: <code>awk 'BEGIN{ commands } pattern{ commands } END{ commands }'</code>, 流程如下:</p></li>
</ul></li>
</ul>

<ol>
<li><p>执行begin</p></li>

<li><p>对输入每一行执行 <code>pattern{ commands }</code>, pattern 可以是 正则<code>/reg exp/</code>, 关系运算等</p></li>

<li><p>处理完毕, 执行 end</p></li>
</ol>

<ul>
<li><p>示例</p>

<p>➜  Documents$ cat file5 11  11 aa cc 22  22 bb 33  33 d 11  11
 11  11
 #行号, 列数量, 第3列
 ➜  Documents$ awk &lsquo;{print NR&rdquo;(&ldquo;NF&rdquo;):&ldquo;, $3}&rsquo; file5 1(4): aa 2(3): bb 3(3): d 4(2): 5(2): #字符串分割, 打印1，2列
 ➜  Documents$ awk -F&rdquo;xxxx&rdquo; &lsquo;{print $1, $2}&rsquo; mobile.csv &ldquo;130 6026&rdquo;
 &ldquo;180 8026&rdquo;
 &ldquo;185 1021&rdquo;
 &ldquo;131 1022&rdquo;
 #添加表达式
 ➜  Documents$ awk &lsquo;$1&gt;=22 {print NR&rdquo;:&ldquo;, $3}&rsquo; file5 2: bb 3: d #累加1到36，奇数，偶数
 ➜  Documents$ seq 36 | awk &lsquo;BEGIN{sum=0; print &ldquo;question:&ldquo;} {print $1&rdquo; +&ldquo;; sum+=$1} END{print &ldquo;=&rdquo;; print sum}&rsquo; | xargs | sed &rsquo;s/+ =/=/&rsquo;
 question: 1 + 2 + 3 + 4 + 5 + 6 + 7 + 8 + 9 + 10 + 11 + 12 + 13 + 14 + 15 + 16 + 17 + 18 + 19 + 20 + 21 + 22 + 23 + 24 + 25 + 26 + 27 + 28 + 29 + 30 + 31 + 32 + 33 + 34 + 35 + 36 = 666
 ➜  Documents$ seq 36 | awk &lsquo;BEGIN{sum=0; print &ldquo;question:&ldquo;} $1 % 2 ==1 {print $1&rdquo; +&ldquo;; sum+=$1} END{print &ldquo;=&rdquo;; print sum}&rsquo; | xargs | sed &rsquo;s/+ =/=/&rsquo;
 question: 1 + 3 + 5 + 7 + 9 + 11 + 13 + 15 + 17 + 19 + 21 + 23 + 25 + 27 + 29 + 31 + 33 + 35 = 324
 ➜  Documents$ seq 36 | awk &lsquo;BEGIN{sum=0; print &ldquo;question:&ldquo;} $1 % 2 !=1 {print $1&rdquo; +&ldquo;; sum+=$1} END{print &ldquo;=&rdquo;; print sum}&rsquo; | xargs | sed &rsquo;s/+ =/=/&rsquo;
 question: 2 + 4 + 6 + 8 + 10 + 12 + 14 + 16 + 18 + 20 + 22 + 24 + 26 + 28 + 30 + 32 + 34 + 36 = 342</p></li>
</ul>

<p>其他高级语法: <code>for, while</code> 等, 各种函数等, 本身<code>awk</code>是一个强大的语言, 可以掌握一些基本的用法.</p>

<h2 id="实际应用">实际应用</h2>

<h3 id="日志统计分析">日志统计分析</h3>

<p>例如拿到一个nginx日志文件, 可以做很多事情, 比如看哪些请求是耗时最久的进而进行优化, 比如看每小时的”PV”数 等等.</p>

<pre><code>➜  Documents$ head -n5 std.nginx.log106.38.187.225 - - [20/Feb/2017:03:31:01 +0800] www.tanglei.name &quot;GET /baike/208344.html HTTP/1.0&quot; 301 486 &quot;-&quot; &quot;Mozilla/5.0 (compatible; MSIE 7.0; Windows NT 5.1; .NET CLR 1.1.4322) 360JK yunjiankong 975382&quot; &quot;106.38.187.225, 106.38.187.225&quot; - 0.000106.38.187.225 - - [20/Feb/2017:03:31:02 +0800] www.tanglei.name &quot;GET /baike/208344.html HTTP/1.0&quot; 301 486 &quot;-&quot; &quot;Mozilla/5.0 (compatible; MSIE 7.0; Windows NT 5.1; .NET CLR 1.1.4322) 360JK yunjiankong 975382&quot; &quot;106.38.187.225, 106.38.187.225&quot; - 0.00010.130.64.143 - - [20/Feb/2017:03:31:02 +0800] stdbaike.bdp.cc &quot;POST /baike/wp-cron.php?doing_wp_cron=1487532662.2058920860290527343750 HTTP/1.1&quot; 200 182 &quot;-&quot; &quot;WordPress/4.5.6; http://www.tanglei.name/baike&quot; &quot;10.130.64.143&quot; 0.205 0.20510.130.64.143 - - [20/Feb/2017:03:31:02 +0800] www.tanglei.name &quot;GET /external/api/login-status HTTP/1.0&quot; 200 478 &quot;-&quot; &quot;-&quot; &quot;10.130.64.143&quot; 0.003 0.00410.130.64.143 - - [20/Feb/2017:03:31:02 +0800] www.tanglei.name &quot;GET /content_util/authorcontents?count=5&amp;offset=0&amp;israndom=1&amp;author=9 HTTP/1.0&quot; 200 11972 &quot;-&quot; &quot;-&quot; &quot;10.130.64.143&quot; 0.013 0.013
</code></pre>

<p>上面是nginx的一个案例, 例如希望找到top 10 请求的path:</p>

<pre><code>head -n 10000 std.nginx.log | awk '{print $8 &quot;,&quot; $10}' | grep ',404' | sort | uniq -c | sort -nr -k1 | head -n 10#orhead -n 10000 std.nginx.log | awk '$10==404 {print $8}' |sort | uniq -c | sort -nr -k1 | head -n 10
</code></pre>

<p>当然, 你可能一次不会直接处理成功, 一般会先少拿一部分数据进行处理看逻辑是否正常, 或者你可以缓存一些中间结果.</p>

<pre><code>cat std.nginx.log | awk '{print $8 &quot;,&quot; $10}' | grep ',404' &gt;404.log
sort 404.log | uniq -c | sort -nr -k1 | head -n 10
</code></pre>

<p>再比如每小时请求数量, 请求耗时等等</p>

<pre><code>➜  Documents$ head -n 100000 std.nginx.log | awk -F: '{print $1 $2}' | cut -f3 -d/ | uniq -c8237 20170315051 20170416083 20170518561 20170622723 20170719345 201708
</code></pre>

<p>其他实际案例 ip block</p>

<h3 id="案例-db数据批处理">案例: db数据批处理</h3>

<p>背景: 因为某服务bug, 导致插入到db的图片路径不对, 需要将形如(安全需要已经将敏感数据替换)<br />
<code>https://www.tanglei.name/upload/photos/129630//internal-
public/shangtongdai/2017-02-19-abcdefg-eb85-4c24-883e-hijklmn.jpg</code><br />
替换成<br />
<code>http://www.tanglei.me/internal-public/shangtongdai/2017-02-19-abcdefg-
eb85-4c24-883e-hijklmn.jpg</code>, 因为mysql等db貌似不支持直接正则的替换, 所以不能够很方便的进行写sql进行替换.<br />
当然将数据导出, 然后写python等脚本处理也是一种解决方案, 但如果用上面的命令行处理, 只需要几十秒即可完成.</p>

<p>步骤:</p>

<ol>
<li><p>准备数据</p>

<pre><code> select id, photo_url_1, photo_url_2, photo_url_3 from somedb.sometable where 
</code></pre>

<p>photo_url_1 like &lsquo;<a href="https://www.tanglei.name/upload/photos/%//internal-public/%'">https://www.tanglei.name/upload/photos/%//internal-public/%'</a> or
 photo_url_2 like &lsquo;<a href="https://www.tanglei.name/upload/photos/%//internal-public/%'">https://www.tanglei.name/upload/photos/%//internal-public/%'</a> or
 photo_url_3 like &lsquo;<a href="https://www.tanglei.name/upload/photos/%//internal-public/%'">https://www.tanglei.name/upload/photos/%//internal-public/%'</a>;</p></li>

<li><p>替换原文件<br />
一般在用sed替换的时候, 先测试一下是否正常替换.</p>

<pre><code> #测试是否OK
</code></pre>

<p>head -n 5 customers.csv | sed &rsquo;s|<a href="https://www.tanglei.name/upload/photos/[0-9]{1,}/|http://www.tanglei.me|g'">https://www.tanglei.name/upload/photos/[0-9]{1,}/|http://www.tanglei.me|g'</a>
 # 直接替换原文件, 可以sed -i &ldquo;.bak&rdquo; 替换时保留原始备份文件
 sed -i &ldquo;&rdquo; &rsquo;s|<a href="https://www.tanglei.name/upload/photos/[0-9]{1,}/|http://www.tanglei.me|g'">https://www.tanglei.name/upload/photos/[0-9]{1,}/|http://www.tanglei.me|g'</a> customers.csv</p></li>

<li><p>拼接sql, 然后执行</p>

<pre><code> awk -F, '{print &quot;update sometable set photo_url_1 = &quot; $2, &quot;, photo_url_2 = &quot; $3, &quot;, photo_url_3 = &quot; $4, &quot; where id = &quot; $1 &quot;;&quot; }' customers.csv &gt; customer.sql #然后执行sql 即可
</code></pre></li>
</ol>

<h3 id="其他">其他</h3>

<ul>
<li><p>play framework session</p>

<ul>
<li><p>老方式: 需要启play环境, 慢</p>

<pre><code>    sbt &quot;project site&quot; consoleQuickimport play.api.libs._val sec = &quot;secret...secret&quot;var uid = &quot;97522&quot;Crypto.sign(s&quot;uid=$uid&quot;, sec.getBytes(&quot;UTF-8&quot;)) + s&quot;-uid=$uid&quot;
</code></pre></li>

<li><p>新方式:</p>

<pre><code>    ➜  Documents$  ~/stdcookie.sh 97522918xxxxdf64abcfcxxxxc465xx7554dxxxx21e-uid=97522➜  Documents$ cat ~/stdcookie.sh#!/bin/bash ##  cannot remove this lineuid=$1hash=`echo -n &quot;uid=$uid&quot; | openssl dgst -sha1 -hmac &quot;secret...secret&quot;`echo &quot;$hash-uid=$uid&quot;
</code></pre></li>
</ul></li>

<li><p>统计文章单词频率: 下面案例统计了川普就职演讲原文中词频最高的10个词.</p>

<pre><code>  ➜  Documents$ head -n3 chuanpu.txt
</code></pre>

<p> Chief Justice Roberts, President Carter, President Clinton, President Bush, President Obama, fellow Americans and people of the world, thank you.</p>

<p> We, the citizens of America, are now joined in a great national effort to rebuild our country and restore its promise for all of our people. Together we will determine the course of America and the world for many, many years to come.
  ➜  Documents$ cat chuanpu.txt | tr -dc &lsquo;a-zA-Z &rsquo; | xargs -n 1 | sort | uniq -c | sort -nr -k1 | head -n 20
    65 the    63 and    48 of    46 our    42 will    37 to    21 We    20 is    18 we    17 America    15 a    14 all    13 in
    13 for
    13 be    13 are    10 your    10 not    10 And    10 American</p></li>

<li><p>随机数</p>

<pre><code>  ➜  Documents$ cat /dev/urandom | LC_CTYPE=C tr -dc 'a-zA-Z0-9' | fold -w 32 | head -n 5
</code></pre>

<p> cpBnvC0niwTybSSJhUUiZwIz6ykJxBvu
  VDP56NlHnugAt2yDySAB9HU2Nd0LlYCW  0WEDzpjPop32T5STvR6K6SfZMyT6KvAI
  a9xBwBat7tJVaad279fOPdA9fEuDEqUd
  hTLrOiTH5FNP2nU3uflsjPUXJmfleI5c
  ➜  Documents$ cat /dev/urandom | head -c32 | base64
  WoCqUye9mSXI/WhHODHDjzLaSb09xrOtbrJagG7Kfqc=</p></li>

<li><p>图片处理压缩, 可批量改图片大小等等 <code>sips</code></p>

<pre><code>  ➜  linux-shell-more-effiency$ sips -g all which-whereis.png
</code></pre>

<p> /Users/tanglei/Documents/linux-shell-more-effiency/which-whereis.png
    pixelWidth: 280
    pixelHeight: 81
    typeIdentifier: public.png
    format: png
    formatOptions: default
    dpiWidth: 72.000
    dpiHeight: 72.000
    samplesPerPixel: 4
    bitsPerSample: 8
    hasAlpha: yes
    space: RGB
    profile: DELL U2412M
  ➜  linux-shell-more-effiency$ sips -Z 250 which-whereis.png
  /Users/tanglei/Documents/linux-shell-more-effiency/which-whereis.png
    /Users/tanglei/Documents/linux-shell-more-effiency/which-whereis.png
  ➜  linux-shell-more-effiency$ sips -g all which-whereis.png
  /Users/tanglei/Documents/linux-shell-more-effiency/which-whereis.png
    pixelWidth: 250
    pixelHeight: 72
    typeIdentifier: public.png
    format: png
    formatOptions: default
    dpiWidth: 72.000
    dpiHeight: 72.000
    samplesPerPixel: 4
    bitsPerSample: 8
    hasAlpha: yes
    space: RGB
    profile: DELL U2412M
  ➜  linux-shell-more-effiency$ sips -z 100 30 which-whereis.png
  /Users/tanglei/Documents/linux-shell-more-effiency/which-whereis.png
    /Users/tanglei/Documents/linux-shell-more-effiency/which-whereis.png
  ➜  linux-shell-more-effiency$ sips -g pixelWidth -g pixelHeight which-whereis.png
  /Users/tanglei/Documents/linux-shell-more-effiency/which-whereis.png
    pixelWidth: 30
    pixelHeight: 100</p></li>
</ul>

<h2 id="reference">Reference</h2>

<ul>
<li><p>Linux工具快速教程</p></li>

<li><p>Linux命令大全</p></li>

<li><p>Advanced Bash-Scripting Guide</p></li>

<li><p>UNIX环境高级编程</p></li>
</ul>

<p><img src="https://img.it610.com/image/info8/5ed3ad44c4844e3da2ab494f70af80c5.jpg" alt="" /></p>

        </div>

        


        

<div class="post-archive">
    <h2>See Also</h2>
    <ul class="listing">
        
        <li><a href="/posts/007hadoop%E9%9B%86%E7%BE%A4%E9%85%8D%E7%BD%AEhadoop%E9%9B%86%E7%BE%A4%E7%9A%84%E5%90%AF%E5%8A%A8%E5%92%8C%E6%B5%8B%E8%AF%95ssh%E5%85%8D%E7%99%BB%E9%99%86%E9%85%8D%E7%BD%AEstartallshhdfs%E5%B8%B8%E7%94%A8%E7%9A%84shell/">007Hadoop集群配置Hadoop集群的启动和测试SSH免登陆配置startallshhdfs常用的shell</a></li>
        
        <li><a href="/posts/009shell%E8%84%9A%E6%9C%AC%E4%B8%8B%E6%9D%A1%E4%BB%B6%E6%B5%8B%E8%AF%95eqne/">009Shell脚本下条件测试eqne</a></li>
        
        <li><a href="/posts/00pythonmanagepyshell%E5%92%8Cpython%E7%9A%84%E5%88%86%E6%9E%90/">00Pythonmanagepyshell和Python的分析</a></li>
        
        <li><a href="/posts/010zookeeper%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5zookeeper%E7%9A%84%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BAzookeeper%E7%9A%84shell%E5%91%BD%E4%BB%A4/">010Zookeeper的基本概念Zookeeper的集群搭建Zookeeper的shell命令</a></li>
        
        <li><a href="/posts/018dockerfileshell/">018DockerfileSHELL</a></li>
        
    </ul>
</div>


        <div class="post-meta meta-tags">
            
            <ul class="clearfix">
                
                <li><a href='https://zaina.newban.cn/tags/shell'>shell</a></li>
                
            </ul>
            
        </div>
    </article>
    
    

    
    
</div>

                    <footer id="footer">
    <div>
        &copy; 2020 <a href="https://zaina.newban.cn">开发者问答集锦 By </a>
        
    </div>
    <br />
    <div>
        <div class="github-badge">
            <a href="https://gohugo.io/" target="_black" rel="nofollow"><span class="badge-subject">Powered by</span><span class="badge-value bg-blue">Hugo</span></a>
        </div>
        <div class="github-badge">
            <a href="https://www.flysnow.org/" target="_black"><span class="badge-subject">Design by</span><span class="badge-value bg-brightgreen">飞雪无情</span></a>
        </div>
        <div class="github-badge">
            <a href="https://github.com/flysnow-org/maupassant-hugo" target="_black"><span class="badge-subject">Theme</span><span class="badge-value bg-yellowgreen">Maupassant</span></a>
        </div>
    </div>
</footer>


    
    <script type="text/javascript">
        window.MathJax = {
            tex2jax: {
                inlineMath: [['$', '$']],
                processEscapes: true
                }
            };
    </script>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML' async></script>

<a id="rocket" href="#top"></a>
<script type="text/javascript" src='/js/totop.js?v=0.0.0' async=""></script>



    <script type="text/javascript" src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script>




                </div>

                <div id="secondary">
    <section class="widget">
        <form id="search" action='https://zaina.newban.cn/search/' method="get" accept-charset="utf-8" target="_blank" _lpchecked="1">
      
      <input type="text" name="q" maxlength="20" placeholder="Search">
      <input type="hidden" name="sitesearch" value="https://zaina.newban.cn">
      <button type="submit" class="submit icon-search"></button>
</form>
    </section>
    
    <section class="widget">
        <h3 class="widget-title">最近文章</h3>
<ul class="widget-list">
    
    <li>
        <a href="https://zaina.newban.cn/posts/001rubyruby%E4%B8%AD%E5%85%A8%E5%B1%80%E5%8F%98%E9%87%8F%E5%AE%9E%E4%BE%8B%E5%8F%98%E9%87%8F%E5%B1%80%E9%83%A8%E5%8F%98%E9%87%8F%E7%B1%BB%E5%8F%98%E9%87%8Fsymbol%E5%AF%B9%E6%AF%94/" title="001rubyRuby中全局变量实例变量局部变量类变量Symbol对比">001rubyRuby中全局变量实例变量局部变量类变量Symbol对比</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/007hadoop%E9%9B%86%E7%BE%A4%E9%85%8D%E7%BD%AEhadoop%E9%9B%86%E7%BE%A4%E7%9A%84%E5%90%AF%E5%8A%A8%E5%92%8C%E6%B5%8B%E8%AF%95ssh%E5%85%8D%E7%99%BB%E9%99%86%E9%85%8D%E7%BD%AEstartallshhdfs%E5%B8%B8%E7%94%A8%E7%9A%84shell/" title="007Hadoop集群配置Hadoop集群的启动和测试SSH免登陆配置startallshhdfs常用的shell">007Hadoop集群配置Hadoop集群的启动和测试SSH免登陆配置startallshhdfs常用的shell</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/009shell%E8%84%9A%E6%9C%AC%E4%B8%8B%E6%9D%A1%E4%BB%B6%E6%B5%8B%E8%AF%95eqne/" title="009Shell脚本下条件测试eqne">009Shell脚本下条件测试eqne</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/00pythonmanagepyshell%E5%92%8Cpython%E7%9A%84%E5%88%86%E6%9E%90/" title="00Pythonmanagepyshell和Python的分析">00Pythonmanagepyshell和Python的分析</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/010zookeeper%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5zookeeper%E7%9A%84%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BAzookeeper%E7%9A%84shell%E5%91%BD%E4%BB%A4/" title="010Zookeeper的基本概念Zookeeper的集群搭建Zookeeper的shell命令">010Zookeeper的基本概念Zookeeper的集群搭建Zookeeper的shell命令</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/018dockerfileshell/" title="018DockerfileSHELL">018DockerfileSHELL</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/01shell%E5%85%A5%E9%97%A801bashshell%E7%89%B9%E6%80%A7/" title="01Shell入门01bashShell特性">01Shell入门01bashShell特性</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/01shell%E5%8F%98%E9%87%8F/" title="01Shell变量">01Shell变量</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/01shell%E5%9F%BA%E7%A1%80%E6%A6%82%E8%BF%B0%E8%84%9A%E6%9C%AC%E6%89%A7%E8%A1%8C%E6%96%B9%E5%BC%8Fbash%E5%9F%BA%E6%9C%AC%E5%8A%9F%E8%83%BD/" title="01Shell基础概述脚本执行方式Bash基本功能">01Shell基础概述脚本执行方式Bash基本功能</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/01shell%E7%BC%96%E7%A8%8Bhelloworld/" title="01shell编程helloworld">01shell编程helloworld</a>
    </li>
    
</ul>
    </section>

    

    <section class="widget">
        <h3 class="widget-title"><a href="/categories">分类</a></h3>
<ul class="widget-list">
    
</ul>
    </section>

    <section class="widget">
        <h3 class="widget-title"><a href="/tags">标签</a></h3>
<div class="tagcloud">
    
    <a href="https://zaina.newban.cn/tags/ruby/">ruby</a>
    
    <a href="https://zaina.newban.cn/tags/shell/">shell</a>
    
</div>
    </section>

    

    <section class="widget">
        <h3 class="widget-title">其它</h3>
        <ul class="widget-list">
            <li><a href="https://zaina.newban.cn/index.xml">文章 RSS</a></li>
        </ul>
    </section>
</div>
            </div>
        </div>
    </div>
</body>

</html>