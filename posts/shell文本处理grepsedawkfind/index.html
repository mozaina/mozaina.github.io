<!doctype html>
<html lang="en-us">
<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">


    <title>Shell文本处理grepsedawkfind | 开发者问答集锦</title>
    <meta property="og:title" content="Shell文本处理grepsedawkfind - 开发者问答集锦">
    <meta property="og:type" content="article">
        
    <meta property="article:published_time" content='2020-09-02T00:00:00&#43;08:00'>
        
        
    <meta property="article:modified_time" content='2020-09-02T00:00:00&#43;08:00'>
        
    <meta name="Keywords" content="">
    <meta name="description" content="Shell文本处理grepsedawkfind">
        
    <meta name="author" content="">
    <meta property="og:url" content="https://zaina.newban.cn/posts/shell%E6%96%87%E6%9C%AC%E5%A4%84%E7%90%86grepsedawkfind/">
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">

    <link rel="stylesheet" href='/css/normalize.css'>
    <link rel="stylesheet" href='/css/style.css'>
    <script type="text/javascript" src="//cdn.bootcdn.net/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

    
    
    
    
    
    
</head>


<body>
    <header id="header" class="clearfix">
    <div class="container">
        <div class="col-group">
            <div class="site-name ">
                
                    <a id="logo" href="https://zaina.newban.cn">
                        开发者问答集锦
                    </a>
                
                
            </div>
            <div>
                <nav id="nav-menu" class="clearfix">
                    <a class="" href="https://zaina.newban.cn">首页</a>
                    
                </nav>
            </div>
        </div>
    </div>
</header>

    <div id="body">
        <div class="container">
            <div class="col-group">

                <div class="col-8" id="main">
                    
<div class="res-cons">
    
    <article class="post">
        <header>
            <h1 class="post-title">Shell文本处理grepsedawkfind</h1>
        </header>
        <date class="post-meta meta-date">
            2020年9月2日
        </date>
        
        
        <div class="post-meta">
            <span id="busuanzi_container_page_pv">|<span id="busuanzi_value_page_pv"></span><span>
                    阅读</span></span>
        </div>
        
        
        <div class="post-content">
            

<h2 id="一-grep文本过滤命令">一.grep文本过滤命令</h2>

<p><strong>1.grep</strong></p>

<p><strong>全面搜索研究正则表达式并显示出来</strong></p>

<h2 id="grep命令是一种强大的文本搜索工具-根据用户指定的-模式-对目标文本进行匹配检查-打印到匹配的行-由正则表达式或者字符及基本文本字符所编写的过滤条件">grep命令是一种强大的文本搜索工具，根据用户指定的“模式”对目标文本进行匹配检查，打印到匹配的行。 由正则表达式或者字符及基本文本字符所编写的过滤条件</h2>

<p><strong>2.grep的格式</strong></p>

<p>grep 匹配条件 处理文件</p>

<p><strong>3.grep中字符的匹配位置设定</strong></p>

<table>
<thead>
<tr>
<th>^关键字</th>
<th>以“关键字“开头</th>
</tr>
</thead>

<tbody>
<tr>
<td>关键字$</td>
<td>以关键字结尾</td>
</tr>

<tr>
<td>关键字前没有字符</td>
<td></td>
</tr>

<tr>
<td>关键字&gt;</td>
<td>关键字后面没有字符</td>
</tr>

<tr>
<td>关键字前后均没有字符</td>
<td></td>
</tr>
</tbody>
</table>

<pre><code>[root@shell mnt]# cp /etc/passwd  .
[root@shell mnt]# ls
passwd
[root@shell mnt]# vim passwd
</code></pre>

<p><a href="https://img.it610.com/image/info8/f3c9af1b8130474e919f79676a1c6806.jpg"><img src="https://img.it610.com/image/info8/f3c9af1b8130474e919f79676a1c6806.jpg" alt="Shell:文本处理（grep/sed/awk/find\)_第1张图片" /></a></p>

<pre><code>[root@shell mnt]# grep root passwd
[root@shell mnt]# grep -i root passwd  ##过滤root其中包含大写
[root@shell mnt]# grep -i &quot;\&quot; passwd   #root前后都不含有附加字符
[root@shell mnt]# grep -i &quot;^\&quot; passwd  #在上一步的基础上以root开头的
</code></pre>

<p><a href="https://img.it610.com/image/info8/2e8c94c1e7b3485988c6a54f30732a0e.jpg"><img src="https://img.it610.com/image/info8/2e8c94c1e7b3485988c6a54f30732a0e.jpg" alt="Shell:文本处理（grep/sed/awk/find\)_第2张图片" /></a></p>

<pre><code>[root@shell mnt]# grep -i &quot;^root&quot; passwd  #同上
[root@shell mnt]# grep -i &quot;^\$&quot; passwd #以root开头以root结尾
[root@shell mnt]# grep -i &quot;\$&quot; passwd  #以root结尾的
</code></pre>

<p><a href="https://img.it610.com/image/info8/aa3577a24423416ebb10ec5f51920b9a.png"><img src="https://img.it610.com/image/info8/aa3577a24423416ebb10ec5f51920b9a.png" alt="Shell:文本处理（grep/sed/awk/find\)_第3张图片" /></a><br />
<strong>4.grep中的正则表达式</strong></p>

<pre><code>grep r... file   #以r开头的任意3个字符的行
grep r...t  file    #以r开头，t结尾的，并且中间有任意三个字符的行
grep  ..t  file   #以t结尾的，前面有3个字符的行 
</code></pre>

<p><a href="https://img.it610.com/image/info8/d02fff02b61941199a5589b410ee98a9.png"><img src="https://img.it610.com/image/info8/d02fff02b61941199a5589b410ee98a9.png" alt="Shell:文本处理（grep/sed/awk/find\)_第4张图片" /></a><br />
<a href="https://img.it610.com/image/info8/f322791113954d9e8bbb8dc309940a62.png"><img src="https://img.it610.com/image/info8/f322791113954d9e8bbb8dc309940a62.png" alt="Shell:文本处理（grep/sed/awk/find\)_第5张图片" /></a><br />
<a href="https://img.it610.com/image/info8/482f1da84b7148148ebe7392a8f89c2d.jpg"><img src="https://img.it610.com/image/info8/482f1da84b7148148ebe7392a8f89c2d.jpg" alt="Shell:文本处理（grep/sed/awk/find\)_第6张图片" /></a><br />
<strong>5.grep正则表达式与扩展正则表达式</strong></p>

<ul>
<li>正规的grep不支持扩展的正则表达式</li>
<li>| 是用于表示或的扩展正则表达式字符，正规的grep无法识别</li>

<li><p>加 \ ,这个字符就被翻译成扩展的正则表达式，就像egrep和grep -E一样。</p>

<p>[root@shell mnt]# grep -iE &ldquo;^root&gt;||</p></li>
</ul>

<p><a href="https://img.it610.com/image/info8/63e387b23c4b4bb7b9a22ef29660312a.png"><img src="https://img.it610.com/image/info8/63e387b23c4b4bb7b9a22ef29660312a.png" alt="Shell:文本处理（grep/sed/awk/find\)_第7张图片" /></a></p>

<pre><code>[root@shell mnt]# grep -iE &quot;^root\&gt;|\|\|\&quot;
</code></pre>

<p><a href="https://img.it610.com/image/info8/513200fe35c74baf8e31c1e10c0744f8.jpg"><img src="https://img.it610.com/image/info8/513200fe35c74baf8e31c1e10c0744f8.jpg" alt="Shell:文本处理（grep/sed/awk/find\)_第8张图片" /></a><br />
<strong>6.grep中字符匹配次数的设定</strong></p>

<table>
<thead>
<tr>
<th>.*</th>
<th>关键字之间匹配任意字符</th>
</tr>
</thead>

<tbody>
<tr>
<td>*</td>
<td>字符出现【0-任意次】</td>
</tr>

<tr>
<td>?</td>
<td>字符出现[ 0-1]次</td>
</tr>

<tr>
<td>+</td>
<td>字符出现1到任意次</td>
</tr>

<tr>
<td>{n}</td>
<td>字符出现n次</td>
</tr>

<tr>
<td>{m,n}</td>
<td>字符出现【最少出现m次，最多出现n次</td>
</tr>

<tr>
<td>{0,n}</td>
<td>字符出现0到n次</td>
</tr>

<tr>
<td>{m,}</td>
<td>字符出现至少m次</td>
</tr>

<tr>
<td>xy{n}xy</td>
<td>关键字出现n次</td>
</tr>
</tbody>
</table>

<p><a href="https://img.it610.com/image/info8/872d8bca639a4ae2aa32559aff8e1207.jpg"><img src="https://img.it610.com/image/info8/872d8bca639a4ae2aa32559aff8e1207.jpg" alt="Shell:文本处理（grep/sed/awk/find\)_第9张图片" /></a><br />
<a href="https://img.it610.com/image/info8/2463c5bdad1541d2b7dd219e1e76a0de.png"><img src="https://img.it610.com/image/info8/2463c5bdad1541d2b7dd219e1e76a0de.png" alt="Shell:文本处理（grep/sed/awk/find\)_第10张图片" /></a></p>

<pre><code>[root@shell mnt]# grep -E &quot;x*&quot; test  #过滤x无数次
</code></pre>

<p><a href="https://img.it610.com/image/info8/ca95f442272f46aa8605dcd4e2c95f0a.png"><img src="https://img.it610.com/image/info8/ca95f442272f46aa8605dcd4e2c95f0a.png" alt="Shell:文本处理（grep/sed/awk/find\)_第11张图片" /></a></p>

<pre><code>[root@shell mnt]# grep -E &quot;x?*&quot; test 
</code></pre>

<p><a href="https://img.it610.com/image/info8/a3359292a99e425cbaa2241b6f93145c.png"><img src="https://img.it610.com/image/info8/a3359292a99e425cbaa2241b6f93145c.png" alt="Shell:文本处理（grep/sed/awk/find\)_第12张图片" /></a></p>

<pre><code>[root@shell mnt]# grep -E &quot;x?y&quot; test
</code></pre>

<p><a href="https://img.it610.com/image/info8/23c45bd3fefd4f2a8debca75852df4dd.png"><img src="https://img.it610.com/image/info8/23c45bd3fefd4f2a8debca75852df4dd.png" alt="Shell:文本处理（grep/sed/awk/find\)_第13张图片" /></a></p>

<pre><code>[root@shell mnt]# grep -E &quot;x+y&quot; test
</code></pre>

<p><a href="https://img.it610.com/image/info8/52bb98a1fd9d41caa984abb8ed955792.png"><img src="https://img.it610.com/image/info8/52bb98a1fd9d41caa984abb8ed955792.png" alt="Shell:文本处理（grep/sed/awk/find\)_第14张图片" /></a></p>

<pre><code>[root@shell mnt]# grep -E &quot;x{3}y&quot; test
</code></pre>

<p><a href="https://img.it610.com/image/info8/85bc7e3b8b44448b822dca97724c27ec.png"><img src="https://img.it610.com/image/info8/85bc7e3b8b44448b822dca97724c27ec.png" alt="Shell:文本处理（grep/sed/awk/find\)_第15张图片" /></a></p>

<pre><code>[root@shell mnt]# grep -E &quot;x{1,}y&quot;  test
</code></pre>

<p><a href="https://img.it610.com/image/info8/769a0adac1ca49d8ae79436f6667b5b4.png"><img src="https://img.it610.com/image/info8/769a0adac1ca49d8ae79436f6667b5b4.png" alt="Shell:文本处理（grep/sed/awk/find\)_第16张图片" /></a></p>

<pre><code>[root@shell mnt]# grep -E &quot;(xy)?&quot; test  #字符出现0-1次
</code></pre>

<p><a href="https://img.it610.com/image/info8/400c92e697f842288074af394651282d.png"><img src="https://img.it610.com/image/info8/400c92e697f842288074af394651282d.png" alt="Shell:文本处理（grep/sed/awk/find\)_第17张图片" /></a></p>

<h2 id="二-sed行编辑器">二.sed行编辑器</h2>

<p><strong>1.sed</strong></p>

<ul>
<li>用来操作纯ASCll码的文本</li>
<li>处理时，把当前处理的行存储在临时缓冲区中，称为“模式间“，可以指定仅仅处理那些行</li>
<li>sed符合末世条件的处理，不符合条件的不与处理</li>
<li>处理完之后把缓冲区的内容送往屏幕</li>
<li>接着处理下一行，这样不断的重复，直到文件末尾</li>
</ul>

<p><strong>调用sed命令格式：</strong><br />
sed [options] ‘command’ file<br />
sed [options] -f scriptfile file</p>

<p><strong>2.p模式操作</strong></p>

<p><a href="https://img.it610.com/image/info8/adedc3649fb7496e9dd41547f51597e3.png"><img src="https://img.it610.com/image/info8/adedc3649fb7496e9dd41547f51597e3.png" alt="在这里插入图片描述" /></a></p>

<pre><code>[root@shell mnt]# sed -n /^#/p fstab  ##显示#开头的行
[root@shell mnt]# sed -n '/^#/!'p fstab  ##显示不以#开头的行
</code></pre>

<p><a href="https://img.it610.com/image/info8/d2ce93ec057b49ca83e7090fd558dda7.jpg"><img src="https://img.it610.com/image/info8/d2ce93ec057b49ca83e7090fd558dda7.jpg" alt="Shell:文本处理（grep/sed/awk/find\)_第18张图片" /></a></p>

<pre><code>[root@shell mnt]# cat -n fstab   ##显示行号
[root@shell mnt]# cat -b fstab   ##显示行号并且不显示空白行
</code></pre>

<p><a href="https://img.it610.com/image/info8/27d45131b70145d49aad0a02334c6e9f.jpg"><img src="https://img.it610.com/image/info8/27d45131b70145d49aad0a02334c6e9f.jpg" alt="Shell:文本处理（grep/sed/awk/find\)_第19张图片" /></a></p>

<pre><code>[root@shell mnt]# cat -n fstab  | sed -n '2,6p'  ##显示第二到第六行
[root@shell mnt]# cat -n fstab  | sed -n '6p'  ##显示第六行
[root@shell mnt]# cat -n fstab  | sed -n -e '6p' -e '2p'  ##只显示第二行和第六行
</code></pre>

<p><a href="https://img.it610.com/image/info8/0c5ce756653c485dae144783a1b7d9b0.png"><img src="https://img.it610.com/image/info8/0c5ce756653c485dae144783a1b7d9b0.png" alt="Shell:文本处理（grep/sed/awk/find\)_第20张图片" /></a></p>

<pre><code>[root@shell mnt]# cat -n fstab  | sed -n -e '6p;2p'   ##只显示第二行和第六行
[root@shell mnt]# cat -n fstab  | sed -n -e '2,6!p'   ##不显示第二行和第六行，其他的全都显示
</code></pre>

<p><a href="https://img.it610.com/image/info8/0cb1f199cbb146debf0a6656bac8eac9.jpg"><img src="https://img.it610.com/image/info8/0cb1f199cbb146debf0a6656bac8eac9.jpg" alt="Shell:文本处理（grep/sed/awk/find\)_第21张图片" /></a><br />
<strong>3.d模式操作</strong></p>

<pre><code>[root@shell mnt]# sed '/^#/d' fstab    ##删掉以#开头的行
[root@shell mnt]# sed -e '/^#/d' fstab  ##删掉以#号开头的行
</code></pre>

<p><a href="https://img.it610.com/image/info8/97d7b4620a0c4a16b0ea79138f193271.png"><img src="https://img.it610.com/image/info8/97d7b4620a0c4a16b0ea79138f193271.png" alt="Shell:文本处理（grep/sed/awk/find\)_第22张图片" /></a></p>

<pre><code>[root@shell mnt]# cat -n fstab | sed '4,6d'
[root@shell mnt]# cat -n fstab | sed '4d'  ##显示行号并删掉第四行
[root@shell mnt]# cat -n fstab | sed '4d;6d'
</code></pre>

<p><a href="https://img.it610.com/image/info8/3d2bac7561e342ef80abb453c0c284b1.jpg"><img src="https://img.it610.com/image/info8/3d2bac7561e342ef80abb453c0c284b1.jpg" alt="Shell:文本处理（grep/sed/awk/find\)_第23张图片" /></a><br />
<a href="https://img.it610.com/image/info8/99e057d98c8647b7ad38255411ae2516.jpg"><img src="https://img.it610.com/image/info8/99e057d98c8647b7ad38255411ae2516.jpg" alt="Shell:文本处理（grep/sed/awk/find\)_第24张图片" /></a></p>

<pre><code>[root@shell mnt]# sed '/^UUID/d'  fstab  ##删掉以次开头的行
[root@shell mnt]# sed '/^UUID/!d'  fstab  ##不删除以此开头的行其它行都删掉
</code></pre>

<p><a href="https://img.it610.com/image/info8/5762b52447de4be09984101eba9c06fc.jpg"><img src="https://img.it610.com/image/info8/5762b52447de4be09984101eba9c06fc.jpg" alt="Shell:文本处理（grep/sed/awk/find\)_第25张图片" /></a><br />
<strong>4.a模式操作</strong></p>

<pre><code>[root@shell mnt]# sed '/UUID/ahello' fstab   ##在UUID这一行后面加hello
[root@shell mnt]# sed 'ahello' fstab
</code></pre>

<p><a href="https://img.it610.com/image/info8/270528ae93ac4fc8af04dcb619920848.jpg"><img src="https://img.it610.com/image/info8/270528ae93ac4fc8af04dcb619920848.jpg" alt="Shell:文本处理（grep/sed/awk/find\)_第26张图片" /></a></p>

<pre><code>[root@shell mnt]# echo 'hello'  &gt;&gt; fstab  ##文件最后添加hello,直接更改文件内容
[root@shell mnt]# sed '/^UUID/ahello\nwestos' fstab ##在UUID这一行后面加hello，换行后在加westos
</code></pre>

<p><a href="https://img.it610.com/image/info8/6a0c22c865ac43a2bf86e2d5f7ccc618.jpg"><img src="https://img.it610.com/image/info8/6a0c22c865ac43a2bf86e2d5f7ccc618.jpg" alt="Shell:文本处理（grep/sed/awk/find\)_第27张图片" /></a><br />
<a href="https://img.it610.com/image/info8/9a49b465a5f043a4ad9e45ed34066a44.jpg"><img src="https://img.it610.com/image/info8/9a49b465a5f043a4ad9e45ed34066a44.jpg" alt="Shell:文本处理（grep/sed/awk/find\)_第28张图片" /></a><br />
<strong>5.i模式</strong></p>

<pre><code>[root@shell mnt]# sed '/^UUID/ihello' fstab     ##在UUID的前一行添加hello
[root@shell mnt]# sed '/^UUID/ihello\nwestos' fstab ##在UUID的前一行添加hello,并且换行再添加westos
</code></pre>

<p><a href="https://img.it610.com/image/info8/0e8b21eb0234450c833aa2f3dc9aa761.png"><img src="https://img.it610.com/image/info8/0e8b21eb0234450c833aa2f3dc9aa761.png" alt="Shell:文本处理（grep/sed/awk/find\)_第29张图片" /></a><br />
<a href="https://img.it610.com/image/info8/9a18e97f9607495488e8fc0a95ef2054.png"><img src="https://img.it610.com/image/info8/9a18e97f9607495488e8fc0a95ef2054.png" alt="Shell:文本处理（grep/sed/awk/find\)_第30张图片" /></a><br />
<strong>6.w模式</strong></p>

<pre><code>[root@shell mnt]# sed '/^#/w /mnt/testfile' fstab  
[root@shell mnt]# sed -n '/^#/w /mnt/testfile' fstab  ##fstab下的以#号开头的都考到/mnt/testfile，-n表示不显示内容
</code></pre>

<p><a href="https://img.it610.com/image/info8/ad40fddf0239404f92f3db10c36141a8.jpg"><img src="https://img.it610.com/image/info8/ad40fddf0239404f92f3db10c36141a8.jpg" alt="Shell:文本处理（grep/sed/awk/find\)_第31张图片" /></a><br />
<a href="https://img.it610.com/image/info8/1a205a17e4ea4220a7865e154c40227e.jpg"><img src="https://img.it610.com/image/info8/1a205a17e4ea4220a7865e154c40227e.jpg" alt="Shell:文本处理（grep/sed/awk/find\)_第32张图片" /></a><br />
<strong>7.sed的其它用法</strong></p>

<p><strong>（1）内容的添加及行号的显示</strong></p>

<pre><code>[root@shell mnt]# sed '6r /mnt/hello'  /mnt/fstab  ##/mnt/fstab的第六行添加/mnt/hello里面的内容
</code></pre>

<p><a href="https://img.it610.com/image/info8/4c2de656fb93404982314330524347df.jpg"><img src="https://img.it610.com/image/info8/4c2de656fb93404982314330524347df.jpg" alt="Shell:文本处理（grep/sed/awk/find\)_第33张图片" /></a></p>

<pre><code>[root@shell mnt]# sed '!r/mnt/fstab'  /mnt/hello  ##/mnt/hello下的每一行都不添加/mnt/fstab里面的内容
[root@shell mnt]# sed 'r/mnt/hello'  /mnt/fstab  ##/mnt/fstab中的每一行添加/mnt/hello里面的内容
</code></pre>

<p><a href="https://img.it610.com/image/info8/b0f791e4adf94132ba511a6ad58ad0bb.jpg"><img src="https://img.it610.com/image/info8/b0f791e4adf94132ba511a6ad58ad0bb.jpg" alt="Shell:文本处理（grep/sed/awk/find\)_第34张图片" /></a></p>

<ul>
<li><p>sed ‘s/27/67/g’ ifcfg-br0 ##替换并显示但不更改文件中的内容</p></li>

<li><p>sed ‘s/27/67/g’ -i ifcfg-br0 ##替换并且更改配置文件中的内容</p>

<p>[root@shell mnt]# sed -n &lsquo;/^UUID/=&rsquo; fstab  ##显示行号
[root@shell mnt]# sed -ne &lsquo;/^UUID/=;/^UUID/p&rsquo; fstab  ##显示内容并显示行号
[root@shell mnt]# sed -ne &lsquo;/^UUID/=;/^UUID/p&rsquo; fstab  | sed &lsquo;N;s/\n//g&rsquo;  ##N提前提取模式空间的内容，即俩个的输入合并</p></li>
</ul>

<p><a href="https://img.it610.com/image/info8/6ef12271c345470fa9bdac290676cd2e.png"><img src="https://img.it610.com/image/info8/6ef12271c345470fa9bdac290676cd2e.png" alt="Shell:文本处理（grep/sed/awk/find\)_第35张图片" /></a><br />
注：N表示提前提取模式空间的内容</p>

<p>练习：写一个脚本，再/mnt/fstab中添加行号</p>

<pre><code>[root@shell mnt]# vim fstab1.sh
</code></pre>

<p>脚本内容为：<br />
<a href="https://img.it610.com/image/info8/1bff5c7e1a77422281a5c348a6fc5a4b.png"><img src="https://img.it610.com/image/info8/1bff5c7e1a77422281a5c348a6fc5a4b.png" alt="在这里插入图片描述" /></a><br />
验证如下：<br />
<a href="https://img.it610.com/image/info8/2722e4d7eddb4fb295e18787108c5b0a.jpg"><img src="https://img.it610.com/image/info8/2722e4d7eddb4fb295e18787108c5b0a.jpg" alt="Shell:文本处理（grep/sed/awk/find\)_第36张图片" /></a><br />
<strong>（2）文件内容的修改,替换和添加</strong></p>

<pre><code>[root@shell mnt]# cp /etc/passwd  .
[root@shell mnt]# sed '/s/nologin/bash/g'  passwd
[root@shell mnt]# sed '=' -i  passwd  ##显示行号
[root@shell mnt]# sed 'N;s/\n/ /g' -i  passwd  ##追加
</code></pre>

<p><a href="https://img.it610.com/image/info8/92064611f19346c2a02d19e400c5de38.jpg"><img src="https://img.it610.com/image/info8/92064611f19346c2a02d19e400c5de38.jpg" alt="Shell:文本处理（grep/sed/awk/find\)_第37张图片" /></a><br />
<a href="https://img.it610.com/image/info8/6206328706b44d5ebe952261e7fbbc56.jpg"><img src="https://img.it610.com/image/info8/6206328706b44d5ebe952261e7fbbc56.jpg" alt="Shell:文本处理（grep/sed/awk/find\)_第38张图片" /></a></p>

<pre><code>[root@shell mnt]# sed '1,5s/nologin/bash/g' passwd  ##修改1到5行
[root@shell mnt]# sed '5s/nologin/bash/g' passwd  ##修改第五行
[root@shell mnt]# sed -e '5s/nologin/bash/g;3s/nologin/bash/g'  passwd  #修改第一行和第五行
[root@shell mnt]# sed  '/daemon/,/mail/s/nologin/bash/g'  passwd #修改以/daemon/到/mail中的内容
</code></pre>

<p><a href="https://img.it610.com/image/info8/1ea13ef7d41946b1b6d141916690672a.jpg"><img src="https://img.it610.com/image/info8/1ea13ef7d41946b1b6d141916690672a.jpg" alt="Shell:文本处理（grep/sed/awk/find\)_第39张图片" /></a><br />
<a href="https://img.it610.com/image/info8/a816f47efa50472f8bd7ebac5d68b689.png"><img src="https://img.it610.com/image/info8/a816f47efa50472f8bd7ebac5d68b689.png" alt="Shell:文本处理（grep/sed/awk/find\)_第40张图片" /></a><br />
<a href="https://img.it610.com/image/info8/062d32c4012b4e30badc2d9d5ea7f2cb.png"><img src="https://img.it610.com/image/info8/062d32c4012b4e30badc2d9d5ea7f2cb.png" alt="Shell:文本处理（grep/sed/awk/find\)_第41张图片" /></a></p>

<pre><code>[root@shell mnt]# sed 's@/@ @g'  passwd   ##把该文件下的/换成空格
[root@shell mnt]# sed 's@nologin@bash@g' passwd  ##替换全文的nologin为bash的另一种方法
</code></pre>

<p><a href="https://img.it610.com/image/info8/63e80f4e128948ce90645d171684c594.png"><img src="https://img.it610.com/image/info8/63e80f4e128948ce90645d171684c594.png" alt="Shell:文本处理（grep/sed/awk/find\)_第42张图片" /></a><br />
<a href="https://img.it610.com/image/info8/17de2b4462604532925facc734147ac3.jpg"><img src="https://img.it610.com/image/info8/17de2b4462604532925facc734147ac3.jpg" alt="Shell:文本处理（grep/sed/awk/find\)_第43张图片" /></a></p>

<pre><code>[root@shell mnt]# sed '$!G' passwd   ##每行后面都加空白行
[root@shell mnt]# sed -n '$p' passwd   ##打印最后一行
</code></pre>

<p><a href="https://img.it610.com/image/info8/2b6a1c46eee246e08303117c841960a5.jpg"><img src="https://img.it610.com/image/info8/2b6a1c46eee246e08303117c841960a5.jpg" alt="Shell:文本处理（grep/sed/awk/find\)_第44张图片" /></a><br />
<a href="https://img.it610.com/image/info8/3e0f9b00d72f4121a7ca9315278546ac.png"><img src="https://img.it610.com/image/info8/3e0f9b00d72f4121a7ca9315278546ac.png" alt="在这里插入图片描述" /></a><br />
<strong>练习：</strong><br />
编辑脚本，当输出为8080，或6666时更改httpd的端口，当输出为空时显示要输入，输出不符合时显示错误</p>

<pre><code>[root@shell mnt]# vim httpd.sh
</code></pre>

<p>脚本编辑内容为：<br />
<a href="https://img.it610.com/image/info8/26b31109506e4d8490b3225b67c01e91.jpg"><img src="https://img.it610.com/image/info8/26b31109506e4d8490b3225b67c01e91.jpg" alt="Shell:文本处理（grep/sed/awk/find\)_第45张图片" /></a><br />
注意：$要用“”符号进行转换，=为绝对等于，而eq只是比较整数的大小<br />
验证如下：<br />
<a href="https://img.it610.com/image/info8/dc0aab0067634b1281d43996ee2f3372.png"><img src="https://img.it610.com/image/info8/dc0aab0067634b1281d43996ee2f3372.png" alt="Shell:文本处理（grep/sed/awk/find\)_第46张图片" /></a></p>

<h2 id="三-awk报告生成器">三.awk报告生成器</h2>

<p><strong>1.awk</strong></p>

<p>awk处理机制：逐行处理文本，支持在处理第一行之前做一些准备工作，以及在处理完最后一行做一些总结性质的工作。</p>

<p>awk在命令格式上分别体现如下：</p>

<ul>
<li>BEGIN{}:读入第一行文本之前执行，一般用来初始化操作</li>
<li>{}:逐行读入文本，执行相应的处理。是最常见的编辑指令块</li>
<li>END{}:处理完最后以行文本后执行，一般用来输出处理结果</li>
</ul>

<p><strong>2.awk的使用</strong></p>

<ul>
<li>分隔符：-F 或 空格</li>
<li>FILENAME：逐行处理</li>

<li><p>不加引号默认执行的动作</p>

<p>[root@localhost mnt]# awk -F : &lsquo;BEGIN{print &ldquo;hello&rdquo;}{print $1}END{print &ldquo;end&rdquo;}&rsquo; passwd #在该文件下的第一列打印一hello开头以end结尾
[root@localhost mnt]# awk -F : &lsquo;{print FILENAME}&rsquo; passwd  #逐行处理该文件</p></li>
</ul>

<p><a href="https://img.it610.com/image/info8/8424a385f605491ca229f56e92ce747d.jpg"><img src="https://img.it610.com/image/info8/8424a385f605491ca229f56e92ce747d.jpg" alt="Shell:文本处理（grep/sed/awk/find\)_第47张图片" /></a><br />
<a href="https://img.it610.com/image/info8/87d9cd5f7c9540e6b53e9bd4d98051c1.png"><img src="https://img.it610.com/image/info8/87d9cd5f7c9540e6b53e9bd4d98051c1.png" alt="Shell:文本处理（grep/sed/awk/find\)_第48张图片" /></a></p>

<pre><code>[root@localhost mnt]# awk -F : '{print NR}' passwd  #打印行
[root@localhost mnt]# awk -F : '{print NF}' passwd   #打印列
[root@localhost mnt]# awk -F : 'BEGIN{print &quot;NAME&quot;}' 
NAME
</code></pre>

<p><a href="https://img.it610.com/image/info8/9f14e96def7b4efb857d72c9dec850ea.jpg"><img src="https://img.it610.com/image/info8/9f14e96def7b4efb857d72c9dec850ea.jpg" alt="Shell:文本处理（grep/sed/awk/find\)_第49张图片" /></a><br />
<img src="https://img.it610.com/image/info8/3b390f3849c34189b49c78feaab1d040.png" alt="在这里插入图片描述" /></p>

<pre><code>[root@localhost mnt]# awk -F : '{print $1}' passwd  #打印第一列
[root@localhost mnt]# awk -F : '/bash$/{print $1}' passwd  #以bash结尾的第一列
[root@localhost mnt]# awk -F : '!/bash$/{print $1}' passwd  #不以bash结尾的第一列
</code></pre>

<p><a href="https://img.it610.com/image/info8/1f6cce1c983b4ff0ba3f219041d3085d.jpg"><img src="https://img.it610.com/image/info8/1f6cce1c983b4ff0ba3f219041d3085d.jpg" alt="Shell:文本处理（grep/sed/awk/find\)_第50张图片" /></a></p>

<pre><code>[root@localhost mnt]# awk 'BEGIN{N=0}/bash$/{N++}END{print  N}' passwd #显示该文件中能登陆系统的用户的个数
</code></pre>

<p><a href="https://img.it610.com/image/info8/1cebc189b45641409b75a36f26692fdf.png"><img src="https://img.it610.com/image/info8/1cebc189b45641409b75a36f26692fdf.png" alt="在这里插入图片描述" /></a></p>

<pre><code>[root@localhost mnt]# awk 'BEGIN{N=100;print N+50}'  ##100+50
[root@localhost mnt]# awk '/[a-d]/{print}' passwd #打印a-d的
[root@localhost mnt]# awk '/^[a-d]/{print}' passwd #以a-d开头的
[root@localhost mnt]# awk '!/^[a-d]/{print}' passwd  #不以a-d开头的
[root@localhost mnt]# awk '/^[^a-d]/{print}' passwd  #不以a-d开头的另一种表示
[root@localhost mnt]# awk '!/^[a-d]/{print}' passwd  #不以a-d开头的另一种表示
[root@localhost mnt]# awk '/^[!a-d]/{print}' passwd  
</code></pre>

<p><a href="https://img.it610.com/image/info8/febc7396429441e2bf02b9181c134e03.jpg"><img src="https://img.it610.com/image/info8/febc7396429441e2bf02b9181c134e03.jpg" alt="Shell:文本处理（grep/sed/awk/find\)_第51张图片" /></a></p>

<pre><code>[root@localhost mnt]# awk -F : '$6~/bin$/' passwd  #第6列以bin结尾的，开头任意
[root@localhost mnt]# awk -F : '$6~/\
</code></pre>

<p><a href="https://img.it610.com/image/info8/fe328e10fcab4c77aeb460fbd538c06a.png"><img src="https://img.it610.com/image/info8/fe328e10fcab4c77aeb460fbd538c06a.png" alt="Shell:文本处理（grep/sed/awk/find\)_第52张图片" /></a><br />
<a href="https://img.it610.com/image/info8/3c89311e22b2400e9351ae5a29724248.png"><img src="https://img.it610.com/image/info8/3c89311e22b2400e9351ae5a29724248.png" alt="Shell:文本处理（grep/sed/awk/find\)_第53张图片" /></a><br />
<strong>练习：</strong><br />
（1）用户的家目录不再home底下并且能登陆系统的用户，并且把这样的用户显示出来</p>

<pre><code>[root@localhost mnt]# useradd -d /mnt/hello hello  ##建立hello家目录在/mnt下
[root@localhost mnt]# ls /home/
[root@localhost mnt]# awk -F : '$6!~/^\/home/&amp;&amp;/bash$/{print $1}'   /etc
</code></pre>

<p><a href="https://img.it610.com/image/info8/8e85847e1c2d475d8e791eb2d403d827.png"><img src="https://img.it610.com/image/info8/8e85847e1c2d475d8e791eb2d403d827.png" alt="在这里插入图片描述" /></a><br />
<a href="https://img.it610.com/image/info8/93bae9fd14f14ea5b45d56e5ce807f12.png"><img src="https://img.it610.com/image/info8/93bae9fd14f14ea5b45d56e5ce807f12.png" alt="在这里插入图片描述" /></a><br />
（2）抓取eth0网卡的ip</p>

<pre><code>ifconfig
ifconfig  eth0 | awk '/inet\&gt;/{print $2}'
</code></pre>

<p><a href="https://img.it610.com/image/info8/30fa579af0464a2d8658f7d8e0653656.jpg"><img src="https://img.it610.com/image/info8/30fa579af0464a2d8658f7d8e0653656.jpg" alt="Shell:文本处理（grep/sed/awk/find\)_第54张图片" /></a></p>

<h2 id="四-find命令">四.find命令</h2>

<p>find -name -type</p>

<p><strong>(1)查找目录下的文件</strong></p>

<pre><code>[root@localhost mnt]# find /etc -name passwd
[root@localhost mnt]# find /etc -maxdepth 2 -name passwd
[root@localhost mnt]# find /etc -maxdepth 1 -name passwd
[root@localhost mnt]# find /etc -mindepth 2 -name passwd
</code></pre>

<p><a href="https://img.it610.com/image/info8/524ee4e2b444476fbf88e4450e005e63.jpg"><img src="https://img.it610.com/image/info8/524ee4e2b444476fbf88e4450e005e63.jpg" alt="Shell:文本处理（grep/sed/awk/find\)_第55张图片" /></a><br />
<strong>（2）根据文件的组及用户查找文件</strong></p>

<p><a href="https://img.it610.com/image/info8/bb97766f45204fdf95c4537cd2479c06.jpg"><img src="https://img.it610.com/image/info8/bb97766f45204fdf95c4537cd2479c06.jpg" alt="Shell:文本处理（grep/sed/awk/find\)_第56张图片" /></a></p>

<pre><code>[root@localhost mnt]# find /mnt/ -group student  
[root@localhost mnt]# find /mnt/ -user root
[root@localhost mnt]# find /mnt/ -user root -a -group student
[root@localhost mnt]# find /mnt/ -user root -o -group student
[root@localhost mnt]# find /mnt/ -user root -o  -not -group student
</code></pre>

<p><a href="https://img.it610.com/image/info8/d3c9acc51120481ab110591e3d9723fb.jpg"><img src="https://img.it610.com/image/info8/d3c9acc51120481ab110591e3d9723fb.jpg" alt="Shell:文本处理（grep/sed/awk/find\)_第57张图片" /></a><br />
<strong>(3)根据文件大小来查找文件</strong><br />
<a href="https://img.it610.com/image/info8/7f456c2ceaff4e3b92cbd5daf92cd319.jpg"><img src="https://img.it610.com/image/info8/7f456c2ceaff4e3b92cbd5daf92cd319.jpg" alt="Shell:文本处理（grep/sed/awk/find\)_第58张图片" /></a></p>

<pre><code>[root@localhost mnt]# find /mnt -size 20k
root@localhost mnt]# find /mnt -size -20k  #&quot;-&quot;表示小于
[root@localhost mnt]# find /mnt -size +20k #“+”表示大于
[root@localhost mnt]# find /mnt -size +20k -exec rm -rf {} \;  ##发现/mnt下的大于20k的文件并且删除，加\为转义，；为命令中的，如果不加转义，则表示为另一条命令。
</code></pre>

<p><a href="https://img.it610.com/image/info8/2d470f4c1ed642a4867b57bc0a05a551.jpg"><img src="https://img.it610.com/image/info8/2d470f4c1ed642a4867b57bc0a05a551.jpg" alt="Shell:文本处理（grep/sed/awk/find\)_第59张图片" /></a><strong>（3）根据文件权限查找文件</strong><br />
<a href="https://img.it610.com/image/info8/7454442914b84b319c525158c969e5aa.jpg"><img src="https://img.it610.com/image/info8/7454442914b84b319c525158c969e5aa.jpg" alt="Shell:文本处理（grep/sed/awk/find\)_第60张图片" /></a></p>

<pre><code>[root@localhost mnt]# find /etc -type l  #发现/etc下的类型为链接的
[root@localhost mnt]# find /mnt/ -perm 444  ##发现权限为444的
[root@localhost mnt]# find /mnt -perm -200  ##发现权限的三位都有大于2的文件，就指每一位必须有w的文件
[root@localhost mnt]# find /mnt -perm /444  ##三个里面只要有一个权限为4
[root@localhost mnt]# find /mnt -perm +444  ##与/的意思一样，但是是7以前的版本用的
</code></pre>

<p><a href="https://img.it610.com/image/info8/23a75755b7384598b5db662ac4148303.jpg"><img src="https://img.it610.com/image/info8/23a75755b7384598b5db662ac4148303.jpg" alt="Shell:文本处理（grep/sed/awk/find\)_第61张图片" /></a></p>

        </div>

        


        

<div class="post-archive">
    <h2>See Also</h2>
    <ul class="listing">
        
        <li><a href="/posts/007hadoop%E9%9B%86%E7%BE%A4%E9%85%8D%E7%BD%AEhadoop%E9%9B%86%E7%BE%A4%E7%9A%84%E5%90%AF%E5%8A%A8%E5%92%8C%E6%B5%8B%E8%AF%95ssh%E5%85%8D%E7%99%BB%E9%99%86%E9%85%8D%E7%BD%AEstartallshhdfs%E5%B8%B8%E7%94%A8%E7%9A%84shell/">007Hadoop集群配置Hadoop集群的启动和测试SSH免登陆配置startallshhdfs常用的shell</a></li>
        
        <li><a href="/posts/009shell%E8%84%9A%E6%9C%AC%E4%B8%8B%E6%9D%A1%E4%BB%B6%E6%B5%8B%E8%AF%95eqne/">009Shell脚本下条件测试eqne</a></li>
        
        <li><a href="/posts/00pythonmanagepyshell%E5%92%8Cpython%E7%9A%84%E5%88%86%E6%9E%90/">00Pythonmanagepyshell和Python的分析</a></li>
        
        <li><a href="/posts/010zookeeper%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5zookeeper%E7%9A%84%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BAzookeeper%E7%9A%84shell%E5%91%BD%E4%BB%A4/">010Zookeeper的基本概念Zookeeper的集群搭建Zookeeper的shell命令</a></li>
        
        <li><a href="/posts/018dockerfileshell/">018DockerfileSHELL</a></li>
        
    </ul>
</div>


        <div class="post-meta meta-tags">
            
            <ul class="clearfix">
                
                <li><a href='https://zaina.newban.cn/tags/shell'>shell</a></li>
                
            </ul>
            
        </div>
    </article>
    
    

    
    
</div>

                    <footer id="footer">
    <div>
        &copy; 2020 <a href="https://zaina.newban.cn">开发者问答集锦 By </a>
        
    </div>
    <br />
    <div>
        <div class="github-badge">
            <a href="https://gohugo.io/" target="_black" rel="nofollow"><span class="badge-subject">Powered by</span><span class="badge-value bg-blue">Hugo</span></a>
        </div>
        <div class="github-badge">
            <a href="https://www.flysnow.org/" target="_black"><span class="badge-subject">Design by</span><span class="badge-value bg-brightgreen">飞雪无情</span></a>
        </div>
        <div class="github-badge">
            <a href="https://github.com/flysnow-org/maupassant-hugo" target="_black"><span class="badge-subject">Theme</span><span class="badge-value bg-yellowgreen">Maupassant</span></a>
        </div>
    </div>
</footer>


    
    <script type="text/javascript">
        window.MathJax = {
            tex2jax: {
                inlineMath: [['$', '$']],
                processEscapes: true
                }
            };
    </script>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML' async></script>

<a id="rocket" href="#top"></a>
<script type="text/javascript" src='/js/totop.js?v=0.0.0' async=""></script>



    <script type="text/javascript" src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script>




                </div>

                <div id="secondary">
    <section class="widget">
        <form id="search" action='https://zaina.newban.cn/search/' method="get" accept-charset="utf-8" target="_blank" _lpchecked="1">
      
      <input type="text" name="q" maxlength="20" placeholder="Search">
      <input type="hidden" name="sitesearch" value="https://zaina.newban.cn">
      <button type="submit" class="submit icon-search"></button>
</form>
    </section>
    
    <section class="widget">
        <h3 class="widget-title">最近文章</h3>
<ul class="widget-list">
    
    <li>
        <a href="https://zaina.newban.cn/posts/001rubyruby%E4%B8%AD%E5%85%A8%E5%B1%80%E5%8F%98%E9%87%8F%E5%AE%9E%E4%BE%8B%E5%8F%98%E9%87%8F%E5%B1%80%E9%83%A8%E5%8F%98%E9%87%8F%E7%B1%BB%E5%8F%98%E9%87%8Fsymbol%E5%AF%B9%E6%AF%94/" title="001rubyRuby中全局变量实例变量局部变量类变量Symbol对比">001rubyRuby中全局变量实例变量局部变量类变量Symbol对比</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/007hadoop%E9%9B%86%E7%BE%A4%E9%85%8D%E7%BD%AEhadoop%E9%9B%86%E7%BE%A4%E7%9A%84%E5%90%AF%E5%8A%A8%E5%92%8C%E6%B5%8B%E8%AF%95ssh%E5%85%8D%E7%99%BB%E9%99%86%E9%85%8D%E7%BD%AEstartallshhdfs%E5%B8%B8%E7%94%A8%E7%9A%84shell/" title="007Hadoop集群配置Hadoop集群的启动和测试SSH免登陆配置startallshhdfs常用的shell">007Hadoop集群配置Hadoop集群的启动和测试SSH免登陆配置startallshhdfs常用的shell</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/009shell%E8%84%9A%E6%9C%AC%E4%B8%8B%E6%9D%A1%E4%BB%B6%E6%B5%8B%E8%AF%95eqne/" title="009Shell脚本下条件测试eqne">009Shell脚本下条件测试eqne</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/00pythonmanagepyshell%E5%92%8Cpython%E7%9A%84%E5%88%86%E6%9E%90/" title="00Pythonmanagepyshell和Python的分析">00Pythonmanagepyshell和Python的分析</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/010zookeeper%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5zookeeper%E7%9A%84%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BAzookeeper%E7%9A%84shell%E5%91%BD%E4%BB%A4/" title="010Zookeeper的基本概念Zookeeper的集群搭建Zookeeper的shell命令">010Zookeeper的基本概念Zookeeper的集群搭建Zookeeper的shell命令</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/018dockerfileshell/" title="018DockerfileSHELL">018DockerfileSHELL</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/01shell%E5%85%A5%E9%97%A801bashshell%E7%89%B9%E6%80%A7/" title="01Shell入门01bashShell特性">01Shell入门01bashShell特性</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/01shell%E5%8F%98%E9%87%8F/" title="01Shell变量">01Shell变量</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/01shell%E5%9F%BA%E7%A1%80%E6%A6%82%E8%BF%B0%E8%84%9A%E6%9C%AC%E6%89%A7%E8%A1%8C%E6%96%B9%E5%BC%8Fbash%E5%9F%BA%E6%9C%AC%E5%8A%9F%E8%83%BD/" title="01Shell基础概述脚本执行方式Bash基本功能">01Shell基础概述脚本执行方式Bash基本功能</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/01shell%E7%BC%96%E7%A8%8Bhelloworld/" title="01shell编程helloworld">01shell编程helloworld</a>
    </li>
    
</ul>
    </section>

    

    <section class="widget">
        <h3 class="widget-title"><a href="/categories">分类</a></h3>
<ul class="widget-list">
    
</ul>
    </section>

    <section class="widget">
        <h3 class="widget-title"><a href="/tags">标签</a></h3>
<div class="tagcloud">
    
    <a href="https://zaina.newban.cn/tags/ruby/">ruby</a>
    
    <a href="https://zaina.newban.cn/tags/shell/">shell</a>
    
</div>
    </section>

    

    <section class="widget">
        <h3 class="widget-title">其它</h3>
        <ul class="widget-list">
            <li><a href="https://zaina.newban.cn/index.xml">文章 RSS</a></li>
        </ul>
    </section>
</div>
            </div>
        </div>
    </div>
</body>

</html>