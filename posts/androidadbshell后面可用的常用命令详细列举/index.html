<!doctype html>
<html lang="en-us">
<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">


    <title>Androidadbshell后面可用的常用命令详细列举 | 开发者问答集锦</title>
    <meta property="og:title" content="Androidadbshell后面可用的常用命令详细列举 - 开发者问答集锦">
    <meta property="og:type" content="article">
        
    <meta property="article:published_time" content='2020-09-02T00:00:00&#43;08:00'>
        
        
    <meta property="article:modified_time" content='2020-09-02T00:00:00&#43;08:00'>
        
    <meta name="Keywords" content="">
    <meta name="description" content="Androidadbshell后面可用的常用命令详细列举">
        
    <meta name="author" content="">
    <meta property="og:url" content="https://zaina.newban.cn/posts/androidadbshell%E5%90%8E%E9%9D%A2%E5%8F%AF%E7%94%A8%E7%9A%84%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4%E8%AF%A6%E7%BB%86%E5%88%97%E4%B8%BE/">
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">

    <link rel="stylesheet" href='/css/normalize.css'>
    <link rel="stylesheet" href='/css/style.css'>
    <script type="text/javascript" src="//cdn.bootcdn.net/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

    
    
    
    
    
    
</head>


<body>
    <header id="header" class="clearfix">
    <div class="container">
        <div class="col-group">
            <div class="site-name ">
                
                    <a id="logo" href="https://zaina.newban.cn">
                        开发者问答集锦
                    </a>
                
                
            </div>
            <div>
                <nav id="nav-menu" class="clearfix">
                    <a class="" href="https://zaina.newban.cn">首页</a>
                    
                </nav>
            </div>
        </div>
    </div>
</header>

    <div id="body">
        <div class="container">
            <div class="col-group">

                <div class="col-8" id="main">
                    
<div class="res-cons">
    
    <article class="post">
        <header>
            <h1 class="post-title">Androidadbshell后面可用的常用命令详细列举</h1>
        </header>
        <date class="post-meta meta-date">
            2020年9月2日
        </date>
        
        
        <div class="post-meta">
            <span id="busuanzi_container_page_pv">|<span id="busuanzi_value_page_pv"></span><span>
                    阅读</span></span>
        </div>
        
        
        <div class="post-content">
            

<p>ENV：Android M</p>

<p>adb shell 后面可以跟的常见命令有如下：<br />
am app_process backup bootanimation coloradjust dpm idmap input media
requestsync settings svc uiautomator<br />
appops appwidget bmgr bu content hid ime interrupter pm screencap sm telecom
wm<br />
dumpsys logcat getprop reboot</p>

<p>下面讲述一些常用的命令</p>

<h1 id="一-adb-shell-pm-常用命令">一 adb shell pm 常用命令</h1>

<p>zhanghu@winth:~$ adb shell<br />
root@wt89536:/ # pm<br />
usage: pm list packages [-f] [-d] [-e] [-s] [-3] [-i] [-u] [&ndash;user USER_ID]
[FILTER]<br />
pm list permission-groups<br />
pm list permissions [-g] [-f] [-d] [-u] [GROUP]<br />
pm list instrumentation [-f] [TARGET-PACKAGE]<br />
pm list features<br />
pm list libraries<br />
pm list users<br />
pm path PACKAGE<br />
pm dump PACKAGE<br />
pm install [-lrtsfd] [-i PACKAGE] [&ndash;user USER_ID] [PATH]<br />
pm install-create [-lrtsfdp] [-i PACKAGE] [-S BYTES]<br />
[&ndash;install-location 0/1/2]<br />
[&ndash;force-uuid internal|UUID]<br />
pm install-write [-S BYTES] SESSION_ID SPLIT_NAME [PATH]<br />
pm install-commit SESSION_ID<br />
pm install-abandon SESSION_ID<br />
pm uninstall [-k] [&ndash;user USER_ID] PACKAGE<br />
pm set-installer PACKAGE INSTALLER<br />
pm move-package PACKAGE [internal|UUID]<br />
pm move-primary-storage [internal|UUID]<br />
pm clear [&ndash;user USER_ID] PACKAGE<br />
pm enable [&ndash;user USER_ID] PACKAGE_OR_COMPONENT<br />
pm disable [&ndash;user USER_ID] PACKAGE_OR_COMPONENT<br />
pm disable-user [&ndash;user USER_ID] PACKAGE_OR_COMPONENT<br />
pm disable-until-used [&ndash;user USER_ID] PACKAGE_OR_COMPONENT<br />
pm hide [&ndash;user USER_ID] PACKAGE_OR_COMPONENT<br />
pm unhide [&ndash;user USER_ID] PACKAGE_OR_COMPONENT<br />
pm grant [&ndash;user USER_ID] PACKAGE PERMISSION<br />
pm revoke [&ndash;user USER_ID] PACKAGE PERMISSION<br />
pm reset-permissions<br />
pm set-app-link [&ndash;user USER_ID] PACKAGE {always|ask|never|undefined}<br />
pm get-app-link [&ndash;user USER_ID] PACKAGE<br />
pm set-install-location [0/auto] [1/internal] [2/external]<br />
pm get-install-location<br />
pm set-permission-enforced PERMISSION [true|false]<br />
pm trim-caches DESIRED_FREE_SPACE [internal|UUID]<br />
pm create-user [&ndash;profileOf USER_ID] [&ndash;managed] USER_NAME<br />
pm remove-user USER_ID<br />
pm get-max-users</p>

<p>pm list packages: prints all packages, optionally only<br />
those whose package name contains the text in FILTER. Options:<br />
-f: see their associated file.<br />
-d: filter to only show disbled packages.<br />
-e: filter to only show enabled packages.<br />
-s: filter to only show system packages.<br />
-3: filter to only show third party packages.<br />
-i: see the installer for the packages.<br />
-u: also include uninstalled packages.</p>

<p>pm list permission-groups: prints all known permission groups.</p>

<p>pm list permissions: prints all known permissions, optionally only<br />
those in GROUP. Options:<br />
-g: organize by group.<br />
-f: print all information.<br />
-s: short summary.<br />
-d: only list dangerous permissions.<br />
-u: list only the permissions users will see.</p>

<p>pm list instrumentation: use to list all test packages; optionally<br />
supply  to list the test packages for a particular<br />
application. Options:<br />
-f: list the .apk file for the test package.</p>

<p>pm list features: prints all features of the system.</p>

<p>pm list users: prints all users on the system.</p>

<p>pm path: print the path to the .apk of the given PACKAGE.</p>

<p>pm dump: print system state associated with the given PACKAGE.</p>

<p>pm install: install a single legacy package<br />
pm install-create: create an install session<br />
-l: forward lock application<br />
-r: replace existing application<br />
-t: allow test packages<br />
-i: specify the installer package name<br />
-s: install application on sdcard<br />
-f: install application on internal flash<br />
-d: allow version code downgrade<br />
-p: partial application install<br />
-g: grant all runtime permissions<br />
-S: size in bytes of entire session</p>

<p>pm install-write: write a package into existing session; path may<br />
be &lsquo;-&rsquo; to read from stdin<br />
-S: size in bytes of package, required for stdin</p>

<p>pm install-commit: perform install of fully staged session<br />
pm install-abandon: abandon session</p>

<p>pm set-installer: set installer package name</p>

<p>pm uninstall: removes a package from the system. Options:<br />
-k: keep the data and cache directories around after package removal.</p>

<p>pm clear: deletes all data associated with a package.</p>

<p>pm enable, disable, disable-user, disable-until-used: these commands<br />
change the enabled state of a given package or component (written<br />
as &ldquo;package/class&rdquo;).</p>

<p>pm grant, revoke: these commands either grant or revoke permissions<br />
to apps. The permissions must be declared as used in the app&rsquo;s<br />
manifest, be runtime permissions (protection level dangerous),<br />
and the app targeting SDK greater than Lollipop MR1.</p>

<p>pm reset-permissions: revert all runtime permissions to their default state.</p>

<p>pm get-install-location: returns the current install location.<br />
0 [auto]: Let system decide the best location<br />
1 [internal]: Install on internal device storage<br />
2 [external]: Install on external media</p>

<p>pm set-install-location: changes the default install location.<br />
NOTE: this is only intended for debugging; using this can cause<br />
applications to break and other undersireable behavior.<br />
0 [auto]: Let system decide the best location<br />
1 [internal]: Install on internal device storage<br />
2 [external]: Install on external media</p>

<p>pm trim-caches: trim cache files to reach the given free space.</p>

<p>pm create-user: create a new user with the given USER_NAME,<br />
printing the new user identifier of the user.</p>

<p>pm remove-user: remove the user with the given USER_IDENTIFIER,<br />
deleting all data associated with that user</p>

<h2 id="1-查看系统中是否安装了指定包名的应用">1. 查看系统中是否安装了指定包名的应用</h2>

<p>A：<br />
root@wt89536:/ # pm list packages com.android.settings<br />
package:com.android.settings<br />
root@wt89536:/ #<br />
表明包名为com.android.settings的应用已经安装在系统中</p>

<p>B：<br />
root@wt89536:/ #  pm list packages com.test.test<br />
root@wt89536:/ #<br />
输入pm list packages com.test.test 之后没有任何输出，表明该应用未安装在系统中</p>

<p>C：<br />
查看安装的路径及apk名字和对应的包名：<br />
root@wt89536:/ # pm list packages -f |more<br />
package:/system/app/lingxi_v3.0.2230_16015906_160418/lingxi_v3.0.2230_16015906_1<br />
60418.apk=com.iflytek.cmcc<br />
package:/system/app/SampleExtAuthService/SampleExtAuthService.apk=com.qualcomm.q<br />
ti.auth.sampleextauthservice<br />
package:/data/app/IndonesianPack/IndonesianPack.apk=com.cootek.smartinputv5.lang<br />
uage.indonesian<br />
package:/system/app/OmaDownload/OmaDownload.apk=com.qrd.omadownload<br />
package:/data/app/VietnamPack/VietnamPack.apk=com.cootek.smartinputv5.language.v<br />
ietnam<br />
package:/system/priv-
app/TelephonyProvider/TelephonyProvider.apk=com.android.pro<br />
viders.telephony<br />
package:/data/app/CangjiePack/CangjiePack.apk=com.cootek.smartinputv5.language.c<br />
angjie<br />
package:/system/priv-
app/CalendarProvider/CalendarProvider.apk=com.android.provi<br />
ders.calendar<br />
package:/system/priv-
app/MediaProvider/MediaProvider.apk=com.android.providers.m<br />
edia<br />
package:/system/vendor/app/colorservice/colorservice.apk=com.qti.service.colorse<br />
rvice<br />
package:/system/app/Emailactivation/Emailactivation.apk=cn.richinfo.automail<br />
package:/system/app/ModemTestMode/ModemTestMode.apk=com.qualcomm.qti.modemtestmo<br />
de<br />
package:/system/app/shutdownlistener/shutdownlistener.apk=com.qualcomm.shutdownl<br />
istner<br />
package:/system/priv-
app/WallpaperCropper/WallpaperCropper.apk=com.android.wallp<br />
apercropper<br />
package:/system/priv-app/CNEService/CNEService.apk=com.quicinc.cne.CNEService<br />
package:/data/app/com.goodix.fpsetting-1/base.apk=com.goodix.fpsetting<br />
package:/system/app/ProfileMgr/ProfileMgr.apk=com.android.profile<br />
--More&ndash;</p>

<h2 id="2-查看指定包名的安装路径">2. 查看指定包名的安装路径</h2>

<p>root@wt89536:/ # pm path com.android.settings<br />
package:/system/priv-app/Settings/Settings.apk<br />
root@wt89536:/ #</p>

<h2 id="3-dump已经安装的所用应用的信息-包括所有类名">3.dump已经安装的所用应用的信息，包括所有类名</h2>

<p>root@wt89536:/ #pm dump PACKAGE</p>

<p>过滤输出指定应用,如：<br />
root@wt89536:/ #<br />
root@wt89536:/ #  pm dump PACKAGE |grep &ldquo;com.android.fingerprint&rdquo; |more<br />
74feecb com.android.fingerprint/.FingerpintApplyGuide<br />
com.android.fingerprint<br />
[com.android.fingerprint]<br />
Package <a href="e0b109f">com.android.fingerprint</a>:<br />
pkg=Package{3c0b5ec com.android.fingerprint}<br />
applicationInfo=ApplicationInfo{1038db5 com.android.fingerprint}<br />
dataDir=/data/user/0/com.android.fingerprint<br />
70/1/2 上午2:36: System package com.android.fingerprint no longer exists; wi<br />
ping its data<br />
package=com.android.fingerprint totalTime=&ldquo;1:14:53&rdquo; lastTime=&ldquo;2016/1/1<br />
上午10:10&rdquo; lastTimeSystem=&ldquo;2016/1/1 上午10:10&rdquo; inactiveTime=&ldquo;18:28&rdquo;<br />
time=&ldquo;2016/1/1 上午8:00&rdquo; type=MOVE_TO_FOREGROUND package=com.android.f<br />
ingerprint class=com.android.fingerprint.FingerpintApplyGuide<br />
time=&ldquo;2016/1/1 上午8:00&rdquo; type=MOVE_TO_BACKGROUND package=com.android.f<br />
ingerprint class=com.android.fingerprint.FingerpintApplyGuide<br />
time=&ldquo;2016/1/1 上午8:00&rdquo; type=MOVE_TO_FOREGROUND package=com.android.f<br />
ingerprint class=com.android.fingerprint.FingerpintApplyGuide<br />
time=&ldquo;2016/1/1 上午8:00&rdquo; type=MOVE_TO_BACKGROUND package=com.android.f<br />
ingerprint class=com.android.fingerprint.FingerpintApplyGuide<br />
time=&ldquo;2016/1/1 上午8:00&rdquo; type=MOVE_TO_FOREGROUND package=com.android.f<br />
ingerprint class=com.android.fingerprint.FingerprintManageBoard<br />
time=&ldquo;2016/1/1 上午8:00&rdquo; type=MOVE_TO_BACKGROUND package=com.android.f<br />
ingerprint class=com.android.fingerprint.FingerprintManageBoard<br />
time=&ldquo;2016/1/1 上午8:00&rdquo; type=MOVE_TO_FOREGROUND package=com.android.f<br />
ingerprint class=com.android.fingerprint.FingerprintRenameBoard<br />
time=&ldquo;2016/1/1 上午8:00&rdquo; type=MOVE_TO_BACKGROUND package=com.android.f<br />
ingerprint class=com.android.fingerprint.FingerprintRenameBoard<br />
time=&ldquo;2016/1/1 上午8:00&rdquo; type=MOVE_TO_FOREGROUND package=com.android.f<br />
ingerprint class=com.android.fingerprint.FingerpintApplyGuide<br />
time=&ldquo;2016/1/1 上午8:00&rdquo; type=MOVE_TO_FOREGROUND package=com.android.f<br />
ingerprint class=com.android.fingerprint.FingerpintApplyGuide<br />
time=&ldquo;2016/1/1 上午8:01&rdquo; type=MOVE_TO_BACKGROUND package=com.android.f<br />
ingerprint class=com.android.fingerprint.FingerpintApplyGuide<br />
time=&ldquo;2016/1/1 上午8:01&rdquo; type=MOVE_TO_FOREGROUND package=com.android.f<br />
ingerprint class=com.android.fingerprint.FingerpintApplyGuide<br />
time=&ldquo;2016/1/1 上午8:01&rdquo; type=MOVE_TO_BACKGROUND package=com.android.f<br />
ingerprint class=com.android.fingerprint.FingerpintApplyGuide<br />
time=&ldquo;2016/1/1 上午8:01&rdquo; type=MOVE_TO_FOREGROUND package=com.android.f<br />
ingerprint class=com.android.fingerprint.FingerpintApplyGuide<br />
time=&ldquo;2016/1/1 上午8:01&rdquo; type=MOVE_TO_BACKGROUND package=com.android.f<br />
&hellip;.</p>

<h2 id="4-launcher上是否显示指定应用">4.launcher上是否显示指定应用</h2>

<p>root@wt89536:/ # pm enable com.android.fingerprint<br />
Package com.android.fingerprint new state: enabled<br />
或<br />
root@wt89536:/ # pm unhide com.android.fingerprint<br />
Package com.android.fingerprint new hidden state: false</p>

<p>root@wt89536:/ # pm disable com.android.fingerprint<br />
Package com.android.fingerprint new state: disabled<br />
或<br />
root@wt89536:/ # pm hide com.android.fingerprint<br />
Package com.android.fingerprint new hidden state: true</p>

<p>通过上面这种方式可以查看Pm.java源码，获知怎样隐藏一个apk</p>

<h2 id="5-清除应用数据">5.清除应用数据</h2>

<p>root@wt89536:/ # pm clear com.android.fingerprint<br />
Success<br />
root@wt89536:/ #</p>

<h2 id="6-查看系统apk的包名">6.查看系统apk的包名</h2>

<p>zhanghu@winth:~$ adb shell pm list packages -s</p>

<h2 id="7-查看第三方apk包名">7.查看第三方apk包名</h2>

<p>zhanghu@winth:~$ adb shell pm list packages -3<br />
package:com.android.touchtest</p>

<h1 id="二-dump系统框架service信息">二 dump系统框架service信息</h1>

<h2 id="2-1-查看可以dump的系统框架service">2.1 查看可以dump的系统框架service</h2>

<p>adb shell dumpsys |grep &ldquo;DUMP OF SERVICE&rdquo;<br />
或adb shell dumpsys -l(字母l)</p>

<p>zhanghu@winth:~$ adb shell dumpsys |grep &ldquo;DUMP OF SERVICE&rdquo;<br />
120:DUMP OF SERVICE AtCmdFwd:<br />
122:DUMP OF SERVICE DockObserver:<br />
128:DUMP OF SERVICE SurfaceFlinger:<br />
346:DUMP OF SERVICE accessibility:<br />
353:DUMP OF SERVICE account:<br />
371:DUMP OF SERVICE activity:<br />
14692:DUMP OF SERVICE alarm:<br />
15056:DUMP OF SERVICE android.hardware.fingerprint.IFingerprintDaemon:<br />
15059:DUMP OF SERVICE android.security.keystore:<br />
15061:DUMP OF SERVICE android.service.gatekeeper.IGateKeeperService:<br />
15063:DUMP OF SERVICE appops:<br />
15551:DUMP OF SERVICE appwidget:<br />
15619:DUMP OF SERVICE audio:<br />
15733:DUMP OF SERVICE backup:<br />
15861:DUMP OF SERVICE battery:<br />
15876:DUMP OF SERVICE batteryproperties:<br />
15882:DUMP OF SERVICE batterystats:<br />
20123:DUMP OF SERVICE bluetooth_manager:<br />
20132:DUMP OF SERVICE carrier_config:<br />
20141:DUMP OF SERVICE clipboard:<br />
20143:DUMP OF SERVICE cneservice:<br />
20145:DUMP OF SERVICE com.qualcomm.location.izat.IzatService:<br />
20147:DUMP OF SERVICE com.qualcomm.qti.qseeproxy:<br />
20149:DUMP OF SERVICE commontime_management:<br />
20152:DUMP OF SERVICE connectivity:<br />
20226:DUMP OF SERVICE consumer_ir:<br />
20228:DUMP OF SERVICE content:<br />
20584:DUMP OF SERVICE country_detector:<br />
20586:DUMP OF SERVICE cpuinfo:<br />
20669:DUMP OF SERVICE dbinfo:<br />
22305:DUMP OF SERVICE device_policy:<br />
22339:DUMP OF SERVICE deviceidle:<br />
22381:DUMP OF SERVICE devicestoragemonitor:<br />
22391:DUMP OF SERVICE diskstats:<br />
22397:DUMP OF SERVICE display:<br />
22400:DUMP OF SERVICE display.qservice:<br />
22402:DUMP OF SERVICE dpmservice:<br />
22404:DUMP OF SERVICE dreams:<br />
22430:DUMP OF SERVICE drm.drmManager:<br />
22432:DUMP OF SERVICE dropbox:<br />
22999:DUMP OF SERVICE ethernet:<br />
23016:DUMP OF SERVICE extphone:<br />
23018:DUMP OF SERVICE fingerprint:<br />
23021:DUMP OF SERVICE gbahttpauth:<br />
23023:DUMP OF SERVICE gfxinfo:<br />
23858:DUMP OF SERVICE goodix.fp:<br />
23888:DUMP OF SERVICE graphicsstats:<br />
24033:DUMP OF SERVICE imms:<br />
24035:DUMP OF SERVICE ims:<br />
24037:DUMP OF SERVICE input:<br />
24497:DUMP OF SERVICE input_method:<br />
24697:DUMP OF SERVICE iphonesubinfo:<br />
24699:DUMP OF SERVICE isms:<br />
24701:DUMP OF SERVICE isub:<br />
25220:DUMP OF SERVICE jobscheduler:<br />
25264:DUMP OF SERVICE launcherapps:<br />
25266:DUMP OF SERVICE location:<br />
25315:DUMP OF SERVICE lock_settings:<br />
25317:DUMP OF SERVICE mdtp:<br />
25319:DUMP OF SERVICE media.audio_flinger:<br />
25620:DUMP OF SERVICE media.audio_policy:<br />
26136:DUMP OF SERVICE media.camera:<br />
26363:DUMP OF SERVICE media.camera.proxy:<br />
26365:DUMP OF SERVICE media.player:<br />
26372:DUMP OF SERVICE media.radio:<br />
26374:DUMP OF SERVICE media.resource_manager:<br />
26409:DUMP OF SERVICE media.sound_trigger_hw:<br />
26411:DUMP OF SERVICE media_projection:<br />
26416:DUMP OF SERVICE media_router:<br />
26464:DUMP OF SERVICE media_session:<br />
26508:DUMP OF SERVICE meminfo:<br />
29520:DUMP OF SERVICE midi:<br />
29525:DUMP OF SERVICE mount:<br />
29571:DUMP OF SERVICE netpolicy:<br />
29609:DUMP OF SERVICE netstats:<br />
29697:DUMP OF SERVICE network_management:<br />
29878:DUMP OF SERVICE network_score:<br />
29881:DUMP OF SERVICE notification:<br />
30178:DUMP OF SERVICE package:<br />
46276:DUMP OF SERVICE permission:<br />
46278:DUMP OF SERVICE persistent_data_block:<br />
46280:DUMP OF SERVICE phone:<br />
46282:DUMP OF SERVICE power:<br />
46284:DUMP OF SERVICE powerguru:<br />
46286:DUMP OF SERVICE print:<br />
46302:DUMP OF SERVICE processinfo:<br />
46304:DUMP OF SERVICE procstats:<br />
55753:DUMP OF SERVICE qti.ims.connectionmanagerservice:<br />
55755:DUMP OF SERVICE restrictions:<br />
55757:DUMP OF SERVICE rttmanager:<br />
55759:DUMP OF SERVICE samplingprofiler:<br />
55763:DUMP OF SERVICE scheduling_policy:<br />
55765:DUMP OF SERVICE search:<br />
55784:DUMP OF SERVICE sensorservice:<br />
55902:DUMP OF SERVICE serial:<br />
55904:DUMP OF SERVICE servicediscovery:<br />
55909:DUMP OF SERVICE simphonebook:<br />
55911:DUMP OF SERVICE sip:<br />
55913:DUMP OF SERVICE statusbar:<br />
55945:DUMP OF SERVICE telecom:<br />
55978:DUMP OF SERVICE telephony.registry:<br />
56046:DUMP OF SERVICE textservices:<br />
56130:DUMP OF SERVICE trust:<br />
56137:DUMP OF SERVICE uimode:<br />
56145:DUMP OF SERVICE updatelock:<br />
56148:DUMP OF SERVICE usagestats:<br />
56364:DUMP OF SERVICE usb:<br />
56386:DUMP OF SERVICE user:<br />
56392:DUMP OF SERVICE vendor.qcom.PeripheralManager:<br />
56394:DUMP OF SERVICE vibrator:<br />
56418:DUMP OF SERVICE voiceinteraction:<br />
56462:DUMP OF SERVICE wallpaper:<br />
56475:DUMP OF SERVICE webviewupdate:<br />
56477:DUMP OF SERVICE wifi:<br />
57921:DUMP OF SERVICE wifip2p:<br />
57951:DUMP OF SERVICE wifiscanner:<br />
58051:DUMP OF SERVICE window:</p>

<h2 id="2-2-查看当前设备的分辨率信息">2.2 查看当前设备的分辨率信息</h2>

<p>命令：adb shell dumpsys deviceidle |grep &ldquo;DisplayMetrics&rdquo;</p>

<p>zhanghu@winth:~$ adb shell dumpsys deviceidle |grep &ldquo;DisplayMetrics&rdquo;<br />
33: mCurDisplay=Display id 0: DisplayInfo{&ldquo;Built-in Screen&rdquo;, uniqueId
&ldquo;local:0&rdquo;, app 1080 x 1920, real 1080 x 1920, largest app 1920 x 1845,
smallest app 1080 x 1005, mode 1, defaultMode 1, modes [{id=1, width=1080,
height=1920, fps=59.0}], colorTransformId 1, defaultColorTransformId 1,
supportedColorTransforms [{id=1, colorTransform=0}], rotation 0, density 480
(403.411 x 406.4) dpi, layerStack 0, appVsyncOff 0, presDeadline 17949152,
type BUILT_IN, state OFF, FLAG_SECURE,
FLAG_SUPPORTS_PROTECTED_BUFFERS},DisplayMetrics{density=3.0, width=1080,
height=1920, scaledDensity=3.0, xdpi=403.411, ydpi=406.4}, isValid=true</p>

<h2 id="2-3-查看包名和类名">2.3 查看包名和类名</h2>

<p>adb shell dumpsys window &gt; window.log</p>

<h3 id="2-3-1-查看当前层叠的窗口">2.3.1 查看当前层叠的窗口</h3>

<p>关键字： WINDOW MANAGER ANIMATOR STATE<br />
WINDOW MANAGER ANIMATOR STATE (dumpsys window animator)<br />
DisplayContentsAnimator #0:<br />
Window #0: WindowStateAnimator{c3aeae1 com.android.systemui.ImageWallpaper}<br />
Window #1: WindowStateAnimator{3acc006
com.android.launcher3/com.android.launcher3.Launcher}<br />
Window #2: WindowStateAnimator{9d36a5e
com.android.settings/com.android.settings.Settings}<br />
Window #3: WindowStateAnimator{10674f4 KeyguardScrim}<br />
Window #4: WindowStateAnimator{1a541d StatusBar}<br />
Window #5: WindowStateAnimator{c44d692 Heads Up}</p>

<h3 id="2-3-2-查看发生anr的类">2.3.2 查看发生ANR的类</h3>

<p>关键字：WINDOW MANAGER LAST ANR<br />
WINDOW MANAGER LAST ANR (dumpsys window lastanr)<br />
ANR time: 9/14/16 3:30 PM<br />
Application at fault: AppWindowToken{192be11 token=Token{fa10308
ActivityRecord{58e30ab u0 com.android.touchtest/.MainActivity t14}}}<br />
Reason: Waiting because no window has focus but there is a focused application
that may eventually add a window when it finishes starting up.</p>

<h2 id="2-4-查看最近任务列表">2.4 查看最近任务列表</h2>

<p>adb shell dumpsys activity &gt; activity.log<br />
adb shell dumpsys dumpsys activity recents</p>

<h3 id="2-4-1-关键字-activity-manager-recent-tasks">2.4.1 关键字：ACTIVITY MANAGER RECENT TASKS</h3>

<p>ACTIVITY MANAGER RECENT TASKS (dumpsys activity recents)<br />
Recent tasks:<br />
* Recent #0: TaskRecord{e61b9b8 #15 A=android.contacts.peopleActivity U=0 sz=1}<br />
* Recent #1: TaskRecord{2825391 #1 A=com.android.launcher3 U=0 sz=1}<br />
* Recent #2: TaskRecord{a19f2f6 #9 I=com.android.vending/com.google.android.vending.verifier.ConsentDialog U=0 sz=0}<br />
* Recent #3: TaskRecord{55796f7 #8 I=com.caf.fmradio/.FMRadio U=0 sz=0}<br />
* Recent #4: TaskRecord{54b964 #7 A=com.android.settings U=0 sz=0}<br />
更详细信息：<br />
关键字：ACTIVITY MANAGER ACTIVITIES</p>

<h3 id="2-4-2-crashed应用">2.4.2 crashed应用</h3>

<p>关键字：Time since processes crashed<br />
Time since processes crashed:<br />
Process com.google.android.setupwizard uid 10025: last crashed +1h12m50s573ms
ago<br />
Process com.android.touchtest uid 10090: last crashed +52m25s195ms ago</p>

<p>博客原文：<a href="http://blog.csdn.net/yelangjueqi/article/details/52575233">http://blog.csdn.net/yelangjueqi/article/details/52575233</a></p>

<h1 id="三-adb-shell-am-常用命令">三 adb shell am 常用命令</h1>

<p>zhanghu@winth:~$ adb shell am<br />
usage: am [subcommand] [options]<br />
usage: am start [-D] [-W] [-P ] [&ndash;start-profiler ]<br />
[&ndash;sampling INTERVAL] [-R COUNT] [-S] [&ndash;opengl-trace]<br />
[&ndash;user  | current]<br />
am startservice [&ndash;user  | current]<br />
am stopservice [&ndash;user  | current]<br />
am force-stop [&ndash;user  | all | current]<br />
am kill [&ndash;user  | all | current]<br />
am kill-all<br />
am broadcast [&ndash;user  | all | current]<br />
am instrument [-r] [-e  ] [-p ] [-w]<br />
[&ndash;user  | current]<br />
[&ndash;no-window-animation] [&ndash;abi ]<br />
am profile start [&ndash;user  current] [&ndash;sampling INTERVAL]<br />
am profile stop [&ndash;user  current] []<br />
am dumpheap [&ndash;user  current] [-n]<br />
am set-debug-app [-w] [&ndash;persistent]<br />
am clear-debug-app<br />
am set-watch-heap<br />
am clear-watch-heap<br />
am monitor [&ndash;gdb ]<br />
am hang [&ndash;allow-restart]<br />
am restart<br />
am idle-maintenance<br />
am screen-compat [on|off]<br />
am package-importance<br />
am to-uri [INTENT]<br />
am to-intent-uri [INTENT]<br />
am to-app-uri [INTENT]<br />
am switch-user<br />
am start-user<br />
am stop-user [-w]<br />
am stack start<br />
am stack movetask  [true|false]<br />
am stack resize<br />
am stack split  [INTENT]<br />
am stack list<br />
am stack info<br />
am task lock<br />
am task lock stop<br />
am task resizeable  [true|false]<br />
am task resize<br />
am get-config<br />
am set-inactive [&ndash;user ]  true|false<br />
am get-inactive [&ndash;user ]<br />
am send-trim-memory [&ndash;user ]<br />
[HIDDEN|RUNNING_MODERATE|BACKGROUND|RUNNING_LOW|MODERATE|RUNNING_CRITICAL|COMPLETE]</p>

<p>am start: start an Activity. Options are:<br />
-D: enable debugging<br />
-W: wait for launch to complete<br />
--start-profiler : start profiler and send results to<br />
--sampling INTERVAL: use sample profiling with INTERVAL microseconds<br />
between samples (use with &ndash;start-profiler)<br />
-P : like above, but profiling stops when app goes idle<br />
-R: repeat the activity launch  times. Prior to each repeat,<br />
the top activity will be finished.<br />
-S: force stop the target app before starting the activity<br />
--opengl-trace: enable tracing of OpenGL functions<br />
--user  | current: Specify which user to run as; if not<br />
specified then run as the current user.</p>

<p>am startservice: start a Service. Options are:<br />
--user  | current: Specify which user to run as; if not<br />
specified then run as the current user.</p>

<p>am stopservice: stop a Service. Options are:<br />
--user  | current: Specify which user to run as; if not<br />
specified then run as the current user.</p>

<p>am force-stop: force stop everything associated with .<br />
--user  | all | current: Specify user to force stop;<br />
all users if not specified.</p>

<p>am kill: Kill all processes associated with . Only kills.<br />
processes that are safe to kill &ndash; that is, will not impact the user<br />
experience.<br />
--user  | all | current: Specify user whose processes to kill;<br />
all users if not specified.</p>

<p>am kill-all: Kill all background processes.</p>

<p>am broadcast: send a broadcast Intent. Options are:<br />
--user  | all | current: Specify which user to send to; if not<br />
specified then send to all users.<br />
--receiver-permission : Require receiver to hold permission.</p>

<p>am instrument: start an Instrumentation. Typically this target<br />
is the form /. Options are:<br />
-r: print raw results (otherwise decode REPORT_KEY_STREAMRESULT). Use with<br />
[-e perf true] to generate raw output for performance measurements.<br />
-e  : set argument  to . For test runners a<br />
common form is [-e  [,&hellip;]].<br />
-p : write profiling data to<br />
-w: wait for instrumentation to finish before returning. Required for<br />
test runners.<br />
--user  | current: Specify user instrumentation runs in;<br />
current user if not specified.<br />
--no-window-animation: turn off window animations while running.<br />
--abi : Launch the instrumented process with the selected ABI.<br />
This assumes that the process supports the selected ABI.</p>

<p>am profile: start and stop profiler on a process. The given  argument<br />
may be either a process name or pid. Options are:<br />
--user  | current: When supplying a process name,<br />
specify user of process to profile; uses current user if not specified.</p>

<p>am dumpheap: dump the heap of a process. The given  argument may<br />
be either a process name or pid. Options are:<br />
-n: dump native heap instead of managed heap<br />
--user  | current: When supplying a process name,<br />
specify user of process to dump; uses current user if not specified.</p>

<p>am set-debug-app: set application  to debug. Options are:<br />
-w: wait for debugger when application starts<br />
--persistent: retain this value</p>

<p>am clear-debug-app: clear the previously set-debug-app.</p>

<p>am set-watch-heap: start monitoring pss size of , if it is at or<br />
above  then a heap dump is collected for the user to report</p>

<p>am clear-watch-heap: clear the previously set-watch-heap.</p>

<p>am bug-report: request bug report generation; will launch UI<br />
when done to select where it should be delivered.</p>

<p>am monitor: start monitoring for crashes or ANRs.<br />
--gdb: start gdbserv on the given port at crash/ANR</p>

<p>am hang: hang the system.<br />
--allow-restart: allow watchdog to perform normal system restart</p>

<p>am restart: restart the user-space system.</p>

<p>am idle-maintenance: perform idle maintenance now.</p>

<p>am screen-compat: control screen compatibility mode of .</p>

<p>am package-importance: print current importance of .</p>

<p>am to-uri: print the given Intent specification as a URI.</p>

<p>am to-intent-uri: print the given Intent specification as an intent: URI.</p>

<p>am to-app-uri: print the given Intent specification as an android-app: URI.</p>

<p>am switch-user: switch to put USER_ID in the foreground, starting<br />
execution of that user if it is currently stopped.</p>

<p>am start-user: start USER_ID in background if it is currently stopped,<br />
use switch-user if you want to start the user in foreground.</p>

<p>am stop-user: stop execution of USER_ID, not allowing it to run any<br />
code until a later explicit start or switch to it.<br />
-w: wait for stop-user to complete.</p>

<p>am stack start: start a new activity on  using .</p>

<p>am stack movetask: move  from its current stack to the top (true) or bottom
(false) of .</p>

<p>am stack resize: change  size and position to .</p>

<p>am stack split: split  into 2 stacks ertically or orizontally<br />
starting the new stack with [INTENT] if specified. If [INTENT] isn&rsquo;t<br />
specified and the current stack has more than one task, then the top task<br />
of the current task will be moved to the new stack. Command will also force<br />
all current tasks in both stacks to be resizeable.</p>

<p>am stack list: list all of the activity stacks and their sizes.</p>

<p>am stack info: display the information about activity stack .</p>

<p>am task lock: bring  to the front and don&rsquo;t allow other tasks to run.</p>

<p>am task lock stop: end the current task lock.</p>

<p>am task resizeable: change if  is resizeable (true) or not (false).</p>

<p>am task resize: makes sure  is in a stack with the specified bounds.<br />
Forces the task to be resizeable and creates a stack if no existing stack<br />
has the specified bounds.</p>

<p>am get-config: retrieve the configuration and any recent configurations<br />
of the device.</p>

<p>am set-inactive: sets the inactive state of an app.</p>

<p>am get-inactive: returns the inactive state of an app.</p>

<p>am send-trim-memory: Send a memory trim event to a .</p>

<p>specifications include these flags and arguments:<br />
[-a ] [-d ] [-t ]<br />
[-c  [-c ] &hellip;]<br />
[-e|&ndash;es  &hellip;]<br />
[&ndash;esn  &hellip;]<br />
[&ndash;ez  &hellip;]<br />
[&ndash;ei  &hellip;]<br />
[&ndash;el  &hellip;]<br />
[&ndash;ef  &hellip;]<br />
[&ndash;eu  &hellip;]<br />
[&ndash;ecn  ]<br />
[&ndash;eia  [,<br />
(mutiple extras passed as Integer[])<br />
[&ndash;eial  [,<br />
(mutiple extras passed as List)<br />
[&ndash;ela  [,<br />
(mutiple extras passed as Long[])<br />
[&ndash;elal  [,<br />
(mutiple extras passed as List)<br />
[&ndash;efa  [,<br />
(mutiple extras passed as Float[])<br />
[&ndash;efal  [,<br />
(mutiple extras passed as List)<br />
[&ndash;esa  [,<br />
(mutiple extras passed as String[]; to embed a comma into a string,<br />
escape it using &ldquo;\,&ldquo;)<br />
[&ndash;esal  [,<br />
(mutiple extras passed as List; to embed a comma into a string,<br />
escape it using &ldquo;\,&ldquo;)<br />
[&ndash;grant-read-uri-permission] [&ndash;grant-write-uri-permission]<br />
[&ndash;grant-persistable-uri-permission] [&ndash;grant-prefix-uri-permission]<br />
[&ndash;debug-log-resolution] [&ndash;exclude-stopped-packages]<br />
[&ndash;include-stopped-packages]<br />
[&ndash;activity-brought-to-front] [&ndash;activity-clear-top]<br />
[&ndash;activity-clear-when-task-reset] [&ndash;activity-exclude-from-recents]<br />
[&ndash;activity-launched-from-history] [&ndash;activity-multiple-task]<br />
[&ndash;activity-no-animation] [&ndash;activity-no-history]<br />
[&ndash;activity-no-user-action] [&ndash;activity-previous-is-top]<br />
[&ndash;activity-reorder-to-front] [&ndash;activity-reset-task-if-needed]<br />
[&ndash;activity-single-top] [&ndash;activity-clear-task]<br />
[&ndash;activity-task-on-home]<br />
[&ndash;receiver-registered-only] [&ndash;receiver-replace-pending]<br />
[&ndash;selector]<br />
[ |  | ]</p>

<h2 id="3-1-发送广播">3.1 发送广播</h2>

<p>adb shell am broadcast -a &ldquo;action&rdquo;<br />
其他更多信息见上面的  介绍。</p>

<h2 id="3-2-停止一个应用">3.2 停止一个应用</h2>

<p>adb shell am force-stop com.android.settings</p>

<h2 id="3-3-查看最近任务列表">3.3 查看最近任务列表</h2>

<p>adb shell am stack list<br />
zhanghu@winth:~$ adb shell am stack list<br />
Stack id=0 bounds=[0,0][1080,1920] displayId=0<br />
taskId=13: com.android.systemui/com.android.systemui.recents.RecentsActivity<br />
taskId=11: com.android.launcher3/com.android.launcher3.Launcher</p>

<p>Stack id=2 bounds=[0,0][1080,1920] displayId=0<br />
taskId=14: com.android.settings/com.android.settings.Settings<br />
taskId=16: com.android.mms/com.android.mms.ui.ConversationList<br />
taskId=15: com.android.contacts/com.android.contacts.activities.PeopleActivity<br />
taskId=17: com.android.camera3/com.android.camera.CameraLauncher</p>

<h2 id="3-4-获取资源配置信息">3.4 获取资源配置信息</h2>

<p>adb shell am get-config<br />
中文简体环境<br />
zhanghu@winth:~$ adb shell am get-config<br />
config: mcc460-mnc2-zh-rCN-ldltr-sw360dp-w360dp-h615dp-normal-long-notround-
port-notnight-xxhdpi-finger-keysexposed-nokeys-navhidden-nonav-v23<br />
abi: arm64-v8a,armeabi-v7a,armeabi<br />
recentConfigs:<br />
config: zh-rCN-ldltr-sw360dp-w360dp-h615dp-normal-long-notround-port-notnight-
xxhdpi-finger-keysexposed-nokeys-navhidden-nonav-v23<br />
config: zh-rCN-ldltr-sw360dp-w360dp-h640dp-normal-long-notround-port-xxhdpi-
notouch-keysexposed-nokeys-navhidden-nonav-v23<br />
config: zh-rCN-ldltr-sw360dp-w360dp-h615dp-normal-long-notround-port-xxhdpi-
finger-keysexposed-nokeys-navhidden-nonav-v23<br />
config: mcc460-mnc2-zh-rCN-ldltr-sw360dp-w360dp-h615dp-normal-long-notround-
port-notnight-xxhdpi-finger-keysexposed-nokeys-navhidden-nonav-v23<br />
config: zh-rCN-ldltr-sw360dp-w360dp-h615dp-normal-long-notround-port-xxhdpi-
notouch-keysexposed-nokeys-navhidden-nonav-v23<br />
config: mcc460-mnc2-zh-rCN-ldltr-sw360dp-w640dp-h335dp-normal-long-notround-
land-notnight-xxhdpi-finger-keysexposed-nokeys-navhidden-nonav-v23<br />
config: zh-rCN-ldltr-sw360dp-w640dp-h335dp-normal-long-notround-land-notnight-
xxhdpi-finger-keysexposed-nokeys-navhidden-nonav-v23</p>

<p>英文环境<br />
zhanghu@winth:~$ adb shell am get-config<br />
config: mcc460-mnc2-en-rUS-ldltr-sw360dp-w360dp-h615dp-normal-long-notround-
port-notnight-xxhdpi-finger-keysexposed-nokeys-navhidden-nonav-v23<br />
abi: arm64-v8a,armeabi-v7a,armeabi<br />
recentConfigs:<br />
config: zh-rCN-ldltr-sw360dp-w360dp-h615dp-normal-long-notround-port-notnight-
xxhdpi-finger-keysexposed-nokeys-navhidden-nonav-v23<br />
config: zh-rCN-ldltr-sw360dp-w360dp-h640dp-normal-long-notround-port-xxhdpi-
notouch-keysexposed-nokeys-navhidden-nonav-v23<br />
config: zh-rCN-ldltr-sw360dp-w360dp-h615dp-normal-long-notround-port-xxhdpi-
finger-keysexposed-nokeys-navhidden-nonav-v23<br />
config: mcc460-mnc2-zh-rCN-ldltr-sw360dp-w360dp-h615dp-normal-long-notround-
port-notnight-xxhdpi-finger-keysexposed-nokeys-navhidden-nonav-v23<br />
config: zh-rCN-ldltr-sw360dp-w360dp-h615dp-normal-long-notround-port-xxhdpi-
notouch-keysexposed-nokeys-navhidden-nonav-v23<br />
config: mcc460-mnc2-zh-rCN-ldltr-sw360dp-w640dp-h335dp-normal-long-notround-
land-notnight-xxhdpi-finger-keysexposed-nokeys-navhidden-nonav-v23<br />
config: zh-rCN-ldltr-sw360dp-w640dp-h335dp-normal-long-notround-land-notnight-
xxhdpi-finger-keysexposed-nokeys-navhidden-nonav-v23<br />
config: mcc460-mnc2-en-rUS-ldltr-sw360dp-w360dp-h615dp-normal-long-notround-
port-notnight-xxhdpi-finger-keysexposed-nokeys-navhidden-nonav-v23</p>

<h1 id="四-获取settings表和systemproperties的数据">四 获取settings表和SystemProperties的数据</h1>

<h2 id="4-1-查看settings表的数据">4.1 查看settings表的数据</h2>

<p>zhanghu@winth:~$ adb shell settings &ndash;help<br />
usage: settings [&ndash;user NUM] get namespace key<br />
settings [&ndash;user NUM] put namespace key value<br />
settings [&ndash;user NUM] delete namespace key<br />
settings [&ndash;user NUM] list namespace</p>

<p>&lsquo;namespace&rsquo; is one of {system, secure, global}, case-insensitive<br />
If &lsquo;&ndash;user NUM&rsquo; is not given, the operations are performed on the owner user.</p>

<p>eg:<br />
zhanghu@winth:~$ adb shell settings list system<br />
614826A2C08954C4136F2E9DDA00A2A4=92F08A6DD962C3F57995B677E553FA32<br />
accelerometer_rotation=0<br />
alarm_alert=content://media/internal/audio/media/7<br />
apn=CMWAP<br />
bd_setting_i=861263030040457<br />
camera_state_changed=false<br />
cellular_to_wlan_type=0<br />
cmcc_wifi_default_value=1<br />
.,,,,,</p>

<h2 id="4-2-查看systemproperties的数据">4.2 查看SystemProperties的数据</h2>

<p>zhanghu@winth:~$ adb shell getprop &ndash;help<br />
usage: getprop [NAME [DEFAULT]]</p>

<p>Gets an Android system property, or lists them all.</p>

<p>zhanghu@winth:~$ adb shell getprop</p>

<p>&hellip;&hellip;</p>

<h1 id="五-控制多媒体播放">五 控制多媒体播放</h1>

<p>zhanghu@winth:~$ adb shell media<br />
usage: media [subcommand] [options]<br />
media dispatch KEY<br />
media list-sessions<br />
media monitor</p>

<p>media dispatch: dispatch a media key to the system.<br />
KEY may be: play, pause, play-pause, mute, headsethook,<br />
stop, next, previous, rewind, record, fast-forword.<br />
media list-sessions: print a list of the current sessions.<br />
media monitor: monitor updates to the specified session.<br />
Use the tag from list-sessions.</p>

<p>zhanghu@winth:~$ adb shell media dispatch play</p>

<p>frameworks/base/cmds/media/src/com/android/commands/media/Media.java</p>

<p>private void runDispatch() throws Exception {<br />
String cmd = nextArgRequired();<br />
int keycode;<br />
if (&ldquo;play&rdquo;.equals(cmd)) {<br />
keycode = KeyEvent.KEYCODE_MEDIA_PLAY;<br />
} else if (&ldquo;pause&rdquo;.equals(cmd)) {<br />
keycode = KeyEvent.KEYCODE_MEDIA_PAUSE;<br />
} else if (&ldquo;play-pause&rdquo;.equals(cmd)) {<br />
keycode = KeyEvent.KEYCODE_MEDIA_PLAY_PAUSE;<br />
} else if (&ldquo;mute&rdquo;.equals(cmd)) {<br />
keycode = KeyEvent.KEYCODE_MUTE;<br />
} else if (&ldquo;headsethook&rdquo;.equals(cmd)) {<br />
keycode = KeyEvent.KEYCODE_HEADSETHOOK;<br />
} else if (&ldquo;stop&rdquo;.equals(cmd)) {<br />
keycode = KeyEvent.KEYCODE_MEDIA_STOP;<br />
} else if (&ldquo;next&rdquo;.equals(cmd)) {<br />
keycode = KeyEvent.KEYCODE_MEDIA_NEXT;<br />
} else if (&ldquo;previous&rdquo;.equals(cmd)) {<br />
keycode = KeyEvent.KEYCODE_MEDIA_PREVIOUS;<br />
} else if (&ldquo;rewind&rdquo;.equals(cmd)) {<br />
keycode = KeyEvent.KEYCODE_MEDIA_REWIND;<br />
} else if (&ldquo;record&rdquo;.equals(cmd)) {<br />
keycode = KeyEvent.KEYCODE_MEDIA_RECORD;<br />
} else if (&ldquo;fast-forward&rdquo;.equals(cmd)) {<br />
keycode = KeyEvent.KEYCODE_MEDIA_FAST_FORWARD;<br />
} else {<br />
showError(&ldquo;Error: unknown dispatch code &lsquo;&rdquo; + cmd + &ldquo;&lsquo;&rdquo;);<br />
return;<br />
}</p>

<p>final long now = SystemClock.uptimeMillis();<br />
sendMediaKey(new KeyEvent(now, now, KeyEvent.ACTION_DOWN, keycode, 0, 0,<br />
KeyCharacterMap.VIRTUAL_KEYBOARD, 0, 0, InputDevice.SOURCE_KEYBOARD));<br />
sendMediaKey(new KeyEvent(now, now, KeyEvent.ACTION_UP, keycode, 0, 0,<br />
KeyCharacterMap.VIRTUAL_KEYBOARD, 0, 0, InputDevice.SOURCE_KEYBOARD));<br />
}</p>

<h1 id="六-模拟输入按键">六 模拟输入按键</h1>

<p>zhanghu@winth:~$ adb shell input<br />
Usage: input []  [&hellip;]</p>

<p>The sources are:<br />
mouse<br />
keyboard<br />
joystick<br />
touchnavigation<br />
touchpad<br />
trackball<br />
stylus<br />
dpad<br />
touchscreen<br />
gamepad</p>

<p>The commands and default sources are:<br />
text  (Default: touchscreen)<br />
keyevent [&ndash;longpress]  &hellip; (Default: keyboard)<br />
tap  (Default: touchscreen)<br />
swipe  <a href="Default: touchscreen">duration(ms)</a><br />
press (Default: trackball)<br />
roll  (Default: trackball)</p>

<p>eg:<br />
模拟输入power按键<br />
zhanghu@winth:~$  adb shell input keyevent KEYCODE_POWER<br />
或<br />
zhanghu@winth:~$ adb shell input keyevent 26</p>

<h1 id="七-查看输入法">七 查看输入法</h1>

<p>zhanghu@winth:~$ adb shell ime<br />
usage: ime list [-a] [-s]<br />
ime enable ID<br />
ime disable ID<br />
ime set ID</p>

<p>The list command prints all enabled input methods. Use<br />
the -a option to see all input methods. Use<br />
the -s option to see only a single summary line of each.</p>

<p>The enable command allows the given input method ID to be used.</p>

<p>The disable command disallows the given input method ID from use.</p>

<p>The set command switches to the given input method ID.<br />
zhanghu@winth:~$  adb shell ime list -s<br />
com.iflytek.inputmethod/.FlyIME<br />
com.android.inputmethod.latin/.LatinIME<br />
zhanghu@winth:~$  adb shell ime list -a<br />
com.iflytek.inputmethod/.FlyIME:<br />
mId=com.iflytek.inputmethod/.FlyIME
mSettingsActivityName=com.iflytek.inputmethod.setting.container.LauncherSettingActivity<br />
mIsDefaultResId=0x0<br />
Service:<br />
priority=100 preferredOrder=0 match=0x108000 specificIndex=-1 isDefault=false<br />
ServiceInfo:<br />
name=com.iflytek.inputmethod.FlyIME<br />
packageName=com.iflytek.inputmethod<br />
enabled=true exported=false processName=com.iflytek.inputmethod<br />
permission=android.permission.BIND_INPUT_METHOD<br />
flags=0x0<br />
com.android.inputmethod.latin/.LatinIME:<br />
mId=com.android.inputmethod.latin/.LatinIME
mSettingsActivityName=com.android.inputmethod.latin.settings.SettingsActivity<br />
mIsDefaultResId=0x7f070000<br />
Service:<br />
priority=0 preferredOrder=0 match=0x108000 specificIndex=-1 isDefault=false<br />
ServiceInfo:<br />
name=com.android.inputmethod.latin.LatinIME<br />
packageName=com.android.inputmethod.latin<br />
labelRes=0x7f0a0038 nonLocalizedLabel=null icon=0x0 banner=0x0<br />
enabled=true exported=true processName=com.android.inputmethod.latin<br />
permission=android.permission.BIND_INPUT_METHOD<br />
flags=0x0</p>

<h1 id="八-查看设备的分辨率">八 查看设备的分辨率</h1>

<p>zhanghu@winth:~$ adb shell wm<br />
usage: wm [subcommand] [options]<br />
wm size [reset|WxH|WdpxHdp]<br />
wm density [reset|DENSITY]<br />
wm overscan [reset|LEFT,TOP,RIGHT,BOTTOM]<br />
wm scaling [off|auto]<br />
wm screen-capture [userId] [true|false]</p>

<p>wm size: return or override display size.<br />
width and height in pixels unless suffixed with &lsquo;dp&rsquo;.</p>

<p>wm density: override display density.</p>

<p>wm overscan: set overscan area for display.</p>

<p>wm scaling: set display scaling mode.</p>

<p>wm screen-capture: enable/disable screen capture.</p>

<p>wm dismiss-keyguard: dismiss the keyguard, prompting the user for auth if
necessary.</p>

<p>zhanghu@winth:~$ adb shell wm size<br />
Physical size: 1080x1920<br />
zhanghu@winth:~$ adb shell wm density<br />
Physical density: 480<br />
zhanghu@winth:~$</p>

<p>九 ContentProvider增删改查</p>

<p>zhanghu@winth:~$ adb shell content<br />
usage: adb shell content [subcommand] [options]</p>

<p>usage: adb shell content insert &ndash;uri  [&ndash;user ] &ndash;bind  [&ndash;bind &hellip;]<br />
a content provider URI.<br />
binds a typed value to a column and is formatted:<br />
:: where:<br />
specifies data type such as:<br />
b - boolean, s - string, i - integer, l - long, f - float, d - double<br />
Note: Omit the value for passing an empty string, e.g column:s:<br />
Example:</p>

<h1 id="add-new-setting-secure-setting-with-value-new-value">Add &ldquo;new_setting&rdquo; secure setting with value &ldquo;new_value&rdquo;.</h1>

<p>adb shell content insert &ndash;uri content://settings/secure &ndash;bind
name:s:new_setting &ndash;bind value:s:new_value</p>

<p>usage: adb shell content update &ndash;uri  [&ndash;user ] [&ndash;where ]<br />
is a SQL style where clause in quotes (You have to escape single quotes - see
example below).<br />
Example:</p>

<h1 id="change-new-setting-secure-setting-to-newer-value">Change &ldquo;new_setting&rdquo; secure setting to &ldquo;newer_value&rdquo;.</h1>

<p>adb shell content update &ndash;uri content://settings/secure &ndash;bind
value:s:newer_value &ndash;where &ldquo;name=&lsquo;new_setting&rsquo;&rdquo;</p>

<p>usage: adb shell content delete &ndash;uri  [&ndash;user ] &ndash;bind  [&ndash;bind &hellip;] [&ndash;where
]<br />
Example:</p>

<h1 id="remove-new-setting-secure-setting">Remove &ldquo;new_setting&rdquo; secure setting.</h1>

<p>adb shell content delete &ndash;uri content://settings/secure &ndash;where
&ldquo;name=&lsquo;new_setting&rsquo;&rdquo;</p>

<p>usage: adb shell content query &ndash;uri  [&ndash;user ] [&ndash;projection ] [&ndash;where ]
[&ndash;sort ]<br />
is a list of colon separated column names and is formatted:<br />
[:&hellip;]<br />
is the order in which rows in the result should be sorted.<br />
Example:</p>

<h1 id="select-name-and-value-columns-from-secure-settings-where-name-is-equal">Select &ldquo;name&rdquo; and &ldquo;value&rdquo; columns from secure settings where &ldquo;name&rdquo; is equal</h1>

<p>to &ldquo;new_setting&rdquo; and sort the result by name in ascending order.<br />
adb shell content query &ndash;uri content://settings/secure &ndash;projection
name:value &ndash;where &ldquo;name=&lsquo;new_setting&rsquo;&rdquo; &ndash;sort &ldquo;name ASC&rdquo;</p>

<p>usage: adb shell content call &ndash;uri  --method  [&ndash;arg ]<br />
[&ndash;extra  &hellip;]<br />
is the name of a provider-defined method<br />
is an optional string argument<br />
is like &ndash;bind above, typed data of the form :{b,s,i,l,f,d}:</p>

<p>usage: adb shell content read &ndash;uri  [&ndash;user ]<br />
Example:</p>

<h1 id="cat-default-ringtone-to-a-file-then-pull-to-host">cat default ringtone to a file, then pull to host</h1>

<p>adb shell &lsquo;content read &ndash;uri content://settings/system/ringtone &gt;
/mnt/sdcard/tmp.ogg&rsquo; &amp;&amp; adb pull /mnt/sdcard/tmp.ogg</p>

<h1 id="十-查看拨号盘">十 查看拨号盘</h1>

<p>zhanghu@winth:~$ adb shell telecom<br />
usage: telecom [subcommand] [options]<br />
usage: telecom set-phone-account-enabled<br />
usage: telecom set-phone-account-disabled<br />
usage: telecom register-phone-account<br />
usage: telecom register-sim-phone-account<br />
usage: telecom unregister-phone-account<br />
usage: telecom set-default-dialer<br />
usage: telecom get-default-dialer<br />
usage: telecom get-system-dialer</p>

<p>telecom set-phone-account-enabled: Enables the given phone account, if it has<br />
already been registered with Telecom.</p>

<p>telecom set-phone-account-disabled: Disables the given phone account, if it<br />
has already been registered with telecom.</p>

<p>telecom set-default-dialer: Sets the default dialer to the given component.</p>

<p>telecom get-default-dialer: Displays the current default dialer.</p>

<p>telecom get-system-dialer: Displays the current system dialer.</p>

<p>zhanghu@winth:~$ adb shell telecom get-system-dialer<br />
com.android.contacts<br />
zhanghu@winth:~$ adb shell telecom get-default-dialer<br />
com.android.contacts<br />
zhanghu@winth:~$ adb shell telecom set-default-dialer com.test.test
//设置包名为com.test.test 的应用为默认拨号<br />
Error - com.test.test is not an installed Dialer app,<br />
or is already the default dialer.</p>

<h1 id="十一-控制关机-重启-数据连接打开-wifi是否打开-usb的状态">十一 控制关机，重启，数据连接打开，wifi是否打开，usb的状态</h1>

<p>zhanghu@winth:~$ adb shell svc &ndash;help<br />
Available commands:<br />
help Show information about the subcommands<br />
power Control the power manager<br />
data Control mobile data connectivity<br />
wifi Control the Wi-Fi manager<br />
usb Control Usb state</p>

<p>zhanghu@winth:~$  adb shell svc power<br />
Control the power manager<br />
usage: svc power stayon [true|false|usb|ac|wireless]<br />
Set the &lsquo;keep awake while plugged in&rsquo; setting.<br />
svc power reboot [reason] //重启机器<br />
Perform a runtime shutdown and reboot device with specified reason.<br />
svc power shutdown //关机</p>

<p>Perform a runtime shutdown and power off the device.</p>

<p>$adb shell svc power shutdown // 关机</p>

<h1 id="十二-截屏">十二 截屏</h1>

<p>zhanghu@winth:~$ adb shell screencap /sdcard/screen.png &amp;&amp; adb pull
/sdcard/screen.png ~/logloglogloglogloglog/</p>

<h1 id="十三-dump当前布局">十三 dump当前布局</h1>

<p>zhanghu@winth:~$ adb shell uiautomator dump &amp;&amp; adb pull
/sdcard/window_dump.xml ~/logloglogloglogloglog/</p>

<h1 id="十四-在设备内创建文件夹">十四 在设备内创建文件夹</h1>

<p>adb shell mkdir /sdcard/LOG</p>

<h1 id="十五-adb-logcat-命令">十五 adb logcat 命令</h1>

<h2 id="a-同时过滤多个应用的tag">A 同时过滤多个应用的Tag</h2>

<p>语法：<br />
adb logcat *:S TAG1 TAG2 TAG3<br />
或<br />
adb logcat -s TAG1 TAG2 TAG3<br />
eg：<br />
zhanghu@winth:~$ adb logcat *:S CAM_Activity KeyEventDispatcher<br />
zhanghu@winth:~$ adb logcat -s CAM_Activity KeyEventDispatcher</p>

<h2 id="b-过滤单个应用的tag">B 过滤单个应用的Tag</h2>

<p>语法：<br />
adb logcat *:S TAG 或 adb logcat -s TAG</p>

<h2 id="c-过滤应用指定级别的tag">C 过滤应用指定级别的Tag</h2>

<p>语法：<br />
adb logcat -s [:priority] [:priority]<br />
where  is a log component tag (or * for all) and priority is:<br />
V Verbose (default for )<br />
D Debug (default for &lsquo;*&lsquo;)<br />
I Info<br />
W Warn<br />
E Error<br />
F Fatal<br />
S Silent (suppress all output)</p>

<p>eg:<br />
zhanghu@winth:~$ adb logcat -s WindowManager:E<br />
zhanghu@winth:~$ adb logcat -s WindowManager:E KeyguardUpdateMonitor:D<br />
zhanghu@winth:~$ adb logcat -s *:E</p>

<h2 id="d-过滤含有多个字符串的行">D 过滤含有多个字符串的行</h2>

<p>语法：<br />
adb logcat |grep -E “string1|string2” 或 adb logcat |grep -E ’string1|string2‘<br />
eg:<br />
zhanghu@winth:~$ adb logcat |grep -E &lsquo;Window|Keyguard&rsquo;</p>

<p>补充几条grep命令：</p>

<p>1) 搜索命令：grep -nrw “abcd” . 在当前文件夹下搜索abcd。</p>

<p>2) 如果在只是想匹配模式的上下几行，grep可以实现。</p>

<p>$grep -5 &lsquo;parttern&rsquo; inputfile //打印匹配行的前后5行</p>

<p>$grep -C 5 &lsquo;parttern&rsquo; inputfile //打印匹配行的前后5行</p>

<p>$grep -A 5 &lsquo;parttern&rsquo; inputfile //打印匹配行的后5行</p>

<p>$grep -B 5 &lsquo;parttern&rsquo; inputfile //打印匹配行的前5行</p>

        </div>

        


        

<div class="post-archive">
    <h2>See Also</h2>
    <ul class="listing">
        
        <li><a href="/posts/007hadoop%E9%9B%86%E7%BE%A4%E9%85%8D%E7%BD%AEhadoop%E9%9B%86%E7%BE%A4%E7%9A%84%E5%90%AF%E5%8A%A8%E5%92%8C%E6%B5%8B%E8%AF%95ssh%E5%85%8D%E7%99%BB%E9%99%86%E9%85%8D%E7%BD%AEstartallshhdfs%E5%B8%B8%E7%94%A8%E7%9A%84shell/">007Hadoop集群配置Hadoop集群的启动和测试SSH免登陆配置startallshhdfs常用的shell</a></li>
        
        <li><a href="/posts/009shell%E8%84%9A%E6%9C%AC%E4%B8%8B%E6%9D%A1%E4%BB%B6%E6%B5%8B%E8%AF%95eqne/">009Shell脚本下条件测试eqne</a></li>
        
        <li><a href="/posts/00pythonmanagepyshell%E5%92%8Cpython%E7%9A%84%E5%88%86%E6%9E%90/">00Pythonmanagepyshell和Python的分析</a></li>
        
        <li><a href="/posts/010zookeeper%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5zookeeper%E7%9A%84%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BAzookeeper%E7%9A%84shell%E5%91%BD%E4%BB%A4/">010Zookeeper的基本概念Zookeeper的集群搭建Zookeeper的shell命令</a></li>
        
        <li><a href="/posts/018dockerfileshell/">018DockerfileSHELL</a></li>
        
    </ul>
</div>


        <div class="post-meta meta-tags">
            
            <ul class="clearfix">
                
                <li><a href='https://zaina.newban.cn/tags/shell'>shell</a></li>
                
            </ul>
            
        </div>
    </article>
    
    

    
    
</div>

                    <footer id="footer">
    <div>
        &copy; 2020 <a href="https://zaina.newban.cn">开发者问答集锦 By </a>
        
    </div>
    <br />
    <div>
        <div class="github-badge">
            <a href="https://gohugo.io/" target="_black" rel="nofollow"><span class="badge-subject">Powered by</span><span class="badge-value bg-blue">Hugo</span></a>
        </div>
        <div class="github-badge">
            <a href="https://www.flysnow.org/" target="_black"><span class="badge-subject">Design by</span><span class="badge-value bg-brightgreen">飞雪无情</span></a>
        </div>
        <div class="github-badge">
            <a href="https://github.com/flysnow-org/maupassant-hugo" target="_black"><span class="badge-subject">Theme</span><span class="badge-value bg-yellowgreen">Maupassant</span></a>
        </div>
    </div>
</footer>


    
    <script type="text/javascript">
        window.MathJax = {
            tex2jax: {
                inlineMath: [['$', '$']],
                processEscapes: true
                }
            };
    </script>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML' async></script>

<a id="rocket" href="#top"></a>
<script type="text/javascript" src='/js/totop.js?v=0.0.0' async=""></script>



    <script type="text/javascript" src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script>




                </div>

                <div id="secondary">
    <section class="widget">
        <form id="search" action='https://zaina.newban.cn/search/' method="get" accept-charset="utf-8" target="_blank" _lpchecked="1">
      
      <input type="text" name="q" maxlength="20" placeholder="Search">
      <input type="hidden" name="sitesearch" value="https://zaina.newban.cn">
      <button type="submit" class="submit icon-search"></button>
</form>
    </section>
    
    <section class="widget">
        <h3 class="widget-title">最近文章</h3>
<ul class="widget-list">
    
    <li>
        <a href="https://zaina.newban.cn/posts/001rubyruby%E4%B8%AD%E5%85%A8%E5%B1%80%E5%8F%98%E9%87%8F%E5%AE%9E%E4%BE%8B%E5%8F%98%E9%87%8F%E5%B1%80%E9%83%A8%E5%8F%98%E9%87%8F%E7%B1%BB%E5%8F%98%E9%87%8Fsymbol%E5%AF%B9%E6%AF%94/" title="001rubyRuby中全局变量实例变量局部变量类变量Symbol对比">001rubyRuby中全局变量实例变量局部变量类变量Symbol对比</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/007hadoop%E9%9B%86%E7%BE%A4%E9%85%8D%E7%BD%AEhadoop%E9%9B%86%E7%BE%A4%E7%9A%84%E5%90%AF%E5%8A%A8%E5%92%8C%E6%B5%8B%E8%AF%95ssh%E5%85%8D%E7%99%BB%E9%99%86%E9%85%8D%E7%BD%AEstartallshhdfs%E5%B8%B8%E7%94%A8%E7%9A%84shell/" title="007Hadoop集群配置Hadoop集群的启动和测试SSH免登陆配置startallshhdfs常用的shell">007Hadoop集群配置Hadoop集群的启动和测试SSH免登陆配置startallshhdfs常用的shell</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/009shell%E8%84%9A%E6%9C%AC%E4%B8%8B%E6%9D%A1%E4%BB%B6%E6%B5%8B%E8%AF%95eqne/" title="009Shell脚本下条件测试eqne">009Shell脚本下条件测试eqne</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/00pythonmanagepyshell%E5%92%8Cpython%E7%9A%84%E5%88%86%E6%9E%90/" title="00Pythonmanagepyshell和Python的分析">00Pythonmanagepyshell和Python的分析</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/010zookeeper%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5zookeeper%E7%9A%84%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BAzookeeper%E7%9A%84shell%E5%91%BD%E4%BB%A4/" title="010Zookeeper的基本概念Zookeeper的集群搭建Zookeeper的shell命令">010Zookeeper的基本概念Zookeeper的集群搭建Zookeeper的shell命令</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/018dockerfileshell/" title="018DockerfileSHELL">018DockerfileSHELL</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/01shell%E5%85%A5%E9%97%A801bashshell%E7%89%B9%E6%80%A7/" title="01Shell入门01bashShell特性">01Shell入门01bashShell特性</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/01shell%E5%8F%98%E9%87%8F/" title="01Shell变量">01Shell变量</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/01shell%E5%9F%BA%E7%A1%80%E6%A6%82%E8%BF%B0%E8%84%9A%E6%9C%AC%E6%89%A7%E8%A1%8C%E6%96%B9%E5%BC%8Fbash%E5%9F%BA%E6%9C%AC%E5%8A%9F%E8%83%BD/" title="01Shell基础概述脚本执行方式Bash基本功能">01Shell基础概述脚本执行方式Bash基本功能</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/01shell%E7%BC%96%E7%A8%8Bhelloworld/" title="01shell编程helloworld">01shell编程helloworld</a>
    </li>
    
</ul>
    </section>

    

    <section class="widget">
        <h3 class="widget-title"><a href="/categories">分类</a></h3>
<ul class="widget-list">
    
</ul>
    </section>

    <section class="widget">
        <h3 class="widget-title"><a href="/tags">标签</a></h3>
<div class="tagcloud">
    
    <a href="https://zaina.newban.cn/tags/ruby/">ruby</a>
    
    <a href="https://zaina.newban.cn/tags/shell/">shell</a>
    
</div>
    </section>

    

    <section class="widget">
        <h3 class="widget-title">其它</h3>
        <ul class="widget-list">
            <li><a href="https://zaina.newban.cn/index.xml">文章 RSS</a></li>
        </ul>
    </section>
</div>
            </div>
        </div>
    </div>
</body>

</html>