<!doctype html>
<html lang="en-us">
<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">


    <title>怎样写出规范的shell脚本仅限Scriptingwithstyle | 开发者问答集锦</title>
    <meta property="og:title" content="怎样写出规范的shell脚本仅限Scriptingwithstyle - 开发者问答集锦">
    <meta property="og:type" content="article">
        
    <meta property="article:published_time" content='2020-09-02T00:00:00&#43;08:00'>
        
        
    <meta property="article:modified_time" content='2020-09-02T00:00:00&#43;08:00'>
        
    <meta name="Keywords" content="">
    <meta name="description" content="怎样写出规范的shell脚本仅限Scriptingwithstyle">
        
    <meta name="author" content="">
    <meta property="og:url" content="https://zaina.newban.cn/posts/%E6%80%8E%E6%A0%B7%E5%86%99%E5%87%BA%E8%A7%84%E8%8C%83%E7%9A%84shell%E8%84%9A%E6%9C%AC%E4%BB%85%E9%99%90scriptingwithstyle/">
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">

    <link rel="stylesheet" href='/css/normalize.css'>
    <link rel="stylesheet" href='/css/style.css'>
    <script type="text/javascript" src="//cdn.bootcdn.net/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

    
    
    
    
    
    
</head>


<body>
    <header id="header" class="clearfix">
    <div class="container">
        <div class="col-group">
            <div class="site-name ">
                
                    <a id="logo" href="https://zaina.newban.cn">
                        开发者问答集锦
                    </a>
                
                
            </div>
            <div>
                <nav id="nav-menu" class="clearfix">
                    <a class="" href="https://zaina.newban.cn">首页</a>
                    
                </nav>
            </div>
        </div>
    </div>
</header>

    <div id="body">
        <div class="container">
            <div class="col-group">

                <div class="col-8" id="main">
                    
<div class="res-cons">
    
    <article class="post">
        <header>
            <h1 class="post-title">怎样写出规范的shell脚本仅限Scriptingwithstyle</h1>
        </header>
        <date class="post-meta meta-date">
            2020年9月2日
        </date>
        
        
        <div class="post-meta">
            <span id="busuanzi_container_page_pv">|<span id="busuanzi_value_page_pv"></span><span>
                    阅读</span></span>
        </div>
        
        
        <div class="post-content">
            

<p>目录： <strong>Area1:</strong> 某位博友总结的shell代码规范</p>

<p><strong>Area2:</strong> 一篇比较规范的脚本范例</p>

<p><strong>Area3:</strong> 书籍中提及的Scripting with style</p>

<p><strong>Area4:</strong> shell脚本学习好书推荐</p>

<p>#
因本人平常酷爱shell脚本，感觉其处理一些常见问题语法灵活，能够方便并快捷地处理许多问题，我们知道linux（UNIX）系统的启动基本上都是通过rc.d里面的脚本来实现，然而在浏览过各式各样的脚本后发现，许多脚本编写者在书写shell脚本时很不规范，也包括自己，譬如不加注释或注释很少或注释形式杂乱无章等，认为很有必要系统性地学习下脚本的规范风格，在chinaunix上也看到有过多年脚本编写经历的人纳闷这个问题。以下是整理的几类认为规范性地学习脚本不错滴文章。尤其是Area3中的Scripting
With Style的专门介绍。</p>

<p>注：本文只是谈及脚本的样式风格，如应该添加版本信息，用法等等，不涉及变量定义，代码效率等问题！</p>

<p>Area1:某位博友总结的shell代码规范</p>

<h1 id="shell代码规范-个人">Shell代码规范［个人］</h1>

<p>#
前言：随着写的SHELL程序越来越多，发现自己每次写都有不同的习惯或者定义了不同的东西，变量名定义得不一样，整个程序缩进不统一，没有注释等问题，等我回过头看这些程序的时候发现很麻烦。所以想到写个自己的shell代码规范。</p>

<p><strong>1 概述</strong></p>

<p>1.1 目的</p>

<p>定义Shell脚本命名和编码规范，统一管理Shell脚本，便于自己和别人查看，提高代码书写速度和美观，暂时只对自己进行约束,其它人只供参考。</p>

<p>1.2 概述</p>

<p>本文主要根据Fedora Core
4.0的特点，描述安装脚本、OS初始脚本、补丁制作等方面的代码编写规范，可能大部分还是根据自己的习惯与反复思考后的结果，同样也参考了PHP代码规范等。</p>

<p>1.3 开发工具</p>

<p>shell脚本是个文件，没有开发环境，FC4图形环境下，可用gedit、vi、vim、joe等，推荐使用vim因为这个最通用，他的功能同样是很强大，如果想在图形化下可以用gvim，并将环境设置为sh高亮显示，方法:1）cp
/etc/vim/vimrc ~/.vimrc 2) vim ~/.vimrc 去掉”syntax
on,并且；Windows下，可用ultraedit。文件保存时，有汉字提示的Shell脚本文件，文件保存时，字符编码必须为GB18030/GBK/GB2132
(UTF-8) 三种格式之一。</p>

<p><strong>2 对象命名规范</strong></p>

<p>2.1 命名约定<br />
1.本文档的命名约定是系统配置文件、脚本文件；</p>

<p>2.文件名、变量名、函数名不超过20个字符；</p>

<p>3.命名只能使用英文字母，数字和下划线，只有一个英文单词时使用全拼，有多个单词时，使用下划线分隔，长度较长时，可以取单词前3～4个字母。</p>

<p>4.文件名全部以小写命名，不能大小写混用（通过U盘交换文件时，大小写可能会丢失，即：大写文件名可能会全部变成小写文件名）；</p>

<p>5.避免使用Linux的保留字如true、关键字如PWD等（见附表）；</p>

<p>6.从配置文件导出配置时，要注意过滤空行和注释</p>

<p>2.2代码开头约定</p>

<p>1、第一行一般为调用使用的语言</p>

<p>2、下面要有这个程序名，避免更改文件名为无法找到正确的文件</p>

<p>3、版本号</p>

<p>4、更改后的时间</p>

<p>5、作者相关信息</p>

<p>6、该程序的作用，及注意事项</p>

<p>7、版权与是否开放共享GNU说明</p>

<p>8、最后是各版本的更新简要说明<br />
如下面的例子：</p>

<pre><code>#!/bin/bash

# -------------------------------------------------------------------------------
# Filename:    check_mem.sh
# Revision:    1.1
# Date:        2009/02/10
# Author:      Ajian
# Email:       ajian521#gmail.com
# Website:     www.ohlinux.com
# Description: Plugin to monitor the memory of the system
# Notes:       This plugin uses the &quot;&quot; command
# -------------------------------------------------------------------------------
# Copyright:   2009 (c) Ajian
# License:     GPL
#
# This program is free software; you can redistribute it and/or
# modify it under the terms of the GNU General Public License
# as published by the Free Software Foundation; either version 2
# of the License, or (at your option) any later version.
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty
# of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
# GNU General Public License for more details.
#
# you should have received a copy of the GNU General Public License
# along with this program (or with Nagios);
#
# Credits go to Ethan Galstad for coding Nagios
# If any changes are made to this script, please mail me a copy of the changes
# -------------------------------------------------------------------------------
#Version 1.0
#The first one , can monitor the system memory
#Version 1.1
#Modify the method of the script ,more fast
</code></pre>

<p>2.3 缩进</p>

<p>由于Shell没有很好的编辑环境，所以，建议用四个空格为基数进行缩进，好处在不同的环境下TAB可能代表的空格数不同，造成代码的错乱。用TAB他的优点是速度快方便，可以在编辑的时候也用TAB，但需要转换。</p>

<dl>
<dt>可以在更改编辑器，Windows的就不说了，主要是VIM</dt>
</dl>

<p>:set softtabstop=4</p>

<p>注意不要使用 <code>:set tabstop=4
上面那个是同时把这一个TAB转换为四个空格，而这一条是定义TAB为四个空格，如果到其它编辑器上就会看到默认8个空格的情况，那就会不美观了。</code></p>

<p>另外将原有的TAB转换为空格，:<code>retab</code></p>

<p>如果想让刚才的配置永久生效需要改动vim的配置文件 vim ~/.vimrc,更多详细的有用的配置见“VIM配置总结”</p>

<p>2.4 页宽</p>

<p>每行不要超过80字，如果超出，建议用“\”折行，有管道的命令行除外。</p>

<p>2.5 环境变量</p>

<p>变量：全部是大写字母</p>

<p>变量引用：全部以变量名加双引号引用，如”$TERMTYPE”，或“${TERMTYPE}”，如果变量类型是数值型不引用，如:</p>

<p>如果需要从配置文件导出变量，则在变量前加一大写字母，以识别导出变量与自定义环境变量的区别，如：</p>

<p>变量值的引用尽量以$开头，如$(ls inst_*.sh)，避免使用<code>ls inst_*。sh</code></p>

<p>循环控制变量可以命名为单个字母， 比如 i、j等。 也可以是更有意义的名称， 比如 UserIndex。</p>

<p>环境变量和全局变量 在脚本开头定义。</p>

<p>函数中使用较多的文件，以环境变量的形式在文件开头定义，仅函数中使用的变量在函数开头定义</p>

<p>2.6 函数</p>

<p>函数以动名词形式存储，且第二个单词首字母要大写，如updateConfig()</p>

<p>每个函数控制在50－100行，超出行数建议分成两个函数</p>

<p>多次反复调用的程序最好分成函数，可以简化程序，使程序条理更清楚</p>

<p>2.7 语句</p>

<p>if 语句</p>

<p>if/then/else 语句中最可能被执行的部分应该放在 then 子句中， 不太可能被执行的部分应该放在 else 子句中。</p>

<p>如果可能， 尽量不要使用一连串的 if 语句， 而应该以 case 语句替代。</p>

<p>不要使 if 语句嵌套超过5层以上， 尽量以更清楚的代码替代。</p>

<p>case 语句</p>

<p>概要</p>

<p>case 语句中的单个子句应该以 case 常数的数字顺序或字母顺序排列。 子句中的执行语句应该尽量保持简单， 一般不要超过4到5行代码。
如果执行语句过于复杂， 应该将它放置在独立的函数中。</p>

<p>case 语句的 *) 子句应该只在正常的默认情况或检测到错误的情况下使用。</p>

<p>格式</p>

<p>case 语句遵循同样的缩进和命名约定。</p>

<p>while 语句</p>

<p>使用 Exit 过程退出 while 循环是不好的; 如果可能， 应该只使用循环条件来结束循环。</p>

<p>while 循环的所有初始化代码应该紧贴在进入 while 循环之前， 不要被其他无关语句分隔开。</p>

<p>循环结束后的处理应该紧跟在循环之后。</p>

<p>for 语句</p>

<p>如果需要执行确定次数的增量循环， 应该用 for 语句替代 while 语句。</p>

<p>2.8 信号捕捉</p>

<p>如果在进行重要配置修改时，应捕捉用户按键，如果用户按下Ctrl+C等重要操作终止程序，则调用回退程序，如：</p>

<p>2.9 关于注释</p>

<p>程序头应加注版本与功能说明的注释。但程序第一行不能汉字。</p>

<p>程序体中应包含必要的注释，注释说明如下：</p>

<p>单行注释，可以放在代码行的尾部或代码行的上部；</p>

<p>多行注释，用于注解复杂的功能说明，可以放在程序体中，也可以放在代码块的开始部分</p>

<p>代码修改时，对修改的内容要加必要版本注释及功能说明。</p>

<p>Area2:一篇比较规范的脚本范例</p>

<p>以下是一个游戏脚本&ndash;“挖地雷”。像代码注释段，该有的信息都有，显得非常专业化，再者脚本的内容也看起来很舒服，可以说是化难为易。</p>

<ol>
<li>#!/bin/bash</li>
<li>#&mdash;&mdash;&mdash;&mdash;-CopyRight&mdash;&mdash;&mdash;&mdash;-</li>
<li># Name:Mine Sweeping</li>
<li># Version Number:1.00</li>
<li># Type:game</li>
<li># Language:bash shell</li>
<li># Date:2005-10-26</li>
<li># Author:BitBull</li>
<li># Email:BitBull.cn(at)gmail.com</li>
<li>#&mdash;&mdash;&mdash;&mdash;Environment&mdash;&mdash;&mdash;&mdash;</li>
<li># Terminal: column 80 line 24</li>
<li># Linux 2.6.9 i686</li>
<li># GNU Bash 3.00.15</li>
<li>#&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;</li>
<li>16. #&mdash;&mdash;&mdash;&mdash;&mdash;Define&mdash;&mdash;&mdash;&mdash;&ndash;</li>
<li>ECHO=&ldquo;echo -ne&rdquo;</li>
<li>ESC=&rdquo;\033[&rdquo;</li>
<li>20. OK=0</li>
<li>FALSE=1</li>
<li>#&mdash;&mdash;&mdash;&mdash;&ndash;Variable&mdash;&mdash;&mdash;&mdash;&ndash;</li>
<li>#ANSI ESC action</li>
<li>FLASH=5</li>
<li>REV=7</li>
<li>27. #color</li>
<li>NULL=0</li>
<li>BLACK=30</li>
<li>RED=31</li>
<li>GREEN=32</li>
<li>ORANGE=33</li>
<li>BLUE=34</li>
<li>PURPLE=35</li>
<li>SBLUE=36</li>
<li>GREY=37</li>
<li>38. #back color</li>
<li>BBLACK=40</li>
<li>BRED=41</li>
<li>BGREEN=42</li>
<li>BORANGE=43</li>
<li>BBLUE=44</li>
<li>BPURPLE=45</li>
<li>BSBLUE=46</li>
<li>BGREY=47</li>
<li>48. MINE=&lsquo;@&rsquo;</li>
<li>FLAG=&lsquo;F&rsquo;</li>
<li>NUL=&rsquo; &lsquo;</li>
<li>SHADOW=&lsquo;X&rsquo;</li>
<li>53. X=0</li>
<li>Y=0</li>
<li>CurX=1 #cur&rsquo;s X</li>
<li>CurY=1 #cur&rsquo;s Y</li>
<li>OCurX=1 #old cur&rsquo;s X</li>
<li>OCurY=1 #old cur&rsquo;s Y</li>
<li>MCount=0 #count mine</li>
<li>FCount=0 #count flag</li>
<li>SCount=0 #count shadow</li>
<li>MXYp=0 #MXY Array&rsquo;s ptr</li>
<li>#&mdash;&mdash;&mdash;&mdash;&mdash;Array&mdash;&mdash;&mdash;&mdash;&mdash;-</li>
<li>65. #if ${XY[]} == M { mine }</li>
<li>#if ${XY[]} == F { flag }</li>
<li>#if ${XY[]} == N { null }</li>
<li>#if ${XY[]} == S { shadow }</li>
<li>#if ${XY[]} == [1-8] { tip_num }</li>
<li>#${XY[]} init in XYInit(i)</li>
<li>72. MXY[0]=&ldquo;&rdquo;</li>
<li>74. #&mdash;&mdash;&mdash;&mdash;&ndash;Function&mdash;&mdash;&mdash;&mdash;&ndash;</li>
<li>76. function SttyInit ()</li>
<li>{</li>
<li>stty_save=$(stty -g) #backup stty</li>
<li>80. clear</li>
<li>trap &ldquo;GameExit;&rdquo; 2 15</li>
<li>stty -echo</li>
<li>84. $ECHO &ldquo;${ESC}?25l&rdquo; #hidden cursor</li>
<li>86. return $OK</li>
<li>}</li>
<li>89. function GameExit ()</li>
<li>{</li>
<li>stty $stty_save</li>
<li>stty echo</li>
<li>clear</li>
<li>trap 2 15</li>
<li>$ECHO &ldquo;${ESC}?25h${ESC}0;0H${ESC}0m&rdquo;</li>
<li>97. exit $OK</li>
<li>}</li>
<li>100. #print help</li>
<li>function Help ()</li>
<li>{</li>
<li>msg=&ldquo;Move:w s a d Dig:j Flag:f NewGame:n Exit:x &ndash;CopyRight&ndash; -2005-10-28 BitBull&ndash;&rdquo;</li>
<li>$ECHO &ldquo;${ESC}${REV};${RED}m${ESC}24;1H${msg}${ESC}${NULL}m&rdquo;</li>
<li>106. return $OK</li>
<li>}</li>
<li>109. #print dialog window in screen</li>
<li>function PMsg ()</li>
<li>{</li>
<li>local title=&ldquo;$1&rdquo; content=&ldquo;$2&rdquo; greeting=&ldquo;$3&rdquo;</li>
<li>114. $ECHO &ldquo;${ESC}${RED}m&rdquo;</li>
<li>$ECHO &ldquo;${ESC}11;20H &mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;- &ldquo;</li>
<li>$ECHO &ldquo;${ESC}12;20H| ======&gt;$title&lt;====== |&rdquo;</li>
<li>$ECHO &ldquo;${ESC}13;20H| $content |&rdquo;</li>
<li>$ECHO &ldquo;${ESC}14;20H| ======&gt;$greeting&lt;====== |&rdquo;</li>
<li>$ECHO &ldquo;${ESC}15;20H &mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;- &ldquo;</li>
<li>$ECHO &ldquo;${ESC}${NULL}m&rdquo;</li>
<li>122. return $OK</li>
<li>}</li>
<li>125. #print menu and player choose level,then ${X,Y,MCount,FCount,SCount} init</li>
<li>function Menu ()</li>
<li>{</li>
<li>local key</li>
<li>130. $ECHO &ldquo;${ESC}6;1H${ESC}${RED}m&rdquo;</li>
<li>cat&lt;</li>
<li>+++++++++++++++++++++++++++++</li>
<li>+ (1) Easy +</li>
<li>+ (2) Normal +</li>
<li>+ (3) Hardly +</li>
<li>+ (4) Exit +</li>
<li>+++++++++++++++++++++++++++++</li>
<li>MENUEND</li>
<li>$ECHO &ldquo;${ESC}${NULL}m&rdquo;</li>
<li>141. while read -s -n 1 key</li>
<li>do</li>
<li>case $key in</li>
<li>1) X=10;Y=10;MCount=10;FCount=10;SCount=100;break</li>
<li>;;</li>
<li>2) X=20;Y=14;MCount=28;FCount=28;SCount=280;break</li>
<li>;;</li>
<li>3) X=36;Y=18;MCount=65;FCount=65;SCount=648;break</li>
<li>;;</li>
<li>4) GameExit</li>
<li>;;</li>
<li>esac</li>
<li>done</li>
<li>155. return $OK</li>
<li>}</li>
<li>158. #receive CurX CurY,put it into XY[CurX+X*(CurY-1))]</li>
<li>#if $# == 3;write into XY[]</li>
<li>#if $# == 2;read from XY[]</li>
<li>function XYFormat ()</li>
<li>{</li>
<li>local XTmp=$1 YTmp=$2</li>
<li>165. if [[ $# -eq 3 ]]</li>
<li>then XY[$XTmp+$X*($YTmp-1)]=$3</li>
<li>else echo ${XY[$XTmp+$X*($YTmp-1)]}</li>
<li>fi</li>
<li>170. return $OK</li>
<li>}</li>
<li>173. function DrawInit ()</li>
<li>{</li>
<li>local DIline DIline2</li>
<li>177. DIline=$( for (( i=1; i2)); i++ )) do $ECHO &lsquo;-&rsquo;;done )</li>
<li>DIline2=$( for (( i=0; i&rdquo;|${ESC}${SBLUE}mX${ESC}${NULL}m&rdquo;;done )</li>
<li>180. clear</li>
<li>Help</li>
<li>183. $ECHO &ldquo;${ESC}1;1H+${DIline}+&rdquo;</li>
<li>for (( i=0; i</li>
<li>do</li>
<li>$ECHO &ldquo;${ESC}$((i+2));1H${DIline2}|&rdquo;</li>
<li>done</li>
<li>$ECHO &ldquo;${ESC}$((Y+2));1H+${DIline}+&rdquo;</li>
<li>190. return $OK</li>
<li>}</li>
<li>193. #${XY[*]}=S</li>
<li>function XYInit ()</li>
<li>{</li>
<li>for (( i=1; i&lt;=$X; i++ ))</li>
<li>do</li>
<li>for (( j=1; j&lt;=$Y; j++ ))</li>
<li>do</li>
<li>XYFormat $i $j S</li>
<li>done</li>
<li>done</li>
<li>return $OK</li>
<li>}</li>
<li>206. #check X Y</li>
<li>function CheckXY ()</li>
<li>{</li>
<li>local XYTmp=&ldquo;$1 $2&rdquo;</li>
<li>211. for(( i=0; i</li>
<li>do</li>
<li>if [[ &ldquo;${MXY[i]}&rdquo; == &ldquo;$XYTmp&rdquo; ]]</li>
<li>then return $FALSE</li>
<li>fi</li>
<li>done</li>
<li>218. return $OK</li>
<li>}</li>
<li>221. #RANDOM mine&rsquo;s X Y</li>
<li>function XYRand ()</li>
<li>{</li>
<li>local XTmp YTmp</li>
<li>226. for(( i=0; i</li>
<li>do</li>
<li>while :</li>
<li>do</li>
<li>XTmp=$(( RANDOM % ( X - 1 ) + 1 ))</li>
<li>YTmp=$(( RANDOM % ( Y - 1 ) + 1 ))</li>
<li>CheckXY $XTmp $YTmp</li>
<li>234. if [[ &ldquo;$?&rdquo; == &ldquo;$OK&rdquo; ]]</li>
<li>then</li>
<li>XYFormat $XTmp $YTmp M</li>
<li>MXY[i]=&ldquo;$XTmp $YTmp&rdquo;</li>
<li>(( ++MXYp ))</li>
<li>break</li>
<li>else continue</li>
<li>fi</li>
<li>done</li>
<li>done</li>
<li>245. return $OK</li>
<li>}</li>
<li>248. #DEBUG</li>
<li># print ${XY[*]} into ./mine.tmp</li>
<li>#you can read mine.tmp to know where is mine,xixi~~:)</li>
<li>#M is mine</li>
<li>function DEBUGPXY ()</li>
<li>{</li>
<li>rm mine.tmp&gt;/dev/null 2&gt;&amp;1</li>
<li>for(( i=1; i&lt;=$Y; i++ ))</li>
<li>do</li>
<li>for(( j=1; j&lt;=$X; j++))</li>
<li>do</li>
<li>$ECHO &ldquo;$(XYFormat $j $i)&rdquo;&gt;&gt;mine.tmp</li>
<li>done</li>
<li>$ECHO &ldquo;\n&rdquo;&gt;&gt;mine.tmp</li>
<li>done</li>
<li>264. return $OK</li>
<li>}</li>
<li>267. #move cur</li>
<li>#usage:CurMov [UP|DOWN|LEFT|RIGHT]</li>
<li>function CurMov ()</li>
<li>{</li>
<li>local direction=$1 Xmin=1 Ymin=1 Xmax=$X Ymax=$Y</li>
<li>273. OCurX=$CurX</li>
<li>OCurY=$CurY</li>
<li>276. case $direction in</li>
<li>&ldquo;UP&rdquo;) if [[ $CurY -gt $Ymin ]];then (( CurY&ndash; ));fi</li>
<li>;;</li>
<li>&ldquo;DOWN&rdquo;) if [[ $CurY -lt $Ymax ]];then (( CurY++ ));fi</li>
<li>;;</li>
<li>&ldquo;LEFT&rdquo;) if [[ $CurX -gt $Xmin ]];then (( CurX&ndash; ));fi</li>
<li>;;</li>
<li>&ldquo;RIGHT&rdquo;)if [[ $CurX -lt $Xmax ]];then (( CurX++ ));fi</li>
<li>;;</li>
<li>esac</li>
<li>287. if [[ $CurX != $OCurX || $CurY != $OCurY ]]</li>
<li>then DrawPoint $CurX $CurY CUR</li>
<li>fi</li>
<li>291. return $OK</li>
<li>}</li>
<li>294. #display point</li>
<li>#include cur,flag,mine,shadow,nul,tip [1-8]</li>
<li>function DrawPoint ()</li>
<li>{</li>
<li>local TCurX=$(( $1 * 2 )) TCurY=$(( $2 + 1 )) Type=$3</li>
<li>local TOCurX=$(( OCurX * 2 )) TOCurY=$(( OCurY + 1 ))</li>
<li>local colr=0 osign=0 sign=0</li>
<li>302. case $Type in</li>
<li>&ldquo;CUR&rdquo;)</li>
<li>case $(XYFormat $OCurX $OCurY) in</li>
<li>F) colr=$PURPLE;osign=$FLAG;;</li>
<li>N) colr=$NULL;osign=$NUL;;</li>
<li>[1-8]) colr=$ORANGE;osign=$(XYFormat $OCurX $OCurY);;</li>
<li>[SM]) colr=$SBLUE;osign=$SHADOW;;</li>
<li>esac</li>
<li>311. case $(XYFormat $CurX $CurY) in</li>
<li>F) sign=$FLAG;;</li>
<li>N) sign=$NUL;;</li>
<li>[1-8]) sign=$(XYFormat $CurX $CurY);;</li>
<li>[SM]) sign=$SHADOW;;</li>
<li>esac</li>
<li>318. $ECHO &ldquo;${ESC}${colr}m${ESC}${TOCurY};${TOCurX}H${osign}${ESC}${NULL}m&rdquo;</li>
<li>$ECHO &ldquo;${ESC}${REV};${FLASH};${ORANGE}m${ESC}${TCurY};${TCurX}H${sign}${ESC}${NULL}m&rdquo;</li>
<li>;;</li>
<li>&ldquo;SHADOW&rdquo;)</li>
<li>$ECHO &ldquo;${ESC}${SBLUE}m${ESC}${TCurY};${TCurX}H${SHADOW}${ESC}${NULL}m&rdquo;</li>
<li>;;</li>
<li>&ldquo;MINE&rdquo;)</li>
<li>$ECHO &ldquo;${ESC}${REV};${RED}m${ESC}${TCurY};${TCurX}H${MINE}${ESC}${NULL}m&rdquo;</li>
<li>;;</li>
<li>&ldquo;FLAG&rdquo;)</li>
<li>$ECHO &ldquo;${ESC}${TCurY};${TCurX}H${ESC}${PURPLE}m${FLAG}${ESC}${NULL}m&rdquo;</li>
<li>;;</li>
<li>[1-8])</li>
<li>$ECHO &ldquo;${ESC}${TCurY};${TCurX}H${ESC}${ORANGE}m${Type}${ESC}${NULL}m&rdquo;</li>
<li>;;</li>
<li>&ldquo;NUL&rdquo;)</li>
<li>$ECHO &ldquo;${ESC}${TCurY};${TCurX}H${NUL}&rdquo;</li>
<li>esac</li>
<li>337. return $OK</li>
<li>}</li>
<li>340. #check xy</li>
<li>function Loop ()</li>
<li>{</li>
<li>local XYTmp=&ldquo;$1 $2&rdquo;</li>
<li>345. for (( i=0; i</li>
<li>do</li>
<li>if [[ &ldquo;$XYTmp&rdquo; == &ldquo;${MXY[i]}&rdquo; ]]</li>
<li>then $ECHO 1</li>
<li>fi</li>
<li>done</li>
<li>352. return $OK</li>
<li>}</li>
<li>355. #count around mine</li>
<li>#A B C</li>
<li>#D X E</li>
<li>#F G H</li>
<li>#return mine&rsquo;s number</li>
<li>function CountM ()</li>
<li>{</li>
<li>local Xmin=1 Ymin=1 Xmax=$X Ymax=$Y minecount=0 n=0</li>
<li>#A</li>
<li>if [[ ( $CurX -gt $Xmin ) &amp;&amp; ( $CurY -gt $Ymin ) ]]</li>
<li>then</li>
<li>n=$( Loop $((CurX-1)) $((CurY-1)) )</li>
<li>(( minecount += n ))</li>
<li>n=0</li>
<li>fi</li>
<li>#B</li>
<li>if [[ $CurY -gt $Ymin ]]</li>
<li>then</li>
<li>n=$( Loop $CurX $((CurY-1)) )</li>
<li>(( minecount += n ))</li>
<li>n=0</li>
<li>fi</li>
<li>#C</li>
<li>if [[ ( $CurX -lt $Xmax ) &amp;&amp; ( $CurY -gt $Ymin ) ]]</li>
<li>then</li>
<li>n=$( Loop $((CurX+1)) $((CurY-1)) )</li>
<li>(( minecount += n ))</li>
<li>n=0</li>
<li>fi</li>
<li>#D</li>
<li>if [[ $CurX -gt $Xmin ]]</li>
<li>then</li>
<li>n=$( Loop $((CurX-1)) $CurY )</li>
<li>(( minecount += n ))</li>
<li>n=0</li>
<li>fi</li>
<li>#E</li>
<li>if [[ $CurX -lt $Xmax ]]</li>
<li>then</li>
<li>n=$( Loop $((CurX+1)) $CurY )</li>
<li>(( minecount += n ))</li>
<li>n=0</li>
<li>fi</li>
<li>#F</li>
<li>if [[ ( $CurX -gt $Xmin ) &amp;&amp; ( $CurY -lt $Ymax ) ]]</li>
<li>then</li>
<li>n=$( Loop $((CurX-1)) $((CurY+1)) )</li>
<li>(( minecount += n ))</li>
<li>n=0</li>
<li>fi</li>
<li>#G</li>
<li>if [[ $CurY -lt $Ymax ]]</li>
<li>then</li>
<li>n=$( Loop $CurX $((CurY+1)) )</li>
<li>(( minecount += n ))</li>
<li>n=0</li>
<li>fi</li>
<li>#H</li>
<li>if [[ ( $CurX -lt $Xmax ) &amp;&amp; ( $CurY -lt $Ymax ) ]]</li>
<li>then</li>
<li>n=$( Loop $((CurX+1)) $((CurY+1)) )</li>
<li>(( minecount += n ))</li>
<li>n=0</li>
<li>fi</li>
<li>420. return $minecount</li>
<li>}</li>
<li>423. #dig</li>
<li>#if mine ,gameover</li>
<li>#else tip around mine&rsquo;s number</li>
<li>function Dig ()</li>
<li>{</li>
<li>local key minenum=0</li>
<li>430. case $(XYFormat $CurX $CurY) in</li>
<li>M)</li>
<li>DrawPoint $CurX $CurY MINE</li>
<li>read -s -n 1 key</li>
<li>GameOver &ldquo;Game Over&rdquo;</li>
<li>;;</li>
<li>S)</li>
<li>CountM</li>
<li>minenum=$?</li>
<li>if [[ $minenum -eq $NULL ]]</li>
<li>then</li>
<li>XYFormat $CurX $CurY N</li>
<li>DrawPoint $CurX $CurY NUL</li>
<li>else</li>
<li>XYFormat $CurX $CurY $minenum</li>
<li>DrawPoint $CurX $CurY $minenum</li>
<li>fi</li>
<li>448. (( SCount&ndash; ))</li>
<li>if [[ $SCount -eq $MCount ]]</li>
<li>then GameOver &ldquo;Well Done&rdquo;</li>
<li>fi</li>
<li>;;</li>
<li>esac</li>
<li>DrawPoint $CurX $CurY CUR</li>
<li>456. return $OK</li>
<li>}</li>
<li>459. #draw flag&rsquo;s number</li>
<li>function DrawFCount ()</li>
<li>{</li>
<li>$ECHO &ldquo;${ESC}22;34H${ESC};${PURPLE}mFLAG=${FCount} ${ESC}${NULL}m&rdquo;</li>
<li>}</li>
<li>465. #sign mine</li>
<li>function Flag ()</li>
<li>{</li>
<li>local XYTmp=&ldquo;$CurX $CurY&rdquo;;stat=$FALSE</li>
<li>470. case $(XYFormat $CurX $CurY) in</li>
<li>F)</li>
<li>for (( i=1; i</li>
<li>do</li>
<li>if [[ &ldquo;${MXY[i]}&rdquo; == &ldquo;$XYTmp&rdquo; ]]</li>
<li>then XYFormat $CurX $CurY M;stat=$OK;break</li>
<li>fi</li>
<li>done</li>
<li>if [[ $stat == $FALSE ]]</li>
<li>then XYFormat $CurX $CurY S</li>
<li>fi</li>
<li>482. DrawPoint $CurX $CurY SHADOW</li>
<li>(( FCount++ ))</li>
<li>DrawFCount</li>
<li>;;</li>
<li>[SM])</li>
<li>if [[ $FCount -eq $NULL ]]</li>
<li>then return $FALSE</li>
<li>fi</li>
<li>491. DrawPoint $CurX $CurY FLAG</li>
<li>XYFormat $CurX $CurY F</li>
<li>(( FCount&ndash; ))</li>
<li>DrawFCount</li>
<li>;;</li>
<li>esac</li>
<li>DrawPoint $CurX $CurY CUR</li>
<li>499. return $OK</li>
<li>}</li>
<li>502. function GameOver ()</li>
<li>{</li>
<li>local key msgtitle=$1</li>
<li>506. PMsg &ldquo;$msgtitle&rdquo; &ldquo;Do you want replay?&rdquo; &ldquo;Thank You&rdquo;</li>
<li>while read -s -n 1 key</li>
<li>do</li>
<li>case $key in</li>
<li>[yY]) exec $(dirname $0)/$(basename $0);;</li>
<li>[nN]) GameExit;;</li>
<li>*) continue;;</li>
<li>esac</li>
<li>done</li>
<li>516. return $OK</li>
<li>}</li>
<li>519. #main</li>
<li>#drawscreen and control</li>
<li>function Main ()</li>
<li>{</li>
<li>local key</li>
<li>525. XYInit</li>
<li>XYRand</li>
<li>############################</li>
<li># if you enable DEBUGPXY,</li>
<li>#you can know where is mine</li>
<li># DEBUGPXY #delete this line&rsquo;s #</li>
<li>#then cat ./mine.tmp</li>
<li>############################</li>
<li>534. DrawPoint $CurX $CurY CUR</li>
<li>DrawFCount</li>
<li>537. while read -s -n 1 key</li>
<li>do</li>
<li>case $key in</li>
<li>[wW]) CurMov UP;;</li>
<li>[sS]) CurMov DOWN;;</li>
<li>[aA]) CurMov LEFT;;</li>
<li>[dD]) CurMov RIGHT;;</li>
<li>[jJ]) Dig;;</li>
<li>[fF]) Flag;;</li>
<li>[nN]) exec $(dirname $0)/$(basename $0);;</li>
<li>[xX]) GameExit;;</li>
<li>esac</li>
<li>done</li>
<li>551. return $OK</li>
<li>}</li>
<li>#&mdash;&mdash;&mdash;&mdash;&mdash;Main&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;</li>
<li>555. SttyInit</li>
<li>Menu #X Y MCount FCount SCount OK!</li>
<li>DrawInit</li>
<li>Main

<br />

<br /></li>
</ol>

<p>Area3:书籍中提及的Scripting with style</p>

<h1 id="http-tldp-org-ldp-abs-html-scrstyle-html这是链接地址"><a href="http://tldp.org/LDP/abs/html/scrstyle.html这是链接地址">http://tldp.org/LDP/abs/html/scrstyle.html这是链接地址</a></h1>

<p>Area4:shell脚本学习好书推荐</p>

<p>ABS，高级Bash脚本编程指南，<a href="http://www.tsnc.edu.cn/default/tsnc_wgrj/doc/abs-3.9.1_cn/html/">http://www.tsnc.edu.cn/default/tsnc_wgrj/doc/abs-3.9.1_cn/html/</a></p>

<p>推荐看这本：《Learning the bash shell》（<a href="http://book.douban.com/subject/3296982/）">http://book.douban.com/subject/3296982/）</a></p>

<p>内容清晰，提纲挈领<br />
书不是很厚，可以很快看完，然后投入实践</p>

<p>1. &lt; &lt; Advanced Bash-Scripting Guide &gt; &gt; ，即ABS，<a href="http://tldp.org/LDP/abs/html/。">http://tldp.org/LDP/abs/html/。</a><br />
经典的Online教程，内容全面，对每一个知识点都有相当多的实例，适合系统的学习。之前有翻译的版本出到过3.9.1。</p>

<p>2. &lt; &lt; UNIX Shells by Example Fourth Edition &gt; &gt; ，网上有chm下载。<br />
这本书适合用的时候查询，结构很清晰，以语法为主。它的亮点在于将几种常用的不同种类的Shell分开来描述。</p>

<p>3. &lt; &lt; Linux Command Line and Shell Scripting Bible &gt; &gt; ，网上有pdf下载。<br />
这本书也很全面。适合那些喜欢一章一章看书的人去学，印刷质量相当的好。</p>

<p>4. &lt; &lt; LINUX与UNIX Shell编程指南 &gt; &gt; ，网上有pdf下载。<br />
中文。中文。中文。</p>

<p>&lt; &lt; UNIX Shells by Example Fourth Edition &gt; &gt;
推荐这本，网上有中文版pdf。内容丰富，讲解也不错。每个例子都是c shell
，ksh，bash三种都有，最好着重学习一个，个人喜欢bash，简练且紧凑。c shell的交互功能做的倒是不错，不过要是用它写脚本你会想去撞墙。<br />
其实学什么教材倒是其次，坚持只用linux做桌面环境才是关键，同时拔掉你的鼠标。</p>

        </div>

        


        

<div class="post-archive">
    <h2>See Also</h2>
    <ul class="listing">
        
        <li><a href="/posts/007hadoop%E9%9B%86%E7%BE%A4%E9%85%8D%E7%BD%AEhadoop%E9%9B%86%E7%BE%A4%E7%9A%84%E5%90%AF%E5%8A%A8%E5%92%8C%E6%B5%8B%E8%AF%95ssh%E5%85%8D%E7%99%BB%E9%99%86%E9%85%8D%E7%BD%AEstartallshhdfs%E5%B8%B8%E7%94%A8%E7%9A%84shell/">007Hadoop集群配置Hadoop集群的启动和测试SSH免登陆配置startallshhdfs常用的shell</a></li>
        
        <li><a href="/posts/009shell%E8%84%9A%E6%9C%AC%E4%B8%8B%E6%9D%A1%E4%BB%B6%E6%B5%8B%E8%AF%95eqne/">009Shell脚本下条件测试eqne</a></li>
        
        <li><a href="/posts/00pythonmanagepyshell%E5%92%8Cpython%E7%9A%84%E5%88%86%E6%9E%90/">00Pythonmanagepyshell和Python的分析</a></li>
        
        <li><a href="/posts/010zookeeper%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5zookeeper%E7%9A%84%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BAzookeeper%E7%9A%84shell%E5%91%BD%E4%BB%A4/">010Zookeeper的基本概念Zookeeper的集群搭建Zookeeper的shell命令</a></li>
        
        <li><a href="/posts/018dockerfileshell/">018DockerfileSHELL</a></li>
        
    </ul>
</div>


        <div class="post-meta meta-tags">
            
            <ul class="clearfix">
                
                <li><a href='https://zaina.newban.cn/tags/shell'>shell</a></li>
                
            </ul>
            
        </div>
    </article>
    
    

    
    
</div>

                    <footer id="footer">
    <div>
        &copy; 2020 <a href="https://zaina.newban.cn">开发者问答集锦 By </a>
        
    </div>
    <br />
    <div>
        <div class="github-badge">
            <a href="https://gohugo.io/" target="_black" rel="nofollow"><span class="badge-subject">Powered by</span><span class="badge-value bg-blue">Hugo</span></a>
        </div>
        <div class="github-badge">
            <a href="https://www.flysnow.org/" target="_black"><span class="badge-subject">Design by</span><span class="badge-value bg-brightgreen">飞雪无情</span></a>
        </div>
        <div class="github-badge">
            <a href="https://github.com/flysnow-org/maupassant-hugo" target="_black"><span class="badge-subject">Theme</span><span class="badge-value bg-yellowgreen">Maupassant</span></a>
        </div>
    </div>
</footer>


    
    <script type="text/javascript">
        window.MathJax = {
            tex2jax: {
                inlineMath: [['$', '$']],
                processEscapes: true
                }
            };
    </script>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML' async></script>

<a id="rocket" href="#top"></a>
<script type="text/javascript" src='/js/totop.js?v=0.0.0' async=""></script>



    <script type="text/javascript" src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script>




                </div>

                <div id="secondary">
    <section class="widget">
        <form id="search" action='https://zaina.newban.cn/search/' method="get" accept-charset="utf-8" target="_blank" _lpchecked="1">
      
      <input type="text" name="q" maxlength="20" placeholder="Search">
      <input type="hidden" name="sitesearch" value="https://zaina.newban.cn">
      <button type="submit" class="submit icon-search"></button>
</form>
    </section>
    
    <section class="widget">
        <h3 class="widget-title">最近文章</h3>
<ul class="widget-list">
    
    <li>
        <a href="https://zaina.newban.cn/posts/001rubyruby%E4%B8%AD%E5%85%A8%E5%B1%80%E5%8F%98%E9%87%8F%E5%AE%9E%E4%BE%8B%E5%8F%98%E9%87%8F%E5%B1%80%E9%83%A8%E5%8F%98%E9%87%8F%E7%B1%BB%E5%8F%98%E9%87%8Fsymbol%E5%AF%B9%E6%AF%94/" title="001rubyRuby中全局变量实例变量局部变量类变量Symbol对比">001rubyRuby中全局变量实例变量局部变量类变量Symbol对比</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/007hadoop%E9%9B%86%E7%BE%A4%E9%85%8D%E7%BD%AEhadoop%E9%9B%86%E7%BE%A4%E7%9A%84%E5%90%AF%E5%8A%A8%E5%92%8C%E6%B5%8B%E8%AF%95ssh%E5%85%8D%E7%99%BB%E9%99%86%E9%85%8D%E7%BD%AEstartallshhdfs%E5%B8%B8%E7%94%A8%E7%9A%84shell/" title="007Hadoop集群配置Hadoop集群的启动和测试SSH免登陆配置startallshhdfs常用的shell">007Hadoop集群配置Hadoop集群的启动和测试SSH免登陆配置startallshhdfs常用的shell</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/009shell%E8%84%9A%E6%9C%AC%E4%B8%8B%E6%9D%A1%E4%BB%B6%E6%B5%8B%E8%AF%95eqne/" title="009Shell脚本下条件测试eqne">009Shell脚本下条件测试eqne</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/00pythonmanagepyshell%E5%92%8Cpython%E7%9A%84%E5%88%86%E6%9E%90/" title="00Pythonmanagepyshell和Python的分析">00Pythonmanagepyshell和Python的分析</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/010zookeeper%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5zookeeper%E7%9A%84%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BAzookeeper%E7%9A%84shell%E5%91%BD%E4%BB%A4/" title="010Zookeeper的基本概念Zookeeper的集群搭建Zookeeper的shell命令">010Zookeeper的基本概念Zookeeper的集群搭建Zookeeper的shell命令</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/018dockerfileshell/" title="018DockerfileSHELL">018DockerfileSHELL</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/01shell%E5%85%A5%E9%97%A801bashshell%E7%89%B9%E6%80%A7/" title="01Shell入门01bashShell特性">01Shell入门01bashShell特性</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/01shell%E5%8F%98%E9%87%8F/" title="01Shell变量">01Shell变量</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/01shell%E5%9F%BA%E7%A1%80%E6%A6%82%E8%BF%B0%E8%84%9A%E6%9C%AC%E6%89%A7%E8%A1%8C%E6%96%B9%E5%BC%8Fbash%E5%9F%BA%E6%9C%AC%E5%8A%9F%E8%83%BD/" title="01Shell基础概述脚本执行方式Bash基本功能">01Shell基础概述脚本执行方式Bash基本功能</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/01shell%E7%BC%96%E7%A8%8Bhelloworld/" title="01shell编程helloworld">01shell编程helloworld</a>
    </li>
    
</ul>
    </section>

    

    <section class="widget">
        <h3 class="widget-title"><a href="/categories">分类</a></h3>
<ul class="widget-list">
    
</ul>
    </section>

    <section class="widget">
        <h3 class="widget-title"><a href="/tags">标签</a></h3>
<div class="tagcloud">
    
    <a href="https://zaina.newban.cn/tags/ruby/">ruby</a>
    
    <a href="https://zaina.newban.cn/tags/shell/">shell</a>
    
</div>
    </section>

    

    <section class="widget">
        <h3 class="widget-title">其它</h3>
        <ul class="widget-list">
            <li><a href="https://zaina.newban.cn/index.xml">文章 RSS</a></li>
        </ul>
    </section>
</div>
            </div>
        </div>
    </div>
</body>

</html>