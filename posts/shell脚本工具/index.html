<!doctype html>
<html lang="en-us">
<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">


    <title>Shell脚本工具 | 开发者问答集锦</title>
    <meta property="og:title" content="Shell脚本工具 - 开发者问答集锦">
    <meta property="og:type" content="article">
        
    <meta property="article:published_time" content='2020-09-02T00:00:00&#43;08:00'>
        
        
    <meta property="article:modified_time" content='2020-09-02T00:00:00&#43;08:00'>
        
    <meta name="Keywords" content="">
    <meta name="description" content="Shell脚本工具">
        
    <meta name="author" content="">
    <meta property="og:url" content="https://zaina.newban.cn/posts/shell%E8%84%9A%E6%9C%AC%E5%B7%A5%E5%85%B7/">
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">

    <link rel="stylesheet" href='/css/normalize.css'>
    <link rel="stylesheet" href='/css/style.css'>
    <script type="text/javascript" src="//cdn.bootcdn.net/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

    
    
    
    
    
    
</head>


<body>
    <header id="header" class="clearfix">
    <div class="container">
        <div class="col-group">
            <div class="site-name ">
                
                    <a id="logo" href="https://zaina.newban.cn">
                        开发者问答集锦
                    </a>
                
                
            </div>
            <div>
                <nav id="nav-menu" class="clearfix">
                    <a class="" href="https://zaina.newban.cn">首页</a>
                    
                </nav>
            </div>
        </div>
    </div>
</header>

    <div id="body">
        <div class="container">
            <div class="col-group">

                <div class="col-8" id="main">
                    
<div class="res-cons">
    
    <article class="post">
        <header>
            <h1 class="post-title">Shell脚本工具</h1>
        </header>
        <date class="post-meta meta-date">
            2020年9月2日
        </date>
        
        
        <div class="post-meta">
            <span id="busuanzi_container_page_pv">|<span id="busuanzi_value_page_pv"></span><span>
                    阅读</span></span>
        </div>
        
        
        <div class="post-content">
            <p><strong>1.grep</strong><br />
grep （global search regular expression(RE) and print out the
line,全面搜索正则表达式并把行打印出来）是一种强大的文本搜索工具，它能使用正则表达式搜索文本，并把匹配的行打印出来。Unix的grep家族包括grep、egrep和fgrep。egrep和fgrep的命令只跟grep有很小不同。egrep是grep的扩展，支持更多的re元字符，
fgrep就是fixed grep或fast
grep，它们把所有的字母都看作单词，也就是说，正则表达式中的元字符表示回其自身的字面意义，不再特殊。Linux使用GNU版本的grep。它功能更强，可以通过-G、-E、-F命令行选项来使用egrep和fgrep的功能。<br />
<strong>工作方式：</strong><br />
它在一个或多个文件中搜索字符串模板。如果模板包括空格，则必须被引用，模板后的所有字符串被看作文件名。搜索的结果被送到屏幕，不影响原文件内容。<br />
<strong>shell脚本下grep</strong><br />
grep通过返回一个状态值来说明搜索的状态，如果模板搜索成功，则返回0，如果搜索不成功，则返回1，如果搜索的文件不存在，则返回2。<br />
<strong>grep选项</strong><br />
匹配模式选择:<br />
-E, –extended-regexp 扩展正则表达式egrep<br />
-F, –fixed-strings 一个换行符分隔的字符串的集合fgrep<br />
-G, –basic-regexp 基本正则<br />
-P, –perl-regexp 调用的perl正则<br />
-e, –regexp=PATTERN 后面根正则模式，默认无<br />
-f, –file=FILE 从文件中获得匹配模式<br />
-i, –ignore-case 不区分大小写<br />
-w, –word-regexp 匹配整个单词<br />
-x, –line-regexp 匹配整行<br />
-z, –null-data 一个 0 字节的数据行，但不是空行</p>

<p>杂项:<br />
-s, –no-messages 不显示错误信息<br />
-v, –invert-match 显示不匹配的行<br />
-V, –version 显示版本号<br />
–help 显示帮助信息<br />
–mmap use memory-mapped input if possible</p>

<p>输入控制:<br />
-m, –max-count=NUM 匹配的最大数<br />
-b, –byte-offset 打印匹配行前面打印该行所在的块号码。<br />
-n, –line-number 显示的加上匹配所在的行号<br />
–line-buffered 刷新输出每一行<br />
-H, –with-filename 当搜索多个文件时，显示匹配文件名前缀<br />
-h, –no-filename 当搜索多个文件时，不显示匹配文件名前缀<br />
–label=LABEL print LABEL as filename for standard input<br />
-o, –only-matching 只显示一行中匹配PATTERN 的部分<br />
-q, –quiet, –silent 不显示任何东西<br />
–binary-files=TYPE 假定二进制文件的TYPE 类型；TYPE 可以是<code>binary',</code>text’, 或`without-match’<br />
-a, –text 匹配二进制的东西<br />
-I 不匹配二进制的东西<br />
-d, –directories=ACTION 目录操作，读取，递归，跳过<br />
-D, –devices=ACTION 设置对设备，FIFO,管道的操作，读取，跳过<br />
-R, -r, –recursive 递归调用<br />
–include=PATTERN 只查找匹配FILE_PATTERN 的文件<br />
–exclude=PATTERN 跳过匹配FILE_PATTERN 的文件和目录<br />
–exclude-from=FILE 跳过所有除FILE 以外的文件<br />
-L, –files-without-match 匹配多个文件时，显示不匹配的文件名<br />
-l, –files-with-matches 匹配多个文件时，显示匹配的文件名<br />
-c, –count 显示匹配了多少次<br />
-Z, –null 在FILE 文件最后打印空字符</p>

<p>文件控制:<br />
-B, –before-context=NUM 打印匹配本身以及前面的几个行由NUM控制<br />
-A, –after-context=NUM 打印匹配本身以及随后的几个行由NUM控制<br />
-C, –context=NUM 打印匹配本身以及随后，前面的几个行由NUM控制<br />
-NUM 根-C的用法一样的<br />
–color[=WHEN],<br />
–colour[=WHEN] 使用标志高亮匹配字串；<br />
-U, –binary 使用标志高亮匹配字串；<br />
-u, –unix-byte-offsets 当CR 字符不存在，报告字节偏移(MSDOS 模式</p>

<p><strong>grep常见用法</strong></p>

<pre><code>grep &quot;hello&quot; file //在file文件中查看是否有hello 
grep -v --color 'failed' /var/log/messages //包含了failed则不显示
echo &quot;abcd1234&quot; |grep --color '[a-z]' //匹配a-z中任意一个字符
echo &quot;aabcd111a1&quot; |grep -E --color 'a?' //匹配字符串中所有出现的a
grep -E --color '^1[34578][0-9]{9}$' file //匹配电话号
grep -E &quot;[1-9]+&quot; 或 egrep &quot;[1-9]+&quot; //使用正则表达式 -E 选项
echo this is a test line. | grep -o -E &quot;[a-z]+\.&quot; line. 或 echo this is a test line. | egrep -o &quot;[a-z]+\.&quot; line. //只输出文件中匹配到的部分 -o 选项
grep -c &quot;text&quot; file_name //统计文件或者文本中包含匹配字符串的行数 -c 选项
grep &quot;text&quot; -n file_name 或 cat file_name | grep &quot;text&quot; -n 
//#多个文件 grep &quot;text&quot; -n file_1 file_2//输出包含匹配字符串的行数 -n 选项
grep -l &quot;text&quot; file1 file2 file3... //搜索多个文件并查找匹配文本在哪些文件中
//更多用法请参考：http://man.linuxde.net/grep
</code></pre>

<p><strong>2.sed</strong><br />
sed意为流编辑器(Stream Editor)。<br />
sed命令是利用script来处理文本文件。<br />
sed可依照script的指令，来处理、编辑文本文件。<br />
sed默认安照Basic规范基本匹配。<br />
Sed主要用来自动编辑一个或多个文件；简化对文件的反复操作；编写转换程序等。<br />
<strong>模式空间</strong><br />
sed 是一种在线编辑器，它一次处理一行内容。处理时，把当前处理的行存储在临时缓冲区中，称为“模式空间”（pattern space）</p>

<p><strong>sed命令</strong><br />
a\：在当前行后面加入一行文本。<br />
b ： label分支到脚本中带有标记的地方，如果分支不存在则分支到脚本的末尾。<br />
c\：用新的文本改变本行的文本。<br />
d ：从模板块（Pattern space）位置删除行。<br />
D ：删除模板块的第一行。<br />
i\：在当前行上面插入文本。<br />
h ：拷贝模板块的内容到内存中的缓冲区。<br />
H ：追加模板块的内容到内存中的缓冲区<br />
g ：获得内存缓冲区的内容，并替代当前模板块中的文本。<br />
G ：获得内存缓冲区的内容，并追加到当前模板块文本的后面。<br />
l ：列表不能打印字符的清单。<br />
n ：读取下一个输入行，用下一个命令处理新的行而不是用第一个命令。<br />
N ：追加下一个输入行到模板块后面并在二者间嵌入一个新行，改变当前行号码。<br />
p ：打印模板块的行。<br />
P ：（大写）打印模板块的第一行。<br />
q ：退出Sed。<br />
r ：file从file中读行。<br />
t ：labelif分支，从最后一行开始，条件一旦满足或者T，t命令，将导致分支到带有标号的命令处，或者到脚本的末尾。<br />
T ：label错误分支，从最后一行开始，一旦发生错误或者T，t命令，将导致分支到带有标号的命令处，或者到脚本的末尾。<br />
w ：file写并追加模板块到file末尾。<br />
W ：file写并追加模板块的第一行到file末尾。<br />
！ ：表示后面的命令对所有没有被选定的行发生作用。<br />
s/re/string ：用string替换正则表达式re。<br />
= ：打印当前行号码。<br />
‘#’ :把注释扩展到下一个换行符以前。<br />
以下的是替换标记g表示行内全面替换。<br />
p :表示打印行。<br />
w :表示把行写入一个文件。<br />
x :表示互换模板块中的文本和缓冲区中的文本。<br />
y :表示把一个字符翻译为另外的字符（但是不用于正则表达式）<br />
<strong>sed选项</strong><br />
-e script或–expression=script以选项中指定的script来处理输入的文本文件。<br />
-f script文件或–file=script文件以选项中指定的script文件来处理输入的文本文件。<br />
-h或–help 显示帮助。<br />
-n或–quiet或–silent 仅显示script处理后的结果。<br />
-V或–version 显示版本信息。<br />
<strong>退出状态</strong><br />
sed不向grep一样，不管是否找到指定的模式，它的退出状态都是0。只有当命令存在语法错误时， sed的退出状态才不是0。<br />
<strong>sed的处理流程</strong><br />
1.读入新的一行内容到缓存空间；<br />
2.从指定的操作指令中取出第一条指令，判断是否匹配pattern；<br />
3.如果不匹配，则忽略后续的编辑命令，回到第2步继续取出下一条指令；<br />
4.如果匹配，则针对缓存的行执行后续的编辑命令；完成后，回到第2步继续取出下一条指令；<br />
5.当所有指令都应用之后，输出缓存行的内容；回到第1步继续读入下一行内容；<br />
6.当所有行都处理完之后，结束；<br />
<strong>sed用法实例</strong></p>

<pre><code>sed 's/hello/hellos/' file //将file中的hello字符串换成hellos
sed -n 's/test/TEST/p' file//-n选项和p命令一起使用表示只打印那些发生替换的行
sed -i 's/hello/hellos/g' file//直接编辑文件选项-i，会匹配file文件中每一行的第一个hello替换为hellos
//使用后缀 /g 标记会替换每一行中的所有匹配:
sed 's/book/books/g' file 
当需要从第N处匹配开始替换时，可以使用 :/Ng： 
echo sksksksksksk | sed 's/sk/SK/2g' skSKSKSKSKSK 
echo sksksksksksk | sed 's/sk/SK/3g' skskSKSKSKSK 
echo sksksksksksk | sed 's/sk/SK/4g' skskskSKSKSK

**//界定符**：
//以上命令中字符 / 在sed中作为定界符使用，也可以使用任意的定界符：
sed 's:test:TEXT:g' 
sed 's|test|TEXT|g' 
//定界符出现在样式内部时，需要进行转义： 
sed 's/\/bin/\/usr\/local\/bin/g'

**//删除操作**：
sed '/^$/d' file  //d命令 删除空白行 
sed '2d' file //删除文件的第2行
sed '2,$d' file //删除文件的第2行到末尾所有行
sed '$d' file //删除文件最后一行
sed '/^test/'d file //删除文件中所有开头是test的行

**//打印奇数行或偶数行** 
//方法1： 
sed -n 'p;n' test.txt #奇数行 
sed -n 'n;p' test.txt #偶数行 
//方法2： 
sed -n '1~2p' test.txt #奇数行 
sed -n '2~2p' test.txt #偶数行

//更多用法实例请参考：http://man.linuxde.net/sed
</code></pre>

<p><strong>3.awk</strong><br />
awk是一种编程语言，用于在linux/unix下对文本和数据进行处理。数据可以来自标准输入(stdin)、一个或多个文件，或其它命令的输出。它支持用户自定义函数和动态正则表达式等先进功能，是linux/unix下的一个强大编程工具。它在命令行中使用，但更多是作为脚本来使用。awk有很多内建的功能，比如数组、函数等，这是它和C语言的相同之处，灵活性是awk最大的优势。<br />
<strong>常用命令选项</strong><br />
-F fs fs指定输入分隔符，fs可以是字符串或正则表达式，如-F:<br />
-v var=value 赋值一个用户定义变量，将外部变量传递给awk<br />
-f scripfile 从脚本文件中读取awk命令 -m[fr] val 对val值设置内在限制，<br />
-mf选项限制分配给val的最大块数目；-mr选项限制记录的最大数目。这两个功能是Bell实验室版awk的扩展功能，在标准awk中不适用。<br />
<strong>模式</strong><br />
/正则表达式/：使用通配符的扩展集。<br />
关系表达式：使用运算符进行操作，可以是字符串或数字的比较测试。<br />
模式匹配表达式：用运算符~（匹配）和~!（不匹配）。<br />
BEGIN语句块、pattern语句块、END语句块<br />
<strong>awk的工作原理</strong><br />
awk ‘BEGIN{ commands } pattern{ commands } END{ commands }’<br />
第一步：执行BEGIN{ commands }语句块中的语句；<br />
第二步：从文件或标准输入(stdin)读取一行，然后执行pattern{ commands
}语句块，它逐行扫描文件，从第一行到最后一行重复这个过程，直到文件全部被读取完毕。<br />
第三步：当读至输入流末尾时，执行END{ commands }语句块。<br />
BEGIN语句块在awk开始从输入流中读取行之前被执行，这是一个可选的语句块，比如变量初始化、打印输出表格的表头等语句通常可以写在BEGIN语句块中。<br />
END语句块在awk从输入流中读取完所有的行之后即被执行，比如打印所有行的分析结果这类信息汇总都是在END语句块中完成，它也是一个可选语句块。<br />
pattern语句块中的通用命令是最重要的部分，它也是可选的。如果没有提供pattern语句块，则默认执行{ print
}，即打印每一个读取到的行，awk读取的每一行都会执行该语句块。</p>

        </div>

        


        

<div class="post-archive">
    <h2>See Also</h2>
    <ul class="listing">
        
        <li><a href="/posts/007hadoop%E9%9B%86%E7%BE%A4%E9%85%8D%E7%BD%AEhadoop%E9%9B%86%E7%BE%A4%E7%9A%84%E5%90%AF%E5%8A%A8%E5%92%8C%E6%B5%8B%E8%AF%95ssh%E5%85%8D%E7%99%BB%E9%99%86%E9%85%8D%E7%BD%AEstartallshhdfs%E5%B8%B8%E7%94%A8%E7%9A%84shell/">007Hadoop集群配置Hadoop集群的启动和测试SSH免登陆配置startallshhdfs常用的shell</a></li>
        
        <li><a href="/posts/009shell%E8%84%9A%E6%9C%AC%E4%B8%8B%E6%9D%A1%E4%BB%B6%E6%B5%8B%E8%AF%95eqne/">009Shell脚本下条件测试eqne</a></li>
        
        <li><a href="/posts/00pythonmanagepyshell%E5%92%8Cpython%E7%9A%84%E5%88%86%E6%9E%90/">00Pythonmanagepyshell和Python的分析</a></li>
        
        <li><a href="/posts/010zookeeper%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5zookeeper%E7%9A%84%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BAzookeeper%E7%9A%84shell%E5%91%BD%E4%BB%A4/">010Zookeeper的基本概念Zookeeper的集群搭建Zookeeper的shell命令</a></li>
        
        <li><a href="/posts/018dockerfileshell/">018DockerfileSHELL</a></li>
        
    </ul>
</div>


        <div class="post-meta meta-tags">
            
            <ul class="clearfix">
                
                <li><a href='https://zaina.newban.cn/tags/shell'>shell</a></li>
                
            </ul>
            
        </div>
    </article>
    
    

    
    
</div>

                    <footer id="footer">
    <div>
        &copy; 2020 <a href="https://zaina.newban.cn">开发者问答集锦 By </a>
        
    </div>
    <br />
    <div>
        <div class="github-badge">
            <a href="https://gohugo.io/" target="_black" rel="nofollow"><span class="badge-subject">Powered by</span><span class="badge-value bg-blue">Hugo</span></a>
        </div>
        <div class="github-badge">
            <a href="https://www.flysnow.org/" target="_black"><span class="badge-subject">Design by</span><span class="badge-value bg-brightgreen">飞雪无情</span></a>
        </div>
        <div class="github-badge">
            <a href="https://github.com/flysnow-org/maupassant-hugo" target="_black"><span class="badge-subject">Theme</span><span class="badge-value bg-yellowgreen">Maupassant</span></a>
        </div>
    </div>
</footer>


    
    <script type="text/javascript">
        window.MathJax = {
            tex2jax: {
                inlineMath: [['$', '$']],
                processEscapes: true
                }
            };
    </script>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML' async></script>

<a id="rocket" href="#top"></a>
<script type="text/javascript" src='/js/totop.js?v=0.0.0' async=""></script>



    <script type="text/javascript" src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script>




                </div>

                <div id="secondary">
    <section class="widget">
        <form id="search" action='https://zaina.newban.cn/search/' method="get" accept-charset="utf-8" target="_blank" _lpchecked="1">
      
      <input type="text" name="q" maxlength="20" placeholder="Search">
      <input type="hidden" name="sitesearch" value="https://zaina.newban.cn">
      <button type="submit" class="submit icon-search"></button>
</form>
    </section>
    
    <section class="widget">
        <h3 class="widget-title">最近文章</h3>
<ul class="widget-list">
    
    <li>
        <a href="https://zaina.newban.cn/posts/001rubyruby%E4%B8%AD%E5%85%A8%E5%B1%80%E5%8F%98%E9%87%8F%E5%AE%9E%E4%BE%8B%E5%8F%98%E9%87%8F%E5%B1%80%E9%83%A8%E5%8F%98%E9%87%8F%E7%B1%BB%E5%8F%98%E9%87%8Fsymbol%E5%AF%B9%E6%AF%94/" title="001rubyRuby中全局变量实例变量局部变量类变量Symbol对比">001rubyRuby中全局变量实例变量局部变量类变量Symbol对比</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/007hadoop%E9%9B%86%E7%BE%A4%E9%85%8D%E7%BD%AEhadoop%E9%9B%86%E7%BE%A4%E7%9A%84%E5%90%AF%E5%8A%A8%E5%92%8C%E6%B5%8B%E8%AF%95ssh%E5%85%8D%E7%99%BB%E9%99%86%E9%85%8D%E7%BD%AEstartallshhdfs%E5%B8%B8%E7%94%A8%E7%9A%84shell/" title="007Hadoop集群配置Hadoop集群的启动和测试SSH免登陆配置startallshhdfs常用的shell">007Hadoop集群配置Hadoop集群的启动和测试SSH免登陆配置startallshhdfs常用的shell</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/009shell%E8%84%9A%E6%9C%AC%E4%B8%8B%E6%9D%A1%E4%BB%B6%E6%B5%8B%E8%AF%95eqne/" title="009Shell脚本下条件测试eqne">009Shell脚本下条件测试eqne</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/00pythonmanagepyshell%E5%92%8Cpython%E7%9A%84%E5%88%86%E6%9E%90/" title="00Pythonmanagepyshell和Python的分析">00Pythonmanagepyshell和Python的分析</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/010zookeeper%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5zookeeper%E7%9A%84%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BAzookeeper%E7%9A%84shell%E5%91%BD%E4%BB%A4/" title="010Zookeeper的基本概念Zookeeper的集群搭建Zookeeper的shell命令">010Zookeeper的基本概念Zookeeper的集群搭建Zookeeper的shell命令</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/018dockerfileshell/" title="018DockerfileSHELL">018DockerfileSHELL</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/01shell%E5%85%A5%E9%97%A801bashshell%E7%89%B9%E6%80%A7/" title="01Shell入门01bashShell特性">01Shell入门01bashShell特性</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/01shell%E5%8F%98%E9%87%8F/" title="01Shell变量">01Shell变量</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/01shell%E5%9F%BA%E7%A1%80%E6%A6%82%E8%BF%B0%E8%84%9A%E6%9C%AC%E6%89%A7%E8%A1%8C%E6%96%B9%E5%BC%8Fbash%E5%9F%BA%E6%9C%AC%E5%8A%9F%E8%83%BD/" title="01Shell基础概述脚本执行方式Bash基本功能">01Shell基础概述脚本执行方式Bash基本功能</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/01shell%E7%BC%96%E7%A8%8Bhelloworld/" title="01shell编程helloworld">01shell编程helloworld</a>
    </li>
    
</ul>
    </section>

    

    <section class="widget">
        <h3 class="widget-title"><a href="/categories">分类</a></h3>
<ul class="widget-list">
    
</ul>
    </section>

    <section class="widget">
        <h3 class="widget-title"><a href="/tags">标签</a></h3>
<div class="tagcloud">
    
    <a href="https://zaina.newban.cn/tags/ruby/">ruby</a>
    
    <a href="https://zaina.newban.cn/tags/shell/">shell</a>
    
</div>
    </section>

    

    <section class="widget">
        <h3 class="widget-title">其它</h3>
        <ul class="widget-list">
            <li><a href="https://zaina.newban.cn/index.xml">文章 RSS</a></li>
        </ul>
    </section>
</div>
            </div>
        </div>
    </div>
</body>

</html>