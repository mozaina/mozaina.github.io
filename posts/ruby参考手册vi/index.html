<!doctype html>
<html lang="en-us">
<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">


    <title>ruby参考手册VI | 开发者问答集锦</title>
    <meta property="og:title" content="ruby参考手册VI - 开发者问答集锦">
    <meta property="og:type" content="article">
        
    <meta property="article:published_time" content='2020-09-02T00:00:00&#43;08:00'>
        
        
    <meta property="article:modified_time" content='2020-09-02T00:00:00&#43;08:00'>
        
    <meta name="Keywords" content="">
    <meta name="description" content="ruby参考手册VI">
        
    <meta name="author" content="">
    <meta property="og:url" content="https://zaina.newban.cn/posts/ruby%E5%8F%82%E8%80%83%E6%89%8B%E5%86%8Cvi/">
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">

    <link rel="stylesheet" href='/css/normalize.css'>
    <link rel="stylesheet" href='/css/style.css'>
    <script type="text/javascript" src="//cdn.bootcdn.net/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

    
    
    
    
    
    
</head>


<body>
    <header id="header" class="clearfix">
    <div class="container">
        <div class="col-group">
            <div class="site-name ">
                
                    <a id="logo" href="https://zaina.newban.cn">
                        开发者问答集锦
                    </a>
                
                
            </div>
            <div>
                <nav id="nav-menu" class="clearfix">
                    <a class="" href="https://zaina.newban.cn">首页</a>
                    
                </nav>
            </div>
        </div>
    </div>
</header>

    <div id="body">
        <div class="container">
            <div class="col-group">

                <div class="col-8" id="main">
                    
<div class="res-cons">
    
    <article class="post">
        <header>
            <h1 class="post-title">ruby参考手册VI</h1>
        </header>
        <date class="post-meta meta-date">
            2020年9月2日
        </date>
        
        
        <div class="post-meta">
            <span id="busuanzi_container_page_pv">|<span id="busuanzi_value_page_pv"></span><span>
                    阅读</span></span>
        </div>
        
        
        <div class="post-content">
            

<p>ruby 1.6 特性</p>

<p>ruby version 1.6是稳定版。在该版本中，主要修改了一些bug。</p>

<p>stable-snapshot是稳定版的源代码，且每日更新。<br />
1.6.8 (2002-12-24) -&gt; stable-snapshot</p>

<p>2003-01-22: errno</p>

<p>在EAGAIN与EWOULDBLOCK同值的系统中，EWOULDBLOCK消失不见了。现在，这种系统中的EWOULDBLOCK被定义为EAGAIN。(这点与1.6.7不同)</p>

<p>p Errno::EAGAIN<br />
p Errno::EWOULDBLOCK</p>

<p>=&gt; ruby 1.6.7 (2002-03-01) [i586-linux]<br />
Errno::EAGAIN<br />
Errno::EWOULDBLOCK</p>

<p>=&gt; ruby 1.6.8 (2002-12-24) [i586-linux]<br />
Errno::EAGAIN<br />
-:2: uninitialized constant EWOULDBLOCK at Errno (NameError)</p>

<p>=&gt; ruby 1.6.8 (2003-02-13) [i586-linux]<br />
Errno::EAGAIN<br />
Errno::EAGAIN</p>

<p>1.6.7 (2002-03-01) -&gt; 1.6.8 (2002-12-24)</p>

<p>2002-10-02: Thread (cygwin)</p>

<p>在Cygwin中，有时无法切换Thread。 [ruby-list:36058], [ruby-list:24637]<br />
2002-10-01: Socket (win)</p>

<p>好像解决了一个Windows中的socket问题。(从原来的邮件中无法得到具体的问题描述，但好像是：虽然可以用select来进行读入，但返回的是空数组)
[ruby-talk:40015], [ruby-win32:366]<br />
2002-09-12: Thread.status (?)</p>

<p>有时用trap捕获信号时却并没有保存线程的状态，导致被信号中断的线程状态混乱[ruby-talk:40337], [ruby-core:00019]<br />
2002-09-11: Queue#pop</p>

<p>Queue#pop中存在竞争问题[ruby-dev:17223]<br />
2002-09-11: SizedQueue.new</p>

<p>修改了可接受0以下的参数的bug。<br />
2002-09-05: 展开式</p>

<p>在stable snapshot中，曾经有一段时间，需要对展开式中引号使用反斜线转义。该变更解决了这个问题。</p>

<p>p &ldquo;#{ &ldquo;&rdquo; }&rdquo;</p>

<p>=&gt; ruby 1.6.7 (2002-03-01) [i586-linux]<br />
&rdquo;&rdquo;</p>

<p>=&gt; -:1: warning: bad substitution in string<br />
ruby 1.6.7 (2002-09-12) [i586-linux]<br />
&rdquo;#{ }&rdquo;</p>

<p>=&gt; ruby 1.6.7 (2002-09-25) [i586-linux]<br />
&rdquo;&rdquo;</p>

<p>这并不是1.7之后的backport。在处理注释等对象时，与1.7有所不同。(请参考ruby 1.7 特性的2002-06-24)</p>

<p>p &ldquo;#{ &ldquo;&rdquo; # comment }&rdquo;<br />
=&gt; ruby 1.6.8 (2002-10-04) [i586-linux]<br />
&rdquo;&rdquo;<br />
=&gt; -:1: parse error<br />
ruby 1.7.3 (2002-10-04) [i586-linux]</p>

<p>SizedQueue#deq, #shift<br />
SizedQueue#enq</p>

<p>添加(push, pop的别名)。以前尚未定义它们时，调用enq等就会执行超类Queue的enq。<br />
2002-09-11: Tempfile#size</p>

<p>添加[ruby-dev:17221]<br />
2002-09-09</p>

<p>在mswin32版和mingw32版的ruby中，从1.6.6版起就有一个bug：ruby的子进程无法接收环境变量。[ruby-dev:18236]<br />
2002-09-03</p>

<p>在使用Bison编译的Ruby中，多次加载库的速度有所提高。(若不使用Bison的话，每次加载时，好像都会显式地执行GC，所以运行速度会下降) [ruby-
dev:18145]<br />
2002-08-20 File.expand_path</p>

<p>Cygwin 1.3.x [ruby-bugs-ja:PR#299]</p>

<p>p File.expand_path(&lsquo;file&rsquo;, &lsquo;c:/&lsquo;)</p>

<p>=&gt; ruby 1.6.7 (2002-03-01) [i586-linux]<br />
/tmp/c:/file<br />
=&gt; ruby 1.6.7 (2002-08-21) [i586-linux]<br />
c:/file</p>

<p>2002-08-19 Thread (win)</p>

<p>以前，同时使用Ruby线程和Win32的结构化异常（包括来自Win32 API的callback）的话就会引起故障。现在该bug已被修复。[ruby-
win32:273]<br />
2002-08-12 Hash#==</p>

<p>以前，只要两个Hash对象的默认值(default)==的话，它们也就被看作相等。</p>

<p>p Hash.new(&ldquo;foo&rdquo;) == Hash.new(&ldquo;bar&rdquo;)</p>

<p>=&gt; ruby 1.6.7 (2002-03-01) [i586-linux]<br />
true<br />
=&gt; ruby 1.6.7 (2002-08-21) [i586-linux]<br />
false</p>

<p>2002-07-11 String#slice!</p>

<p>以前，若指定了范围之外的字符串的话，有时会返回异常。现在统一返回nil。(也就是返回与String#[]或String#slice一样的结果)</p>

<p>p &ldquo;foo&rdquo;.slice!(&ldquo;bar&rdquo;) # p &ldquo;foo&rdquo;.slice!(5,10)</p>

<p>=&gt; ruby 1.6.7 (2002-03-01) [i586-linux]<br />
nil<br />
-:2:in `slice!&rsquo;: index 5 out of string (IndexError)<br />
from -:2<br />
=&gt; ruby 1.6.7 (2002-08-01) [i586-linux]<br />
nil<br />
nil</p>

<p>2002-07-05 String#split</p>

<p>现在可以给第一个参数指定nil了。[ruby-talk:43513] 此时把$;当作分割字符串。以前，只有省略参数时才能使用$;。</p>

<p>$; = &ldquo;:&rdquo;<br />
p &ldquo;a:b:c&rdquo;.split(nil)<br />
=&gt; -:2:in `split&rsquo;: bad separator (ArgumentError)<br />
from -:2<br />
ruby 1.6.7 (2002-03-01) [i586-linux]</p>

<p>=&gt; ruby 1.6.7 (2002-07-30) [i586-linux]<br />
[&ldquo;a&rdquo;, &ldquo;b&rdquo;, &ldquo;c&rdquo;]</p>

<p>2002-06-15 Dir.glob</p>

<p>以前，Dir.glob不会匹配已断链的符号连接。</p>

<p>File.symlink(&ldquo;foo&rdquo;, &ldquo;bar&rdquo;)<br />
p Dir.glob(&ldquo;bar&rdquo;)<br />
=&gt; ruby 1.6.7 (2002-03-01) [i586-linux]<br />
[]<br />
=&gt; ruby 1.6.7 (2002-08-01) [i586-linux]<br />
[&ldquo;bar&rdquo;]</p>

<p>2002-06-13 Hash[]</p>

<p>以前，无法用Hash[]来dup &amp; freeze键字符串。</p>

<p>a = &ldquo;key&rdquo;<br />
h = Hash[a,&ldquo;val&rdquo;]<br />
h.keys[0].upcase!<br />
p a<br />
=&gt; ruby 1.6.7 (2002-03-01) [i586-linux]<br />
&ldquo;KEY&rdquo;<br />
=&gt; -:3:in `upcase!&rsquo;: can&rsquo;t modify frozen string (TypeError)<br />
from -:3<br />
ruby 1.6.7 (2002-08-01) [i586-linux]</p>

<p>2002-06-10 Fixnum#&gt;&gt;, &lt;&lt;</p>

<p>有时对负数进行右移位时，就会变成0。 [ruby-bugs-ja:PR#247]</p>

<p>以负数为参数的左移位(即右移位)中也会出现这种问题。[ruby-bugs-ja:PR#248]</p>

<p>p(-1 &gt;&gt; 31)<br />
=&gt; ruby 1.6.7 (2002-03-01) [i586-linux]<br />
0<br />
=&gt; ruby 1.6.7 (2002-08-01) [i586-linux]<br />
-1</p>

<p>p(-1 &lt;&lt; -1)<br />
=&gt; ruby 1.6.7 (2002-03-01) [i586-linux]<br />
-2147483649<br />
=&gt; ruby 1.6.7 (2002-08-01) [i586-linux]<br />
-1</p>

<p>2002-06-05<br />
Math.acosh<br />
Math.asinh<br />
Math.atanh</p>

<p>添加。<br />
2002-06-03<br />
String#[]=</p>

<p>若receiver中不包含指定的索引字符串时，直接返回右边部分。</p>

<p>foo = &ldquo;foo&rdquo;<br />
p foo[&ldquo;bar&rdquo;] = &ldquo;baz&rdquo;<br />
p foo</p>

<p>=&gt; ruby 1.6.7 (2002-03-01) [i586-linux]<br />
&ldquo;baz&rdquo;<br />
&ldquo;foo&rdquo;<br />
=&gt; -:2:in `[]=&rsquo;: string not matched (IndexError)<br />
from -:2<br />
ruby 1.6.7 (2002-07-30) [i586-linux]</p>

<p>2002-06-03 sprintf()</p>

<p>用&rdquo;%d&rdquo;把参数变为整数时，使用与Integer相同的规则。</p>

<p>p sprintf(&ldquo;%d&rdquo;, nil)</p>

<p>=&gt; -:1:in `sprintf&rsquo;: no implicit conversion from nil (TypeError)<br />
from -:1<br />
ruby 1.6.7 (2002-03-01) [i586-linux]</p>

<p>=&gt; ruby 1.6.7 (2002-07-30) [i586-linux]<br />
&ldquo;0&rdquo;</p>

<p>2002-05-23 -* 选项(?)</p>

<p>以前，为了兼顾那些使用</p>

<p>#! ruby -<em>- mode: ruby -</em>-</p>

<p>这种Emacs&rsquo;-*-&lsquo;的脚本，而特别规定：忽略-<em>以后的部分(将其看作是不进行任何操作的选项)，现在已经取消了这种特别设定。若想设定Emacs的&rsquo;-</em>-&lsquo;时，应该写在第2行。[ruby-
dev:17193]</p>

<p>ruby &lsquo;-*&rsquo; -v<br />
=&gt; ruby 1.6.7 (2002-03-01) [i586-linux]</p>

<p>=&gt; ruby: invalid option -* (-h will show valid options)</p>

<p>2002-05-22 parsedate</p>

<p>版本升级[ruby-dev:17171]<br />
2002-05-22 -T 选项</p>

<p>以前，若在ruby的命令行选项-T后不留空格地添加其他选项时，-T后面的选项将被忽略。现在，-T后面的非数字部分都被看作是选项(与-0选项相同)
[ruby-dev:17179]</p>

<p>ruby -Tv # -v が無効 (ruby 1.6.7 (2002-03-01) [i586-linux])</p>

<p>=&gt; ruby: No program input from stdin allowed in tainted mode (SecurityError)</p>

<p>=&gt; ruby 1.6.7 (2002-07-30) [i586-linux]</p>

<p>2002-05-20 IO#close</p>

<p>若对双向管道dup进行close_write时，则会引发错误。 [ruby-dev:17155]</p>

<p>open(&ldquo;|-&rdquo;,&ldquo;r+&rdquo;) {|f|<br />
if f<br />
f.dup.close_write<br />
else<br />
sleep 1<br />
end<br />
}</p>

<p>=&gt; ruby 1.6.7 (2002-03-01) [i586-linux]<br />
-:3:in <code>close_write': closing non-duplex IO for writing (IOError)   
from -:3  
from -:1:in</code>open&rsquo;<br />
from -:1</p>

<p>=&gt; ruby 1.6.7 (2002-07-30) [i586-linux]</p>

<p>2002-05-02 Regexp.quote</p>

<h1 id="已经变为back-slash-quote-主要是为了能将quote中的正则表达式正确嵌入-x-ruby-bugs-ja-pr-231">已经变为back slash quote。主要是为了能将quote中的正则表达式正确嵌入//x。[ruby-bugs-ja:PR#231]</h1>

<p>p Regexp.quote(&ldquo;#&rdquo;)</p>

<p>p /a#{Regexp.quote(&ldquo;#&rdquo;)}b/x =~ &ldquo;ab&rdquo;</p>

<p>=&gt; -:3: warning: ambiguous first argument; make sure<br />
ruby 1.6.7 (2002-03-01) [i586-linux]<br />
&rdquo;#&rdquo;<br />
0</p>

<p>=&gt; -:3: warning: ambiguous first argument; make sure<br />
ruby 1.6.7 (2002-07-30) [i586-linux]<br />
&ldquo;\\#&rdquo;<br />
nil</p>

<p>2002-04-29: rb_find_file()</p>

<p>在$SAFE &gt;= 4的情况下，若没有指定绝对路径的话，则会引发SecurityError异常。<br />
2002-04-26: Regexp.quote</p>

<p>[ruby-bugs-ja:PR#231]</p>

<p>p Regexp.quote(&rdquo;\t&rdquo;)</p>

<p>p /a#{Regexp.quote(&rdquo;\t&rdquo;)}b/x =~ &ldquo;ab&rdquo;</p>

<p>=&gt; -:3: warning: ambiguous first argument; make sure<br />
ruby 1.6.7 (2002-03-01) [i586-linux]<br />
&ldquo;\t&rdquo;<br />
0</p>

<p>=&gt; -:3: warning: ambiguous first argument; make sure<br />
ruby 1.6.7 (2002-05-04) [i586-linux]<br />
&ldquo;\\t&rdquo;<br />
nil</p>

<p>2002-04-20: Regexp#inspect</p>

<p>带/x标识的正则表达式对象的inspect把换行变成了\n。[ruby-bugs-ja:PR#225]</p>

<p>p /a<br />
b/x</p>

<p>=&gt; -:1: warning: ambiguous first argument; make sure<br />
ruby 1.6.7 (2002-03-01) [i586-linux]<br />
/a\n b/x</p>

<p>=&gt; -:1: warning: ambiguous first argument; make sure<br />
ruby 1.7.2 (2002-04-24) [i586-linux]<br />
/a<br />
b/x</p>

<p>2002-04-19: 结束时的相关处理</p>

<p>以前在下列脚本中，需要发送2次信号才能结束。现在该问题已解决。[ruby-bugs-ja:PR#223]</p>

<p>trap(:TERM, &ldquo;EXIT&rdquo;)</p>

<p>END{<br />
puts &ldquo;exit&rdquo;<br />
}</p>

<p>Thread::start{ Thread::stop }<br />
sleep</p>

<p>2002-04-17: Regexp#inspect</p>

<p>[ruby-bugs-ja:PR#222]</p>

<p>p %r{\/}</p>

<p>=&gt; ruby 1.6.7 (2002-03-01) [i586-linux]<br />
/\\//</p>

<p>=&gt; ruby 1.6.7 (2002-05-04) [i586-linux]<br />
/\//</p>

<p>2002-04-15: pack(&lsquo;U&rsquo;)</p>

<p>已经修复了无法使用unpack(&lsquo;U&rsquo;)来还原pack(&lsquo;U&rsquo;)的bug。(unpack按照字符单位进行处理，而并非以前的字节单位) [ruby-bugs-
ja:PR#220]</p>

<p>p [128].pack(&ldquo;U&rdquo;)<br />
p [128].pack(&ldquo;U&rdquo;).unpack(&ldquo;U&rdquo;)</p>

<p>=&gt; ruby 1.6.7 (2002-03-01) [i586-linux]<br />
&ldquo;\302\200&rdquo;<br />
[0]</p>

<p>=&gt; ruby 1.6.7 (2002-05-04) [i586-linux]<br />
&ldquo;\302\200&rdquo;<br />
[128]</p>

<p>2002-04-11: IO#write</p>

<p>检测socket或管道中的EPIPE时，有时会出现失败的情况。[ruby-dev:16849]<br />
2002-04-11: cgi/session.rb (<em>文档中未出现</em>)</p>

<p>support for multipart form.<br />
2002-04-10: Object#remove_instance_variable</p>

<p>若指定的实例变量尚未定义时，则引发NameError异常。[ruby-bugs-ja:PR#216]</p>

<p>Object.new.instance_eval {<br />
p remove_instance_variable :@foo<br />
}<br />
=&gt; ruby 1.6.7 (2002-03-01) [i586-linux]<br />
nil</p>

<p>=&gt; -:2:in `remove_instance_variable&rsquo;: instance variable @foo not defined
(NameError)<br />
ruby 1.6.7 (2002-04-10) [i586-linux]</p>

<p>2002-04-04: Integer#step</p>

<p>以前，若将第二参数设为小于1的数时，它会被看作为0，进而引发错误。</p>

<p>1.step(2, 0.1) {|f| p f }</p>

<p>=&gt; -:1:in `step&rsquo;: step cannot be 0 (ArgumentError)<br />
from -:1<br />
ruby 1.6.7 (2002-03-01) [i586-linux]</p>

<dl>
<dt>1.1<br /></dt>
<dd>
1.9<br />
<br /></dd>
</dl>

<dl>
<dt>1.1<br /></dt>
<dd>
1.9<br />
<br /></dd>
</dl>

<dl>
<dt>1.1<br /></dt>
<dd>
1.9<br />
<br /></dd>
</dl>

<p>.9</p>

<p>2002-04-01: $~</p>

<p>修复了无法将nil赋值给$~的bug。[ruby-dev:16697]</p>

<p>/foo/ =~ &ldquo;foo&rdquo;<br />
p $~<br />
$~ = nil<br />
p $~<br />
=&gt; ruby 1.6.7 (2002-03-01) [i586-linux]<br />
#<0x401b1be4><br />
-:3: wrong argument type nil (expected Match) (TypeError)<br />
^^^^^ MatchData的错误<br />
=&gt; ruby 1.6.7 (2002-04-04) [i586-linux]<br />
#<0x401b1c98><br />
nil</p>

<p>2002-03-25 BasicSocket.do_not_reverse_lookup</p>

<p>在$SAFE &gt; 3的情况下，无法设定值。[ruby-dev:16554]<br />
2002-03-23 IO#read</p>

<p>修复了File#read等无法读取大小为0的有内容文件(在Linux的/proc文件系统中会发生这种情况)的bug。</p>

<p>p File.open(&ldquo;/proc/#$$/cmdline&rdquo;).read</p>

<p>=&gt; ruby 1.6.7 (2002-03-01) [i586-linux]<br />
&rdquo;&rdquo;</p>

<p>=&gt; ruby 1.6.7 (2002-03-29) [i586-linux]<br />
&ldquo;ruby-1.6\000-v\000-&rdquo;</p>

<p>2002-03-22 module_eval</p>

<p>在module_eval的块中，常数和类变量的作用域不再变化。[ruby-dev:17876]</p>

<p>class Foo<br />
FOO = 1<br />
@@foo = 1<br />
end</p>

<p>FOO = 2<br />
@@foo = 2</p>

<p>Foo.module_eval { p FOO, @@foo }</p>

<p>=&gt; ruby 1.6.7 (2002-03-01) [i586-linux]<br />
1<br />
1</p>

<p>=&gt; ruby 1.6.7 (2002-03-29) [i586-linux]<br />
2<br />
2</p>

<p>2002-03-22 net/http.rb</p>

<p>以前，Net::HTTP.new在不带块的时候返回nil。 [ruby-bugs-ja:PR#214]</p>

<p>一般认为会逐渐取消net/protocol.rb，该bug好像是在调试时不小心种下的。<br />
2002-03-20 File.expand_path</p>

<p>有时会出现内存释放不彻底的情况。[ruby-bugs:PR#276]<br />
2002-03-18 字符串字面值</p>

<p>在#{..}等结构中，有时会出现汉字代码处理不全的现象。[ruby-list:34478]</p>

<p>#! ruby -Ks<br />
p a = &ldquo;#{&ldquo;表&rdquo;}&rdquo;<br />
=&gt; -:1: compile error in string expansion (SyntaxError)<br />
-:1: unterminated string meets end of file<br />
ruby 1.6.7 (2002-03-15) [i586-linux]<br />
=&gt; ruby 1.6.7 (2002-03-19) [i586-linux]<br />
&ldquo;表&rdquo;</p>

<p>#! ruby -Ks<br />
p %[评价]<br />
=&gt; -:2: parse error<br />
p %[评价]<br />
^<br />
ruby 1.6.7 (2002-03-15) [i586-linux]</p>

<p>=&gt; ruby 1.6.7 (2002-03-19) [i586-linux]<br />
&ldquo;评价&rdquo;</p>

<p>2002-03-16 $~</p>

<p>以前，若正则表达式方法没有在内部进行匹配操作时，将不会清除$~ 的状态。[ruby-bugs-ja:PR#208]</p>

<p>/foo/ =~ &ldquo;foo&rdquo;<br />
/foo/ =~ nil<br />
p $~</p>

<p>/foo/ =~ &ldquo;foo&rdquo;<br />
$_ = nil; ~&ldquo;foo&rdquo;<br />
p $~</p>

<p>/foo/ =~ &ldquo;foo&rdquo;<br />
&ldquo;foo&rdquo;.index(/bar/, 4)<br />
p $~</p>

<p>/foo/ =~ &ldquo;foo&rdquo;<br />
&ldquo;foo&rdquo;.rindex(/bar/, -4)<br />
p $~</p>

<p>=&gt; ruby 1.6.7 (2002-03-06) [i586-linux]<br />
#<0x401b1be4><br />
#<0x401b198c><br />
#<0x401b1644><br />
#<0x401b1414><br />
=&gt; ruby 1.6.7 (2002-03-19) [i586-linux]<br />
nil<br />
nil<br />
nil<br />
nil</p>

<p>2002-03-14 扩展库的autoload</p>

<p>无法对扩展库进行autoload。[ruby-dev:16379]</p>

<p>autoload :Fcntl, &ldquo;fcntl&rdquo;<br />
require &ldquo;fcntl&rdquo;</p>

<p>=&gt; -:2:in `require&rsquo;: uninitialized constant Fcntl (NameError)<br />
from -:2<br />
ruby 1.6.7 (2002-03-01) [i586-linux]</p>

<p>=&gt; ruby 1.6.7 (2002-03-15) [i586-linux]</p>

<p>2002-03-13 getopts.rb</p>

<p>refine. [ruby-dev:16193], [ruby-dev:16213]<br />
2002-03-11 正则表达式中的8进制代码</p>

<p>以前，在正则表达式中的\nnn形式的8进制表示法中，只有开头是0时，才允许4位数。[ruby-bugs-ja:PR#207]</p>

<p>p /\0001/ =~ &ldquo;\0001&rdquo; # equivalent to &ldquo;\0&rdquo; + &ldquo;1&rdquo;<br />
=&gt; -:1: warning: ambiguous first argument; make sure<br />
ruby 1.6.7 (2002-03-01) [i586-linux]<br />
nil<br />
=&gt; -:1: warning: ambiguous first argument; make sure<br />
ruby 1.6.7 (2002-03-15) [i586-linux]<br />
0</p>

<p>2002-03-11 trap</p>

<p>[ruby-bugs-ja:PR#206]</p>

<p>trap(&lsquo;EXIT&rsquo;,&lsquo;Foo&rsquo;)<br />
=&gt; -:1: [BUG] Segmentation fault<br />
ruby 1.6.7 (2002-03-01) [i586-linux]<br />
=&gt; ruby 1.6.7 (2002-03-15) [i586-linux]</p>

<p>2002-03-10 方法的返回值</p>

<p>下列方法的返回值已被修正。[ruby-bugs-ja:PR#205]</p>

<ul>
<li>each_with_index返回self(以前是nil)<br /></li>
<li>Process.setpgrp返回不定值。<br /></li>
<li>ljust, rjust, center返回已dup的字符串<br />
<br /></li>
</ul>

<p>2002-03-08 class variable</p>

<p>[ruby-talk:35122]</p>

<p>class C<br />
class &lt;&lt; self<br />
def test<br />
@@cv = 5<br />
p @@cv<br />
end<br />
end</p>

<p>test<br />
end<br />
=&gt; -:5:in `test&rsquo;: uninitialized class variable @@cv in C (NameError)<br />
from -:9<br />
ruby 1.6.7 (2002-03-01) [i586-linux]</p>

<p>=&gt; ruby 1.6.6 (2001-12-26) [i586-linux]<br />
5</p>

<p>2002-03-03 Marshal.load</p>

<p>以前，Marshal.load一直调用1.7的Proc#yield方法。[ruby-dev:16178]</p>

<p>Marshal.load(Marshal.dump(&lsquo;foo&rsquo;), proc {|o| p o})<br />
=&gt; -:1:in <code>load': undefined method</code>yield&rsquo; for #<0x401b1b30> (NameError)<br />
from -:1<br />
ruby 1.6.7 (2002-03-01) [i586-linux]</p>

<p>=&gt; ruby 1.6.6 (2001-12-26) [i586-linux]<br />
&ldquo;foo&rdquo;</p>

<p>1.6.6 (2001-12-26) -&gt; 1.6.7 (2002-03-01)</p>

<p>2002-02-20 true/false/nil的特殊方法定义</p>

<p>可以通过定义特殊类的方法来为这些伪变量定义特殊方法。</p>

<p>class &lt; def foo<br />
&ldquo;foo&rdquo;<br />
end<br />
end<br />
p true.foo<br />
=&gt; -:1: no virtual class for true (TypeError)<br />
ruby 1.6.6 (2001-12-26) [i586-linux]</p>

<p>=&gt; ruby 1.6.7 (2002-03-01) [i586-linux]<br />
&ldquo;foo&rdquo;</p>

<p>time.rb, URI</p>

<p>已添加。<br />
Ruby/Tk</p>

<p>修复bug，增加功能[ruby-dev:16139],[ruby-dev:16153]。<br />
数值字面值的`_&rsquo;</p>

<p>重新制定`_&lsquo;的使用规则，统一了String#hex等数值变换方法的行为规则。[rubyist:1018], [ruby-dev:15684],
[ruby-dev:15757]<br />
include</p>

<p>不会递归地对模块进行include操作。</p>

<p>module Foo; end<br />
module Bar; include Foo; end<br />
module Foo; include Bar; end</p>

<p>p Foo.ancestors</p>

<p>=&gt; ruby 1.6.6 (2001-12-26) [i586-linux]<br />
[Foo, Bar, Foo]</p>

<p>=&gt; -:3:in <code>append_features': cyclic include detected (ArgumentError)  
from -:3:in</code>include&rsquo;<br />
from -:3<br />
ruby 1.6.6 (2002-01-28) [i586-linux]</p>

<p>方法的返回值</p>

<p>修正了下列方法的返回值。 [ruby-bugs-ja:PR#182], [rubyist:1016]</p>

<ul>
<li>Hash#default= 返回右边部分(以前返回self)。<br /></li>
<li>Dir#pos= 返回右边部分(以前返回self)。 (Dir#seek仍然返回self)<br /></li>
<li>Dir.glob 带块时返回nil(以前返回false)<br /></li>
<li>IO#close 遇到已关闭的IO则引发IOError。<br /></li>
<li>IO#each_byte 返回self(以前返回nil)<br />
<br /></li>
</ul>

<p>rb_define_module_under()</p>

<p>以前，若C函数 rb_define_module_under()定义模块时遇到了已定义的同名常数的话就会失败。[ruby-talk:30203]</p>

<p>Constants = 1<br />
require &lsquo;syslog&rsquo;<br />
p Syslog::Constants</p>

<p>=&gt; -:2:in `require&rsquo;: Syslog::Fixnum is not a module (TypeError)<br />
from -:2<br />
ruby 1.6.6 (2001-12-26) [i586-linux]</p>

<p>=&gt; ruby 1.6.6 (2002-01-07) [i586-linux]<br />
Syslog::Constants</p>

<p>因为这个bug的问题，可能最近就会放出1.6.7[ruby-talk:30387](好像不是这样。因此使用1.6.6的stable-
snapshot的用户需要特别注意。因为2002/1/30的下列变更(ChangeLog)</p>

<ul>
<li>re.c (rb_reg_search): should set regs.allocated.<br />
<br /></li>
</ul>

<p>的原因，将导致内存不足。2002/2/13以后的修正版解决了这个问题)。</p>

<p>1.6.5 (2001-09-19) -&gt; 1.6.6 (2001-09-19)</p>

<p>Syslog</p>

<p>已添加。<br />
CGI</p>

<p>针对Netscape(版本是？)的bug进行了处理 [ruby-list:32089]<br />
Time#localtime<br />
Time#gmtime</p>

<p>可以调用一次已冻结的Time 对象。</p>

<p>t = Time.new.freeze<br />
p t.gmtime<br />
p t.localtime</p>

<p>=&gt; -:2:in `gmtime&rsquo;: can&rsquo;t modify frozen Time (TypeError)<br />
from -:2<br />
ruby 1.6.5 (2001-09-19) [i586-linux]</p>

<p>=&gt; ruby 1.6.5 (2001-11-01) [i586-linux]<br />
Mon Nov 05 18:08:34 UTC 2001<br />
-:3:in `localtime&rsquo;: can&rsquo;t modify frozen Time (TypeError)<br />
from -:3</p>

<p>File::SEPARATOR<br />
File::ALT_SEPARATOR<br />
File::PATH_SEPARATOR<br />
RUBY_PLATFORM<br />
RUBY_RELEASE_DATE<br />
RUBY_VERSION</p>

<p>上述各项已变为被freeze的字符串。</p>

<p>p File::SEPARATOR.frozen?<br />
p File::ALT_SEPARATOR.frozen?<br />
p File::PATH_SEPARATOR.frozen?</p>

<p>=&gt; ruby 1.6.5 (2001-09-19) [i586-linux]<br />
false<br />
false<br />
false</p>

<p>=&gt; ruby 1.6.5 (2001-11-01) [i586-linux]<br />
true<br />
false # 因为运行环境是Linux，所以ALT_SEPARATOR是nil<br />
true</p>

<p>Integer[nth]</p>

<p>以前，若遇到大索引值就会引发异常。 [ruby-bugs-ja:PR#114]</p>

<p>p(-1[10000000000])</p>

<p>=&gt; -:1:in <code>[]': bignum too big to convert into</code>int&rsquo; (RangeError)<br />
from -:1<br />
ruby 1.6.5 (2001-09-19) [i586-linux]</p>

<p>=&gt; ruby 1.6.5 (2001-11-01) [i586-linux]<br />
1</p>

<p>不能对整数的负索引返回0。？[ruby-bugs-ja:PR#122]</p>

<p>p(-1[-1])</p>

<p>=&gt; ruby 1.6.5 (2001-09-19) [i586-linux]<br />
1<br />
=&gt; ruby 1.6.5 (2001-11-01) [i586-linux]<br />
1</p>

<p>Numeric#remainder</p>

<p>[ruby-bugs-ja:PR#110]</p>

<p>p( 3.remainder(-3))<br />
p(-3.remainder(3))</p>

<p>=&gt; ruby 1.6.5 (2001-09-19) [i586-linux]<br />
3<br />
-3<br />
=&gt; ruby 1.6.5 (2001-11-01) [i586-linux]<br />
0<br />
0</p>

<p>END { &hellip; }</p>

<p>以前，不能运行END块中的END块。 [ruby-bugs-ja:PR#107]</p>

<p>END {<br />
p 1<br />
END { p 2 }<br />
}</p>

<p>=&gt; ruby 1.6.5 (2001-09-19) [i586-linux]<br />
1</p>

<p>=&gt; ruby 1.6.5 (2001-11-01) [i586-linux]<br />
1<br />
2</p>

<p>String#succ</p>

<p>[ruby-talk:22557]</p>

<p>p &ldquo;*<strong>&rdquo;.succ<br />
p &ldquo;<em>&rdquo;.succ<br />
p sprintf(&ldquo;%c&rdquo;, 255).succ<br />
p sprintf(&rdquo;</em>%c&rdquo;, 255).succ<br />
p sprintf(&rdquo;</strong>%c&rdquo;, 255).succ</p>

<p>=&gt; ruby 1.6.5 (2001-09-19) [i586-linux]<br />
&ldquo;*<em>+&rdquo;<br />
&ldquo;\001+&rdquo;<br />
&ldquo;\001\000&rdquo;<br />
&ldquo;\001+\000&rdquo;<br />
&ldquo;</em>+\000&rdquo;</p>

<p>=&gt; ruby 1.6.5 (2001-11-01) [i586-linux]<br />
&ldquo;*<em>+&rdquo;<br />
&rdquo;+&rdquo;<br />
&ldquo;\001\000&rdquo;<br />
&rdquo;+\000&rdquo;<br />
&ldquo;</em>+\000&rdquo;</p>

<p>method_missing</p>

<p>以前，下列内容被Segmentation Fault。[ruby-dev:14942]</p>

<p>Module::constants.each {|c|<br />
c = eval c<br />
if c.instance_of?(Class)<br />
p c<br />
c.instance_methods.each {|m|<br />
c.module_eval &ldquo;undef #{m};&rdquo;<br />
}<br />
c.module_eval {undef initialize}<br />
end<br />
}</p>

<p>=&gt; ruby 1.6.5 (2001-09-19) [i586-linux]<br />
NotImplementedError<br />
MatchData<br />
Exception<br />
Numeric<br />
MatchData<br />
Segmentation fault</p>

<p>=&gt; ruby 1.6.5 (2001-10-15) [i586-linux]<br />
MatchData<br />
NotImplementedError<br />
FloatDomainError<br />
LoadError<br />
Float<br />
Binding<br />
SignalException<br />
Module<br />
-:6:in `method_missing&rsquo;: stack level too deep (SystemStackError)</p>

<p>%q(&hellip;)</p>

<p>在使用%表示法的字面值中，不能将英文字母和数字用作切分字符。</p>

<p>p %q1..1</p>

<p>=&gt; ruby 1.6.5 (2001-10-10) [i586-linux]<br />
&rdquo;..&rdquo;<br />
=&gt; -:1: unknown type of %string<br />
p %q1..1<br />
^<br />
ruby 1.6.5 (2001-10-15) [i586-linux]</p>

<p>String#=~</p>

<p>调用String#=~时，若两边都是字面值的话，为了提升速度而禁止进行方法调用。(实际上，此前就曾考虑过这么做，但因为出现了bug而未能禁止方法调用(不是String#=~，而是Regexp#=~))</p>

<p>class String<br />
def =~(arg)<br />
[&ldquo;String#=~&ldquo;, self, arg]<br />
end<br />
end</p>

<p>class Regexp<br />
def =~(arg)<br />
[&ldquo;Regexp#=~&ldquo;, self, arg]<br />
end<br />
end</p>

<p>p &ldquo;foo&rdquo; =~ /foo/<br />
p &ldquo;foo&rdquo; =~ Regexp.new(&ldquo;foo&rdquo;)</p>

<p>=&gt; -:2: warning: discarding old =~<br />
-:8: warning: discarding old =~<br />
ruby 1.6.5 (2001-09-19) [i586-linux]<br />
[&ldquo;Regexp#=~&ldquo;, /foo/, &ldquo;foo&rdquo;]<br />
[&ldquo;String#=~&ldquo;, &ldquo;foo&rdquo;, /foo/]</p>

<p>=&gt; -:2: warning: discarding old =~<br />
-:8: warning: discarding old =~<br />
ruby 1.6.5 (2001-10-10) [i586-linux]<br />
0<br />
[&ldquo;String#=~&ldquo;, &ldquo;foo&rdquo;, /foo/]</p>

<p>(有时会对内部方法进行这种最优化设置，因此可能导致重定义方法无效的情况，而确切地说，您应该先判断某方法是否已被重定义，然后再选择是否进行最优化)<br />
class 定义</p>

<p>以前，若显式地使用一个不同的超类来重定义某个已定义的类时，则会忽略指定的超类。[ruby-bugs-ja:PR#87]</p>

<p>class A<br />
p self.id<br />
end<br />
class A &lt; String<br />
p self.id<br />
p self.superclass<br />
end</p>

<p>=&gt; ruby 1.6.5 (2001-09-19) [i586-linux]<br />
537760880<br />
-:4: warning: already initialized constant A<br />
537757180<br />
Object<br />
=&gt; ruby 1.6.5 (2001-10-10) [i586-linux]<br />
537760960<br />
-:4: warning: already initialized constant A<br />
537757200<br />
String</p>

<p>%w(&hellip;)</p>

<p>以前，语法解释器会将数组字面值 %w(&hellip;)误判为字符串字面值，从而导致下列异常情况。[ruby-bugs-ja:PR#91]</p>

<p>%w!a! &ldquo;b&rdquo;<br />
=&gt; -:1: tried to allocate too big memory (NoMemoryError)<br />
ruby 1.6.5 (2001-09-19) [i586-linux]</p>

<p>=&gt; -:1: parse error<br />
%w!a! &ldquo;b&rdquo;<br />
^<br />
ruby 1.6.5 (2001-10-10) [i586-linux]</p>

<p>Thread</p>

<p>以前存在下列bug：Thread#status对aborting状态返回&rdquo;run&rdquo;，而Thread#priority =
val会返回self而不是val。现已解决这些问题。[rubyist:0820], [ruby-dev:14903]<br />
Marshal</p>

<p>不能dump无名的类／模块。</p>

<p>p Marshal.dump(Class.new)</p>

<p>=&gt; ruby 1.6.4 (2001-06-04) [i586-linux]<br />
&ldquo;\004\005c\031#&rdquo;</p>

<p>=&gt; -:1:in `dump&rsquo;: can&rsquo;t dump anonymous class # (ArgumentError)<br />
from -:1<br />
ruby 1.6.5 (2001-10-05) [i586-linux]</p>

<p>UNIXSocket#addr</p>

<p>以前，UNIXSocket#addr会返回一些垃圾信息(在BSD中如何呢？)。 [ruby-bugs-ja:PR#85]</p>

<h1 id="server">server</h1>

<p>require &lsquo;socket&rsquo;<br />
File.unlink(&ldquo;/tmp/sss&rdquo;)<br />
sock = UNIXServer.new(&ldquo;/tmp/sss&rdquo;).accept</p>

<h1 id="client">client</h1>

<p>require &lsquo;socket&rsquo;<br />
sock = UNIXSocket.new(&ldquo;/tmp/sss&rdquo;).addr</p>

<p>=&gt; [&ldquo;AF_UNIX&rdquo;, &ldquo;\031((\306\031(\010&rdquo;]</p>

<p>=&gt; [&ldquo;AF_UNIX&rdquo;, &ldquo;&rdquo;]</p>

<p>???</p>

<p>[ruby-talk:21722]</p>

<p>class Ptr</p>

<p>def initialize(obj) @obj = obj end<br />
def []=() @obj = obj end<br />
def []() @obj end</p>

<p>end module Kernel</p>

<p>def _ptr() Ptr.new(self) end</p>

<p>end</p>

<p>def foo(int)</p>

<p>int[] += 1</p>

<p>end x = 1._ptr foo(x) puts x[]</p>

<p>=&gt; -:11: [BUG] Segmentation fault</p>

<p>ruby 1.6.5 (2001-09-19) [i586-linux]</p>

<p>=&gt; -:11:in `[]=&rsquo;: wrong # of arguments(1 for 0) (ArgumentError)</p>

<p>from -:11:in `foo&rsquo;<br />
from -:14</p>

<p>ruby 1.6.5 (2001-10-05) [i586-linux]</p>

<p>Subclass of String and Array</p>

<p>以前，在String, Array的子类中调用某些特定方法时，就会变成String, Array。</p>

<p>class Foo &lt; String<br />
end<br />
p Foo.new(&ldquo;&rdquo;).type<br />
p Foo.new(&ldquo;foo&rdquo;)[0,0].type # String ???<br />
p Foo.new(&ldquo;foo&rdquo;)[1,1].type<br />
p Foo.new(&ldquo;foo&rdquo;).succ.type<br />
p Foo.new(&ldquo;foo&rdquo;).reverse.type<br />
p((Foo.new(&ldquo;foo&rdquo;) * 5).type)<br />
p Foo.new(&ldquo;foo&rdquo;).gsub(/foo/, &ldquo;bar&rdquo;).type<br />
p Foo.new(&ldquo;foo&rdquo;).sub(/foo/, &ldquo;bar&rdquo;).type<br />
p Foo.new(&ldquo;foo&rdquo;).ljust(10).type<br />
p Foo.new(&ldquo;foo&rdquo;).rjust(10).type<br />
p Foo.new(&ldquo;foo&rdquo;).center(10).type</p>

<p>=&gt; ruby 1.6.5 (2001-09-19) [i586-linux]<br />
Foo<br />
String<br />
String<br />
String<br />
String<br />
String<br />
String<br />
Foo<br />
String<br />
String<br />
String</p>

<p>=&gt; ruby 1.6.5 (2001-10-05) [i586-linux]<br />
Foo<br />
String<br />
Foo<br />
Foo<br />
Foo<br />
Foo<br />
Foo<br />
Foo<br />
Foo<br />
Foo<br />
Foo</p>

<p>class Bar &lt; Array<br />
end<br />
bar = Bar.new<br />
p bar.type<br />
p bar.push(1,2,3)<br />
p bar.type<br />
p bar[0,0].type # =&gt; Array ???<br />
p bar[0,1].type<br />
p ((bar * 5).type)</p>

<p>=&gt; -:9: warning: p (&hellip;) interpreted as method call<br />
ruby 1.6.5 (2001-09-19) [i586-linux]<br />
Bar<br />
[1, 2, 3]<br />
Bar<br />
Array<br />
Array<br />
Array<br />
=&gt; -:9: warning: p (&hellip;) interpreted as method call<br />
ruby 1.6.5 (2001-10-05) [i586-linux]<br />
Bar<br />
[1, 2, 3]<br />
Bar<br />
Array<br />
Bar<br />
Bar</p>

<p>1.6.4 (2001-06-04) -&gt; 1.6.5 (2001-09-19)</p>

<p>$_, $~, if a..b</p>

<p>以前，在函数中使用Thread#run时，与该线程共享scope的父线程中的$_, $~会被子线程所覆盖。[ruby-dev:14743]</p>

<p>def foo(t)<br />
t.run<br />
end</p>

<p>t = Thread.start do<br />
t = $<em>= &ldquo;sub&rdquo;<br />
loop{Thread.stop;puts &ldquo;sub:#$</em>&rdquo;}<br />
end</p>

<p>$_ = &ldquo;main&rdquo;<br />
t.run # =&gt; sub:sub<br />
puts &ldquo;main:#$<em>&rdquo; # =&gt; main:main<br />
foo(t) # =&gt; sub:sub<br />
puts &ldquo;main:#$</em>&rdquo; # =&gt; main:sub<br />
=&gt; ruby 1.6.4 (2001-06-04) [i586-linux]<br />
sub:sub<br />
main:main<br />
sub:sub<br />
main:sub<br />
=&gt; ruby 1.6.5 (2001-09-19) [i586-linux]<br />
sub:sub<br />
main:main<br />
sub:sub<br />
main:main</p>

<p>net/telnet.rb</p>

<p>有时，当Net::Telnet连接到特定的端口之后，就失去反应。 [ruby-list:31303]<br />
CGI#header</p>

<p>以前，在下述脚本中，TEXT_PLAIN会被改写成&rdquo;text/plain; charset=iso-8859-1&rdquo;。 [ruby-dev:14716]</p>

<p>require &lsquo;cgi&rsquo;</p>

<p>TEXT_PLAIN = &ldquo;text/plain&rdquo;</p>

<p>cgi = CGI.new<br />
print cgi.header(&ldquo;type&rdquo; =&gt; TEXT_PLAIN,<br />
&ldquo;charset&rdquo; =&gt; &ldquo;iso-8859-1&rdquo;)<br />
printf(&ldquo;TEXT_PLAIN: %s\n&rdquo;, TEXT_PLAIN)</p>

<p>=&gt; ruby 1.6.4 (2001-06-04) [i586-linux]<br />
Content-Type: text/plain; charset=iso-8859-1<br />
^M<br />
TEXT_PLAIN: text/plain; charset=iso-8859-1<br />
TEXT_PLAIN: text/plain</p>

<p>=&gt; ruby 1.6.5 (2001-09-19) [i586-linux]<br />
Content-Type: text/plain; charset=iso-8859-1<br />
^M<br />
TEXT_PLAIN: text/plain</p>

<p>Dir.chdir</p>

<p>在尚未定义HOME或LOGDIR时，若不带参数地调用Dir.chdir的话，就会引发ArgumentError异常</p>

<p>ENV[&lsquo;HOME&rsquo;] = nil ENV[&lsquo;LOGDIR&rsquo;] = nil Dir.chdir =&gt; -:3:in `chdir&rsquo;: Bad address
(Errno::EFAULT)</p>

<p>from -:3</p>

<p>ruby 1.6.4 (2001-08-26) [i586-linux]</p>

<p>=&gt; -:3:in `chdir&rsquo;: HOME/LOGDIR not set (ArgumentError)</p>

<p>from -:3</p>

<p>ruby 1.6.5 (2001-09-19) [i586-linux]</p>

<p>Dir.glob</p>

<p>以前，下列代码会引起死循环。</p>

<p>Dir.mkdir(&ldquo;test?&rdquo;) rescue nil<br />
p Dir.glob(&ldquo;test?/*&ldquo;)<br />
=&gt; ruby 1.6.5 (2001-09-19) [i586-linux]<br />
[]</p>

<p>jcode.rb</p>

<p>修改了若干bug。[ruby-list:31238]</p>

<p>Dir.glob</p>

<p>Dir.glob(&rdquo;*/*<em>/</em>&rdquo;)会重复返回子目录中的文件。 [ruby-dev:14576]</p>

<p>Dir.mkdir(&lsquo;foo&rsquo;) rescue nil<br />
Dir.mkdir(&lsquo;foo/bar&rsquo;) rescue nil<br />
p Dir.glob(&rsquo;*/*<em>/</em>&rsquo;)</p>

<p>=&gt; ruby 1.6.4 (2001-06-04) [i586-linux]<br />
[&ldquo;foo/bar&rdquo;, &ldquo;foo/bar&rdquo;]</p>

<p>=&gt; ruby 1.6.4 (2001-08-26) [i586-linux]<br />
[&ldquo;foo/bar&rdquo;]</p>

<p>UnboundMethod#bind</p>

<p>无法bind模块的UnboundMethod对象。 [rubyist:0728]</p>

<p>module Foo<br />
def foo<br />
:foo<br />
end<br />
end</p>

<p>class Bar<br />
include Foo<br />
end</p>

<p>m = Foo.instance_method :foo<br />
p m.bind(Bar.new).call</p>

<p>=&gt; ruby 1.6.4 (2001-06-04) [i586-linux]<br />
-:12:in `bind&rsquo;: first argument must be an instance of Foo (TypeError)<br />
from -:12</p>

<p>=&gt; ruby 1.6.4 (2001-08-23) [i586-linux]<br />
:foo</p>

<p>内部类的替换</p>

<p>对内部类／模块进行赋值时，会出现警告。</p>

<p>Array = nil<br />
p Array<br />
=&gt; ruby 1.6.4 (2001-06-04) [i586-linux]<br />
nil</p>

<p>=&gt; -:1: warning: already initialized constant Array<br />
ruby 1.6.4 (2001-08-23) [i586-linux]<br />
nil</p>

<p>Regexp</p>

<p>以前，若反向参考中的数字大于括号数量时，则会匹配任何内容。[ruby-list:30975]</p>

<p>p /(foo)\2/ =~ &ldquo;foobar&rdquo;<br />
=&gt; ruby 1.6.4 (2001-06-04) [i586-linux]<br />
0<br />
=&gt; ruby 1.6.4 (2001-08-23) [i586-linux]<br />
nil</p>

<p>TCPSocket.open</p>

<p>修复了Cygwin中TCPSocket.open 时常出错(Errno::EINVAL, EALREADY)的问题。(1.6.4 20010712以后)
[ruby-talk:9939], [ruby-talk:16632], [ruby-list:24702], [ruby-list:27805],
[ruby-list:30512] 等等<br />
lib/resolv.rb, lib/resolv-replace.rb</p>

<p>添加。主要是为了在ruby的resolver(DNS解析)和Socket相关的类中使用该库而设立。</p>

<p>在ruby的resovler中，timeout.rb的控制是有效的(即，在域名解析过程中可以进行Thread的切换)</p>

<p>require &lsquo;resolv&rsquo;<br />
p Resolv.new.getaddress(&ldquo;www.ruby-lang.org&rdquo;).to_s</p>

<p>=&gt; /usr/local/lib/ruby/1.6/resolv.rb:160: warning: timeout (&hellip;) interpreted
as method call<br />
/usr/local/lib/ruby/1.6/resolv.rb:55: warning: instance variable @initialized
not initialized<br />
/usr/local/lib/ruby/1.6/resolv.rb:113: warning: instance variable @initialized
not initialized<br />
/usr/local/lib/ruby/1.6/resolv.rb:392: warning: instance variable @initialized
not initialized<br />
ruby 1.6.4 (2001-08-23) [i586-linux]<br />
&ldquo;210.251.121.214&rdquo;</p>

<p>Digest 模块</p>

<p>SHA1, MD5被替换成Digest::SHA1, Digest::MD5。 另外，还新增了Digest::SHA256, Digest::SHA384,
Digest::SHA512, Digest::RMD160。</p>

<p>require &lsquo;digest/md5&rsquo;<br />
include Digest</p>

<p>md = MD5.new<br />
md &lt;&lt; &ldquo;abc&rdquo;<br />
puts md</p>

<p>puts MD5.hexdigest(&ldquo;123&rdquo;)</p>

<p>Struct</p>

<p>以前，可以修改已被冻结的结构体对象。另外，当$SAFE = 4时，则禁止进行修改操作。[ruby-talk:19167]</p>

<p>cat = Struct.new(&ldquo;Cat&rdquo;, :name, :age, :life)<br />
a = cat.new(&ldquo;cat&rdquo;, 12, 7).freeze<br />
a.name = &ldquo;dog&rdquo;<br />
p a<br />
=&gt; ruby 1.6.4 (2001-06-04) [i586-linux]<br />
#&lt;:cat name=&ldquo;dog&rdquo; age=&ldquo;12,&rdquo; life=&ldquo;7&rdquo;&gt;<br />
=&gt; ruby 1.6.4 (2001-08-06) [i586-linux]<br />
-:4:in `name=&rsquo;: can&rsquo;t modify frozen Struct (TypeError)<br />
from -:4</p>

<p>cat = Struct.new(&ldquo;Cat&rdquo;, :name, :age, :life)<br />
a = cat.new(&ldquo;cat&rdquo;, 12, 7)<br />
Thread.new do<br />
abort_on_exception = true<br />
$SAFE = 4<br />
a.life -= 1<br />
end.join<br />
p a.life<br />
=&gt; ruby 1.6.4 (2001-06-04) [i586-linux]<br />
6<br />
=&gt; ruby 1.6.4 (2001-08-06) [i586-linux]<br />
-:6:in <code>life=': Insecure: can't modify Struct (SecurityError)   
from -:3:in</code>join&rsquo;<br />
from -:3</p>

<p>String#rindex</p>

<p>将正则表达式传给rindex时，则会出现bug。<a href="该bug出现在1.6.4 版本之后">ruby-dev:13843</a></p>

<p>p &ldquo;foobar&rdquo;.rindex(/b/)<br />
=&gt; ruby 1.6.4 (2001-06-04) [i586-linux]<br />
3</p>

<p>=&gt; ruby 1.6.4 (2001-06-19) [i386-freebsd5.0]<br />
nil</p>

<p>=&gt; ruby 1.6.4 (2001-08-06) [i586-linux]<br />
3</p>

<p>require</p>

<p>以前，若把以~开头的文件名传给require时必须带上扩展名，否则无法进行加载。[ruby-dev:13756]</p>

<p>$ echo p <strong>FILE</strong> &gt; ~/a.rb<br />
$ ruby17 -v -r~/a -e0<br />
ruby 1.7.1 (2001-07-03) [i686-linux]<br />
0: No such file to load &ndash; ~/a (LoadError)<br />
$ ruby16 -v -r~/a -e0<br />
ruby 1.6.4 (2001-07-02) [i686-linux]<br />
0: No such file to load &ndash; ~/a (LoadError)<br />
$ ruby14 -v -r~/a -e0<br />
ruby 1.4.6 (2000-08-16) [i686-linux]<br />
&rdquo;/home/nobu/a.rb&rdquo;</p>

<p>String#each_line</p>

<p>以前，无法正确传递污染。[ruby-dev:13755]</p>

<p>&ldquo;foo\nbar\n&rdquo;.taint.each_line {|v| p v.tainted?}<br />
=&gt; ruby 1.6.4 (2001-06-04) [i586-linux]<br />
false<br />
true<br />
=&gt; ruby 1.6.4 (2001-08-06) [i586-linux]<br />
true<br />
true</p>

<p>NKF::nkf</p>

<p>以前，无法正确传递污染。[ruby-dev:13754]</p>

<p>require &lsquo;nkf&rsquo;<br />
p NKF.nkf(&ldquo;-j&rdquo;, &ldquo;a&rdquo;.taint).tainted?</p>

<p>=&gt; ruby 1.6.4 (2001-06-04) [i586-linux]<br />
false<br />
=&gt; ruby 1.6.4 (2001-08-06) [i586-linux]<br />
true</p>

<p>ruby -x</p>

<p>指定了-x[directory]选项的话，有时会出现尚未执行脚本就已经结束的情况。[ruby-dev:13752]<br />
attr_*</p>

<p>向accessor传递多余的参数也不会引起错误。 [ruby-dev:13748]</p>

<p>class C<br />
def initialize<br />
@message = &lsquo;ok&rsquo;<br />
end<br />
attr_reader :message<br />
end<br />
puts C.new.message(1,2,3)</p>

<p>=&gt; ruby 1.6.4 (2001-06-04) [i586-linux]<br />
ok<br />
=&gt; ruby 1.6.4 (2001-08-06) [i586-linux]<br />
-:7:in `message&rsquo;: wrong # of arguments(3 for 0) (ArgumentError)<br />
from -:7</p>

<p>Readline::completion_append_character<br />
Readline::completion_append_character=</p>

<p>添加。GNU Readline库中的rl_completion_append_character变量的accessor。(在GNU readline
2.1之后的版本中才能使用该变量) [ruby-ext:01760]<br />
Socket::Constants</p>

<p>添加了下列socket相关的常数。</p>

<p>SO_PASSCRED<br />
SO_PEERCRED<br />
SO_RCVLOWAT<br />
SO_SNDLOWAT<br />
SO_RCVTIMEO<br />
SO_SNDTIMEO<br />
SO_SECURITY_AUTHENTICATION<br />
SO_SECURITY_ENCRYPTION_TRANSPORT<br />
SO_SECURITY_ENCRYPTION_NETWORK<br />
SO_BINDTODEVICE<br />
SO_ATTACH_FILTER<br />
SO_DETACH_FILTER<br />
SO_PEERNAME<br />
SO_TIMESTAMP</p>

<p>require / $LOAD_PATH</p>

<p>Changed to use a new algorithm to locate a library.</p>

<p>Now when requiring &ldquo;foo&rdquo;, the following directories are searched for the
library in the order listed.</p>

<p>$prefix/lib/ruby/site_ruby/$ver/foo.rb<br />
$prefix/lib/ruby/site_ruby/$ver/foo.so<br />
$prefix/lib/ruby/site_ruby/$ver/$arch/foo.rb<br />
$prefix/lib/ruby/site_ruby/$ver/$arch/foo.so<br />
$prefix/lib/ruby/site_ruby/foo.rb<br />
$prefix/lib/ruby/site_ruby/foo.so<br />
$prefix/lib/ruby/$ver/foo.rb<br />
$prefix/lib/ruby/$ver/foo.so<br />
$prefix/lib/ruby/$ver/$arch/foo.rb<br />
$prefix/lib/ruby/$ver/$arch/foo.so<br />
./foo.rb<br />
./foo.so</p>

<p>The previous behavior had a potential security risk because a foo.rb (if
exists) in the current directory is located prior to a foo.so in
$prefix/lib/ruby/site_ruby/$ver/$arch.</p>

<p>[ruby-bugs:PR#140], [ruby-ext:01778], [ruby-dev:13659]<br />
lib/sync.rb<br />
lib/mutex_m.rb</p>

<p>Fixed for obj.extend(Sync_m) and obj.extend(Mutex_m).[ruby-dev:13463]</p>

<p>$ ruby -v -rsocket -rmutex_m -e &rsquo;s=TCPSocket.new(&ldquo;localhost&rdquo;,25);
s.extend(Mutex_m)&rsquo;<br />
ruby 1.6.4 (2001-06-04) [i386-linux]<br />
/usr/lib/ruby/1.6/mutex_m.rb:104:in <code>initialize': wrong # of arguments (0 for
1) (ArgumentError)  
from /usr/lib/ruby/1.6/mutex_m.rb:104:in</code>initialize&rsquo;<br />
from /usr/lib/ruby/1.6/mutex_m.rb:50:in <code>mu_extended'  
from /usr/lib/ruby/1.6/mutex_m.rb:34:in</code>extend_object&rsquo;<br />
from -e:1:in `extend&rsquo;<br />
from -e:1</p>

<p>$SAFE / load</p>

<p>以前存在以下bug：在1 &lt;= $SAFE &lt;=
3的情况下，当第二参数为true时，即使指定了被污染的对象名，也能进行load()。现在已经修复该bug。[ruby-dev:13481]</p>

<p>$SAFE = 1<br />
filename = &ldquo;foo&rdquo;<br />
filename.taint<br />
p load(filename, true)</p>

<p>=&gt; ruby 1.6.4 (2001-06-04) [i586-linux]<br />
true</p>

<p>=&gt; ruby 1.6.4 (2001-08-06) [i586-linux]<br />
-:4:in `load&rsquo;: Insecure operation - load (SecurityError)<br />
from -:4</p>

<p>Regexp</p>

<p>以前，只有后者能匹配成功。[ruby-talk:16233]</p>

<p>puts &ldquo;OK 1&rdquo; if /(.|a)bd/ =~ &ldquo;cxbd&rdquo;<br />
puts &ldquo;OK 2&rdquo; if /(a|.)bd/ =~ &ldquo;cxbd&rdquo;</p>

<p>=&gt; ruby 1.6.4 (2001-06-04) [i586-linux]<br />
OK 2<br />
=&gt; ruby 1.6.4 (2001-08-06) [i586-linux]<br />
OK 1<br />
OK 2</p>

<p>Marshal</p>

<p>以前，模块加载时的类型检测中存在错误。修复该错误后，dump format的minor版本号升高1级</p>

<p>p Marshal.dump(Object.new).unpack(&ldquo;CC&rdquo;).join(&ldquo;.&rdquo;)<br />
=&gt; ruby 1.6.4 (2001-06-04) [i586-linux]<br />
&ldquo;4.5&rdquo;<br />
p Marshal.dump(Object.new).unpack(&ldquo;CC&rdquo;).join(&ldquo;.&rdquo;)<br />
=&gt; ruby 1.6.4 (2001-06-11) [i586-linux]<br />
&ldquo;4.6&rdquo;</p>

<p>$SAFE / def</p>

<p>虽然doc/NEWS中有下列内容</p>

<p>Fixed so defining a new method is allowed under $SAFE == 4, which<br />
previously wasn&rsquo;t.</p>

<p>但实际上是行不通的。</p>

<p>$SAFE = 4; def a; end</p>

<p>=&gt; -:1: Insecure operation `(null)&rsquo; at level 4 (SecurityError)<br />
ruby 1.6.4 (2001-06-04) [i586-linux]</p>

<p>=&gt; -:1: Insecure: can&rsquo;t define method (SecurityError)<br />
ruby 1.6.4 (2001-08-06) [i586-linux]</p>

<p>对应的ChangeLog内容如下。</p>

<p>Tue Jun 5 15:16:06 2001 Yukihiro Matsumoto</p>

<ul>
<li>eval.c (rb_add_method): should not call rb_secure(), for<br />
last_func may not be set.<br />
<br /></li>
</ul>

<p>差别如下所示。</p>

<p>@@ -227,10 +227,7 @@ rb_add_method(klass, mid, node, noex)<br />
NODE *body;</p>

<p>if (NIL_P(klass)) klass = rb_cObject;<br />
- if (klass == rb_cObject) {<br />
- rb_secure(4);<br />
- }<br />
- if (rb_safe_level() &gt;= 4 &amp;&amp; !OBJ_TAINTED(klass)) {<br />
+ if (rb_safe_level() &gt;= 4 &amp;&amp; (klass == rb_cObject || !OBJ_TAINTED(klass))) {<br />
rb_raise(rb_eSecurityError, &ldquo;Insecure: can&rsquo;t define method&rdquo;);<br />
}<br />
if (OBJ_FROZEN(klass)) rb_error_frozen(&ldquo;class/module&rdquo;);</p>

<p>留作日后调查。<br />
IO#ioctl</p>

<p>第2参数也可以接受Bignum了(为了覆盖long int的范围)</p>

<p>1.6.3 (2001-03-19) -&gt; 1.6.4 (2001-06-04)</p>

<p>Hash#replace</p>

<p>以前，在哈希表迭代过程中，若删除某元素后，向其他哈希表中进行replace时，就会Abort。[ruby-dev:13432]</p>

<p>h = { 10 =&gt; 100, 20 =&gt; 200 }<br />
h2 = { }</p>

<p>h.each { |k, v|<br />
if (k == 10)<br />
h.delete(10)<br />
h2.replace(h) # =&gt; Abort core dumped<br />
end<br />
}</p>

<p>$SAFE / File::unlink</p>

<p>在$SAFE &gt;= 2的环境中，即使参数未被污染也不能使用File.unlink。[ruby-dev:13426]</p>

<p>touch foo<br />
ruby -v -e &lsquo;$SAFE=2;File.unlink(&ldquo;foo&rdquo;)&rsquo;</p>

<p>=&gt; ruby 1.6.3 (2001-03-19) [i586-linux]<br />
=&gt; ruby 1.6.4 (2001-06-04) [i586-linux]<br />
-e:1:in <code>unlink': Insecure operation</code>unlink&rsquo; at level 2 (SecurityError)<br />
from -e:1</p>

<p>Object#untaint</p>

<p>现在不能对已冻结的对象使用untaint方法。[ruby-dev:13409]</p>

<p>a = Object.new<br />
a.taint<br />
a.freeze<br />
a.untaint</p>

<p>=&gt; ruby 1.6.3 (2001-03-19) [i586-linux]<br />
=&gt; ruby 1.6.4 (2001-06-04) [i586-linux]<br />
-:4:in `untaint&rsquo;: can&rsquo;t modify frozen object (TypeError)<br />
from -:4</p>

<p>ruby -T4</p>

<p>指定-T4选项时，因为无法修改ARGV导致程序无法运行。[ruby-dev:13401]</p>

<p>touch foo<br />
ruby-1.6.3 -v -T4 foo<br />
=&gt; ruby 1.6.3 (2001-03-19) [i586-linux]<br />
foo: Insecure: can&rsquo;t modify array (SecurityError)</p>

<p>Regexp</p>

<p>现在，正则表达式中的 \1 .. \9 总是会被解释为反向参考(以前则不同，若有对应的括号则看作反向参考，若没有的话则看作8进制字符代码)。</p>

<p>在正则表达式中指定8进制字符代码时，请使用形如\001这种3位表示法。</p>

<p>另外，若反向参考中没有对应的括号，或者对应的括号中包含反向参考本身的话，则会引起匹配失败。</p>

<p>p /(foo)\2/ =~ &ldquo;foo\002&rdquo;<br />
=&gt; ruby 1.6.3 (2001-03-19) [i586-linux]<br />
0<br />
=&gt; ruby 1.6.4 (2001-06-04) [i586-linux]<br />
0<br />
=&gt; ruby 1.6.4 (2001-08-23) [i586-linux]<br />
nil</p>

<p>(如上所示，1.6.4中仍然有bug。大概是在2001-08-23的时候得到了修正[ruby-list:30975])</p>

<p>p /(foo\1)/ =~ &ldquo;foo&rdquo;<br />
=&gt; ruby 1.6.3 (2001-03-19) [i586-linux]<br />
0<br />
=&gt; ruby 1.6.4 (2001-06-04) [i586-linux]<br />
nil</p>

<p>污染字符串的传播</p>

<p>下列各项都会返回true。[ruby-dev:13340]</p>

<h1 id="toc_3">[]=</h1>

<p>s1 = &ldquo;abc&rdquo;<br />
s2 = &ldquo;cde&rdquo;.taint<br />
s1[0]= s2<br />
p s1.tainted? # =&gt; false</p>

<h1 id="crypt">crypt</h1>

<p>s = &ldquo;abc&rdquo;.taint<br />
p s.crypt(&ldquo;cd&rdquo;).tainted? # =&gt; false</p>

<h1 id="ljust">ljust</h1>

<p>s = &ldquo;abc&rdquo;.taint<br />
p s.ljust(10).tainted? # =&gt; false</p>

<h1 id="rjust">rjust</h1>

<p>s = &ldquo;abc&rdquo;.taint<br />
p s.rjust(10).tainted? # =&gt; false</p>

<h1 id="center">center</h1>

<p>s = &ldquo;abc&rdquo;.taint<br />
p s.center(10).tainted? # =&gt; false</p>

<p>rb_yield_0()</p>

<p>以前在C API中使用yield时，1个参数会被当作只包含1个元素的数组来处理。[ruby-dev:13299]</p>

<p>class X<br />
include Enumerable</p>

<p>def each(&amp;block)<br />
block.call(1,2)<br />
block.call(2,3)<br />
block.call(3,4)<br />
end<br />
end</p>

<p>x = X.new<br />
p x.to_a #=&gt; [[1], [2], [3]]</p>

<h1 id="ruby-1-6-3-2001-03-19-i586-linux">=&gt; ruby 1.6.3 (2001-03-19) [i586-linux]</h1>

<p>[[1], [2], [3]]</p>

<h1 id="ruby-1-6-4-2001-06-04-i586-linux">=&gt; ruby 1.6.4 (2001-06-04) [i586-linux]</h1>

<p>[1, 2, 3]</p>

<p>$SAFE / alias</p>

<p>当$SAFE = 4时，不允许全局变量使用别名。 [ruby-dev:13287]<br />
Open3::popen3</p>

<p>结束的进程不会调用at_exit。 (将exit修正为exit!) [ruby-dev:13170]<br />
SizedQueue#pop</p>

<p>下列代码不会再导致死锁了。[ruby-dev:13169]</p>

<p>ruby -r thread -e &lsquo;q = SizedQueue.new(1); q.push(1);&rsquo;\<br />
-e &lsquo;Thread.new{sleep 1; q.pop}; q.push(1);&rsquo;</p>

<p>SizedQueue#max=</p>

<p>以前当max大于当前值时，则会唤起相应的等待线程。但在该处理过程中存在错误。[ruby-dev:13170]<br />
Queue<br />
SizedQueue</p>

<p>在调用Thread#run时，若线程忽然死亡则会引发ThreadError。现在已经针对这个问题进行了相应的处理。[ruby-dev:13194]<br />
Ctrl-C (Interrupt)失效</p>

<p>[ruby-dev:13195]</p>

<p>th1 = Thread.start {<br />
begin<br />
Thread.stop<br />
ensure<br />
Thread.pass<br />
Thread.stop<br />
end<br />
}<br />
sleep 1</p>

<p>(据我所知，在ruby-1.7.0 (2001-05-17) 以后的版本中解决了这个问题，但1.6好像还不行)<br />
Array#&amp;<br />
Array#|<br />
Array#uniq</p>

<p>以前，结果数组中的元素均被冻结，不能修改。[ruby-list:29665]</p>

<p>(%w(foo bar) &amp; %w(foo baz))[0].upcase!<br />
=&gt; -:1:in `upcase!&rsquo;: can&rsquo;t modify frozen string (TypeError)</p>

<p>%w(foo bar bar baz).uniq[0].upcase!<br />
=&gt; -:1:in `upcase!&rsquo;: can&rsquo;t modify frozen string (TypeError)</p>

<p>shell.rb</p>

<p>shell.rb 0.6被添加到标准库中。(文档在doc目录中)<br />
forwardable.rb</p>

<p>forwardable.rb 1.1被添加到标准库中。(文档在doc目录中)<br />
irb.rb &amp; irb-tools</p>

<p>irb和irb-tools分别升级到0.7.4和0.7.1。<br />
夏令时</p>

<p>对夏令时的考虑不周(？) [ruby-bugs-ja:PR#46]</p>

<p>env TZ=America/Managua ruby -e &lsquo;p Time.local(1998,12,1,0,59,59)&rsquo;<br />
=&gt; Mon Nov 30 01:59:59 EST 1998<br />
env TZ=America/Managua ruby -e &lsquo;p Time.local(1998,12,1,0,59,59).tv_sec&rsquo;<br />
=&gt; 912409199</p>

<p>SIGINFO</p>

<p>对4.4BSD的SIGINFO信号采取了相应的处理措施。[ruby-bugs-ja:PR#45]<br />
Thread.stop中的SEGV</p>

<p>有时会在Thread.stop中发生SEGV。[ruby-dev:13189]<br />
rescue 修饰部分</p>

<p>下列代码在1.6.3中会引起parse error，现在已经修复了该bug。[ruby-dev:13073], [ruby-dev:13292]</p>

<p>raise &ldquo;&rdquo; rescue []<br />
raise &ldquo;&rdquo; rescue (p &ldquo;foo&rdquo;; true)<br />
raise &ldquo;&rdquo; rescue -1<br />
raise &ldquo;&rdquo; rescue (-1)</p>

<p>Thread</p>

<p>下列代码不会再引起dead lock了。</p>

<p>Thread.start { Thread.stop }<br />
sleep</p>

<p>=&gt; deadlock 0x40199b58: 2:0 - -:1<br />
deadlock 0x401a2528: 2:4 (main) - -:2<br />
-:2:in `sleep&rsquo;: Thread: deadlock (fatal)<br />
from -:2<br />
ruby 1.6.3 (2001-03-19) [i586-linux]</p>

<p>Module#const_defined?<br />
Module#const_get<br />
Module#const_set</p>

<p>以前，这些方法甚至可以访问常数以外的对象。现在已经修正了该bug [ruby-dev:13019]<br />
Marshal.dump</p>

<p>dump Float时精度由&rdquo;%.12g&rdquo;提升到了&rdquo;%.16g&rdquo;。 [ruby-list:29349]<br />
Fixnum#[]</p>

<p>好像是修正了在sizeof(long) &gt; sizeof(int)这种系统上的bug。<br />
正则表达式</p>

<p>修正了2个较少见的bug [ruby-talk:13658], [ruby-talk:13744]<br />
retry</p>

<p>在1.6.3中，下列代码不能正常运行[ruby-talk:13957]</p>

<p>def WHILE(cond)<br />
return if not cond<br />
yield<br />
retry<br />
end</p>

<p>i=0<br />
WHILE(i&lt;3) {<br />
print i<br />
i+=1<br />
}</p>

<p>ruby 1.6.2 (2000-12-25) [i586-linux]<br />
=&gt; 012</p>

<p>ruby 1.6.3 (2001-03-19) [i586-linux]<br />
=&gt; 0</p>

<p>ruby 1.6.4 (2001-05-02) [i586-linux]<br />
=&gt; 012</p>

<p>File::Stat#size</p>

<p>以前无法正确返回超过1G byte的文件的大小。</p>

<p>File.open(&ldquo;/tmp/1GB&rdquo;, &ldquo;w&rdquo;) {|f|<br />
f.seek(2**30-1, 0)<br />
f.puts<br />
f.flush<br />
p f.stat.size<br />
}</p>

<h1 id="ruby-1-6-3-2001-04-03-i586-linux">=&gt; ruby 1.6.3 (2001-04-03) [i586-linux]</h1>

<p>-1073741824</p>

<h1 id="ruby-1-6-4-2001-04-19-i586-linux">=&gt; ruby 1.6.4 (2001-04-19) [i586-linux]</h1>

<p>1073741824</p>

<p>Float#modulo, Float#divmod</p>

<p>好像修正了一些问题 [ruby-dev:12718]<br />
ObjectSpace#_id2ref</p>

<p>以前会莫名其妙地返回异常。<br />
malloc的递归调用问题</p>

<p>当stdio在内部调用malloc()时，会破坏其与Thread的兼容性，因此采取了一些补救措施。(通过使用setvbuf()，来避免调用malloc())
[ruby-dev:12795]<br />
File#flock</p>

<p>在File#flock锁定之后，有时会抛出Errno::EACCES异常，而并不会返回false(这种情况出现在没有flock()的系统中)<br />
File::Stat.new(filename)</p>

<p>添加 [ruby-dev:12803]<br />
Bignum#%的计算错误</p>

<p>(再次)修正了导致% 计算错误的bug</p>

<p>a = 677330545177305025495135714080<br />
b = 14269972710765292560<br />
p a % b #=&gt; 0<br />
p -a % b #=&gt;</p>

<p>=&gt; ruby 1.6.3 (2001-04-02) [i386-cygwin]<br />
0<br />
14269972710765292560</p>

<p>=&gt; ruby 1.6.4 (2001-04-19) [i586-linux]<br />
0<br />
0</p>

<p>Marshal</p>

<p>将Bignum进行dump -&gt; load操作之后得到的结果往往与原值不同。</p>

<p>在1.6.3版本之后，共进行了3次相关部分的修改。 请使用stable-snapshot的</p>

<p>ruby 1.6.3 (2001-03-22)</p>

<p>之后的版本。<br />
Universal Naming Convention(UNC) 的支持(win32)</p>

<p>UNC 形式的路径名 (//host/share)得到了支持。使用斜线(<code>/')，而并非反斜线(</code>\&lsquo;)。 (其实以前就支持的，难道是修正bug了？？)<br />
Dir.glob (win32)</p>

<p>以前，无法对当前目录(./)进行glob。</p>

<p>p Dir[&ldquo;./*.c&rdquo;]<br />
=&gt; []</p>

<p>1.6.2 -&gt; 1.6.3 (2001-03-19)</p>

<p>do .. end 和 { .. }</p>

<p>以前的版本认定二者的结合度相同，现在修正了这个bug。</p>

<p>在1.6.0到1.6.2之间的版本中，</p>

<p>method v { .. }<br />
method v do .. end</p>

<p>两者之间没有区别。正确的描述详见迭代器部分。<br />
Bignum#% 的计算错误</p>

<p>修正了导致 % 计算错误的bug</p>

<p>ruby-1.6.2 -ve &lsquo;p 6800000000%4000000000&rsquo;<br />
=&gt; ruby 1.6.2 (2000-12-25) [i586-linux]<br />
-1494967296</p>

<p>ruby-1.6.3 -ve &lsquo;p 6800000000%4000000000&rsquo;<br />
=&gt; ruby 1.6.3 (2001-03-10) [i586-linux]<br />
2800000000</p>

<p>特殊方法定义</p>

<p>与通常的方法定义一样，也可以指定rescue, ensure部分</p>

<p>obj = Object.new<br />
def obj.foo<br />
rescue<br />
ensure<br />
end</p>

<p>String#count<br />
String#delete<br />
String#squeeze<br />
String#tr_s</p>

<p>可以用&rsquo;\-&lsquo;来表示&rsquo;-&lsquo;(tr! 等、bang method也是一样的)。以前，只有字符串开头或末尾的&rsquo;-&lsquo;才会被看作是&rsquo;-&lsquo;。</p>

<p>p &ldquo;-&rdquo;.tr(&ldquo;a-z&rdquo;, &ldquo;+&rdquo;) # =&gt; &ldquo;-&rdquo;<br />
p &ldquo;-&rdquo;.tr(&ldquo;-az&rdquo;, &ldquo;+&rdquo;) # =&gt; &ldquo;+&rdquo;<br />
p &ldquo;-&rdquo;.tr(&ldquo;az-&rdquo;, &ldquo;+&rdquo;) # =&gt; &ldquo;+&rdquo;<br />
p &ldquo;-&rdquo;.tr(&lsquo;a\-z&rsquo;, &ldquo;+&rdquo;) # =&gt; &ldquo;+&rdquo; # 请注意单引号字符串<br />
p &ldquo;-&rdquo;.tr(&ldquo;a\\-z&rdquo;, &ldquo;+&rdquo;) # =&gt; &ldquo;+&rdquo; # 在&rdquo;&ldquo;中需要使用二个</p>

<p>Regexp#==</p>

<p>所有选项都相同的话，则被判定为相同。以前，只要汉字代码选项 和 /i (case-insensitive)相同，就被看作是相同。<br />
%q(), %w()</p>

<p>可以使用反斜线对字面值的末尾字符(`)&lsquo;等)进行转义。<br />
Dir.glob</p>

<p>&ldquo;**/&ldquo;无法找到符号连接了。<br />
String#[]</p>

<p>现在&rdquo;a&rdquo;[1,2]会返回&rdquo;&ldquo;。</p>

<p>p &ldquo;a&rdquo;[1,2]<br />
=&gt; &ldquo;&rdquo;</p>

<p>这是正确的结果。以前的老版本(1.4.6等)也都是对的。但1.6.0到1.6.2之间的版本则返回nil。</p>

<p>p &ldquo;a&rdquo;[2,1]返回nil。<br />
Object#taint</p>

<p>无法对freeze的对象进行taint操作</p>

<p>obj = Object.new.freeze<br />
obj.taint<br />
=&gt; -:2:in `taint&rsquo;: can&rsquo;t modify frozen object (TypeError)<br />
from -:2</p>

<p>ruby 1.7 特性</p>

<p>ruby version 1.7是开发版。将来可能会删除下列中的部分内容，也可能因为兼容性问题而对其进行修改。<br />
1.7.3 -&gt; 1.8.0 preview1 (2002-12-24)<br />
2002-12-20</p>

<p>profiler.rb [lib] [new]</p>

<p>新增。作为profile.rb的实体将其分离出来。<br />
rb_define_alloc_func() [api] [new]<br />
rb_undef_alloc_func() [api] [new]</p>

<p>新增。用在allocate方法的定义中。 [ruby-dev:19116]</p>

<p>2002-12-18</p>

<p>Regexp#=== [compat]</p>

<p>返回布尔值。</p>

<p>p(/foo/ === &ldquo;foo&rdquo;)</p>

<p>=&gt; ruby 1.6.8 (2002-12-24) [i586-linux]<br />
0<br />
=&gt; ruby 1.8.0 (2003-03-12) [i586-linux]<br />
true</p>

<p>2002-12-17</p>

<p>defined? [compat]</p>

<p>遇到对属性赋值或对数组元素进行赋值的情况时，返回&rdquo;assignment&rdquo;而非&rdquo;method&rdquo;。</p>

<p>class Foo<br />
attr_accessor :foo<br />
end<br />
p defined? Foo.new.foo = 1</p>

<p>ary = []<br />
p defined? ary[2] = 1</p>

<p>=&gt; ruby 1.6.8 (2002-12-24) [i586-linux]<br />
&ldquo;method&rdquo;<br />
&ldquo;method&rdquo;<br />
=&gt; ruby 1.8.0 (2003-03-12) [i586-linux]<br />
&ldquo;assignment&rdquo;<br />
&ldquo;assignment&rdquo;</p>

<p>2002-12-17</p>

<p>open-uri.rb [lib] [new]</p>

<p>新增</p>

<p>2002-12-14</p>

<p>WindowsCE [platform]</p>

<p>加入了WindowsCE的支持补丁。</p>

<p>2002-12-11</p>

<p>IO#read [compat]<br />
IO#sysread [compat]</p>

<p>向IO#read, IO#sysread新增了第二参数(指定了预先分配好的读入缓冲)</p>

<p>2002-12-10</p>

<p>Thread#terminate [new]</p>

<p>新增。与Thread#kill 相同。</p>

<p>2002-12-07</p>

<p>Process.abort [new]<br />
Process.exit [new]</p>

<p>新增。与abort, exit函数相同。</p>

<p>2002-12-06</p>

<p>Process::Status#pid [new]</p>

<p>新增</p>

<p>2002-12-04</p>

<p>Object#copy_object</p>

<p>改名了，原名为become。(此后，在1.8中又改名为initialize_copy)</p>

<p>2002-11-27</p>

<p>SystemExit#initialize [compat]</p>

<p>增加了参数。</p>

<p>ruby -e &lsquo;raise SystemExit.new(2)&rsquo;<br />
echo $?</p>

<h1 id="2">=&gt; 2</h1>

<p>2002-11-19</p>

<p>Array#transpose [new]</p>

<p>新增</p>

<p>p [[1,2,3],<br />
[4,5,6],<br />
[7,8,9]].transpose<br />
=&gt; ruby 1.7.3 (2002-12-11) [i586-linux]<br />
[[1, 4, 7], [2, 5, 8], [3, 6, 9]]</p>

<p>2002-11-08</p>

<p>[parser] [experimental]</p>

<p>试验性的修改。</p>

<p>a = 1<br />
p a / 5<br />
=&gt; ruby 1.6.8 (2002-12-24) [i586-linux]<br />
0<br />
=&gt; ruby 1.8.0 (2003-03-12) [i586-linux]<br />
0</p>

<p>a = 1<br />
p a /5<br />
=&gt; -:2: warning: ambiguous first argument; make sure<br />
-:2: unterminated regexp meets end of file<br />
ruby 1.6.8 (2002-12-24) [i586-linux]<br />
=&gt; ruby 1.8.0 (2003-03-12) [i586-linux]<br />
0</p>

<p>2002-11-02</p>

<p>Object#object_id [new]</p>

<p>新增 (Object#id是obsolete)</p>

<p>p Object.new.id</p>

<p>=&gt; ruby 1.6.7 (2002-03-01) [i586-linux]<br />
537730140<br />
=&gt; -:1: warning: Object#id will be deprecated; use Object#object_id<br />
ruby 1.7.3 (2002-12-04) [i586-linux]<br />
537723790</p>

<p>2002-11-02</p>

<p>Fixnum#to_sym [new]<br />
String#to_sym [new]</p>

<p>新增(取消了Symbol#intern)</p>

<p>2002-11-01</p>

<p>Array#zip [new]<br />
Enumerable#zip [new]</p>

<p>新增</p>

<p>p [1,2,3].zip([4,5,6], [7,8,9])</p>

<p>=&gt; ruby 1.7.3 (2002-12-11) [i586-linux]<br />
[[1, 4, 7], [2, 5, 8], [3, 6, 9]]</p>

<p>p [1,2,3].zip([4,5,6], [7,8,9]) {|v| p v}</p>

<p>=&gt; ruby 1.7.3 (2002-12-11) [i586-linux]<br />
[1, 4, 7]<br />
[2, 5, 8]<br />
[3, 6, 9]<br />
nil</p>

<p>2002-10-30</p>

<p>Module#private_method_defined? [new]<br />
Module#protected_method_defined? [new]<br />
Module#public_method_defined? [new]<br />
Object#methods [change]<br />
Module#instance_methods [change]</p>

<p>[ruby-dev:18606]</p>

<p>增加了Module#private_method_defined?，Module#protected_method_defined?，Module#public_method_defined?</p>

<p>修改了Object#methods, Module#instance_methods(为了与
Module#method_defined?和Module#instance_methods的关系 取得一致)</p>

<p>class Foo<br />
def public_m; end<br />
private<br />
def private_m; end<br />
protected<br />
def protected_m; end<br />
end</p>

<p>foo = Foo.new</p>

<p>m = %w(public_m private_m protected_m)</p>

<p>p m.collect {|_| Foo.method<em>defined?(</em>)}<br />
if Foo.respond_to? :public_method<em>defined?<br />
p m.collect {|</em>| Foo.public_method<em>defined?(</em>)}<br />
p m.collect {|_| Foo.private_method<em>defined?(</em>)}<br />
p m.collect {|_| Foo.protected_method<em>defined?(</em>)}<br />
end<br />
puts &lsquo;&mdash;&rsquo;<br />
p m.collect {|_| Foo.instance<em>methods.member?(</em>)}<br />
p m.collect {|_| Foo.public_instance<em>methods.member?(</em>)}<br />
p m.collect {|_| Foo.private_instance<em>methods.member?(</em>)}<br />
p m.collect {|_| Foo.protected_instance<em>methods.member?(</em>)}<br />
puts &lsquo;&mdash;&rsquo;<br />
p m.collect {|<em>| foo.methods.member?(</em>)}<br />
p m.collect {|_| foo.public<em>methods.member?(</em>)}<br />
p m.collect {|_| foo.private<em>methods.member?(</em>)}<br />
p m.collect {|_| foo.protected<em>methods.member?(</em>)}</p>

<p>=&gt; ruby 1.6.8 (2002-12-24) [i586-linux]<br />
[true, false, true]<br />
-&ndash;<br />
[true, false, false]<br />
[true, false, false]<br />
[false, true, false]<br />
[false, false, true]<br />
-&ndash;<br />
[true, false, false]<br />
[true, false, false]<br />
[false, true, false]<br />
[false, false, true]<br />
=&gt; ruby 1.8.0 (2003-03-09) [i586-linux]<br />
[true, false, true]<br />
[true, false, false]<br />
[false, true, false]<br />
[false, false, true]<br />
-&ndash;<br />
[true, false, true]<br />
[true, false, false]<br />
[false, true, false]<br />
[false, false, true]<br />
-&ndash;<br />
[true, false, true]<br />
[true, false, false]<br />
[false, true, false]<br />
[false, false, true]</p>

<p>2002-10-23</p>

<p>[parser] [new]</p>

<p>采用了符号的扩展表示法。[ruby-dev:18537]</p>

<p>p :&ldquo;foo#{&ldquo;bar&rdquo;}&rdquo;<br />
p :&lsquo;foo#{&ldquo;bar&rdquo;}&rsquo;<br />
p %s{foo#{&ldquo;bar&rdquo;}}</p>

<p>=&gt; ruby 1.7.3 (2002-11-14) [i586-linux]<br />
:foobar<br />
:&ldquo;foo\#{\&ldquo;bar\&ldquo;}&rdquo;<br />
:&ldquo;foo\#{\&ldquo;bar\&ldquo;}&rdquo;</p>

<p>2002-10-11</p>

<p>rescue修饰部分 [parser] [change]</p>

<p>修改了rescue修饰部分的优先级。好像是试验性的修改。 (在1.8版本中正式采用了这个修改)。因此</p>

<p>a = b rescue c</p>

<p>不会被解释成</p>

<p>(a = b) rescue c</p>

<p>而是被解释为</p>

<p>a = (b rescue c)</p>

<p>虽然与if修饰部分的优先级有所不同，但它有个好处：如果b发生异常时可以使用c的值。</p>

<h1 id="若在以前的版本-1-6-中执行下列代码时-则不会进行赋值">若在以前的版本(1.6)中执行下列代码时，则不会进行赋值</h1>

<h1 id="只是对变量进行了定义-结果是v等于nil">只是对变量进行了定义，结果是v等于nil。</h1>

<p>v = raise rescue true<br />
p v</p>

<p>=&gt; ruby 1.6.7 (2002-03-01) [i586-linux]<br />
nil<br />
=&gt; ruby 1.7.3 (2002-10-18) [i586-linux]<br />
true</p>

<p>2002-10-02</p>

<p>Object#type [obsolete]</p>

<p>使用它就会出现警告。请您使用Object#class来代替它。</p>

<p>p Object.new.type<br />
=&gt; -:1: warning: Object#type is deprecated; use Object#class<br />
ruby 1.7.3 (2002-10-08) [i586-linux]<br />
Object</p>

<p>2002-09-27</p>

<p>Class#inherited [change]</p>

<p>在类定义表达式的末尾才会调用inherited方法。 [ruby-bugs-ja:PR#342]</p>

<p>def Object.inherited&copy;<br />
p &ldquo;inherited!&rdquo;<br />
end<br />
class Foo<br />
p &ldquo;defining Foo&rdquo;<br />
end</p>

<p>=&gt; ruby 1.6.7 (2002-03-01) [i586-linux]<br />
&ldquo;inherited!&rdquo;<br />
&ldquo;defining Foo&rdquo;<br />
=&gt; ruby 1.7.3 (2002-10-04) [i586-linux]<br />
&ldquo;defining Foo&rdquo;<br />
&ldquo;inherited!&rdquo;</p>

<p>2002-09-26</p>

<p>[parser] [compat]</p>

<p>若在方法定义的外侧调用return的话，则会在运行时而非编译时引发错误。</p>

<p>p :doing<br />
return<br />
=&gt; -:2: return appeared outside of method<br />
ruby 1.6.7 (2002-03-01) [i586-linux]<br />
=&gt; ruby 1.7.3 (2002-10-04) [i586-linux]<br />
:doing<br />
-:2: unexpected return</p>

<p>2002-09-13</p>

<p>||= [bug]</p>

<p>以前，使用||=对未定义的变量进行赋值时，会在全局变量中出现警告。另外，在类变量中会引发错误。 [ruby-dev:18278]</p>

<p>local ||= 1<br />
@instance ||= 1<br />
$global ||= 1<br />
@@class ||= 1</p>

<p>=&gt; -:3: warning: global variable `$global&rsquo; not initialized<br />
-:4: uninitialized class variable @@class in Object (NameError)<br />
ruby 1.6.7 (2002-03-01) [i586-linux]<br />
=&gt; ruby 1.7.3 (2002-09-13) [i586-linux]</p>

<p>2002-09-11</p>

<p>Process.pid (win) [change]</p>

<p>在mswin32版和mingw32版中，ruby会在内部将进程ID变为正数。虽然在NT系列的OS中没有什么变化，但在Win9x系列的OS中，由OS控制的进程ID是负数，所以才将其变为正数。[ruby-
dev:18263]</p>

<p>2002-09-11</p>

<p>IO#read, gets &hellip;, etc. [bug]</p>

<p>在对File::NONBLOCK模式的IO进行读入操作时，如果发生EWOULDBLOCK的话，可能会导致读入数据丢失。 [ruby-dev:17855]</p>

<p>在使用Thread的程序中，如果从文件中读出数据并写入socket时，可能会在Socket#write中引发Errno::EINTR，但这种情况极少出现。[ruby-
dev:17878], [ruby-core:00444]</p>

<p>2002-09-05</p>

<p>Marshal.dump [marshal] [change]</p>

<p>无法对包含(include)了无名模块的对象进行dump。 [ruby-dev:18186]</p>

<p>class &lt;&lt; obj = Object.new<br />
include Module.new<br />
end<br />
Marshal.dump(obj)</p>

<p>=&gt; ruby 1.6.7 (2002-03-01) [i586-linux]<br />
=&gt; -:4:in `dump&rsquo;: can&rsquo;t dump anonymous class #<0x401a871c> (ArgumentError)<br />
from -:4<br />
ruby 1.7.3 (2002-09-06) [i586-linux]</p>

<p>可以dump包含(include)了有名模块的对象，此时模块的信息被保存到dump format之中。</p>

<p>module M<br />
def foo<br />
p :foo<br />
end<br />
end<br />
class &lt;&lt; obj = Object.new<br />
include M<br />
end<br />
p dump = Marshal.dump(obj)<br />
p obj2 = Marshal.load(dump)<br />
class &lt;&lt; obj2<br />
p included_modules<br />
end<br />
obj2.foo</p>

<p>=&gt; ruby 1.6.7 (2002-03-01) [i586-linux]<br />
&ldquo;\004\006o:\vObject\000&rdquo;<br />
#<0x401a9630><br />
[Kernel]<br />
-:14: undefined method `foo&rsquo; for #<0x401a9630> (NameError)<br />
=&gt; ruby 1.7.3 (2002-09-06) [i586-linux]<br />
&ldquo;\004\ae:\006Mo:\vObject\000&rdquo;<br />
#<0x401a821c><br />
[M, Kernel]<br />
:foo</p>

<p>因此将format version由4.7提升到4.8。 (2002-09-17)</p>

<p>2002-09-03</p>

<p>mkmf.rb, extmk.rb [lib] [compat]</p>

<p>开始着手合并extmk.rb和mkmf.rb。extmk.rb将会用到mkmf.rb。相应地对mkmf.rb也作出调整。[ruby-dev:18109]</p>

<p>2002-08-31</p>

<p>ruby interpreter [ruby] [change]</p>

<p>定义规定：类的特殊类的特殊类，就是特殊类本身[ruby-bugs-ja:PR#313]。不太明白(^^;</p>

<p>class &lt;&lt; Object<br />
p [self.id, self]<br />
class &lt;&lt; self<br />
p [self.id, self]<br />
end<br />
end<br />
=&gt; ruby 1.6.7 (2002-03-01) [i586-linux]<br />
[537771634, Class]<br />
[537742484, Class]<br />
=&gt; ruby 1.7.3 (2002-09-05) [i586-linux]<br />
[537771634, #]<br />
[537771634, #]</p>

<p>另外好像说，对象的特殊类的超类的特殊类 和 对象的特殊类的特殊类的超类是一回事儿[ruby-bugs-ja:PR#324]。更不明白了(^^;;</p>

<p>class &lt;&lt; Object.new<br />
class &lt;&lt; self.superclass<br />
p [self.id, self]<br />
end<br />
class &lt;&lt; self<br />
p [self.superclass.id, self.superclass]<br />
end<br />
end<br />
=&gt; ruby 1.6.7 (2002-03-01) [i586-linux]<br />
[537771634, Class]<br />
[537771644, Class]<br />
=&gt; ruby 1.7.3 (2002-09-05) [i586-linux]<br />
[537771634, #]<br />
[537771634, #]</p>

<p>[ruby-bugs-ja:PR#336]中好像还有些变化 (请参考2002-09-21的ChangeLog。)</p>

<p>2002-08-30</p>

<p>set.rb [lib] [new]</p>

<p>新增</p>

<p>2002-08-27</p>

<p>Object#become</p>

<p>新增(后来改名为copy_object。再后来又改名为initialize_copy)</p>

<p>ary = [1,2,3]<br />
p ary, ary.id<br />
ary.become [3,2,1]<br />
p ary, ary.id</p>

<p>=&gt; ruby 1.7.3 (2002-08-30) [i586-linux]<br />
[1, 2, 3]<br />
537743354<br />
[3, 2, 1]<br />
537743354</p>

<p>ary = [1,2,3]<br />
p ary, ary.id<br />
ary.replace [3,2,1]<br />
p ary, ary.id<br />
=&gt; ruby 1.7.3 (2002-08-30) [i586-linux]<br />
[1, 2, 3]<br />
537743354<br />
[3, 2, 1]<br />
537743354</p>

<p>obj = Object.new<br />
p obj, obj.id<br />
obj.become Object.new<br />
p obj, obj.id<br />
=&gt; ruby 1.7.3 (2002-08-30) [i586-linux]<br />
#<0x401a9ff4><br />
537743354<br />
#<0x401a9ff4><br />
537743354</p>

<p>2002-08-23</p>

<p>ruby interpreter (win32, MinGW) [ruby] [change]</p>

<p>保证了mswin32版ruby 和
MinGW版ruby中的扩展库的兼容性。分别把Config::CONFIG[&lsquo;RUBY_SO_NAME&rsquo;]变更为msvcrt-
rubyXX(成为DLL名)，把Config::CONFIG<a href="扩展库所在地的路径元素">&lsquo;sitearch&rsquo;</a>变更为&rdquo;i386-msvcrt&rdquo;。
[ruby-dev:17144], [ruby-dev:18047]</p>

<p>在这次修改中，新增了sitearch(在其他环境中，则与CONFIG[&lsquo;arch&rsquo;]相同)</p>

<p>另外请参考Win32 native版的脚注</p>

<p>2002-08-20</p>

<p>IO#putc [compat]</p>

<p>在各输出方法中，只有putc不使用write方法。 [ruby-dev:18038]</p>

<p>class &lt;&lt; foo = STDOUT.dup<br />
def write(s)<br />
p &ldquo;foo&rdquo;<br />
end<br />
end</p>

<p>foo.putc(&ldquo;bar&rdquo;)<br />
puts<br />
=&gt; ruby 1.6.7 (2002-03-01) [i586-linux]<br />
b<br />
=&gt; ruby 1.7.3 (2002-09-05) [i586-linux]<br />
&ldquo;foo&rdquo;</p>

<p>2002-08-13</p>

<p>Hash#default_proc [new]</p>

<p>新增 [ruby-dev:17966]</p>

<p>2002-08-11</p>

<p>Proc#to_s [compat]</p>

<p>在Proc#to_s 的结果中新增了脚本的源文件名和行号。[ruby-dev:17968]</p>

<p>p Proc.new {<br />
2<br />
3<br />
}.to_s<br />
=&gt; -:2: warning: useless use of a literal in void context<br />
ruby 1.6.7 (2002-03-01) [i586-linux]<br />
&rdquo;#<0x401ab8b8>&rdquo;<br />
=&gt; -:2: warning: useless use of a literal in void context<br />
ruby 1.7.3 (2002-09-05) [i586-linux]<br />
&rdquo;#<0x0x401a87d0>&ldquo;</p>

<p>2002-08-01</p>

<p>Enumerable#find [change]</p>

<p>不能将字符串指定给参数了。</p>

<p>[1,2,3].find(&ldquo;p :nothing&rdquo;) {|v| v &gt; 5}</p>

<p>=&gt; ruby 1.6.7 (2002-03-01) [i586-linux]<br />
:nothing</p>

<p>=&gt; -:1:in <code>find': undefined method</code>call&rsquo; for &ldquo;p :nothing&rdquo;:String
(NoMethodError)<br />
from -:1<br />
ruby 1.7.2 (2002-08-01) [i586-linux]</p>

<p>另外，若没有找到元素的话，就返回ifnone 的结果。</p>

<p>p [1,2,3].find(proc {:nothing}) {|v| v &gt; 5}<br />
=&gt; ruby 1.6.7 (2002-03-01) [i586-linux]<br />
nil<br />
=&gt; ruby 1.7.2 (2002-08-01) [i586-linux]<br />
:nothing</p>

<p>2002-07-27</p>

<p>Numeric#to_int [new]<br />
Float#to_int [new]</p>

<p>新增。</p>

<p>2002-07-26</p>

<p>rand [compat]</p>

<p>在生成随机数的算法中使用了Mersenne Twister。</p>

<p>2002-07-24</p>

<p>[parser] [compat]</p>

<p>允许对方法定义进行嵌套。</p>

<p>def func1<br />
def func2<br />
p :func2<br />
end<br />
end<br />
func1<br />
func2</p>

<p>=&gt; -:2: nested method definition<br />
ruby 1.6.7 (2002-03-01) [i586-linux]<br />
=&gt; ruby 1.7.3 (2002-09-05) [i586-linux]<br />
:func2</p>

<p>允许在方法定义中出现alias, undef。</p>

<p>def bar<br />
end<br />
def foo<br />
p :foo<br />
undef bar<br />
end</p>

<p>foo</p>

<p>def bar<br />
p :bar<br />
alias foo bar<br />
end</p>

<p>bar<br />
foo<br />
=&gt; -:5: undef within method<br />
-:12: alias within method<br />
ruby 1.6.7 (2002-03-01) [i586-linux]<br />
=&gt; ruby 1.7.3 (2002-09-05) [i586-linux]<br />
:foo<br />
-:10: warning: method redefined; discarding old bar<br />
-:10: warning: overriding global function `bar&rsquo;<br />
:bar<br />
:bar</p>

<p>在方法定义外侧调用super时，将会在运行时而不是编译时引发错误。</p>

<p>p 1<br />
super<br />
=&gt; -:2: super called outside of method<br />
ruby 1.6.7 (2002-03-01) [i586-linux]<br />
=&gt; ruby 1.7.3 (2002-09-05) [i586-linux]<br />
1<br />
-:2: super called outside of method (NoMethodError)</p>

<p>也许[ruby-dev:16969]中给出了变更的理由。[ruby-dev:17882]</p>

<p>2002-07-19</p>

<p>数值字面值 [compat]</p>

<p>新增了10进制整数字面值的0d前缀。</p>

<p>p 0d10<br />
=&gt; ruby 1.7.3 (2002-09-04) [i586-linux]<br />
10</p>

<p>p 0d10.1<br />
=&gt; -:1: parse error<br />
ruby 1.7.3 (2002-09-04) [i586-linux]</p>

<p>允许使用</p>

        </div>

        


        

<div class="post-archive">
    <h2>See Also</h2>
    <ul class="listing">
        
        <li><a href="/posts/001rubyruby%E4%B8%AD%E5%85%A8%E5%B1%80%E5%8F%98%E9%87%8F%E5%AE%9E%E4%BE%8B%E5%8F%98%E9%87%8F%E5%B1%80%E9%83%A8%E5%8F%98%E9%87%8F%E7%B1%BB%E5%8F%98%E9%87%8Fsymbol%E5%AF%B9%E6%AF%94/">001rubyRuby中全局变量实例变量局部变量类变量Symbol对比</a></li>
        
        <li><a href="/posts/051rubyonrails%E5%AD%B8%E7%BF%92%E7%AD%86%E8%A8%981hellorails/">051RubyonRails學習筆記1Hellorails</a></li>
        
        <li><a href="/posts/053rubyonrails%E5%AD%B8%E7%BF%92%E7%AD%86%E8%A8%986%E9%87%8D%E6%A7%8B%E5%88%AA%E9%99%A4%E7%95%99%E8%A8%80%E5%AE%89%E5%85%A8/">053RubyonRails學習筆記6重構刪除留言安全</a></li>
        
        <li><a href="/posts/055rubyonrails%E5%AD%B8%E7%BF%92%E7%AD%86%E8%A8%987carrierwaveimplementation/">055RubyonRails學習筆記7CarrierwaveImplementation</a></li>
        
        <li><a href="/posts/065rubyonrails%E7%AD%86%E8%A8%9810showtargetinfoongooglemaps/">065Rubyonrails筆記10showtargetinfoongooglemaps</a></li>
        
    </ul>
</div>


        <div class="post-meta meta-tags">
            
            <ul class="clearfix">
                
                <li><a href='https://zaina.newban.cn/tags/ruby'>ruby</a></li>
                
            </ul>
            
        </div>
    </article>
    
    

    
    
</div>

                    <footer id="footer">
    <div>
        &copy; 2020 <a href="https://zaina.newban.cn">开发者问答集锦 By </a>
        
    </div>
    <br />
    <div>
        <div class="github-badge">
            <a href="https://gohugo.io/" target="_black" rel="nofollow"><span class="badge-subject">Powered by</span><span class="badge-value bg-blue">Hugo</span></a>
        </div>
        <div class="github-badge">
            <a href="https://www.flysnow.org/" target="_black"><span class="badge-subject">Design by</span><span class="badge-value bg-brightgreen">飞雪无情</span></a>
        </div>
        <div class="github-badge">
            <a href="https://github.com/flysnow-org/maupassant-hugo" target="_black"><span class="badge-subject">Theme</span><span class="badge-value bg-yellowgreen">Maupassant</span></a>
        </div>
    </div>
</footer>


    
    <script type="text/javascript">
        window.MathJax = {
            tex2jax: {
                inlineMath: [['$', '$']],
                processEscapes: true
                }
            };
    </script>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML' async></script>

<a id="rocket" href="#top"></a>
<script type="text/javascript" src='/js/totop.js?v=0.0.0' async=""></script>



    <script type="text/javascript" src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script>




                </div>

                <div id="secondary">
    <section class="widget">
        <form id="search" action='https://zaina.newban.cn/search/' method="get" accept-charset="utf-8" target="_blank" _lpchecked="1">
      
      <input type="text" name="q" maxlength="20" placeholder="Search">
      <input type="hidden" name="sitesearch" value="https://zaina.newban.cn">
      <button type="submit" class="submit icon-search"></button>
</form>
    </section>
    
    <section class="widget">
        <h3 class="widget-title">最近文章</h3>
<ul class="widget-list">
    
    <li>
        <a href="https://zaina.newban.cn/posts/001rubyruby%E4%B8%AD%E5%85%A8%E5%B1%80%E5%8F%98%E9%87%8F%E5%AE%9E%E4%BE%8B%E5%8F%98%E9%87%8F%E5%B1%80%E9%83%A8%E5%8F%98%E9%87%8F%E7%B1%BB%E5%8F%98%E9%87%8Fsymbol%E5%AF%B9%E6%AF%94/" title="001rubyRuby中全局变量实例变量局部变量类变量Symbol对比">001rubyRuby中全局变量实例变量局部变量类变量Symbol对比</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/007hadoop%E9%9B%86%E7%BE%A4%E9%85%8D%E7%BD%AEhadoop%E9%9B%86%E7%BE%A4%E7%9A%84%E5%90%AF%E5%8A%A8%E5%92%8C%E6%B5%8B%E8%AF%95ssh%E5%85%8D%E7%99%BB%E9%99%86%E9%85%8D%E7%BD%AEstartallshhdfs%E5%B8%B8%E7%94%A8%E7%9A%84shell/" title="007Hadoop集群配置Hadoop集群的启动和测试SSH免登陆配置startallshhdfs常用的shell">007Hadoop集群配置Hadoop集群的启动和测试SSH免登陆配置startallshhdfs常用的shell</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/009shell%E8%84%9A%E6%9C%AC%E4%B8%8B%E6%9D%A1%E4%BB%B6%E6%B5%8B%E8%AF%95eqne/" title="009Shell脚本下条件测试eqne">009Shell脚本下条件测试eqne</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/00pythonmanagepyshell%E5%92%8Cpython%E7%9A%84%E5%88%86%E6%9E%90/" title="00Pythonmanagepyshell和Python的分析">00Pythonmanagepyshell和Python的分析</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/010zookeeper%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5zookeeper%E7%9A%84%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BAzookeeper%E7%9A%84shell%E5%91%BD%E4%BB%A4/" title="010Zookeeper的基本概念Zookeeper的集群搭建Zookeeper的shell命令">010Zookeeper的基本概念Zookeeper的集群搭建Zookeeper的shell命令</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/018dockerfileshell/" title="018DockerfileSHELL">018DockerfileSHELL</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/01shell%E5%85%A5%E9%97%A801bashshell%E7%89%B9%E6%80%A7/" title="01Shell入门01bashShell特性">01Shell入门01bashShell特性</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/01shell%E5%8F%98%E9%87%8F/" title="01Shell变量">01Shell变量</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/01shell%E5%9F%BA%E7%A1%80%E6%A6%82%E8%BF%B0%E8%84%9A%E6%9C%AC%E6%89%A7%E8%A1%8C%E6%96%B9%E5%BC%8Fbash%E5%9F%BA%E6%9C%AC%E5%8A%9F%E8%83%BD/" title="01Shell基础概述脚本执行方式Bash基本功能">01Shell基础概述脚本执行方式Bash基本功能</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/01shell%E7%BC%96%E7%A8%8Bhelloworld/" title="01shell编程helloworld">01shell编程helloworld</a>
    </li>
    
</ul>
    </section>

    

    <section class="widget">
        <h3 class="widget-title"><a href="/categories">分类</a></h3>
<ul class="widget-list">
    
</ul>
    </section>

    <section class="widget">
        <h3 class="widget-title"><a href="/tags">标签</a></h3>
<div class="tagcloud">
    
    <a href="https://zaina.newban.cn/tags/ruby/">ruby</a>
    
    <a href="https://zaina.newban.cn/tags/shell/">shell</a>
    
</div>
    </section>

    

    <section class="widget">
        <h3 class="widget-title">其它</h3>
        <ul class="widget-list">
            <li><a href="https://zaina.newban.cn/index.xml">文章 RSS</a></li>
        </ul>
    </section>
</div>
            </div>
        </div>
    </div>
</body>

</html>