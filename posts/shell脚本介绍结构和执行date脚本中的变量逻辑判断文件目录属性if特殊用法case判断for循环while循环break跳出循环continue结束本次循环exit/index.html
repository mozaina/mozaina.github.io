<!doctype html>
<html lang="en-us">
<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">


    <title>shell脚本介绍结构和执行date脚本中的变量逻辑判断文件目录属性if特殊用法case判断for循环while循环break跳出循环continue结束本次循环exit | 开发者问答集锦</title>
    <meta property="og:title" content="shell脚本介绍结构和执行date脚本中的变量逻辑判断文件目录属性if特殊用法case判断for循环while循环break跳出循环continue结束本次循环exit - 开发者问答集锦">
    <meta property="og:type" content="article">
        
    <meta property="article:published_time" content='2020-09-02T00:00:00&#43;08:00'>
        
        
    <meta property="article:modified_time" content='2020-09-02T00:00:00&#43;08:00'>
        
    <meta name="Keywords" content="">
    <meta name="description" content="shell脚本介绍结构和执行date脚本中的变量逻辑判断文件目录属性if特殊用法case判断for循环while循环break跳出循环continue结束本次循环exit">
        
    <meta name="author" content="">
    <meta property="og:url" content="https://zaina.newban.cn/posts/shell%E8%84%9A%E6%9C%AC%E4%BB%8B%E7%BB%8D%E7%BB%93%E6%9E%84%E5%92%8C%E6%89%A7%E8%A1%8Cdate%E8%84%9A%E6%9C%AC%E4%B8%AD%E7%9A%84%E5%8F%98%E9%87%8F%E9%80%BB%E8%BE%91%E5%88%A4%E6%96%AD%E6%96%87%E4%BB%B6%E7%9B%AE%E5%BD%95%E5%B1%9E%E6%80%A7if%E7%89%B9%E6%AE%8A%E7%94%A8%E6%B3%95case%E5%88%A4%E6%96%ADfor%E5%BE%AA%E7%8E%AFwhile%E5%BE%AA%E7%8E%AFbreak%E8%B7%B3%E5%87%BA%E5%BE%AA%E7%8E%AFcontinue%E7%BB%93%E6%9D%9F%E6%9C%AC%E6%AC%A1%E5%BE%AA%E7%8E%AFexit/">
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">

    <link rel="stylesheet" href='/css/normalize.css'>
    <link rel="stylesheet" href='/css/style.css'>
    <script type="text/javascript" src="//cdn.bootcdn.net/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

    
    
    
    
    
    
</head>


<body>
    <header id="header" class="clearfix">
    <div class="container">
        <div class="col-group">
            <div class="site-name ">
                
                    <a id="logo" href="https://zaina.newban.cn">
                        开发者问答集锦
                    </a>
                
                
            </div>
            <div>
                <nav id="nav-menu" class="clearfix">
                    <a class="" href="https://zaina.newban.cn">首页</a>
                    
                </nav>
            </div>
        </div>
    </div>
</header>

    <div id="body">
        <div class="container">
            <div class="col-group">

                <div class="col-8" id="main">
                    
<div class="res-cons">
    
    <article class="post">
        <header>
            <h1 class="post-title">shell脚本介绍结构和执行date脚本中的变量逻辑判断文件目录属性if特殊用法case判断for循环while循环break跳出循环continue结束本次循环exit</h1>
        </header>
        <date class="post-meta meta-date">
            2020年9月2日
        </date>
        
        
        <div class="post-meta">
            <span id="busuanzi_container_page_pv">|<span id="busuanzi_value_page_pv"></span><span>
                    阅读</span></span>
        </div>
        
        
        <div class="post-content">
            <p><strong>shell脚本介绍</strong></p>

<ul>
<li>shell是一种脚本语言 和传统的开发语言比较，会比较简单</li>
<li>shell有自己的语法；可以使用逻辑判断、循环等语法</li>
<li>可以自定义函数，目的就是为了减少重复的代码</li>
<li>shell是系统命令的集合</li>
<li>shell脚本可以实现自动化运维，能大大增加我们的运维效率</li>
</ul>

<p><strong>shell脚本结构和执行</strong></p>

<ul>
<li>开头需要加#!/bin/bash</li>
<li>以#开头的行作为解释说明</li>
<li>脚本的名字以.sh结尾，用于区分这是一个shell脚本</li>
<li>执行方法有两种</li>
<li>chmod +x 1.sh; ./1.sh</li>
<li>bash 1.sh</li>
<li>查看脚本执行过程 bash -x 1.sh</li>
<li>查看脚本是否语法错误 bash -n 1.sh</li>
</ul>

<p><strong>实践操作：</strong></p>

<ul>
<li>创建一个shell文件夹，并切入到文件夹中</li>
</ul>

<blockquote>
<pre><code>[root@aminglinux ~]# mkdir shell
[root@aminglinux ~]# cd shell/
[root@aminglinux shell]#
</code></pre>
</blockquote>

<ul>
<li>写shell脚本：#! /bin/bash //第一行必须这么写，固定格式，作用就是脚本若是在当台机器上去执行，可以不加这一行也没关系，因为它知道下面若干条的命令能在这台机器上去执行，去解析</li>
</ul>

<blockquote>
<pre><code>[root@aminglinux shell]# vi 1.sh
#!/bin/bash
echo &quot;abc&quot;
w
ls
</code></pre>
</blockquote>

<ul>
<li>执行脚本——&gt;sh 01.sh</li>
</ul>

<blockquote>
<pre><code>[root@aminglinux shell]# sh 1.sh
abc
 15:17:34 up  5:30,  1 user,  load average: 0.00, 0.01, 0.05
USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT
root     pts/0    192.168.222.1    09:48    6.00s  0.12s  0.05s w
1.sh
</code></pre>
</blockquote>

<ul>
<li>在当前终端里，把01.sh中的#! /bin/bash 去掉后在执行脚本，会看到得到的结果相同，不会出现任何的问题，这就说明这台机器是能识别里面一条一条的命令的，去运行这里面的命令；但若是换一台机器，就不一定能执行了</li>
<li>在第一行，文件头指定 #!/bin/bash ，接下来要运行的命令是通过哪一个解释器来操作的，通常都是 /bin/bash 解释器来执行的</li>
<li>给01.sh文件一个执行权限</li>
</ul>

<blockquote>
<pre><code>[root@aminglinux shell]# chmod a+x 1.sh
</code></pre>
</blockquote>

<ul>
<li>执行shell脚本 ./01.sh 能这样执行，说明这些命令被解析了，被/bin/bash认识了</li>
</ul>

<blockquote>
<pre><code>[root@aminglinux shell]# ./1.sh
abc
 15:21:19 up  5:33,  1 user,  load average: 0.08, 0.03, 0.05
USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT
root     pts/0    192.168.222.1    09:48    7.00s  0.10s  0.00s w
1.sh
</code></pre>
</blockquote>

<ul>
<li>/bin/bash也是一条命令， /bin/bash 和 /bin/sh 是同一个文件</li>
</ul>

<blockquote>
<pre><code>[root@aminglinux shell]# ll /bin/bash
-rwxr-xr-x. 1 root root 960472 8月   3 2017 /bin/bash
[root@aminglinux shell]# ll /bin/sh
lrwxrwxrwx. 1 root root 4 6月  10 04:03 /bin/sh -&gt; bash
</code></pre>
</blockquote>

<ul>
<li>1.sh文件内容就是被/bin/bash所解析的；若没有 /bin/bash ，可以使用 /bin/bash 1.sh去执行</li>
</ul>

<blockquote>
<pre><code>[root@aminglinux shell]# /bin/bash 1.sh
abc
 15:26:49 up  5:39,  1 user,  load average: 0.00, 0.01, 0.05
USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT
root     pts/0    192.168.222.1    09:48    1.00s  0.12s  0.01s w
1.sh
</code></pre>
</blockquote>

<ul>
<li>若是在shell脚本中在写入第二遍 #号开头的行， 就表示解释说明的作用</li>
<li>脚本的一般都是以.sh结尾，是为了区分这是一个shell脚本，否则需要打开这个文件，才知道是shell脚本</li>
</ul>

<p><strong>运行shell脚本有两种方法</strong></p>

<ul>
<li>一种是sh 01.sh运行shell脚本</li>
<li>另一种方法:</li>
</ul>

<ol>
<li>先 chmod a+x 1.sh 给文件加一个执行权限</li>
<li>再 ./1.sh 去执行</li>
</ol>

<ul>
<li>这里的 ./ 就相当于一个相对路径，相对当前一个路径</li>
<li>也可以使用绝对路径去执行脚本 /root/shell/01.sh ，其实就是找到这个文件去执行</li>
</ul>

<blockquote>
<pre><code>[root@aminglinux shell]# /root/shell/1.sh
abc
 15:29:52 up  5:42,  1 user,  load average: 0.16, 0.05, 0.06
USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT
root     pts/0    192.168.222.1    09:48    0.00s  0.13s  0.00s w
1.sh
</code></pre>
</blockquote>

<ul>
<li>查看脚本执行过程 sh -x 1.sh 或者bash -x 1.sh</li>
</ul>

<ol>
<li>-x，就是显示脚本执行的过程</li>
<li>每一个加号，表示一个操作步骤</li>
</ol>

<blockquote>
<pre><code>[root@aminglinux shell]# sh -x 1.sh
+ echo abc
abc
+ w
 15:32:10 up  5:44,  1 user,  load average: 0.02, 0.03, 0.05
USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT
root     pts/0    192.168.222.1    09:48    2.00s  0.14s  0.01s w
+ ls
1.sh
</code></pre>
</blockquote>

<ul>
<li>查看脚本是否有错误 sh -n 1.sh</li>
</ul>

<ol>
<li>若是没有任何的输出，那么脚本则没有错误</li>
<li>sh -n 1.sh命令是检测是否存在语法错误</li>
</ol>

<blockquote>
<pre><code>[root@aminglinux shell]# sh -n 1.sh
</code></pre>
</blockquote>

<p><strong>date命令用法</strong></p>

<ul>
<li>date +%Y-%m-%d, date +%y-%m-%d 年月日</li>
<li>date +%H:%M:%S = date +%T 时间</li>
<li>date +%s 时间戳</li>
<li>date -d @1504620492</li>
<li>date -d &ldquo;+1day&rdquo; 一天后</li>
<li>date -d &ldquo;-1 day&rdquo; 一天前</li>
<li>date -d &ldquo;-1 month&rdquo; 一月前</li>
<li>date -d &ldquo;-1 min&rdquo; 一分钟前</li>
<li>date +%w, date +%W 星期</li>
</ul>

<p><strong>date命令用法实践</strong></p>

<ul>
<li>date命令，会显示当前系统时间日期</li>
</ul>

<blockquote>
<pre><code>[root@aminglinux ~]# date
2018年 07月 29日 星期日 15:44:05 CST
</code></pre>
</blockquote>

<ul>
<li>date命令，在shell中用处非常大；对文件后缀增加一个时间，以便后期管理。</li>
</ul>

<p>LANG=en //date命令显示的时间就是英文的 LANG=zh_CN.UTF-8 //date命令显示的时间是中文的</p>

<ul>
<li>date +%Y-%m-%d, date +%y-%m-%d 年月日</li>
</ul>

<blockquote>
<pre><code>[root@aminglinux ~]#  LANG=en     切换为英文显示
[root@aminglinux ~]#  date
Wed Jul 11 23:01:05 CST 2018
[root@aminglinux ~]#  date +%Y
2018      四位的年
[root@aminglinux ~]#  date +%y
18                两位的年
[root@aminglinux ~]#  date +%m
07                月份
[root@aminglinux ~]#  date +%M
51                分钟
[root@aminglinux ~]#  date +%d
29        日期
[root@aminglinux ~]#  date +%D
07/29/18  直接标记年月日，不过格式比较特殊
[root@aminglinux ~]#  date +%Y%m%d
20180729  年月日
[root@aminglinux ~]#  date +%F
2018-07-29        年月日，这种带横杠的
</code></pre>
</blockquote>

<ul>
<li>常见时间单位</li>
</ul>

<blockquote>
<pre><code>[root@aminglinux ~]#  date +%w
0         表示周几
[root@aminglinux ~]#  date +%W
30                今年的第几周，今年的第28周
[root@aminglinux ~]#  date +%h
Jul               英文的月份
[root@aminglinux ~]#  date +%H
15                        小时
[root@aminglinux ~]#  date +%S
26                        秒
[root@aminglinux ~]#  date +%s
1532850869        这是一个时间戳，距离1970总共过去多少秒
</code></pre>
</blockquote>

<ul>
<li>时间其他标记方法：date +%H:%M:%S = date +%T 时间</li>
</ul>

<blockquote>
<pre><code>[root@aminglinux ~]# date +%T
15:56:18
[root@aminglinux ~]# date +%H:%M:%S
15:56:39
</code></pre>
</blockquote>

<ul>
<li>显示日历 cal命令，查看到日期</li>
</ul>

<blockquote>
<pre><code>[root@aminglinux ~]# cal
      July 2018  
Su Mo Tu We Th Fr Sa
 1  2  3  4  5  6  7
 8  9 10 11 12 13 14
15 16 17 18 19 20 21
22 23 24 25 26 27 28
29 30 31
</code></pre>
</blockquote>

<ul>
<li>标记之前的日期</li>
<li>比如：在做nginx日志切割的时候，到了凌晨切割日志，到了零点零分切割的日志是前一天的日志。所以把日志加一个时间标记的话，应标记为昨天的日期</li>
</ul>

<p><strong>学会用date标记之前的日期</strong></p>

<ul>
<li>day、month、year、hour、min后面可以加 s 可以不加 s</li>
<li>减号- 表示之前的日期，加号 + 表示从今往后的日期</li>
<li>date -d &ldquo;-1 day&rdquo; +%F 显示前一天的日期</li>
<li>date -d &ldquo;-1 month&rdquo; +%F 显示上个月的日期</li>
<li>date -d &ldquo;-1 years&rdquo; +%F 显示上一年的日期</li>
<li>date -d &ldquo;+1 hour&rdquo; +%T 显示下一小时</li>
<li>date -d &ldquo;+1 min&rdquo; +%T 显示下一分钟</li>
</ul>

<blockquote>
<pre><code>[root@aminglinux ~]# date -d &quot;-1 day&quot;
Sat Jul 28 16:01:23 CST 2018
[root@aminglinux ~]# date -d &quot;-1 day&quot; +%F
2018-07-28
[root@aminglinux ~]# date -d &quot;-1 month&quot; +%F
2018-06-29
[root@aminglinux ~]# date -d &quot;-1 year&quot; +%F
2017-07-29
[root@aminglinux ~]# date -d &quot;+1 hour&quot; +%T
17:02:53
[root@aminglinux ~]# date -d &quot;+1 min&quot; +%T
16:04:02
</code></pre>
</blockquote>

<ul>
<li>时间戳 date +%s</li>
<li>另一种表现方法，表示时间戳</li>
<li>date -d @1532850869就是@后跟时间戳</li>
</ul>

<blockquote>
<pre><code>[root@aminglinux ~]# date +%s
1532851512
[root@aminglinux ~]# date -d @1532851512
Sun Jul 29 16:05:12 CST 2018
</code></pre>
</blockquote>

<ul>
<li>若想在linux系统中，把具体的日期换算成时间戳的时候，可以使用date +%s -d &ldquo;2018-07-29 16:08:00&rdquo;</li>
</ul>

<blockquote>
<pre><code>[root@aminglinux ~]# date +%s -d &quot;2018-07-29 16:08:00&quot;
1532851680
[root@aminglinux ~]# date -d @1532851680
Sun Jul 29 16:08:00 CST 2018
</code></pre>
</blockquote>

<p><strong>shell脚本中的变量</strong></p>

<ul>
<li><p>shell脚本中的变量：是某个字符串使用频繁，或者字符串长度长，可以使用变量才代替，提高代码编写的效率。</p></li>

<li><p>在条件语句中常使用到变量：</p></li>
</ul>

<blockquote>
<pre><code>if [$a -gt 10];then 语句; fi  //a就是变量
</code></pre>
</blockquote>

<ul>
<li>引用命令结果时用变量：</li>
</ul>

<blockquote>
<pre><code>n='wc -l 1.txt' //wc统计行数命令的结果，赋值给变量n
</code></pre>
</blockquote>

<ul>
<li>用户交互脚本中，使用变量：</li>
</ul>

<blockquote>
<pre><code>read -p &quot;input a number : &quot; n; echo $n   //把输入的数值，赋值给变量n
</code></pre>
</blockquote>

<ul>
<li>系统的内置变量：</li>
</ul>

<blockquote>
<pre><code>$0,$1,$2,$3等   //$0表示脚本本身，$1、$2代表命令的第1个参数、第2个参数，如此类推。$#代表参数个数
</code></pre>
</blockquote>

<ul>
<li>数序运算中使用变量：</li>
</ul>

<blockquote>
<pre><code>a=1
b=2
c=$(($a+$b))  //c=$[$a+$b] 这种写法也行
</code></pre>
</blockquote>

<p><strong>shell脚本中的逻辑判断</strong></p>

<ul>
<li>格式1：if 条件 ; then 语句; fi</li>
<li>格式2：if 条件; then 语句; else 语句; fi</li>
<li>格式3：if …; then … ;elif …; then …; else …; fi</li>
<li>逻辑判断表达式：if [ $a -gt $b ]; if [ $a -lt 5 ]; if [ $b -eq 10 ]等 -gt (&gt;); -lt(=); -le(&lt;=);-eq(==); -ne(!=) 注意到处都是空格</li>
<li>可以使用 &amp;&amp; || 结合多个条件</li>
<li>if [ $a -gt 5 ] &amp;&amp; [ $a -lt 10 ]; then</li>
<li>if [ $b -gt 5 ] || [ $b -lt 3 ]; then</li>
</ul>

<p><strong>shell脚本中的逻辑判断实战</strong></p>

<ul>
<li>for语句循环 ：for 变量 in 条件(值范围); do 语句 ;done</li>
</ul>

<blockquote>
<pre><code>[root@aminglinux ~]# for i in `seq 1 5`;do echo $i;done
1
2
3
4
5
[root@aminglinux ~]# for i in `seq 1 5`
&gt; do
&gt; echo $i
&gt; done
1
2
3
4
5
</code></pre>
</blockquote>

<ul>
<li>if语句格式1：if 条件 ; then 语句; fi //如果条件满足，输出ok</li>
</ul>

<blockquote>
<pre><code>[root@aminglinux shell]# vim if1.sh
#!/bin/bash
a=5
if [ $a -gt 3 ]
then
    echo OK
fi
[root@aminglinux shell]# sh if1.sh
OK
</code></pre>
</blockquote>

<ul>
<li>if语句格式2：if 条件; then 语句; else 语句; fi //如果条件满足，输出ok,如果条件不满足，输出nook</li>
</ul>

<blockquote>
<pre><code>[root@aminglinux shell]# cp if1.sh if2.sh
[root@aminglinux shell]# vim if2.sh
a=1
if [ $a -gt 3 ]
then
  echo OK
else
  echo nook
fi
[root@aminglinux shell]# sh -x if2.sh
+ a=1
+ '[' 1 -gt 3 ']'
+ echo nook
nook
</code></pre>
</blockquote>

<ul>
<li>if语句格式3：if …; then … ;elif …; then …; else …; fi //如果不满足条件1，满足条件2，输出条件2,不满足则输出nook，</li>
</ul>

<blockquote>
<pre><code>[root@aminglinux shell]# vim if3.sh
[root@aminglinux shell]# cat if3.sh
#! /bin/bash
a=6
if  [ $a -lt 5 ]
then
  echo &quot;a&lt;5&quot;
elif [ $a -gt 5 ] &amp;&amp; [ $a -lt 9 ]
then
  echo &quot;59&quot;
fi
[root@aminglinux shell]# sh -x if3.sh
+ a=6
+ '[' 6 -lt 5 ']'
+ '[' 6 -gt 5 ']'
+ '[' 6 -lt 9 ']'
+ echo '5
</code></pre>
</blockquote>

<p><strong>逻辑判断表达式</strong></p>

<ul>
<li>if [ $a -gt $b ] 表示，大于</li>
<li>if [ $a -lt 5 ] 表示，小于</li>
<li>if [ $b -eq 10 ] 表示，等于10</li>
<li>-ne(!=) 表示，不等于</li>
<li>-ge(&gt;=) 表示，大于等于</li>
<li>-le(&lt;=) 表示，小于等于</li>
</ul>

<p><strong>可以使用 &amp;&amp; || 结合多个条件</strong></p>

<ul>
<li>if [ $a -gt 5 ] &amp;&amp; [ $a -lt 10 ]; then</li>
<li>if [ $b -gt 5 ] || [ $b -lt 3 ]; then</li>
</ul>

<p><strong>- if文件目录属性判断</strong></p>

<ul>
<li>if 判断文件、目录属性</li>
<li>[ -f file ] 判断是否是普通文件，且存在</li>
<li>[ -d file ] 判断是否是目录，且存在</li>
<li>[ -e file ] 判断文件或者目录是否存在</li>
<li>[ -r file ] 判断文件是否可读</li>
<li>[ -w file ] 判断文件是否可写</li>
<li>[ -x file ] 判断文件是否可执行</li>
</ul>

<p><strong>文件目录属性判断实战</strong></p>

<ul>
<li><p>[ -f file ]判断是否是普通文件，且存在</p></li>

<li><p>[root@aminglinux shell]# vim file1.sh</p></li>

<li><p>[root@aminglinux shell]# cat file1.sh</p></li>

<li><p>#! /bin/bash</p></li>

<li><p>f=&ldquo;/tmp/aminglinux1&rdquo;</p></li>

<li><p>if [ -f $f ]</p></li>

<li><p>then</p></li>

<li><p>echo $f exist</p></li>

<li><p>else</p></li>

<li><p>touch $f</p></li>

<li><p>fi</p></li>

<li><p>[root@aminglinux shell]# sh -x file1.sh  //第一次执行，会创建该文件</p></li>

<li><ul>
<li>f=/tmp/aminglinux1</li>
</ul></li>

<li><ul>
<li>&lsquo;[&rsquo; -f /tmp/aminglinux1 &lsquo;]&rsquo;</li>
</ul></li>

<li><ul>
<li>touch /tmp/aminglinux1</li>
</ul></li>

<li><p>[root@aminglinux shell]# sh -x file1.sh  //第二次执行，会提示该文件已存在</p></li>

<li><ul>
<li>f=/tmp/aminglinux1</li>
</ul></li>

<li><ul>
<li>&lsquo;[&rsquo; -f /tmp/aminglinux1 &lsquo;]&rsquo;</li>
</ul></li>

<li><ul>
<li>echo /tmp/aminglinux1 exist</li>
</ul></li>

<li><p>/tmp/aminglinux1 exist</p></li>

<li><p>[ -d file ] 判断是否是目录，且存在</p></li>
</ul>

<blockquote>
<pre><code>[root@aminglinux shell]# vim file2.sh
[root@aminglinux shell]# cat file2.sh
#! /bin/bash
f=&quot;/tmp/aminglinuxd&quot;
if [ -d $f ]
then
        echo $f exist
else
        mkdir $f
fi
[root@aminglinux shell]# sh -x file2.sh
+ f=/tmp/aminglinuxd
+ '[' -d /tmp/aminglinuxd ']'
+ mkdir /tmp/aminglinuxd
[root@aminglinux shell]# sh -x file2.sh
+ f=/tmp/aminglinuxd
+ '[' -d /tmp/aminglinuxd ']'
+ echo /tmp/aminglinuxd exist
/tmp/aminglinuxd exist
</code></pre>
</blockquote>

<ul>
<li>[ -e file ] 判断文件或目录是否存在</li>
<li>目录和文件都可以touch 的，touch的目的是 如果这个文件或目录不存在，它会创建这个文件，如果这个文件或目录存在了，在touch 就会更改这个文件的三个 time</li>
</ul>

<blockquote>
<pre><code>[root@aminglinux shell]# vim file3.sh
[root@aminglinux shell]# cat file3.sh
#! /bin/bash
f=&quot;/tmp/aminglinux1&quot;
if [ -e $f ]
then
  echo $f exist
else
  touch $f
fi
[root@aminglinux shell]# sh -x file3.sh
+ f=/tmp/aminglinux1
+ '[' -e /tmp/aminglinux1 ']'
+ echo /tmp/aminglinux1 exist
/tmp/aminglinux1 exist
[root@aminglinux shell]# ll /tmp/
total 0
-rw-r--r-- 1 root  root   0 Jul 29 17:23 aminglinux1
</code></pre>
</blockquote>

<ul>
<li>[ -r file ] 判断文件是否可读</li>
</ul>

<blockquote>
<pre><code>[root@aminglinux shell]# vim file4.sh
[root@aminglinux shell]# cat file4.sh
#! /bin/bash
f=&quot;/tmp/aminglinux1&quot;
if [ -r $f ]
then
        echo $f readable
fi
[root@aminglinux shell]# sh file4.sh
/tmp/aminglinux1 readable
</code></pre>
</blockquote>

<ul>
<li>[ -w file ] 判断文件是否可写</li>
<li>[ -x file ] 判断文件是否可执行</li>
</ul>

<blockquote>
<pre><code>[root@aminglinux shell]# !vim
vim file4.sh
[root@aminglinux shell]# sh file4.sh
/tmp/aminglinux1 writeadable
[root@aminglinux shell]# !vim
vim file4.sh
[root@aminglinux shell]# sh file4.sh
[root@aminglinux shell]#   //因为文件 没有执行权限，所以没有输入出
</code></pre>
</blockquote>

<ul>
<li>并且 &amp;&amp;</li>
</ul>

<blockquote>
<pre><code>f=&quot;/tmp/aminglinux1&quot;
[ -f $f ] &amp;&amp; rm -f $f     //前一条命令执行成功才会继续执行之后的命令
等同于下面的表达方式
if [ -f $f ]  
then
      rm -rf $f
fi
</code></pre>
</blockquote>

<ul>
<li>或者 ||</li>
</ul>

<blockquote>
<pre><code>f=&quot;/tmp/aminglinux1&quot;
[ -f $f ] || touch $f    //前面命令不成功时，执行后面的命令
if [ ! -f $f ]        //  “！”表示了如果这条命令不成功，就往下执行
then
      touch $f
fi
</code></pre>
</blockquote>

<p><strong>if 特殊用法</strong></p>

<ul>
<li><p>if [ -z &ldquo;$a&rdquo; ] 这个表示当变量a的值为空时会怎么样</p></li>

<li><p>if [ -n &ldquo;$a&rdquo; ] 表示当变量a的值不为空</p></li>

<li><p>if grep -q &lsquo;123&rsquo; 1.txt; then 表示如果1.txt中含有&rsquo;123&rsquo;的行时会怎么样</p></li>

<li><p>if [ ! -e file ]; then 表示文件不存在时会怎么样</p></li>

<li><p>if (($a&lt;1)); then …等同于 if [ $a -lt 1 ]; then…</p></li>

<li><p>中不能使用,==,!=,&gt;=,&lt;=这样的符号</p></li>

<li><p>-n 判断变量的时候，需要用&rdquo;&ldquo;双引号引起来，若是文件的时候，则不需要用双引号引起来</p></li>
</ul>

<blockquote>
<pre><code>[root@aminglinux shell]# ls
1.sh  file1.sh  file2.sh  file3.sh  file4.sh  if1.sh  if2.sh  if3.sh
[root@aminglinux shell]# if [ -n 1.sh ]; then echo ok; fi
ok
[root@aminglinux shell]# if [ -n &quot;$b&quot; ]; then echo $b; else echo &quot;b is
</code></pre>

<p>null&rdquo;; fi  //当变量为空时时输出
    b is null</p>
</blockquote>

<ul>
<li>grep -wq 其中-w 后跟一个单词，-q仅仅做一个过滤</li>
</ul>

<blockquote>
<pre><code>[root@aminglinux shell]# grep -w 'zabbix' /etc/passwd   //查看zabbix用户是否存在
zabbix:x:996:993:Zabbix Monitoring System:/var/lib/zabbix:/sbin/nologin
[root@aminglinux shell]# if grep -wq 'zabbix' /etc/passwd; then echo
</code></pre>

<p>&ldquo;zabbix exist&rdquo;; fi //-q ,表示把grep -w的值过滤掉
    zabbix exist</p>
</blockquote>

<ul>
<li>if ! 取反值</li>
</ul>

<blockquote>
<pre><code>[root@aminglinux shell]# if ! grep -wq 'zabbix' /etc/passwd; then echo
</code></pre>

<p>useradd zabbix; fi  //当没有zabix用户时创建用户，因zabbix用户存在，所以没有输出；
    [root@aminglinux shell]#</p>
</blockquote>

<ul>
<li>if [ ! -e file ]; then 表示文件不存在时会怎么样</li>
<li>if (($a&lt;1)); then …等同于 if [ $a -lt 1 ]; then…</li>
<li>中不能使用,==,!=,&gt;=,&lt;=这样的符号 一个等于号= 是赋值</li>
</ul>

<p><strong>case判断</strong></p>

<p><strong><a href="https://img.it610.com/image/info8/b40de2f99c6d45619216fac33edaed2f.jpg"><img src="https://img.it610.com/image/info8/b40de2f99c6d45619216fac33edaed2f.jpg" alt="shell脚本介绍、结构和执行、date、 脚本中的变量、逻辑判断、文件目录属性、if特殊用法 、case判断、for循环
、while循环、break跳出循环、continue结束本次循环、exit_第1张图片" /></a></strong></p>

<ul>
<li><p>shell脚本案例：</p></li>

<li><p>脚本目的是 输入一个数字，然后用脚本去判断这个数字的范围</p></li>
</ul>

<blockquote>
<pre><code>[root@aminglinux shell]# vim case.sh
#!/bin/bash
#判断是否输入有数值，空直接结束整个文本
read -p &quot;Please input a number: &quot; n  
#read 让用户输出一些字符串；赋值给最后一个变量；这里的赋值是“n”
if [ -z &quot;$n&quot; ]                    //变量n 为空
then
    echo &quot;Please input a number.&quot;
    exit 1   // 知识点 1
fi
#n1将输入的数值清空数字，检查变量是否为空，如果不为空，就证明输入有其他的字符，告知用户，请输入一个数字
n1=`echo $n|sed 's/[0-9]//g'`   //确定，n变量是否为数字
if [ -n &quot;$n1&quot; ]
then
echo &quot;Please input a number.&quot;
exit 1
fi

if [ $n -lt 60 ] &amp;&amp; [ $n -ge 0 ]
then
    tag=1
elif [ $n -ge 60 ] &amp;&amp; [ $n -lt 80 ]
then
    tag=2
elif [ $n -ge 80 ]  &amp;&amp; [ $n -lt 90 ]
then
    tag=3
elif [ $n -ge 90 ] &amp;&amp; [ $n -le 100 ]
then
    tag=4
else
    tag=0
fi
case $tag in
    1)
         echo &quot;not ok&quot;
        ;;
    2)
         echo &quot;ok&quot;
        ;;
    3)
         echo &quot;ook&quot;
        ;;
    4)
         echo &quot;oook&quot;
        ;;
    *)
         echo &quot;The input value exceeds the calculation range.The number
</code></pre>

<p>range is 0-100.&rdquo;
            ;;
    esac</p>
</blockquote>

<ul>
<li>read -p &ldquo; Please input a number: &ldquo; n //shell中与用户交互输入数值</li>
</ul>

<blockquote>
<pre><code>[root@aminglinux shell]# read -p &quot; Please input a number: &quot; n
 Please input a number: 100  //n赋值 100，输出为100
[root@aminglinux shell]# echo $n
100
</code></pre>
</blockquote>

<p>shell 中 exit0 exit1 的区别：</p>

<ul>
<li>exit（0）：正常运行程序并退出程序；</li>
<li>exit（1）：非正常运行导致退出程序；</li>
<li>exit 0 可以告知你的程序的使用者：你的程序是正常结束的。如果 exit 非 0 值，那么你的程序的使用者通常会认为你的程序产生了一个错误。</li>
<li>在 shell 中调用完你的程序之后，用 echo $? 命令就可以看到你的程序的 exit 值。在 shell 脚本中，通常会根据上一个命令的 $? 值来进行一些流程控制。</li>
</ul>

<p><strong>for循环</strong></p>

<ul>
<li>语法：for 变量名 in 条件; do …; done</li>
</ul>

<p><strong>案例1</strong></p>

<ul>
<li>1+2+3..+100的和</li>
<li>sum 第一次作为变量的时候，是0；当进入for循环里面的时候，每运算一次，sum变量就会改变一次，直至$i 结束；最后输出结果 $sum</li>
<li>在做加减法的时候，[ ] 方括号里面不需要加空格</li>
</ul>

<blockquote>
<pre><code>[root@aminglinux shell]# vim for1.sh
[root@aminglinux shell]# cat for1.sh
#!/bin/bash
sum=0
for i in `seq 1 100`
#seq  1到100个数字
do
    sum=$[$sum+$i]
    echo $i
done
echo $sum
[root@aminglinux shell]# sh -x for1.sh
+ sum=0
++ seq 1 100
+ for i in '`seq 1 100`'
+ sum=1
+ echo 1
1

......
+ for i in '`seq 1 100`'
+ sum=5050
+ echo 100
100
+ echo 5050
5050
</code></pre>
</blockquote>

<p><strong>for循环案例2</strong></p>

<ul>
<li>文件列表循环</li>
<li>列出所有 etc目录下的子目录</li>
</ul>

<blockquote>
<pre><code>[root@aminglinux shell]# vim for2.sh
[root@aminglinux shell]# cat for2.sh
 #!/bin/bash
cd /etc/
for a in `ls /etc/`
do
    if [ -d $a ]
    then
       ls -d $a
    fi
done


[root@aminglinux shell]# for a in `seq 1 3`; do echo $a; done
1
2
3
[root@aminglinux shell]# for a in 1 2 3; do echo $a; done
1
2
3
</code></pre>
</blockquote>

<ul>
<li>for 循环的时候会以 空格 或者 回车做为分隔符</li>
</ul>

<p><strong>while循环</strong></p>

<ul>
<li>语法 while 条件; do … ; done</li>
</ul>

<p><strong>案例1</strong></p>

<ul>
<li>每隔1分钟检查一下系统负载，当系统的负载大于10的时候，发一封邮件（监控脚本）</li>
<li>最小单元是任务计划 cron</li>
</ul>

<blockquote>
<pre><code>[root@aminglinux shell]# vim while1.sh
[root@aminglinux shell]# cat while1.sh
#!/bin/bash
while :
# 冒号 : 表示死循环的意思，或者1，或者 true都是死循环
do
    load=`w|head -1|awk -F 'load average: ' '{print $2}'|cut -d. -f1`
    if [ $load -gt 10 ]
    then
           /usr/local/sbin/mail.py xxx@163.com &quot;load high&quot; &quot;$load&quot;
    fi
    sleep 30
#休眠30秒，因为检查系统负载，不需要一直去检查，过一会再看
done
[root@yong-01 shell]# sh -x while1.sh
+ :
++ w
++ head -1
++ awk -F 'load average:' '{print $2}'
++ cut -d. -f1
+ load=' 0'
+ '[' 0 -gt 10 ']'
+ sleep 30
若想这种脚本不意外的终止，可以打开screen，在screen跑脚本
</code></pre>
</blockquote>

<p><strong>知识点</strong></p>

<ul>
<li>w //查看系统负载 ；</li>
<li>uptime 可以直接显示 w 系统负载的第一行，就可以省去 head -1</li>
<li>head -1 //取第一行</li>
<li>awk -F &lsquo;load average: &lsquo; &lsquo;{print $2}&rsquo; // 以&rsquo;load average: &lsquo;分隔，输出第二段</li>
<li>cut -d . -f1 // 以 . 分隔 取第一段</li>
</ul>

<p><strong>while循环案例2</strong></p>

<ul>
<li>在循环过程过，需要用户输入一个数字；输入的不是数字，是数字，输入为空；回应相应的结果</li>
</ul>

<blockquote>
<pre><code>[root@aminglinux shell]# vim while2.sh
[root@aminglinux shell]# cat while2.sh
#!/bin/bash
while :
do
    read -p &quot;Please input a number: &quot; n
    if [ -z &quot;$n&quot; ]
    then
        echo &quot;you need input sth.&quot;
        continue
#continue 重新回到循环
    fi
    n1=`echo $n|sed 's/[0-9]//g'`
    if [ -n &quot;$n1&quot; ]
    then
        echo &quot;you just only input numbers.&quot;
        continue
    fi
    break
#break  退出循环
done
echo $n
</code></pre>
</blockquote>

<p><strong>break跳出循环</strong></p>

<ul>
<li>break 常用于循环语句中</li>
<li>跳出整个循环语句，直接结束所有循环</li>
</ul>

<blockquote>
<pre><code>[root@aminglinux shell]# vim break.sh
[root@aminglinux shell]# cat break.sh
#!/bin/bash
for i in `seq 1 5`
do
    echo $i
    if [ $i -eq 3 ]
#比较数字，用-eq ；若是比较的是字符串，那需要用 ==
    then
        break
    fi
    echo $i
done
echo AAA


[root@aminglinux shell]# sh -x break.sh
++ seq 1 5
+ for i in '`seq 1 5`'
+ echo 1
1
+ '[' 1 -eq 3 ']'
+ echo 1
1
+ for i in '`seq 1 5`'
+ echo 2
2
+ '[' 2 -eq 3 ']'
+ echo 2
2
+ for i in '`seq 1 5`'
+ echo 3
3
+ '[' 3 -eq 3 ']'
+ break
+ echo AAA
AAA
</code></pre>
</blockquote>

<p><strong>continue结束本次循环</strong></p>

<ul>
<li>忽略continue之下的代码，直接进行下一次循环</li>
</ul>

<blockquote>
<pre><code>[root@aminglinux shell]# vim continue.sh
[root@aminglinux shell]# cat continue.sh
#!/bin/bash
for i in `seq 1 5`
do
    echo $i
    if [ $i -eq 3 ]
    then
        continue
    fi
    echo $i
done
echo AAA


[root@aminglinux shell]# sh continue.sh
1
1
2
2
3
4
4
5
5
AAA
</code></pre>
</blockquote>

<p><strong>exit退出整个脚本</strong></p>

<ul>
<li>exit直接结束退出整个脚本</li>
<li>可以定义退出的数值，可以用于确定脚本运行到什么地方的时候，结束</li>
</ul>

<blockquote>
<pre><code>[root@aminglinux shell]# vim exit.sh
[root@aminglinux shell]# cat exit.sh
#!/bin/bash
for i in `seq 1 5`
do
    echo $i
    if [ $i -eq 3 ]
    then
        exit
    fi
    echo $i
done
echo AAA
[root@aminglinux shell]# sh exit.sh
1
1
2
2
3
</code></pre>
</blockquote>

        </div>

        


        

<div class="post-archive">
    <h2>See Also</h2>
    <ul class="listing">
        
        <li><a href="/posts/007hadoop%E9%9B%86%E7%BE%A4%E9%85%8D%E7%BD%AEhadoop%E9%9B%86%E7%BE%A4%E7%9A%84%E5%90%AF%E5%8A%A8%E5%92%8C%E6%B5%8B%E8%AF%95ssh%E5%85%8D%E7%99%BB%E9%99%86%E9%85%8D%E7%BD%AEstartallshhdfs%E5%B8%B8%E7%94%A8%E7%9A%84shell/">007Hadoop集群配置Hadoop集群的启动和测试SSH免登陆配置startallshhdfs常用的shell</a></li>
        
        <li><a href="/posts/009shell%E8%84%9A%E6%9C%AC%E4%B8%8B%E6%9D%A1%E4%BB%B6%E6%B5%8B%E8%AF%95eqne/">009Shell脚本下条件测试eqne</a></li>
        
        <li><a href="/posts/00pythonmanagepyshell%E5%92%8Cpython%E7%9A%84%E5%88%86%E6%9E%90/">00Pythonmanagepyshell和Python的分析</a></li>
        
        <li><a href="/posts/010zookeeper%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5zookeeper%E7%9A%84%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BAzookeeper%E7%9A%84shell%E5%91%BD%E4%BB%A4/">010Zookeeper的基本概念Zookeeper的集群搭建Zookeeper的shell命令</a></li>
        
        <li><a href="/posts/018dockerfileshell/">018DockerfileSHELL</a></li>
        
    </ul>
</div>


        <div class="post-meta meta-tags">
            
            <ul class="clearfix">
                
                <li><a href='https://zaina.newban.cn/tags/shell'>shell</a></li>
                
            </ul>
            
        </div>
    </article>
    
    

    
    
</div>

                    <footer id="footer">
    <div>
        &copy; 2020 <a href="https://zaina.newban.cn">开发者问答集锦 By </a>
        
    </div>
    <br />
    <div>
        <div class="github-badge">
            <a href="https://gohugo.io/" target="_black" rel="nofollow"><span class="badge-subject">Powered by</span><span class="badge-value bg-blue">Hugo</span></a>
        </div>
        <div class="github-badge">
            <a href="https://www.flysnow.org/" target="_black"><span class="badge-subject">Design by</span><span class="badge-value bg-brightgreen">飞雪无情</span></a>
        </div>
        <div class="github-badge">
            <a href="https://github.com/flysnow-org/maupassant-hugo" target="_black"><span class="badge-subject">Theme</span><span class="badge-value bg-yellowgreen">Maupassant</span></a>
        </div>
    </div>
</footer>


    
    <script type="text/javascript">
        window.MathJax = {
            tex2jax: {
                inlineMath: [['$', '$']],
                processEscapes: true
                }
            };
    </script>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML' async></script>

<a id="rocket" href="#top"></a>
<script type="text/javascript" src='/js/totop.js?v=0.0.0' async=""></script>



    <script type="text/javascript" src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script>




                </div>

                <div id="secondary">
    <section class="widget">
        <form id="search" action='https://zaina.newban.cn/search/' method="get" accept-charset="utf-8" target="_blank" _lpchecked="1">
      
      <input type="text" name="q" maxlength="20" placeholder="Search">
      <input type="hidden" name="sitesearch" value="https://zaina.newban.cn">
      <button type="submit" class="submit icon-search"></button>
</form>
    </section>
    
    <section class="widget">
        <h3 class="widget-title">最近文章</h3>
<ul class="widget-list">
    
    <li>
        <a href="https://zaina.newban.cn/posts/001rubyruby%E4%B8%AD%E5%85%A8%E5%B1%80%E5%8F%98%E9%87%8F%E5%AE%9E%E4%BE%8B%E5%8F%98%E9%87%8F%E5%B1%80%E9%83%A8%E5%8F%98%E9%87%8F%E7%B1%BB%E5%8F%98%E9%87%8Fsymbol%E5%AF%B9%E6%AF%94/" title="001rubyRuby中全局变量实例变量局部变量类变量Symbol对比">001rubyRuby中全局变量实例变量局部变量类变量Symbol对比</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/007hadoop%E9%9B%86%E7%BE%A4%E9%85%8D%E7%BD%AEhadoop%E9%9B%86%E7%BE%A4%E7%9A%84%E5%90%AF%E5%8A%A8%E5%92%8C%E6%B5%8B%E8%AF%95ssh%E5%85%8D%E7%99%BB%E9%99%86%E9%85%8D%E7%BD%AEstartallshhdfs%E5%B8%B8%E7%94%A8%E7%9A%84shell/" title="007Hadoop集群配置Hadoop集群的启动和测试SSH免登陆配置startallshhdfs常用的shell">007Hadoop集群配置Hadoop集群的启动和测试SSH免登陆配置startallshhdfs常用的shell</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/009shell%E8%84%9A%E6%9C%AC%E4%B8%8B%E6%9D%A1%E4%BB%B6%E6%B5%8B%E8%AF%95eqne/" title="009Shell脚本下条件测试eqne">009Shell脚本下条件测试eqne</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/00pythonmanagepyshell%E5%92%8Cpython%E7%9A%84%E5%88%86%E6%9E%90/" title="00Pythonmanagepyshell和Python的分析">00Pythonmanagepyshell和Python的分析</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/010zookeeper%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5zookeeper%E7%9A%84%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BAzookeeper%E7%9A%84shell%E5%91%BD%E4%BB%A4/" title="010Zookeeper的基本概念Zookeeper的集群搭建Zookeeper的shell命令">010Zookeeper的基本概念Zookeeper的集群搭建Zookeeper的shell命令</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/018dockerfileshell/" title="018DockerfileSHELL">018DockerfileSHELL</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/01shell%E5%85%A5%E9%97%A801bashshell%E7%89%B9%E6%80%A7/" title="01Shell入门01bashShell特性">01Shell入门01bashShell特性</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/01shell%E5%8F%98%E9%87%8F/" title="01Shell变量">01Shell变量</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/01shell%E5%9F%BA%E7%A1%80%E6%A6%82%E8%BF%B0%E8%84%9A%E6%9C%AC%E6%89%A7%E8%A1%8C%E6%96%B9%E5%BC%8Fbash%E5%9F%BA%E6%9C%AC%E5%8A%9F%E8%83%BD/" title="01Shell基础概述脚本执行方式Bash基本功能">01Shell基础概述脚本执行方式Bash基本功能</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/01shell%E7%BC%96%E7%A8%8Bhelloworld/" title="01shell编程helloworld">01shell编程helloworld</a>
    </li>
    
</ul>
    </section>

    

    <section class="widget">
        <h3 class="widget-title"><a href="/categories">分类</a></h3>
<ul class="widget-list">
    
</ul>
    </section>

    <section class="widget">
        <h3 class="widget-title"><a href="/tags">标签</a></h3>
<div class="tagcloud">
    
    <a href="https://zaina.newban.cn/tags/ruby/">ruby</a>
    
    <a href="https://zaina.newban.cn/tags/shell/">shell</a>
    
</div>
    </section>

    

    <section class="widget">
        <h3 class="widget-title">其它</h3>
        <ul class="widget-list">
            <li><a href="https://zaina.newban.cn/index.xml">文章 RSS</a></li>
        </ul>
    </section>
</div>
            </div>
        </div>
    </div>
</body>

</html>