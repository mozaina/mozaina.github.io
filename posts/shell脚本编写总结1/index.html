<!doctype html>
<html lang="en-us">
<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">


    <title>shell脚本编写总结1 | 开发者问答集锦</title>
    <meta property="og:title" content="shell脚本编写总结1 - 开发者问答集锦">
    <meta property="og:type" content="article">
        
    <meta property="article:published_time" content='2020-09-02T00:00:00&#43;08:00'>
        
        
    <meta property="article:modified_time" content='2020-09-02T00:00:00&#43;08:00'>
        
    <meta name="Keywords" content="">
    <meta name="description" content="shell脚本编写总结1">
        
    <meta name="author" content="">
    <meta property="og:url" content="https://zaina.newban.cn/posts/shell%E8%84%9A%E6%9C%AC%E7%BC%96%E5%86%99%E6%80%BB%E7%BB%931/">
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">

    <link rel="stylesheet" href='/css/normalize.css'>
    <link rel="stylesheet" href='/css/style.css'>
    <script type="text/javascript" src="//cdn.bootcdn.net/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

    
    
    
    
    
    
</head>


<body>
    <header id="header" class="clearfix">
    <div class="container">
        <div class="col-group">
            <div class="site-name ">
                
                    <a id="logo" href="https://zaina.newban.cn">
                        开发者问答集锦
                    </a>
                
                
            </div>
            <div>
                <nav id="nav-menu" class="clearfix">
                    <a class="" href="https://zaina.newban.cn">首页</a>
                    
                </nav>
            </div>
        </div>
    </div>
</header>

    <div id="body">
        <div class="container">
            <div class="col-group">

                <div class="col-8" id="main">
                    
<div class="res-cons">
    
    <article class="post">
        <header>
            <h1 class="post-title">shell脚本编写总结1</h1>
        </header>
        <date class="post-meta meta-date">
            2020年9月2日
        </date>
        
        
        <div class="post-meta">
            <span id="busuanzi_container_page_pv">|<span id="busuanzi_value_page_pv"></span><span>
                    阅读</span></span>
        </div>
        
        
        <div class="post-content">
            

<h3 id="知识点1-变量">[知识点1]：变量</h3>

<h4 id="1-环境变量">1、环境变量</h4>

<p>1、变量：BASH</p>

<p>Bash Shell的全路径</p>

<p>比如：echo $BASH</p>

<p>2、变量：BASH_VERSION</p>

<p>Bash Shell的版本号</p>

<p>3、变量：EUID</p>

<p>记录当前用户的UID。root用户值为0。</p>

<p>4、FUNCNAME</p>

<p>在用户函数体内部，记录当前函数体的函数名。</p>

<p>5、变量：HISTCMD</p>

<p>说明：记录下一条命令在history命令中的编号。</p>

<p>6、HISTFILE</p>

<p>记录history命令记录文件的位置。运行history命令将打印已经运行过的命令列表，即便重启机器后还可以保存以前的命令记录。因为执行过的命令</p>

<p>会记录在/root/.bash_history文件中。</p>

<p>可以执行 cat /root/.bash_history 查看以前执行过的命令。</p>

<p>7、HISTFILESIZE</p>

<p>用来设置HISTFILESIZE文件记录命令的行数。这样可以限制.bash_history文件大小，避免出现文件过大的情况，不好处理。</p>

<p>8、HISTSIZE</p>

<p>实际上linux并不会针对每次运行命令后就立即将命令记录写入HISTFILE对应的文件中去，而是通过命令缓冲区来记录所有已经运行过的命令，只有</p>

<p>在缓冲区满了或者退出Shell时才将缓冲区记录写入HISTFILE对于的文件中。而缓冲区的大小需要通过HISTSIZE去定义。</p>

<p>9、HOSTNAME</p>

<p>用来显示主机名</p>

<p>10、HOSTTYPE</p>

<p>用来显示主机的架构，是i386、i686、还是x86、x64等。</p>

<p>11、MACHTYPE</p>

<p>用来显示主机类型的GNU标识。一般是主机架构-公司-系统-gnu。</p>

<p>12、LANG</p>

<p>用来设置当前系统语言环境。</p>

<p>export LANG=zh_CN.UTF-8</p>

<p>echo $LANG #显示当前语言环境</p>

<p>13、PWD</p>

<p>记录当前目录</p>

<p>14、OLDPWD</p>

<p>记录之前的目录。</p>

<p>15、PATH</p>

<p>代表命令的搜索路径。</p>

<p>2、用户变量<br />
var=10<br />
var=12.55<br />
var=‘c’<br />
var=testing<br />
var=“this is a test”</p>

<p>变量输出语句：</p>

<pre><code>echo &quot;$var&quot;
</code></pre>

<h3 id="知识点2-命令替换-即保存命令执行的结果到变量中">【知识点2】：命令替换：即保存命令执行的结果到变量中</h3>

<p>（1）反引号字符（`）</p>

<pre><code>date=`date`
echo $date
</code></pre>

<p>(2) $( )格式</p>

<pre><code>date=$(date + %y%m%d)
echo $date
</code></pre>

<h3 id="知识点3-输入输出重定向">【知识点3】：输入输出重定向</h3>

<p>1、输出重定向</p>

<pre><code># 输出当前时间到文件中
date &gt; current_date.txt

# 不想输出任何打印消息怎么办？
date &gt; NULL
</code></pre>

<p>2、输入重定向</p>

<pre><code>root$ date &gt;current_date.txt
root$ cat current_date.txt 
2019年 6月16日 星期日 13时15分06秒 CST

# 使用wc工具队数据中的文本进行统计
root$ wc &lt; current_date.txt 
       1       5      48

# 现在统计指定文本内容的行数，并保存到变量中
root$ var=$(wc &lt; current_date.txt | awk '{print $1}')
root$ echo &quot;$var&quot;
1        
# 可以看到，统计到current_date.txt文本共一行
</code></pre>

<p>3、内联输入重定向<br />
语法格式：</p>

<pre><code>Command &lt;&lt; Mark
&gt; Mark

Mark作为起始和结束的标识符，可以为任意字符
</code></pre>

<p>下面举个例子：</p>

<pre><code>root$ wc &lt;&lt; EOF
&gt; she 
&gt; is
&gt; a
&gt; girl
&gt; EOF
       4       4      15
</code></pre>

<p>上面讲的都是输入输出到文件中，如果能把文件中的内容输出定向到变量中或者变量中的字符定向到文件就好了。ok，很简单，我们一起来总结下：</p>

<pre><code># 下面我们从文件中读取保存的日期到变量 context中，然后输出
root$ read context &lt; current_date.txt ;echo $context
2019年 6月16日 星期日 13时15分06秒 CST
# 那么如何将变量保存到文件中呢？这里，我们借用echo指令
root$ var=“varfile”;echo &quot;$var&quot; &gt; var_to_file;cat var_to_file
“varfile” ==》cat 结果输出

除了这样，我们还可以别的玩法么？当然。用一下write指令试试看。
我们创建一个文件，writefile
root$ touch writefile
开两个终端，其中一个输入：
cat writefile &amp;   ==》即后台执行查看writefile文件指令
另一个输入如下：
root$ write sungang &gt; writefile 
daf
name is good

然后在另一个终端中我们就发现有了输出结果了：
root$ Message from sungang@kissness.local on ttys000 at 13:55 ...
daf
name is good

这里实际上也是通过重定向消息文本到文件中。暂时这样理解，后面我们再跟深入的研究write指令。
</code></pre>

<h3 id="知识点4-管道">【知识点4】：管道</h3>

<p>有时候需要将一个命令的输出作为另一个命令的输入，这时候使用管道会比较便捷.<br />
(1) 现在又这样一个例子，我需要仅且需要今天是几月几号（例如：6月12日），怎么办？<br />
解决这个问题前，先学习一个指令 cut。<br />
先知道，cut 指令可以用于字符串的截取。</p>

<pre><code>cut
usage: cut -b list [-n] [file ...]
       cut -c list [file ...]
       cut -f list [-s] [-d delim] [file ...]



# 我们先通过date指令获取当前日期信息，然后把date指令的输出结果作为cut指令的输入，这时候
# 只需要使用管道符号“|”来连接就可以了。
root$ date | cut -d &quot; &quot; -f 2
6月16日
# 如果需要保存这个结果字符串到变量中，只需要
var=$(date | cut -d &quot; &quot; -f 2)
或者
var=`date | cut -d &quot; &quot; -f 2`
</code></pre>

<h3 id="知识点5-数学计算">【知识点5】：数学计算</h3>

<p>1、简单的数学计算 expr 命令</p>

<pre><code>root$ expr 1 + 5    ==》注意空格
6
</code></pre>

<p><a href="https://img.it610.com/image/info8/3d1d0d962d55492c9e44d44f7d18e6dd.jpg"><img src="https://img.it610.com/image/info8/3d1d0d962d55492c9e44d44f7d18e6dd.jpg" alt="shell
脚本编写总结（1）_第1张图片" /></a></p>

<p>2、使用方括号：</p>

<pre><code>root$ echo $[1 + 4]
5
</code></pre>

<p>这种方法也比较适合在shell脚本中使用。下面举个shell脚本中使用方括号做数学计算的例子：</p>

<pre><code>#!/bin/bash
    var1=100
    var2=50
    var3=45
    var4=$[$var1 * ($var2 - $var3)]
    echo The final result is $var4
</code></pre>

<p>3、上面的方法或许简单，但是我们发现遇到浮点数的计算就困难重重了，那么，有没有好的工具呢，当然有，bc计算器。<br />
在脚本中使用bc，语法如下：</p>

<pre><code>variable=$(echo &quot;options; expression&quot; | bc)
</code></pre>

<p>尝试使用一下如下：</p>

<pre><code>var=$(echo &quot;1.111112 * 2&quot; | bc);
echo $var
2.222224  ==&gt;输出结果
</code></pre>

<h3 id="知识点6-查看退出状态码">【知识点6】：查看退出状态码</h3>

<p>Linux提供了一个??的变量 <code>$?</code> 来保存上个已执行命令的?出?态码。?于需要进行检?的
命令，??在其运行完?后????或使用$?变量。它的?会变成?shell所执行的最后一?命令 的?出?态码。</p>

<pre><code>$ date
Sat Jan 15 10:01:30 EDT 2014
$ echo $?
0
$
</code></pre>

<p>????，一个成功??的命令的?出?态码是0。如果一个命令??时有错?，?出?态码就是一个正数?。</p>

<p><a href="https://img.it610.com/image/info8/cb6c3bb9d8df476d8df8108d957e1dfe.jpg"><img src="https://img.it610.com/image/info8/cb6c3bb9d8df476d8df8108d957e1dfe.jpg" alt="shell
脚本编写总结（1）_第2张图片" /></a></p>

<h3 id="知识点7-if-then语句">【知识点7】：if-then语句</h3>

<p>1、基础语法<br />
语法格式1：</p>

<pre><code>if command ;then
    commands
else
    commands
fi
</code></pre>

<p>bash shell的if??会运行if后面的那个命令。如果?命令的?出?态码(参?第11章)是0
(?命令成功运行)，?于then部分的命令就会?执行。如果?命令的?出?态码是其他?，then部分的命令就不会?执行，bash
shell会继续执行脚本中的下一个命令。fi??用来表示if-then ??到???。</p>

<p>语法格式2:</p>

<pre><code>if [ condition ] then   ==》一定要注意【 】中的空格
commands
fi
</code></pre>

<p>（1）数值比较<a href="https://img.it610.com/image/info8/43c42ffaf9b54709a269325f363597a1.jpg"><img src="https://img.it610.com/image/info8/43c42ffaf9b54709a269325f363597a1.jpg" alt="shell
脚本编写总结（1）_第3张图片" /></a></p>

<p>（2）字符串比较<br />
<a href="https://img.it610.com/image/info8/3ec5e6642de34105ab9315b3a818f01e.jpg"><img src="https://img.it610.com/image/info8/3ec5e6642de34105ab9315b3a818f01e.jpg" alt="shell
脚本编写总结（1）_第4张图片" /></a><br />
（3）文件比较<br />
<a href="https://img.it610.com/image/info8/ba42c4d6dd174002ae62ac95684c63ce.jpg"><img src="https://img.it610.com/image/info8/ba42c4d6dd174002ae62ac95684c63ce.jpg" alt="shell
脚本编写总结（1）_第5张图片" /></a></p>

<p>2、复合条件测试<br />
if-then????你使用???辑来组?测?。有?种??运??可用: ?</p>

<pre><code> [ condition1 ] &amp;&amp; [ condition2 ]
 [ condition1 ] || [ condition2 ]
</code></pre>

<p>3、高级特性<br />
（1）使用双括号<br />
?括?命令的?式如下:<br />
<code>(( expression ))</code><br />
expression可以是任?的数学??或比?表达式。除了test命令使用的??数学运??，<br />
<a href="https://img.it610.com/image/info8/4e5eb494d3524b818bf8a114fd752204.jpg"><img src="https://img.it610.com/image/info8/4e5eb494d3524b818bf8a114fd752204.jpg" alt="shell
脚本编写总结（1）_第6张图片" /></a></p>

<p>2、使用双方括号<br />
?方括?命令的?式如下:<br />
<code>[[ expression ]]</code><br />
?方括??的expression使用了test命令中采用的?????比?。但它提供了test命<br />
令未提供的?一个特性??????(pattern matching)。</p>

<pre><code>#!/bin/bash
# using pattern matching #4 if [[ $USER == r* ]]
then
echo &quot;Hello $USER&quot;
else 5
       echo &quot;Sorry, I do not know you&quot;
 fi



    在上面的脚本中，我们使用了???(==)。???将??的???(r*)?为一个?式， 并应用?式???则。?方括?命令$USER环境变量进行??，?它是?以??r开?。如果是 的话，比?通过，shell会执行then部分的命令。
</code></pre>

<h3 id="知识点8-case指令">【知识点8】：case指令</h3>

<p>语法格式：</p>

<pre><code>case variable in
pattern1 | pattern2) commands1;; pattern3) commands2;;
*) default commands;;
esac
</code></pre>

<p>demo：</p>

<pre><code>#!/bin/bash
# using the case command #
case $USER in
rich | barbara)
       echo &quot;Welcome, $USER&quot;
       echo &quot;Please enjoy your visit&quot;;;
testing)
      echo &quot;Special testing account&quot;;;
jessica)
       echo &quot;Do not forget to log off when you're done&quot;;;
*)
       echo &quot;Sorry, you are not allowed here&quot;;;
 esac
</code></pre>

        </div>

        


        

<div class="post-archive">
    <h2>See Also</h2>
    <ul class="listing">
        
        <li><a href="/posts/007hadoop%E9%9B%86%E7%BE%A4%E9%85%8D%E7%BD%AEhadoop%E9%9B%86%E7%BE%A4%E7%9A%84%E5%90%AF%E5%8A%A8%E5%92%8C%E6%B5%8B%E8%AF%95ssh%E5%85%8D%E7%99%BB%E9%99%86%E9%85%8D%E7%BD%AEstartallshhdfs%E5%B8%B8%E7%94%A8%E7%9A%84shell/">007Hadoop集群配置Hadoop集群的启动和测试SSH免登陆配置startallshhdfs常用的shell</a></li>
        
        <li><a href="/posts/009shell%E8%84%9A%E6%9C%AC%E4%B8%8B%E6%9D%A1%E4%BB%B6%E6%B5%8B%E8%AF%95eqne/">009Shell脚本下条件测试eqne</a></li>
        
        <li><a href="/posts/00pythonmanagepyshell%E5%92%8Cpython%E7%9A%84%E5%88%86%E6%9E%90/">00Pythonmanagepyshell和Python的分析</a></li>
        
        <li><a href="/posts/010zookeeper%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5zookeeper%E7%9A%84%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BAzookeeper%E7%9A%84shell%E5%91%BD%E4%BB%A4/">010Zookeeper的基本概念Zookeeper的集群搭建Zookeeper的shell命令</a></li>
        
        <li><a href="/posts/018dockerfileshell/">018DockerfileSHELL</a></li>
        
    </ul>
</div>


        <div class="post-meta meta-tags">
            
            <ul class="clearfix">
                
                <li><a href='https://zaina.newban.cn/tags/shell'>shell</a></li>
                
            </ul>
            
        </div>
    </article>
    
    

    
    
</div>

                    <footer id="footer">
    <div>
        &copy; 2020 <a href="https://zaina.newban.cn">开发者问答集锦 By </a>
        
    </div>
    <br />
    <div>
        <div class="github-badge">
            <a href="https://gohugo.io/" target="_black" rel="nofollow"><span class="badge-subject">Powered by</span><span class="badge-value bg-blue">Hugo</span></a>
        </div>
        <div class="github-badge">
            <a href="https://www.flysnow.org/" target="_black"><span class="badge-subject">Design by</span><span class="badge-value bg-brightgreen">飞雪无情</span></a>
        </div>
        <div class="github-badge">
            <a href="https://github.com/flysnow-org/maupassant-hugo" target="_black"><span class="badge-subject">Theme</span><span class="badge-value bg-yellowgreen">Maupassant</span></a>
        </div>
    </div>
</footer>


    
    <script type="text/javascript">
        window.MathJax = {
            tex2jax: {
                inlineMath: [['$', '$']],
                processEscapes: true
                }
            };
    </script>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML' async></script>

<a id="rocket" href="#top"></a>
<script type="text/javascript" src='/js/totop.js?v=0.0.0' async=""></script>



    <script type="text/javascript" src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script>




                </div>

                <div id="secondary">
    <section class="widget">
        <form id="search" action='https://zaina.newban.cn/search/' method="get" accept-charset="utf-8" target="_blank" _lpchecked="1">
      
      <input type="text" name="q" maxlength="20" placeholder="Search">
      <input type="hidden" name="sitesearch" value="https://zaina.newban.cn">
      <button type="submit" class="submit icon-search"></button>
</form>
    </section>
    
    <section class="widget">
        <h3 class="widget-title">最近文章</h3>
<ul class="widget-list">
    
    <li>
        <a href="https://zaina.newban.cn/posts/001rubyruby%E4%B8%AD%E5%85%A8%E5%B1%80%E5%8F%98%E9%87%8F%E5%AE%9E%E4%BE%8B%E5%8F%98%E9%87%8F%E5%B1%80%E9%83%A8%E5%8F%98%E9%87%8F%E7%B1%BB%E5%8F%98%E9%87%8Fsymbol%E5%AF%B9%E6%AF%94/" title="001rubyRuby中全局变量实例变量局部变量类变量Symbol对比">001rubyRuby中全局变量实例变量局部变量类变量Symbol对比</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/007hadoop%E9%9B%86%E7%BE%A4%E9%85%8D%E7%BD%AEhadoop%E9%9B%86%E7%BE%A4%E7%9A%84%E5%90%AF%E5%8A%A8%E5%92%8C%E6%B5%8B%E8%AF%95ssh%E5%85%8D%E7%99%BB%E9%99%86%E9%85%8D%E7%BD%AEstartallshhdfs%E5%B8%B8%E7%94%A8%E7%9A%84shell/" title="007Hadoop集群配置Hadoop集群的启动和测试SSH免登陆配置startallshhdfs常用的shell">007Hadoop集群配置Hadoop集群的启动和测试SSH免登陆配置startallshhdfs常用的shell</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/009shell%E8%84%9A%E6%9C%AC%E4%B8%8B%E6%9D%A1%E4%BB%B6%E6%B5%8B%E8%AF%95eqne/" title="009Shell脚本下条件测试eqne">009Shell脚本下条件测试eqne</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/00pythonmanagepyshell%E5%92%8Cpython%E7%9A%84%E5%88%86%E6%9E%90/" title="00Pythonmanagepyshell和Python的分析">00Pythonmanagepyshell和Python的分析</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/010zookeeper%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5zookeeper%E7%9A%84%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BAzookeeper%E7%9A%84shell%E5%91%BD%E4%BB%A4/" title="010Zookeeper的基本概念Zookeeper的集群搭建Zookeeper的shell命令">010Zookeeper的基本概念Zookeeper的集群搭建Zookeeper的shell命令</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/018dockerfileshell/" title="018DockerfileSHELL">018DockerfileSHELL</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/01shell%E5%85%A5%E9%97%A801bashshell%E7%89%B9%E6%80%A7/" title="01Shell入门01bashShell特性">01Shell入门01bashShell特性</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/01shell%E5%8F%98%E9%87%8F/" title="01Shell变量">01Shell变量</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/01shell%E5%9F%BA%E7%A1%80%E6%A6%82%E8%BF%B0%E8%84%9A%E6%9C%AC%E6%89%A7%E8%A1%8C%E6%96%B9%E5%BC%8Fbash%E5%9F%BA%E6%9C%AC%E5%8A%9F%E8%83%BD/" title="01Shell基础概述脚本执行方式Bash基本功能">01Shell基础概述脚本执行方式Bash基本功能</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/01shell%E7%BC%96%E7%A8%8Bhelloworld/" title="01shell编程helloworld">01shell编程helloworld</a>
    </li>
    
</ul>
    </section>

    

    <section class="widget">
        <h3 class="widget-title"><a href="/categories">分类</a></h3>
<ul class="widget-list">
    
</ul>
    </section>

    <section class="widget">
        <h3 class="widget-title"><a href="/tags">标签</a></h3>
<div class="tagcloud">
    
    <a href="https://zaina.newban.cn/tags/ruby/">ruby</a>
    
    <a href="https://zaina.newban.cn/tags/shell/">shell</a>
    
</div>
    </section>

    

    <section class="widget">
        <h3 class="widget-title">其它</h3>
        <ul class="widget-list">
            <li><a href="https://zaina.newban.cn/index.xml">文章 RSS</a></li>
        </ul>
    </section>
</div>
            </div>
        </div>
    </div>
</body>

</html>