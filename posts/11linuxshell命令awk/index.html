<!doctype html>
<html lang="en-us">
<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">


    <title>11linuxshell命令awk | 开发者问答集锦</title>
    <meta property="og:title" content="11linuxshell命令awk - 开发者问答集锦">
    <meta property="og:type" content="article">
        
    <meta property="article:published_time" content='2020-09-02T00:00:00&#43;08:00'>
        
        
    <meta property="article:modified_time" content='2020-09-02T00:00:00&#43;08:00'>
        
    <meta name="Keywords" content="">
    <meta name="description" content="11linuxshell命令awk">
        
    <meta name="author" content="">
    <meta property="og:url" content="https://zaina.newban.cn/posts/11linuxshell%E5%91%BD%E4%BB%A4awk/">
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">

    <link rel="stylesheet" href='/css/normalize.css'>
    <link rel="stylesheet" href='/css/style.css'>
    <script type="text/javascript" src="//cdn.bootcdn.net/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

    
    
    
    
    
    
</head>


<body>
    <header id="header" class="clearfix">
    <div class="container">
        <div class="col-group">
            <div class="site-name ">
                
                    <a id="logo" href="https://zaina.newban.cn">
                        开发者问答集锦
                    </a>
                
                
            </div>
            <div>
                <nav id="nav-menu" class="clearfix">
                    <a class="" href="https://zaina.newban.cn">首页</a>
                    
                </nav>
            </div>
        </div>
    </div>
</header>

    <div id="body">
        <div class="container">
            <div class="col-group">

                <div class="col-8" id="main">
                    
<div class="res-cons">
    
    <article class="post">
        <header>
            <h1 class="post-title">11linuxshell命令awk</h1>
        </header>
        <date class="post-meta meta-date">
            2020年9月2日
        </date>
        
        
        <div class="post-meta">
            <span id="busuanzi_container_page_pv">|<span id="busuanzi_value_page_pv"></span><span>
                    阅读</span></span>
        </div>
        
        
        <div class="post-content">
            

<h1 id="awk指令">awk指令</h1>

<ul>
<li>awk指令

<ul>
<li>awk 简介</li>
<li>awk 的命令格式</li>
<li>awk 的工作方式</li>
<li>awk 的基本使用方法

<ul>
<li>1 从命令行读取程序脚本</li>
<li>2 使用数据字段变量</li>
<li>3 在程序脚本中使用多个命令</li>
<li>4 在处理数据前运行脚本</li>
<li>5 在处理数据后运行脚本</li>
<li>6 从文件中读取程序</li>
</ul></li>
<li>awk 的高级使用方法

<ul>
<li>1 使用变量</li>
<li>11 内建变量</li>
<li>12 自定义变量</li>
<li>2 处理数组</li>
<li>21 定义数组</li>
<li>22 遍历数组</li>
<li>3 使用模式</li>
<li>31 正则表达式</li>
<li>32 匹配操作符</li>
<li>33 数学表达式</li>
<li>4 结构化命令</li>
<li>41 if 语句</li>
<li>42 while 语句</li>
<li>43 do-while 语句</li>
<li>44 for 语句</li>
<li>5 格式打印</li>
<li>6 使用函数</li>
<li>61 数学函数</li>
<li>62 字符串函数</li>
<li>63 时间函数</li>
<li>64 自定义函数</li>
</ul></li>
<li>参考网址</li>
</ul></li>
</ul>

<h2 id="1-awk-简介">1. awk 简介</h2>

<p>awk是linux中的一个强大的文本分析工具，它为文本分析提供了一个类编程环境，允许我们修改和重新组织文件。 awk
有3个不同的版本，分别是awk、nawk和gawk，未作特别说明，一般指gawk，gawk 是 AWK 的 GNU 版本。</p>

<p>awk 程序让流编辑迈上了一个新的台阶，它提供了一种编程语言，而不仅仅是一个编辑器命令。在awk编程语言中，我们可以做下面的事情：</p>

<ul>
<li>定义变量来保存数据</li>
<li>使用算术和字符串操作符来处理数据</li>
<li>使用结构化编程概念，比如 if-then 语句和循环，来为数据增加逻辑</li>
<li>提取数据文件中的数据元素，并将它们按照另一顺序或格式重新放置，从而生成格式化报告</li>
</ul>

<h2 id="2-awk-的命令格式">2. awk 的命令格式</h2>

<p>awk 程序的基本格式如下</p>

<pre><code>awk options '/search pattern1/ {Actions}
             /search pattern2/ {Actions}' file
</code></pre>

<p>其中， options 的可用选项如下：</p>

<table>
<thead>
<tr>
<th>选项</th>
<th>描述</th>
</tr>
</thead>

<tbody>
<tr>
<td>-F fs</td>
<td>指定行中分割数据字段的字段分隔符</td>
</tr>

<tr>
<td>-f file</td>
<td>指定读取程序的文件名</td>
</tr>

<tr>
<td>-v var=value</td>
<td>定义 awk 程序中的一个变量及其默认值</td>
</tr>

<tr>
<td>-mf N</td>
<td>指定要处理的数据文件中的最大字段数</td>
</tr>

<tr>
<td>-mr N</td>
<td>指定数据文件中的最大数据行数</td>
</tr>

<tr>
<td>-W keyword</td>
<td>指定 awk 的兼容模式或者警告等级</td>
</tr>
</tbody>
</table>

<h2 id="3-awk-的工作方式">3. awk 的工作方式</h2>

<ol>
<li>awk 每次读取输入文件中的一行</li>
<li>对于读取到的输入文件的每一行，awk 通过给定的模式去匹配该行内容，如果匹配成功，awk 便去执行相应的动作。</li>
<li>如果匹配失败，awk 不会去执行任何的相应的动作。</li>
<li>在上述章节1所提到的语法中，匹配模式和相应的动作都是可选的，不需要都有</li>
<li>如果匹配模式没有给定， awk 会对输入文件的每一行进行相应的指令操作</li>
<li>如果相应的指令操作没有给定， awk 会打印出用匹配模式匹配到的输入行。其中打印操作是默认的 awk 操作。</li>
<li>任何指令的空括号都不做任何动作。它不会执行默认的打印操作。</li>
<li>操作中的每个语句都要用分号分隔。</li>
</ol>

<h2 id="4-awk-的基本使用方法">4. awk 的基本使用方法</h2>

<h3 id="4-1-从命令行读取程序脚本">4.1 从命令行读取程序脚本</h3>

<p>awk 程序脚本用 <strong>一对花括号</strong> 来定义，必须将脚本命令放到两个花括号中。由于 awk 命令假定脚本是单个文本字符串，所以必须将脚本放到
<strong>单引号</strong> 中。举个栗子：</p>

<pre><code>awk '{print $0}'
</code></pre>

<p>这个程序脚本定义了一个命令，即 print 命令。该程序会一直等待从 STDIN 输入的文本，然后打印出来。在命令行运行脚本的效果如下：</p>

<pre><code>sk@sk ~ $ awk '{print $0}'
hello world
hello world
hello sk
hello sk
</code></pre>

<h3 id="4-2-使用数据字段变量">4.2 使用数据字段变量</h3>

<p>awk 会自动给每行中的每一个字段分配一个变量。每一个字段通过字段分割符来划分，默认的字段分隔符是任意的空白字符（空格或者制表符）。默认情况下，awk
会将如下变量分配给每一个字段。</p>

<table>
<thead>
<tr>
<th>变量</th>
<th>变量含义</th>
</tr>
</thead>

<tbody>
<tr>
<td>$0</td>
<td>整行文本</td>
</tr>

<tr>
<td>$1</td>
<td>文本行中的第1个字段</td>
</tr>

<tr>
<td>$2</td>
<td>文本行中的第2个字段</td>
</tr>

<tr>
<td>…</td>
<td>…</td>
</tr>

<tr>
<td>$n</td>
<td>文本行中的第n个字段</td>
</tr>
</tbody>
</table>

<p>假设我们有如下的文件</p>

<pre><code>$cat employee.txt

100  Thomas  Manager    Sales       $5,000
200  Jason   Developer  Technology  $5,500
300  Sanjay  Sysadmin   Technology  $7,000
400  Nisha   Manager    Marketing   $9,500
500  Randy   DBA        Technology  $6,000
</code></pre>

<p>然后，我们只打印每个人的人名。</p>

<pre><code>awk '{print $2}' employee.txt
</code></pre>

<p>输出结果如下：</p>

<pre><code>Thomas
Jason
Sanjay
Nisha
Randy
</code></pre>

<h3 id="4-3-在程序脚本中使用多个命令">4.3 在程序脚本中使用多个命令</h3>

<p>在 awk 的程序脚本中，采用分号（;）来区分每条命令。比如：</p>

<pre><code>echo &quot;hello world&quot; | awk '{$2=$2&quot;!&quot;; $3=&quot;my name is sk&quot;; print $0}'
</code></pre>

<p>上述指令，是将  2，也就是&rdquo;world&rdquo;，重新赋值成&rdquo;world!&ldquo;。然后，又添加了 3 变量，最后打印整行文本。运行结果如下：</p>

<pre><code>hello world! my name is sk
</code></pre>

<h3 id="4-4-在处理数据前运行脚本">4.4 在处理数据前运行脚本</h3>

<p>有时候，我们需要 awk 在处理每行文本前运行某些指令，比如打印报告开头部分。此时，我们可以使用关键字 <strong>BEGIN</strong> 来标示 awk 开始部分。
awk 会在处理每行文本前执行 <strong>BEGIN</strong> 关键字后面指定的程序脚本。</p>

<p>比如，我们给 employee.txt 文本添加一个报告开头，然后，在打印出来。</p>

<pre><code>awk '
BEGIN {print &quot;工号     姓名    岗位    职能    薪水&quot;; print &quot;----      ----    ----    ----    ----&quot;} 
{print $0}
' employee.txt 
</code></pre>

<p>运行结果如下</p>

<pre><code>工号     姓名    岗位    职能    薪水
----      ----    ----    ----    ----
100  Thomas  Manager    Sales       $5,000
200  Jason   Developer  Technology  $5,500
300  Sanjay  Sysadmin   Technology  $7,000
400  Nisha   Manager    Marketing   $9,500
500  Randy   DBA        Technology  $6,000
</code></pre>

<h3 id="4-5-在处理数据后运行脚本">4.5 在处理数据后运行脚本</h3>

<p>跟 <strong>BEGIN</strong> 类似， <strong>END</strong> 关键字允许我们指定一个程序脚本，然后 awk 在读完所有数据之后，执行 <strong>END</strong>
指定的程序脚本。采用这种方法，我们可以个报告添加结尾。比如，我们给 employee.txt 文本添加一个报告结尾。</p>

<pre><code>awk '
BEGIN {print &quot;工号     姓名    岗位    职能    薪水&quot;; print &quot;----      ----    ----    ----    ----&quot;} 
{print $0}
END {print &quot;----------------------&quot;; print &quot;This is all employee info&quot;}
' employee.txt
</code></pre>

<p>运行结果如下：</p>

<pre><code>工号     姓名    岗位    职能    薪水
----      ----    ----    ----    ----
100  Thomas  Manager    Sales       $5,000
200  Jason   Developer  Technology  $5,500
300  Sanjay  Sysadmin   Technology  $7,000
400  Nisha   Manager    Marketing   $9,500
500  Randy   DBA        Technology  $6,000
----------------------
This is all employee info
</code></pre>

<h3 id="4-6-从文件中读取程序">4.6 从文件中读取程序</h3>

<p>有时候， awk 指令中，需要执行的脚本程序太多，我们就可以将程序存储到文件中，然后再在命令行中引用。 比如，我们有如下的脚本文件：</p>

<pre><code>$ cat cropt_employee

BEGIN {print &quot;工号     姓名    岗位    职能    薪水&quot;; print &quot;----      ----    ----    ----    ----&quot;}
{print $0}
END {print &quot;----------------------&quot;; print &quot;This is all employee info&quot;}
</code></pre>

<p>然后，我们在命令行中用 awk 指令去调用这个脚本文件。调用方法采用章节2中的 <strong>-f file</strong> options 选项。调用方法如下：</p>

<pre><code>awk -f scropt_employee employee.txt
</code></pre>

<p>执行的结果跟上面 3.5 小节的一样。</p>

<h2 id="5-awk-的高级使用方法">5. awk 的高级使用方法</h2>

<h3 id="5-1-使用变量">5.1 使用变量</h3>

<p>awk 有两种变量， 分别是内建变量和自定义变量。</p>

<h4 id="5-1-1-内建变量">5.1.1 内建变量</h4>

<p>awk 的内建变量有很多，其中主要的有：</p>

<table>
<thead>
<tr>
<th>变量</th>
<th>描述</th>
</tr>
</thead>

<tbody>
<tr>
<td>FS</td>
<td>输入字段分隔符</td>
</tr>

<tr>
<td>RS</td>
<td>输入数据行分隔符</td>
</tr>

<tr>
<td>OFS</td>
<td>输出字段分隔符</td>
</tr>

<tr>
<td>ORS</td>
<td>输出数据行分割符</td>
</tr>
</tbody>
</table>

<p>FS 变量会将输入数据按照 FS 变量来分隔字段。比如</p>

<pre><code>echo -e &quot;I,love,hinata&quot; | awk 'BEGIN {FS=&quot;,&quot;}{print $1, $2, $3}'
</code></pre>

<p>然后输出是</p>

<pre><code>I love hinata
</code></pre>

<p>而 RS 与 FS 不同的是，
它是根据数据行来作为分隔符的。比如，你有一些用户数据，包括用户名，用户住址，用户电话号码，但是每一个字段是按照一行来存储的，然后每一个用户之间的信息用一个空白行来分割，就像这样：</p>

<pre><code>$ cat user_info.txt

sk
china
0512-215215

hinata
china
0512-13141314
</code></pre>

<p>这时，你就可以用 RS=”” 来区分每一个用户，用 FS=’\n’来区分每一个用户中的字段。如下所示：</p>

<pre><code>awk 'BEGIN {RS=&quot;&quot;; FS=&quot;\n&quot;; print &quot;姓名  地址    电话&quot;} {print $1, $2, $3}' user_info.txt
</code></pre>

<p>输入如下</p>

<pre><code>姓名  地址    电话
sk china 0512-215215
hinata china 0512-13141314
</code></pre>

<p>OFS 和 ORS 与 FS 和 RS 相反，它们是控制输出数据的分隔。比如：</p>

<pre><code>echo -e &quot;i love hinata&quot; | awk 'BEGIN {OFS=&quot;--&gt;&quot;}{print $1, $2, $3}'
</code></pre>

<p>输出结果如下</p>

<pre><code>i--&gt;love--&gt;hinata
</code></pre>

<h4 id="5-1-2-自定义变量">5.1.2 自定义变量</h4>

<p>awk 允许我们定义自己的变量在程序脚本中使用。比如，我们创建一个简单的加法, 定义一个 sum 变量，计算两个数的和。</p>

<pre><code>echo &quot;1+2&quot; | awk 'BEGIN {FS=&quot;+&quot;; sum=0}{sum=sum+$1+$2} END {print sum}'
</code></pre>

<p>最后的输出结果是 3</p>

<h3 id="5-2-处理数组">5.2 处理数组</h3>

<p>linux 中的数组是 <strong>关联数组</strong> 。 <strong>关联数组</strong> 中的索引值可以是任何的文本字符串，但是每个索引字符串都必须是唯一的。这跟其他语言（如
python）中的字典是同一个概念。</p>

<h4 id="5-2-1-定义数组">5.2.1 定义数组</h4>

<p>数组的定义如下</p>

<pre><code>var[index] = element 
</code></pre>

<p>比如，</p>

<pre><code>awk '
BEGIN {
    var[1]=34
    var[2]=3
    total=var[1]+var[2]
    print total
}
' 
</code></pre>

<h4 id="5-2-2-遍历数组">5.2.2 遍历数组</h4>

<p>可以使用 for 语句来遍历数组</p>

<pre><code>for (var in array) {
    statements 
}


awk '           
BEGIN {
    var[&quot;i&quot;] = 1
    var[&quot;k&quot;] = 2
    var[&quot;s&quot;] =9
    for ( test in var ) {                  
        print &quot;Index:&quot;, test, &quot; - Value&quot;, var[test]
    }                                          
}
'
</code></pre>

<h3 id="5-3-使用模式">5.3 使用模式</h3>

<p>awk 使用模式来过滤数据行。 BEGIN 和 END
关键字是用来在读取数据流之前或者之后执行命令的特殊模式。我们也可以使用其他的模式来在数据流中出现匹配数据时执行一些命令。</p>

<h4 id="5-3-1-正则表达式">5.3.1 正则表达式</h4>

<p>使用正则表达式时，正则表达式必须出现在它要控制的程序脚本的花括号前面。awk
会用正则表达式对数据行中的所有数据字段进行匹配，包括字段分隔符。若匹配成功，则执行相应的指令。</p>

<pre><code>echo -e &quot;hello world \nhello hinata&quot; | awk 'BEGIN {print &quot;start&quot;} /hinata/{print $0}'
</code></pre>

<h4 id="5-3-2-匹配操作符">5.3.2 匹配操作符</h4>

<p>匹配操作符允许将正则表达式限定在数据行中的特定数据字段。匹配操作符是波浪线(~)。<br />
下面表示的是用 data2 去匹配第二个字段。</p>

<pre><code>echo -e &quot;data11,data12,data13\ndata21,data22,data23&quot; | awk -F, '$2 ~ /data2/{print $0}'
</code></pre>

<p>也可以用 ! 符号来排除正则表达式的匹配。</p>

<pre><code>echo -e &quot;data11,data12,data13\ndata21,data22,data23&quot; | awk -F, '$2 !~ /data2/{print $0}'
</code></pre>

<h4 id="5-3-3-数学表达式">5.3.3 数学表达式</h4>

<p>awk 允许我们在匹配模式中使用数学表达式。如下所示，是显示所有属于 root 用户组的系统用户。</p>

<pre><code>awk -F: '$4==0{print $1}' /etc/passwd
</code></pre>

<p>也可以对文本数据使用表达式，但是数据和模式必须完全匹配。</p>

<pre><code>echo -e &quot;data11,data12,data13\ndata21,data22,data23&quot; | awk -F, '$1==&quot;data1&quot;{print $0}'


echo -e &quot;data11,data12,data13\ndata21,data22,data23&quot; | awk -F, '$1==&quot;data11&quot;{print $0}'
</code></pre>

<h3 id="5-4-结构化命令">5.4 结构化命令</h3>

<h4 id="5-4-1-if-语句">5.4.1 if 语句</h4>

<p>awk 编程语言支持标准的 if-then-else 格式的 if 语句。格式如下：</p>

<pre><code>if (condition)
    statement1
</code></pre>

<p>如：</p>

<pre><code>echo -e &quot;2\n4\n6\n8&quot; | awk '{if ($1 &gt; 4) print $1 }'


echo -e &quot;2\n4\n6\n8&quot; | awk '{if ($1 &gt; 4){x=$1 * 2; print x}}'
</code></pre>

<h4 id="5-4-2-while-语句">5.4.2 while 语句</h4>

<p>while 语句的格式如下</p>

<pre><code>while (condition) {
    statements
}
</code></pre>

<p>如有如下的数据文件：</p>

<pre><code>$ cat data5 

110,120,145
223,345,666
234,563,854
</code></pre>

<p>我们计算每一行的平均值为：</p>

<pre><code>awk '
BEGIN {
    FS = &quot;,&quot;
    num = 4
}
{
    total = 0
    i = 1
    while (i &lt; num){
        total += $i
        i++
    }
    avg = total / 3
    print &quot;Average:&quot;, avg
}
' data5
</code></pre>

<p>输出如下：</p>

<pre><code>Average: 125
Average: 411.333
Average: 550.333
</code></pre>

<h4 id="5-4-3-do-while-语句">5.4.3 do-while 语句</h4>

<p>do-while 语句和 while 语句类似，只不过， do-while 语句至少执行一次。格式如下：</p>

<pre><code>do {
    statement
} while (condition)
</code></pre>

<h4 id="5-4-4-for-语句">5.4.4 for 语句</h4>

<p>awk 支持 c 风格的 for 循环， 格式如下：</p>

<pre><code>for(variable assignment; condition; iteration process) {
    statement
}
</code></pre>

<p>比如，我们将上面的求平均值的例子用 for 写出来为：</p>

<pre><code>awk '
BEGIN {
    FS = &quot;,&quot;
    num = 4
}
{
    total = 0
    for (i=1; i data5
</code></pre>

<h3 id="5-5-格式打印">5.5 格式打印</h3>

<p>awk 支持 c 语言中的 printf ， 允许指定具体的如何显示数据的指令。 printf 的格式如下：</p>

<pre><code>printf &quot;format string&quot;, var1, var2
</code></pre>

<p>“format string”
会用文本元素和格式化指定符来具体指定如何呈现格式化输出。格式化指定符是一种特殊的代码，它会指明什么类型的变量可以显示以及如何显示。指定符的格式为：</p>

<pre><code>%[modifier]control-letter
</code></pre>

<p>其中 modifier 是修饰符， 分别为</p>

<table>
<thead>
<tr>
<th>修饰符</th>
<th>描述</th>
</tr>
</thead>

<tbody>
<tr>
<td>width</td>
<td>指定输出字段最小宽度的数字值</td>
</tr>

<tr>
<td>prec</td>
<td>指定浮点数中小数点后面位数的数字值，或者文本字符串中显示的最大字符数</td>
</tr>

<tr>
<td>-</td>
<td>指明在向格式化空间中放入数据时采用左对齐而不是右对齐</td>
</tr>
</tbody>
</table>

<p>control-letter 是指明显示什么类型数据值的单字符码，各个类型的字符码表示如下</p>

<table>
<thead>
<tr>
<th>控制字母</th>
<th>描述</th>
</tr>
</thead>

<tbody>
<tr>
<td>d</td>
<td>显示一个整数值</td>
</tr>

<tr>
<td>i</td>
<td>同d</td>
</tr>

<tr>
<td>e</td>
<td>用科学计数法显示一个数</td>
</tr>

<tr>
<td>f</td>
<td>显示一个浮点值</td>
</tr>

<tr>
<td>o</td>
<td>显示一个八进制数</td>
</tr>

<tr>
<td>s</td>
<td>显示一个文本字符串</td>
</tr>

<tr>
<td>x</td>
<td>显示一个十六进制</td>
</tr>

<tr>
<td>X</td>
<td>显示一个十六进制，但是用大写字母A~F</td>
</tr>
</tbody>
</table>

<p>比如我们用科学计数法显示一个数</p>

<pre><code>awk 'BEGIN {
    x = 12345 * 6789
    printf &quot;the anwser is: %e\n&quot;, x
}'
</code></pre>

<p>格式化输出字符串</p>

<pre><code>awk 'BEGIN {
    FS=&quot;\n&quot;
    RS=&quot;&quot;
    printf &quot;%-10s   %-10s   %s\n&quot;, &quot;name&quot;, &quot;address&quot;, &quot;mobile&quot;
    printf &quot;%-10s   %-10s   %s\n&quot;, &quot;----&quot;, &quot;----&quot;, &quot;----&quot;
}
{
    printf &quot;%-10s   %-10s   %s\n&quot;, $1, $2, $3
}
' user_info.txt 
</code></pre>

<p>输出结果如下</p>

<pre><code>name         address      mobile
----         ----         ----
sk           china        0512-215215
hinata       china        0512-13141314
</code></pre>

<p>格式化打印浮点数</p>

<pre><code>awk '
BEGIN {
    FS = &quot;,&quot;
    num = 4
}
{
    total = 0
    for (i=1; i3
    printf &quot;Average: %-5.1f\n&quot;, avg
}' data5


Average: 125.0
Average: 411.3
Average: 550.3
</code></pre>

<h3 id="5-6-使用函数">5.6 使用函数</h3>

<h4 id="5-6-1-数学函数">5.6.1 数学函数</h4>

<p>awk 提供了内建的数学函数，比如 atan2(x,y), cos(x), int(x)等等。</p>

<h4 id="5-6-2-字符串函数">5.6.2 字符串函数</h4>

<p>内建的字符串函数有 length([s])， split(s, a[,t])， gsub(r,s,[,t])等等。</p>

<h4 id="5-6-3-时间函数">5.6.3 时间函数</h4>

<p>awk 提供一些函数来帮助处理时间值，比如：</p>

<pre><code>awk 'BEGIN {
    date = systime()
    day = strftime(&quot;%Y-%m-%d %H:%M:%S&quot;, date)
    print day
}
'
</code></pre>

<h4 id="5-6-4-自定义函数">5.6.4 自定义函数</h4>

<p>awk 允许我们创建自己的自定义函数，注意自定义函数必须放置在所有代码块之前，有助于将函数代码和 awk 程序的其他部分分开。</p>

<pre><code>awk '

function myprint() {
    printf &quot;%-16s - %s\n&quot;, $1, $3
}

BEGIN {
    FS=&quot;\n&quot;
    RS=&quot;&quot;
}

{
    myprint()
}
' user_info.txt 
</code></pre>

<p>运行结果如下:</p>

<pre><code>sk               - 0512-215215
hinata           - 0512-13141314
</code></pre>

<p>同时，我们也可以创建自己的函数库，将函数写到一个文件里面，然后一同调用。我们可以使用多个 -f 参数来使用多个 awk 脚本文件和函数库文件。</p>

<pre><code>$ cat funclib 

function myprint() {
    printf &quot;%-16s - %s\n&quot;, $1, $3
}

function myrand(limit) {
    return int(limit * rand())
}

function printthird() {
    print $3
}

$ cat script 

BEGIN {
    rand_num = myrand(10)
    print rand_num
}


awk -f funclib -f script
</code></pre>

<h2 id="参考网址">参考网址</h2>

<ul>
<li><a href="http://www.thegeekstuff.com/2010/01/awk-introduction-tutorial-7-awk-print-examples/">http://www.thegeekstuff.com/2010/01/awk-introduction-tutorial-7-awk-print-examples/</a></li>
<li><a href="http://www.thegeekstuff.com/2010/02/awk-conditional-statements/">http://www.thegeekstuff.com/2010/02/awk-conditional-statements/</a></li>
<li>《Linux命令行与shell脚本编程大全》</li>
</ul>

        </div>

        


        

<div class="post-archive">
    <h2>See Also</h2>
    <ul class="listing">
        
        <li><a href="/posts/007hadoop%E9%9B%86%E7%BE%A4%E9%85%8D%E7%BD%AEhadoop%E9%9B%86%E7%BE%A4%E7%9A%84%E5%90%AF%E5%8A%A8%E5%92%8C%E6%B5%8B%E8%AF%95ssh%E5%85%8D%E7%99%BB%E9%99%86%E9%85%8D%E7%BD%AEstartallshhdfs%E5%B8%B8%E7%94%A8%E7%9A%84shell/">007Hadoop集群配置Hadoop集群的启动和测试SSH免登陆配置startallshhdfs常用的shell</a></li>
        
        <li><a href="/posts/009shell%E8%84%9A%E6%9C%AC%E4%B8%8B%E6%9D%A1%E4%BB%B6%E6%B5%8B%E8%AF%95eqne/">009Shell脚本下条件测试eqne</a></li>
        
        <li><a href="/posts/00pythonmanagepyshell%E5%92%8Cpython%E7%9A%84%E5%88%86%E6%9E%90/">00Pythonmanagepyshell和Python的分析</a></li>
        
        <li><a href="/posts/010zookeeper%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5zookeeper%E7%9A%84%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BAzookeeper%E7%9A%84shell%E5%91%BD%E4%BB%A4/">010Zookeeper的基本概念Zookeeper的集群搭建Zookeeper的shell命令</a></li>
        
        <li><a href="/posts/018dockerfileshell/">018DockerfileSHELL</a></li>
        
    </ul>
</div>


        <div class="post-meta meta-tags">
            
            <ul class="clearfix">
                
                <li><a href='https://zaina.newban.cn/tags/shell'>shell</a></li>
                
            </ul>
            
        </div>
    </article>
    
    

    
    
</div>

                    <footer id="footer">
    <div>
        &copy; 2020 <a href="https://zaina.newban.cn">开发者问答集锦 By </a>
        
    </div>
    <br />
    <div>
        <div class="github-badge">
            <a href="https://gohugo.io/" target="_black" rel="nofollow"><span class="badge-subject">Powered by</span><span class="badge-value bg-blue">Hugo</span></a>
        </div>
        <div class="github-badge">
            <a href="https://www.flysnow.org/" target="_black"><span class="badge-subject">Design by</span><span class="badge-value bg-brightgreen">飞雪无情</span></a>
        </div>
        <div class="github-badge">
            <a href="https://github.com/flysnow-org/maupassant-hugo" target="_black"><span class="badge-subject">Theme</span><span class="badge-value bg-yellowgreen">Maupassant</span></a>
        </div>
    </div>
</footer>


    
    <script type="text/javascript">
        window.MathJax = {
            tex2jax: {
                inlineMath: [['$', '$']],
                processEscapes: true
                }
            };
    </script>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML' async></script>

<a id="rocket" href="#top"></a>
<script type="text/javascript" src='/js/totop.js?v=0.0.0' async=""></script>



    <script type="text/javascript" src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script>




                </div>

                <div id="secondary">
    <section class="widget">
        <form id="search" action='https://zaina.newban.cn/search/' method="get" accept-charset="utf-8" target="_blank" _lpchecked="1">
      
      <input type="text" name="q" maxlength="20" placeholder="Search">
      <input type="hidden" name="sitesearch" value="https://zaina.newban.cn">
      <button type="submit" class="submit icon-search"></button>
</form>
    </section>
    
    <section class="widget">
        <h3 class="widget-title">最近文章</h3>
<ul class="widget-list">
    
    <li>
        <a href="https://zaina.newban.cn/posts/001rubyruby%E4%B8%AD%E5%85%A8%E5%B1%80%E5%8F%98%E9%87%8F%E5%AE%9E%E4%BE%8B%E5%8F%98%E9%87%8F%E5%B1%80%E9%83%A8%E5%8F%98%E9%87%8F%E7%B1%BB%E5%8F%98%E9%87%8Fsymbol%E5%AF%B9%E6%AF%94/" title="001rubyRuby中全局变量实例变量局部变量类变量Symbol对比">001rubyRuby中全局变量实例变量局部变量类变量Symbol对比</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/007hadoop%E9%9B%86%E7%BE%A4%E9%85%8D%E7%BD%AEhadoop%E9%9B%86%E7%BE%A4%E7%9A%84%E5%90%AF%E5%8A%A8%E5%92%8C%E6%B5%8B%E8%AF%95ssh%E5%85%8D%E7%99%BB%E9%99%86%E9%85%8D%E7%BD%AEstartallshhdfs%E5%B8%B8%E7%94%A8%E7%9A%84shell/" title="007Hadoop集群配置Hadoop集群的启动和测试SSH免登陆配置startallshhdfs常用的shell">007Hadoop集群配置Hadoop集群的启动和测试SSH免登陆配置startallshhdfs常用的shell</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/009shell%E8%84%9A%E6%9C%AC%E4%B8%8B%E6%9D%A1%E4%BB%B6%E6%B5%8B%E8%AF%95eqne/" title="009Shell脚本下条件测试eqne">009Shell脚本下条件测试eqne</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/00pythonmanagepyshell%E5%92%8Cpython%E7%9A%84%E5%88%86%E6%9E%90/" title="00Pythonmanagepyshell和Python的分析">00Pythonmanagepyshell和Python的分析</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/010zookeeper%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5zookeeper%E7%9A%84%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BAzookeeper%E7%9A%84shell%E5%91%BD%E4%BB%A4/" title="010Zookeeper的基本概念Zookeeper的集群搭建Zookeeper的shell命令">010Zookeeper的基本概念Zookeeper的集群搭建Zookeeper的shell命令</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/018dockerfileshell/" title="018DockerfileSHELL">018DockerfileSHELL</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/01shell%E5%85%A5%E9%97%A801bashshell%E7%89%B9%E6%80%A7/" title="01Shell入门01bashShell特性">01Shell入门01bashShell特性</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/01shell%E5%8F%98%E9%87%8F/" title="01Shell变量">01Shell变量</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/01shell%E5%9F%BA%E7%A1%80%E6%A6%82%E8%BF%B0%E8%84%9A%E6%9C%AC%E6%89%A7%E8%A1%8C%E6%96%B9%E5%BC%8Fbash%E5%9F%BA%E6%9C%AC%E5%8A%9F%E8%83%BD/" title="01Shell基础概述脚本执行方式Bash基本功能">01Shell基础概述脚本执行方式Bash基本功能</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/01shell%E7%BC%96%E7%A8%8Bhelloworld/" title="01shell编程helloworld">01shell编程helloworld</a>
    </li>
    
</ul>
    </section>

    

    <section class="widget">
        <h3 class="widget-title"><a href="/categories">分类</a></h3>
<ul class="widget-list">
    
</ul>
    </section>

    <section class="widget">
        <h3 class="widget-title"><a href="/tags">标签</a></h3>
<div class="tagcloud">
    
    <a href="https://zaina.newban.cn/tags/ruby/">ruby</a>
    
    <a href="https://zaina.newban.cn/tags/shell/">shell</a>
    
</div>
    </section>

    

    <section class="widget">
        <h3 class="widget-title">其它</h3>
        <ul class="widget-list">
            <li><a href="https://zaina.newban.cn/index.xml">文章 RSS</a></li>
        </ul>
    </section>
</div>
            </div>
        </div>
    </div>
</body>

</html>