<!doctype html>
<html lang="en-us">
<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">


    <title>Posts | 开发者问答集锦</title>
    <meta property="og:title" content="Posts - 开发者问答集锦">
    <meta property="og:type" content="article">
        
        
    <meta name="Keywords" content="">
    <meta name="description" content="Posts">
        
    <meta name="author" content="">
    <meta property="og:url" content="https://zaina.newban.cn/posts/">
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">

    <link rel="stylesheet" href='/css/normalize.css'>
    <link rel="stylesheet" href='/css/style.css'>
    <link rel="alternate" type="application/rss+xml+xml" href="https://zaina.newban.cn/posts/index.xml" title="开发者问答集锦" />
    <script type="text/javascript" src="//cdn.bootcdn.net/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

    
    
    
    
    
    
</head>


<body>
    <header id="header" class="clearfix">
    <div class="container">
        <div class="col-group">
            <div class="site-name ">
                
                    <a id="logo" href="https://zaina.newban.cn">
                        开发者问答集锦
                    </a>
                
                
            </div>
            <div>
                <nav id="nav-menu" class="clearfix">
                    <a class="" href="https://zaina.newban.cn">首页</a>
                    
                </nav>
            </div>
        </div>
    </div>
</header>

    <div id="body">
        <div class="container">
            <div class="col-group">

                <div class="col-8" id="main">
                    
<div class="res-cons">
    
    
    <article class="post">
        <header>
            <h1 class="post-title">
                <a href="https://zaina.newban.cn/posts/sparkshell%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B/" title="SparkShell入门教程">SparkShell入门教程</a>
            </h1>
        </header>
        <date class="post-meta meta-date">
            2020年9月2日
        </date>
        
        <div class="post-content">
            教程目录  0x00 教程内容 0x01 Spark Shell 操作 * 1. 启动与关闭 Spark Shell * 2. 使用 Spark Shell 进行 Scala 编程 0x02 测试词频统计案例 * 1. 查看 Spark Shell 的启动信息 * 2. 修改词频统计代码 * 3. 执行词频统计代码 0x03 Pyspark 初体验 * 1. 启动与关闭 Pyspark * 2. 执行 Pyspark 并查看结果 0xFF 总结  0x00 教程内容  Spark Shell 操作 测试词频统计案例 Pyspark 初体验  学习前提：有一定的Scala基础、基本的 Linux 基础，对Spark有一定的概念，并且安装好了Spark环境。
相关环境参考教程：
1、分布式集群环境之Scala的安装与配置（Centos7）
2、分布式集群环境之Spark的安装与配置（Centos7）
0x01 Spark Shell 操作 1.……
        </div>
        <p class="readmore"><a href="https://zaina.newban.cn/posts/sparkshell%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B/">阅读全文</a></p>
    </article>
    
    
    
    <article class="post">
        <header>
            <h1 class="post-title">
                <a href="https://zaina.newban.cn/posts/sparkshell%E4%B8%AD%E7%BC%96%E5%86%99wordcount%E7%A8%8B%E5%BA%8F/" title="sparkshell中编写WordCount程序">sparkshell中编写WordCount程序</a>
            </h1>
        </header>
        <date class="post-meta meta-date">
            2020年9月2日
        </date>
        
        <div class="post-content">
            启动hdfs 略
http://blog.csdn.net/zengmingen/article/details/53006541
启动spark 略
安装：http://blog.csdn.net/zengmingen/article/details/72123717
spark-shell：http://blog.csdn.net/zengmingen/article/details/72162821
准备数据 vi wordcount.txt
hello zeng hello miao hello gen hello zeng hello wen hello biao zeng miao gen zeng wen biao lu ting ting zhang xiao zhu chang sheng xiang qi lai zhu ye su ai ni  上传到hdfs hdfs dfs -put wordcount.txt /
编写代码 用scala语言，在spark-shell命令窗下
sc.textFile(&ldquo;hdfs://nbdo1:9000/wordcount.txt&rdquo;)
.flatMap(.split(&rdquo; &ldquo;)).map((,1)).reduceByKey(+)
.saveAsTextFile(&ldquo;hdfs://nbdo1:9000/out&rdquo;)
运行结果 
补充： 将运行结果保存到一个文件。点击阅读扩展
代码： sc.textFile(&ldquo;hdfs://nbdo1:9000/wordcount.txt&rdquo;)
.flatMap(.split(&rdquo; &ldquo;)).map((,1)).reduceByKey(+)
. coalesce(1,true).saveAsTextFile(&ldquo;hdfs://nbdo1:9000/out2&rdquo;)
运行结果……
        </div>
        <p class="readmore"><a href="https://zaina.newban.cn/posts/sparkshell%E4%B8%AD%E7%BC%96%E5%86%99wordcount%E7%A8%8B%E5%BA%8F/">阅读全文</a></p>
    </article>
    
    
    
    <article class="post">
        <header>
            <h1 class="post-title">
                <a href="https://zaina.newban.cn/posts/sparkshellscala%E4%BA%8C/" title="SparkshellScala二">SparkshellScala二</a>
            </h1>
        </header>
        <date class="post-meta meta-date">
            2020年9月2日
        </date>
        
        <div class="post-content">
            ……
        </div>
        <p class="readmore"><a href="https://zaina.newban.cn/posts/sparkshellscala%E4%BA%8C/">阅读全文</a></p>
    </article>
    
    
    
    <article class="post">
        <header>
            <h1 class="post-title">
                <a href="https://zaina.newban.cn/posts/sparkshellonyarn%E5%87%BA%E9%94%99%E8%A7%A3%E5%86%B3%E5%90%AF%E5%8A%A8%E5%91%BD%E4%BB%A4binsparkshellmasteryarnclient%E5%87%BA%E7%8E%B0%E9%94%99%E8%AF%AF%E7%B1%BBexecutorlauncher%E6%89%BE%E4%B8%8D%E5%88%B0/" title="sparkshellonyarn出错解决启动命令binsparkshellmasteryarnclient出现错误类ExecutorLauncher找不到">sparkshellonyarn出错解决启动命令binsparkshellmasteryarnclient出现错误类ExecutorLauncher找不到</a>
            </h1>
        </header>
        <date class="post-meta meta-date">
            2020年9月2日
        </date>
        
        <div class="post-content">
            ……
        </div>
        <p class="readmore"><a href="https://zaina.newban.cn/posts/sparkshellonyarn%E5%87%BA%E9%94%99%E8%A7%A3%E5%86%B3%E5%90%AF%E5%8A%A8%E5%91%BD%E4%BB%A4binsparkshellmasteryarnclient%E5%87%BA%E7%8E%B0%E9%94%99%E8%AF%AF%E7%B1%BBexecutorlauncher%E6%89%BE%E4%B8%8D%E5%88%B0/">阅读全文</a></p>
    </article>
    
    
    
    <article class="post">
        <header>
            <h1 class="post-title">
                <a href="https://zaina.newban.cn/posts/sparkshellonyarn%E5%87%BA%E9%94%99arnapplicationalreadyendedmightbekilledornotabletolaunchapplic%E8%A7%A3%E5%86%B3/" title="sparkshellonyarn出错arnapplicationalreadyendedmightbekilledornotabletolaunchapplic解决">sparkshellonyarn出错arnapplicationalreadyendedmightbekilledornotabletolaunchapplic解决</a>
            </h1>
        </header>
        <date class="post-meta meta-date">
            2020年9月2日
        </date>
        
        <div class="post-content">
            今天想要将spark-shell 在yarn-client的状态下 结果出错：
[hadoop@localhost spark-1.0.1-bin-hadoop2]$ bin/spark-shell --master yarn-client Spark assembly has been built with Hive, including Datanucleus jars on classpath 14/07/22 17:28:46 INFO spark.SecurityManager: Changing view acls to: hadoop 14/07/22 17:28:46 INFO spark.SecurityManager: SecurityManager: authentication disabled; ui acls disabled; users with view permissions: Set(hadoop) 14/07/22 17:28:46 INFO spark.HttpServer: Starting HTTP Server 14/07/22 17:28:46 INFO server.Server: jetty-8.y.z-SNAPSHOT 14/07/22 17:28:46 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:49827 Welcome to ____ __ / __/__ ___ _____/ /__ _\ \/ _ \/ _ `/ __/ '_/ /___/ .……
        </div>
        <p class="readmore"><a href="https://zaina.newban.cn/posts/sparkshellonyarn%E5%87%BA%E9%94%99arnapplicationalreadyendedmightbekilledornotabletolaunchapplic%E8%A7%A3%E5%86%B3/">阅读全文</a></p>
    </article>
    
    
    
    <article class="post">
        <header>
            <h1 class="post-title">
                <a href="https://zaina.newban.cn/posts/sparkshellmasteryarnclient%E5%BC%82%E5%B8%B8%E5%B7%B2%E7%BB%8F%E8%A7%A3%E5%86%B3/" title="sparkshellmasteryarnclient异常已经解决">sparkshellmasteryarnclient异常已经解决</a>
            </h1>
        </header>
        <date class="post-meta meta-date">
            2020年9月2日
        </date>
        
        <div class="post-content">
            [root@node1 ~]# spark-shell --master yarn-client Warning: Master yarn-client is deprecated since 2.0. Please use master &quot;yarn&quot; with specified deploy mode instead. Using Spark's default log4j profile: org/apache/spark/log4j-defaults.properties Setting default log level to &quot;WARN&quot;. To adjust logging level use sc.setLogLevel(newLevel). For SparkR, use setLogLevel(newLevel). 17/04/09 08:36:06 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable 17/04/09 08:36:11 WARN Client: Neither spark.yarn.jars nor spark.yarn.archive is set, falling back to uploading libraries under SPARK_HOME.……
        </div>
        <p class="readmore"><a href="https://zaina.newban.cn/posts/sparkshellmasteryarnclient%E5%BC%82%E5%B8%B8%E5%B7%B2%E7%BB%8F%E8%A7%A3%E5%86%B3/">阅读全文</a></p>
    </article>
    
    
    
    <article class="post">
        <header>
            <h1 class="post-title">
                <a href="https://zaina.newban.cn/posts/sparkshellcausedbyjavasqlsqlexceptionfailedtostartdatabasemetastoredbwith/" title="sparkshellCausedbyjavasqlSQLExceptionFailedtostartdatabasemetastoredbwith">sparkshellCausedbyjavasqlSQLExceptionFailedtostartdatabasemetastoredbwith</a>
            </h1>
        </header>
        <date class="post-meta meta-date">
            2020年9月2日
        </date>
        
        <div class="post-content">
            主要错误信息如下: Caused by: org.apache.derby.iapi.error.StandardException: Container Container(0, 401) cannot be opened; it either has been dropped or does not exist. Unable to instantiate org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient Caused by: java.sql.SQLException: Failed to start database 'metastore_db' with class loader org.apache.spark.sql.hive.client.IsolatedClientLoader$$anon$1@65d9e72a, see the next exception for details. Caused by: ERROR 40XD2: Container Container(0, 401) cannot be opened; it either has been dropped or does not exist. ...... 原因:可能之前您的环境和hive整合过 解决方法: 删除spark安装目录下的metastore_db目录,再次启动报如下错误 java.lang.IllegalArgumentException: Error while instantiating 'org.apache.spark.sql.hive.HiveSessionState': Caused by: java.……
        </div>
        <p class="readmore"><a href="https://zaina.newban.cn/posts/sparkshellcausedbyjavasqlsqlexceptionfailedtostartdatabasemetastoredbwith/">阅读全文</a></p>
    </article>
    
    
    
    <article class="post">
        <header>
            <h1 class="post-title">
                <a href="https://zaina.newban.cn/posts/sparkshell/" title="sparkshell">sparkshell</a>
            </h1>
        </header>
        <date class="post-meta meta-date">
            2020年9月2日
        </date>
        
        <div class="post-content">
            ……
        </div>
        <p class="readmore"><a href="https://zaina.newban.cn/posts/sparkshell/">阅读全文</a></p>
    </article>
    
    
    
    <article class="post">
        <header>
            <h1 class="post-title">
                <a href="https://zaina.newban.cn/posts/sparkpluginthatsupportforsparkauthorizersparkshellpysparkorsparksubmitbyranger/" title="sparkpluginthatsupportforsparkauthorizersparkshellpysparkorsparksubmitbyranger">sparkpluginthatsupportforsparkauthorizersparkshellpysparkorsparksubmitbyranger</a>
            </h1>
        </header>
        <date class="post-meta meta-date">
            2020年9月2日
        </date>
        
        <div class="post-content">
            源自： https://github.com/yaooqinn/spark-authorizer
Spark Authorizer Spark Authorizer provides you with SQL Standard Based Authorization for Apache Spark™ as same as SQL Standard Based Hive Authorization. While you are using Spark SQL or Dataset/DataFrame API to load data from tables embedded with Apache Hive™ metastore, this library provides row/column level fine- grained access controls by Apache Ranger™ or Hive SQL Standard Based Authorization.
Security is one of fundamental features for enterprise adoption.……
        </div>
        <p class="readmore"><a href="https://zaina.newban.cn/posts/sparkpluginthatsupportforsparkauthorizersparkshellpysparkorsparksubmitbyranger/">阅读全文</a></p>
    </article>
    
    
    
    <article class="post">
        <header>
            <h1 class="post-title">
                <a href="https://zaina.newban.cn/posts/sparkapp%E5%8E%8B%E6%B5%8B%E6%B8%85%E7%90%86%E6%A3%80%E6%9F%A5%E7%9B%B8%E5%85%B3shell1/" title="SPARKAPP压测清理检查相关SHELL1">SPARKAPP压测清理检查相关SHELL1</a>
            </h1>
        </header>
        <date class="post-meta meta-date">
            2020年9月2日
        </date>
        
        <div class="post-content">
            压力测试前需要对大数据环境、日志和存储数据库进行清理、检查环境是否可用、保存测试前的环境状态。
压力测试过程中需要定期检查PARQUET文件生成情况、报表生成情况、HBASE数据生成情况、是否有SPARK APP FAILED、收集错误日志等。
压力测试后需要检查PARQUET文件生成情况、报表生成情况、HBASE数据生成情况、是否有SPARK APP FAILED、收集错误日志、查看APP执行时间间隔、各主机CPU内存网络磁盘状况等。
基础脚本，eea_2_all.sh，分发命令到HDP集群各节点主机执行，内容如下，注意基础脚本运行于HDP第一台主机（与其他主机做免密处理）。
#!/bin/bash
#数组中用主机名亦可
HOSTS=(192.168.1.4 192.168.1.5 192.168.1.6 192.168.1.8 192.168.1.9 192.168.1.10 192.168.1.11 192.168.1.12 192.168.1.13)
COMMAND=$1
PROMPT=$2
if [ $# == 0 ] ; then
COMMAND=&ldquo;/bin/rm -rf /var/log/rmslog/*;/bin/echo &ldquo; &gt; /var/log/rmslog/debug.log;/bin/chmod 666 /var/log/rmslog/debug.log&rdquo;
PROMPT=&ldquo;Clear debug log&rdquo;
fi
count=1
for host in ${HOSTS[@]}
do
echo &ldquo;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;eea-younge-${count}.test&ndash;$host: ${PROMPT}&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;-&rdquo;
ssh $host ${COMMAND}
let count++
done
1.测试前的准备工作包括，
a.确保Hmaster上面的Hbase Thrift Server处于运行状态，命令如下。
. ssh 192.168.1.6 &ldquo;if test $(ps -ef | grep &lsquo;hbase.thrift.ThriftServer start&rsquo; | wc -l ) -eq 2 then ; echo &lsquo;Hbase Thrift Server is running.……
        </div>
        <p class="readmore"><a href="https://zaina.newban.cn/posts/sparkapp%E5%8E%8B%E6%B5%8B%E6%B8%85%E7%90%86%E6%A3%80%E6%9F%A5%E7%9B%B8%E5%85%B3shell1/">阅读全文</a></p>
    </article>
    
    
    



<ol class="page-navigator">
    
    <li class="prev">
        <a href="https://zaina.newban.cn/posts/page/471/">上一页</a>
    </li>
    

    

    
        
        
    
    

    
        
        
        <li >
            <a href="https://zaina.newban.cn/posts/">1</a>
        </li>
        
    
        
        <li>
            <span>...</span>
        </li>
        
    
        
        
        <li >
            <a href="https://zaina.newban.cn/posts/page/470/">470</a>
        </li>
        
    
        
        
        <li >
            <a href="https://zaina.newban.cn/posts/page/471/">471</a>
        </li>
        
    
        
        
        <li  class="current">
            <a href="https://zaina.newban.cn/posts/page/472/">472</a>
        </li>
        
    
        
        
        <li >
            <a href="https://zaina.newban.cn/posts/page/473/">473</a>
        </li>
        
    
        
        
        <li >
            <a href="https://zaina.newban.cn/posts/page/474/">474</a>
        </li>
        
    
        
        <li>
            <span>...</span>
        </li>
        
    
        
        
        <li >
            <a href="https://zaina.newban.cn/posts/page/1960/">1960</a>
        </li>
        
    

    
    

    <li class="next">
        <a href="https://zaina.newban.cn/posts/page/473/">下一页</a>
    </li>
    
</ol>




</div>

                    <footer id="footer">
    <div>
        &copy; 2020 <a href="https://zaina.newban.cn">开发者问答集锦 By </a>
        
    </div>
    <br />
    <div>
        <div class="github-badge">
            <a href="https://gohugo.io/" target="_black" rel="nofollow"><span class="badge-subject">Powered by</span><span class="badge-value bg-blue">Hugo</span></a>
        </div>
        <div class="github-badge">
            <a href="https://www.flysnow.org/" target="_black"><span class="badge-subject">Design by</span><span class="badge-value bg-brightgreen">飞雪无情</span></a>
        </div>
        <div class="github-badge">
            <a href="https://github.com/flysnow-org/maupassant-hugo" target="_black"><span class="badge-subject">Theme</span><span class="badge-value bg-yellowgreen">Maupassant</span></a>
        </div>
    </div>
</footer>



<a id="rocket" href="#top"></a>
<script type="text/javascript" src='/js/totop.js?v=0.0.0' async=""></script>



    <script type="text/javascript" src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script>




                </div>

                <div id="secondary">
    <section class="widget">
        <form id="search" action='https://zaina.newban.cn/search/' method="get" accept-charset="utf-8" target="_blank" _lpchecked="1">
      
      <input type="text" name="q" maxlength="20" placeholder="Search">
      <input type="hidden" name="sitesearch" value="https://zaina.newban.cn">
      <button type="submit" class="submit icon-search"></button>
</form>
    </section>
    
    <section class="widget">
        <h3 class="widget-title">最近文章</h3>
<ul class="widget-list">
    
    <li>
        <a href="https://zaina.newban.cn/posts/001rubyruby%E4%B8%AD%E5%85%A8%E5%B1%80%E5%8F%98%E9%87%8F%E5%AE%9E%E4%BE%8B%E5%8F%98%E9%87%8F%E5%B1%80%E9%83%A8%E5%8F%98%E9%87%8F%E7%B1%BB%E5%8F%98%E9%87%8Fsymbol%E5%AF%B9%E6%AF%94/" title="001rubyRuby中全局变量实例变量局部变量类变量Symbol对比">001rubyRuby中全局变量实例变量局部变量类变量Symbol对比</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/007hadoop%E9%9B%86%E7%BE%A4%E9%85%8D%E7%BD%AEhadoop%E9%9B%86%E7%BE%A4%E7%9A%84%E5%90%AF%E5%8A%A8%E5%92%8C%E6%B5%8B%E8%AF%95ssh%E5%85%8D%E7%99%BB%E9%99%86%E9%85%8D%E7%BD%AEstartallshhdfs%E5%B8%B8%E7%94%A8%E7%9A%84shell/" title="007Hadoop集群配置Hadoop集群的启动和测试SSH免登陆配置startallshhdfs常用的shell">007Hadoop集群配置Hadoop集群的启动和测试SSH免登陆配置startallshhdfs常用的shell</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/009shell%E8%84%9A%E6%9C%AC%E4%B8%8B%E6%9D%A1%E4%BB%B6%E6%B5%8B%E8%AF%95eqne/" title="009Shell脚本下条件测试eqne">009Shell脚本下条件测试eqne</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/00pythonmanagepyshell%E5%92%8Cpython%E7%9A%84%E5%88%86%E6%9E%90/" title="00Pythonmanagepyshell和Python的分析">00Pythonmanagepyshell和Python的分析</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/010zookeeper%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5zookeeper%E7%9A%84%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BAzookeeper%E7%9A%84shell%E5%91%BD%E4%BB%A4/" title="010Zookeeper的基本概念Zookeeper的集群搭建Zookeeper的shell命令">010Zookeeper的基本概念Zookeeper的集群搭建Zookeeper的shell命令</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/018dockerfileshell/" title="018DockerfileSHELL">018DockerfileSHELL</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/01shell%E5%85%A5%E9%97%A801bashshell%E7%89%B9%E6%80%A7/" title="01Shell入门01bashShell特性">01Shell入门01bashShell特性</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/01shell%E5%8F%98%E9%87%8F/" title="01Shell变量">01Shell变量</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/01shell%E5%9F%BA%E7%A1%80%E6%A6%82%E8%BF%B0%E8%84%9A%E6%9C%AC%E6%89%A7%E8%A1%8C%E6%96%B9%E5%BC%8Fbash%E5%9F%BA%E6%9C%AC%E5%8A%9F%E8%83%BD/" title="01Shell基础概述脚本执行方式Bash基本功能">01Shell基础概述脚本执行方式Bash基本功能</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/01shell%E7%BC%96%E7%A8%8Bhelloworld/" title="01shell编程helloworld">01shell编程helloworld</a>
    </li>
    
</ul>
    </section>

    

    <section class="widget">
        <h3 class="widget-title"><a href="/categories">分类</a></h3>
<ul class="widget-list">
    
</ul>
    </section>

    <section class="widget">
        <h3 class="widget-title"><a href="/tags">标签</a></h3>
<div class="tagcloud">
    
    <a href="https://zaina.newban.cn/tags/ruby/">ruby</a>
    
    <a href="https://zaina.newban.cn/tags/shell/">shell</a>
    
</div>
    </section>

    

    <section class="widget">
        <h3 class="widget-title">其它</h3>
        <ul class="widget-list">
            <li><a href="https://zaina.newban.cn/index.xml">文章 RSS</a></li>
        </ul>
    </section>
</div>
            </div>
        </div>
    </div>
</body>

</html>