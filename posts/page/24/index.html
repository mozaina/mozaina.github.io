<!doctype html>
<html lang="en-us">
<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">


    <title>Posts | 开发者问答集锦</title>
    <meta property="og:title" content="Posts - 开发者问答集锦">
    <meta property="og:type" content="article">
        
        
    <meta name="Keywords" content="">
    <meta name="description" content="Posts">
        
    <meta name="author" content="">
    <meta property="og:url" content="https://zaina.newban.cn/posts/">
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">

    <link rel="stylesheet" href='/css/normalize.css'>
    <link rel="stylesheet" href='/css/style.css'>
    <link rel="alternate" type="application/rss+xml+xml" href="https://zaina.newban.cn/posts/index.xml" title="开发者问答集锦" />
    <script type="text/javascript" src="//cdn.bootcdn.net/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

    
    
    
    
    
    
</head>


<body>
    <header id="header" class="clearfix">
    <div class="container">
        <div class="col-group">
            <div class="site-name ">
                
                    <a id="logo" href="https://zaina.newban.cn">
                        开发者问答集锦
                    </a>
                
                
            </div>
            <div>
                <nav id="nav-menu" class="clearfix">
                    <a class="" href="https://zaina.newban.cn">首页</a>
                    
                </nav>
            </div>
        </div>
    </div>
</header>

    <div id="body">
        <div class="container">
            <div class="col-group">

                <div class="col-8" id="main">
                    
<div class="res-cons">
    
    
    <article class="post">
        <header>
            <h1 class="post-title">
                <a href="https://zaina.newban.cn/posts/%E8%BF%90%E7%BB%B4%E7%9A%84shell%E5%B0%8F%E7%BC%961/" title="运维的shell小编1">运维的shell小编1</a>
            </h1>
        </header>
        <date class="post-meta meta-date">
            2020年9月2日
        </date>
        
        <div class="post-content">
            ……
        </div>
        <p class="readmore"><a href="https://zaina.newban.cn/posts/%E8%BF%90%E7%BB%B4%E7%9A%84shell%E5%B0%8F%E7%BC%961/">阅读全文</a></p>
    </article>
    
    
    
    <article class="post">
        <header>
            <h1 class="post-title">
                <a href="https://zaina.newban.cn/posts/%E8%BF%90%E7%BB%B4%E6%8A%80%E6%9C%AFshell%E8%84%9A%E6%9C%AC%E5%AE%9E%E7%8E%B0%E7%BA%BF%E7%A8%8B%E6%8C%82%E6%8E%89%E8%87%AA%E5%8A%A8%E9%87%8D%E5%90%AF%E5%8A%9F%E8%83%BD/" title="运维技术shell脚本实现线程挂掉自动重启功能">运维技术shell脚本实现线程挂掉自动重启功能</a>
            </h1>
        </header>
        <date class="post-meta meta-date">
            2020年9月2日
        </date>
        
        <div class="post-content">
            由于分布式系统的流行，服务器上面部署的项目都是多实例的。而我又希望有一个功能，当服务器出现异常情况能够自动重启实例。
所以我想到了使用shell脚本监控实例进程id，如果不存在的话，就重启对应的实例。
一、轮询监控实现：
1. 使用crontab，缺点一分钟轮询一次
2. 使用shell死循环进行轮询
参考：https://blog.csdn.net/u011261430/article/details/72921991
由于我们系统使用人数比较少，所以我选择crontab进行轮询
二、环境变量问题：
crontab中的环境变量默认不会将我们自行定义的环境变量载入进来，所以执行脚本的时候，需要执行source命令
source /etc/profile  三、日志输出
对于轮询失败的次数和时间需要进行统计，保证能够查询到，所以我们要将日志重定向到一个固定的目录，定时清理
*/1 * * * * /app/crontab/monitor.sh &gt;&gt; /app/crontab/kafka.log  四、代码实例：
crontab -e：将对应日志写入到文件中，方便后期查询失败的情况
*/1 * * * * /app/crontab/monitor.sh &gt;&gt; /app/crontab/kafka.log  文件目录结构：
├── app │ ├── crontab │ ├── kafka.log │ ├── monitor.sh  monitor.sh
记得必须先赋权
chmod 777 monitor.sh  具体代码
#!/bin/sh # 默认shell执行需要的内容 # 环境变量重新生效 source /etc/profile # 判断进程是否存在，记得使用grep -v 排除gerp进程 retDesc=`ps -ef | grep &quot;kafka.……
        </div>
        <p class="readmore"><a href="https://zaina.newban.cn/posts/%E8%BF%90%E7%BB%B4%E6%8A%80%E6%9C%AFshell%E8%84%9A%E6%9C%AC%E5%AE%9E%E7%8E%B0%E7%BA%BF%E7%A8%8B%E6%8C%82%E6%8E%89%E8%87%AA%E5%8A%A8%E9%87%8D%E5%90%AF%E5%8A%9F%E8%83%BD/">阅读全文</a></p>
    </article>
    
    
    
    <article class="post">
        <header>
            <h1 class="post-title">
                <a href="https://zaina.newban.cn/posts/%E8%BF%90%E7%BB%B4%E5%BF%85%E9%A1%BB%E5%AD%A6%E5%A5%BDshell/" title="运维必须学好shell">运维必须学好shell</a>
            </h1>
        </header>
        <date class="post-meta meta-date">
            2020年9月2日
        </date>
        
        <div class="post-content">
            @我家的馨宝儿！
备注：那么作为一个开发人员，尤其是对于大公司的开发人员或者分工比较明确的开发公司，运维的工作的确做得很少，那么今天首先一起学习以下shell。
课程的第一节主要介绍了shell以及他的种类、常见的shell、当前系统中shell的信息查看、shell脚本等
shell 是什么
它是操作系统和外部用户之间交互的一种 命令解释器
这句话是啥意思呢，意思就像翻译一样，就像咱俩咱一起可以说蔚县话一样，但是有时候和其他人说话你就需要用普通话，所以shell语言就起了普通话的作用，用来实现操作系统和我们外部用户的交流
shell 有两种:
图形界面shell GUI shell（实际工作中很少用，反正我咋用）
命令行 shell CLI shell，所谓命令行，就是没有图形化操作界面，是通过语言命令进行操作，这样说吧，通俗的说就是看电视
和听收音机的区别，这个命令行就像听收音机，没有形象的图形，但是操作快捷，执行效率高，还可以 实现自定义脚本
常见的shell:
sh/csh/ksh/bash
我们工作中用到的,一般就是 bash， 这个bash你就这样理解，因为shell有很多种类或者版本，那么bash就是其中一个常见的版本
查看shell 的信息(就是一些简单的查询语句) ，cat 是进行显示，echo是进行输出的，简单的说就是像大屏幕一样，将需要的东西通过固定语句进行结果显示
cat /etc/shells
echo $SHELL
echo $BASH_VERSION
shell 脚本基础信息：
shell脚本是一堆命令在文件中的组合
shell脚本的 首行是也必须是 shell 的命令解释器 #!/bin/bash
shell脚本的执行的顺序是 从上到下依次按照顺序执行的
那么第一张需要掌握的东西基本就是这些了！……
        </div>
        <p class="readmore"><a href="https://zaina.newban.cn/posts/%E8%BF%90%E7%BB%B4%E5%BF%85%E9%A1%BB%E5%AD%A6%E5%A5%BDshell/">阅读全文</a></p>
    </article>
    
    
    
    <article class="post">
        <header>
            <h1 class="post-title">
                <a href="https://zaina.newban.cn/posts/%E8%BF%90%E7%BB%B4%E5%BC%80%E5%8F%91%E5%B7%A5%E7%A8%8B%E5%B8%88%E9%9D%A2%E8%AF%95%E9%A2%98shell%E7%BC%96%E7%A8%8B/" title="运维开发工程师面试题shell编程">运维开发工程师面试题shell编程</a>
            </h1>
        </header>
        <date class="post-meta meta-date">
            2020年9月2日
        </date>
        
        <div class="post-content">
            1. 32位随机密码生成
cat /proc/sys/kernel/random/uuid | tr -d '-'  2.查看当前系统每个ip的tcp连接数
-n 强制显示IP地址
-t 显示TCP连接
sudo netstat -nt 2&gt; /dev/null | awk '/^tcp/ {print $5}' | cut -d ':' -f 1 | sort | uniq -c  3.显示 /etc/inittab 中包含了: 一个数字: 的行
grep ':[0-9]:' /etc/inittab  4.写一个脚本，批量添加20个用户，用户名为user01-20,密码为user后面跟5个随机字符
#!/bin/bash for n in `seq -w 1 20` do # 脚本第一个参数是A|a 时，批量创建uesr01-20,并将密码设为user加5个随机字符；脚本第一个参数是D|d时，批量删除user01-20 case $1 in A|a) sudo useradd -s /bin/bash user$n echo user$RANDOM | sudo passwd --stdin user$n ;; D|d) sudo userdel -r user$n ;; *) ;; esac done  附 连续输出 01 - 20 ，每个都是两个字符 seq -f &ldquo;%02g&rdquo; 1 20 ### seq -w 1 20……
        </div>
        <p class="readmore"><a href="https://zaina.newban.cn/posts/%E8%BF%90%E7%BB%B4%E5%BC%80%E5%8F%91%E5%B7%A5%E7%A8%8B%E5%B8%88%E9%9D%A2%E8%AF%95%E9%A2%98shell%E7%BC%96%E7%A8%8B/">阅读全文</a></p>
    </article>
    
    
    
    <article class="post">
        <header>
            <h1 class="post-title">
                <a href="https://zaina.newban.cn/posts/%E8%BF%90%E7%BB%B4%E5%B8%B8%E7%94%A8shell%E8%84%9A%E6%9C%AC/" title="运维常用shell脚本">运维常用shell脚本</a>
            </h1>
        </header>
        <date class="post-meta meta-date">
            2020年9月2日
        </date>
        
        <div class="post-content">
            ……
        </div>
        <p class="readmore"><a href="https://zaina.newban.cn/posts/%E8%BF%90%E7%BB%B4%E5%B8%B8%E7%94%A8shell%E8%84%9A%E6%9C%AC/">阅读全文</a></p>
    </article>
    
    
    
    <article class="post">
        <header>
            <h1 class="post-title">
                <a href="https://zaina.newban.cn/posts/%E8%BF%90%E7%BB%B4%E5%B8%B8%E7%94%A8shell/" title="运维常用shell">运维常用shell</a>
            </h1>
        </header>
        <date class="post-meta meta-date">
            2020年9月2日
        </date>
        
        <div class="post-content">
            ……
        </div>
        <p class="readmore"><a href="https://zaina.newban.cn/posts/%E8%BF%90%E7%BB%B4%E5%B8%B8%E7%94%A8shell/">阅读全文</a></p>
    </article>
    
    
    
    <article class="post">
        <header>
            <h1 class="post-title">
                <a href="https://zaina.newban.cn/posts/%E8%BF%90%E7%BB%B4%E5%B7%A5%E7%A8%8B%E5%B8%88%E5%BF%85%E9%A1%BB%E6%8E%8C%E6%8F%A1%E7%9A%84shell%E6%8A%80%E6%9C%AF%E5%AE%9E%E6%88%98%E5%86%85%E5%AE%B9/" title="运维工程师必须掌握的shell技术实战内容">运维工程师必须掌握的shell技术实战内容</a>
            </h1>
        </header>
        <date class="post-meta meta-date">
            2020年9月2日
        </date>
        
        <div class="post-content">
            ……
        </div>
        <p class="readmore"><a href="https://zaina.newban.cn/posts/%E8%BF%90%E7%BB%B4%E5%B7%A5%E7%A8%8B%E5%B8%88%E5%BF%85%E9%A1%BB%E6%8E%8C%E6%8F%A1%E7%9A%84shell%E6%8A%80%E6%9C%AF%E5%AE%9E%E6%88%98%E5%86%85%E5%AE%B9/">阅读全文</a></p>
    </article>
    
    
    
    <article class="post">
        <header>
            <h1 class="post-title">
                <a href="https://zaina.newban.cn/posts/%E8%BF%90%E7%BB%B4%E5%B7%A5%E7%A8%8B%E5%B8%88%E5%B7%A5%E4%BD%9C%E4%B8%AD%E5%AE%9E%E7%94%A8shell%E8%84%9A%E6%9C%AC%E4%B8%8E%E8%AF%AD%E5%8F%A5/" title="运维工程师工作中实用shell脚本与语句">运维工程师工作中实用shell脚本与语句</a>
            </h1>
        </header>
        <date class="post-meta meta-date">
            2020年9月2日
        </date>
        
        <div class="post-content">
            ……
        </div>
        <p class="readmore"><a href="https://zaina.newban.cn/posts/%E8%BF%90%E7%BB%B4%E5%B7%A5%E7%A8%8B%E5%B8%88%E5%B7%A5%E4%BD%9C%E4%B8%AD%E5%AE%9E%E7%94%A8shell%E8%84%9A%E6%9C%AC%E4%B8%8E%E8%AF%AD%E5%8F%A5/">阅读全文</a></p>
    </article>
    
    
    
    <article class="post">
        <header>
            <h1 class="post-title">
                <a href="https://zaina.newban.cn/posts/%E8%BF%90%E7%BB%B4%E5%88%A9%E5%99%A8%E9%92%89%E9%92%89%E6%9C%BA%E5%99%A8%E4%BA%BA%E8%84%9A%E6%9C%AC%E5%91%8A%E8%AD%A6linuxshell%E7%AF%87/" title="运维利器钉钉机器人脚本告警LinuxShell篇">运维利器钉钉机器人脚本告警LinuxShell篇</a>
            </h1>
        </header>
        <date class="post-meta meta-date">
            2020年9月2日
        </date>
        
        <div class="post-content">
            ……
        </div>
        <p class="readmore"><a href="https://zaina.newban.cn/posts/%E8%BF%90%E7%BB%B4%E5%88%A9%E5%99%A8%E9%92%89%E9%92%89%E6%9C%BA%E5%99%A8%E4%BA%BA%E8%84%9A%E6%9C%AC%E5%91%8A%E8%AD%A6linuxshell%E7%AF%87/">阅读全文</a></p>
    </article>
    
    
    
    <article class="post">
        <header>
            <h1 class="post-title">
                <a href="https://zaina.newban.cn/posts/%E8%BF%90%E7%BB%B4%E4%B9%8B%E9%81%93%E4%BD%BF%E7%94%A8shell%E8%84%9A%E6%9C%AC%E6%A3%80%E6%B5%8B%E8%BF%9C%E7%A8%8B%E4%B8%BB%E6%9C%BA%E6%98%AF%E5%90%A6%E5%AD%98%E6%B4%BB/" title="运维之道使用shell脚本检测远程主机是否存活">运维之道使用shell脚本检测远程主机是否存活</a>
            </h1>
        </header>
        <date class="post-meta meta-date">
            2020年9月2日
        </date>
        
        <div class="post-content">
            1、编写需检测主机存活IP集群文本 [root@master ~]# cat ip.txt 192.168.182.11 192.168.182.12 192.168.182.13 192.168.182.14  2、编写检测主机存活脚本 [root@master ~]# vim auto_check.sh #!/usr/bin/bash while read ip do fail_count=0 for count in {1..2} ///定义count次数 do ping -c1 -W1 $ip &amp;&gt;/dev/null if [ $? -eq 0 ];then echo -e &quot;\033[32mThe $ip ping is ok...\033[0m&quot; echo break else echo -e &quot;\033[31mThe server ping is failurl: $ip\033[0m&quot; let fail_count++ fi done if [ $fail_count -eq 2 ];then ///定义失败后执行次数 echo -e &quot;\033[31mThe $ip ping is failure.……
        </div>
        <p class="readmore"><a href="https://zaina.newban.cn/posts/%E8%BF%90%E7%BB%B4%E4%B9%8B%E9%81%93%E4%BD%BF%E7%94%A8shell%E8%84%9A%E6%9C%AC%E6%A3%80%E6%B5%8B%E8%BF%9C%E7%A8%8B%E4%B8%BB%E6%9C%BA%E6%98%AF%E5%90%A6%E5%AD%98%E6%B4%BB/">阅读全文</a></p>
    </article>
    
    
    



<ol class="page-navigator">
    
    <li class="prev">
        <a href="https://zaina.newban.cn/posts/page/23/">上一页</a>
    </li>
    

    

    
        
        
    
    

    
        
        
        <li >
            <a href="https://zaina.newban.cn/posts/">1</a>
        </li>
        
    
        
        <li>
            <span>...</span>
        </li>
        
    
        
        
        <li >
            <a href="https://zaina.newban.cn/posts/page/22/">22</a>
        </li>
        
    
        
        
        <li >
            <a href="https://zaina.newban.cn/posts/page/23/">23</a>
        </li>
        
    
        
        
        <li  class="current">
            <a href="https://zaina.newban.cn/posts/page/24/">24</a>
        </li>
        
    
        
        
        <li >
            <a href="https://zaina.newban.cn/posts/page/25/">25</a>
        </li>
        
    
        
        
        <li >
            <a href="https://zaina.newban.cn/posts/page/26/">26</a>
        </li>
        
    
        
        <li>
            <span>...</span>
        </li>
        
    
        
        
        <li >
            <a href="https://zaina.newban.cn/posts/page/1960/">1960</a>
        </li>
        
    

    
    

    <li class="next">
        <a href="https://zaina.newban.cn/posts/page/25/">下一页</a>
    </li>
    
</ol>




</div>

                    <footer id="footer">
    <div>
        &copy; 2020 <a href="https://zaina.newban.cn">开发者问答集锦 By </a>
        
    </div>
    <br />
    <div>
        <div class="github-badge">
            <a href="https://gohugo.io/" target="_black" rel="nofollow"><span class="badge-subject">Powered by</span><span class="badge-value bg-blue">Hugo</span></a>
        </div>
        <div class="github-badge">
            <a href="https://www.flysnow.org/" target="_black"><span class="badge-subject">Design by</span><span class="badge-value bg-brightgreen">飞雪无情</span></a>
        </div>
        <div class="github-badge">
            <a href="https://github.com/flysnow-org/maupassant-hugo" target="_black"><span class="badge-subject">Theme</span><span class="badge-value bg-yellowgreen">Maupassant</span></a>
        </div>
    </div>
</footer>



<a id="rocket" href="#top"></a>
<script type="text/javascript" src='/js/totop.js?v=0.0.0' async=""></script>



    <script type="text/javascript" src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script>




                </div>

                <div id="secondary">
    <section class="widget">
        <form id="search" action='https://zaina.newban.cn/search/' method="get" accept-charset="utf-8" target="_blank" _lpchecked="1">
      
      <input type="text" name="q" maxlength="20" placeholder="Search">
      <input type="hidden" name="sitesearch" value="https://zaina.newban.cn">
      <button type="submit" class="submit icon-search"></button>
</form>
    </section>
    
    <section class="widget">
        <h3 class="widget-title">最近文章</h3>
<ul class="widget-list">
    
    <li>
        <a href="https://zaina.newban.cn/posts/001rubyruby%E4%B8%AD%E5%85%A8%E5%B1%80%E5%8F%98%E9%87%8F%E5%AE%9E%E4%BE%8B%E5%8F%98%E9%87%8F%E5%B1%80%E9%83%A8%E5%8F%98%E9%87%8F%E7%B1%BB%E5%8F%98%E9%87%8Fsymbol%E5%AF%B9%E6%AF%94/" title="001rubyRuby中全局变量实例变量局部变量类变量Symbol对比">001rubyRuby中全局变量实例变量局部变量类变量Symbol对比</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/007hadoop%E9%9B%86%E7%BE%A4%E9%85%8D%E7%BD%AEhadoop%E9%9B%86%E7%BE%A4%E7%9A%84%E5%90%AF%E5%8A%A8%E5%92%8C%E6%B5%8B%E8%AF%95ssh%E5%85%8D%E7%99%BB%E9%99%86%E9%85%8D%E7%BD%AEstartallshhdfs%E5%B8%B8%E7%94%A8%E7%9A%84shell/" title="007Hadoop集群配置Hadoop集群的启动和测试SSH免登陆配置startallshhdfs常用的shell">007Hadoop集群配置Hadoop集群的启动和测试SSH免登陆配置startallshhdfs常用的shell</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/009shell%E8%84%9A%E6%9C%AC%E4%B8%8B%E6%9D%A1%E4%BB%B6%E6%B5%8B%E8%AF%95eqne/" title="009Shell脚本下条件测试eqne">009Shell脚本下条件测试eqne</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/00pythonmanagepyshell%E5%92%8Cpython%E7%9A%84%E5%88%86%E6%9E%90/" title="00Pythonmanagepyshell和Python的分析">00Pythonmanagepyshell和Python的分析</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/010zookeeper%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5zookeeper%E7%9A%84%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BAzookeeper%E7%9A%84shell%E5%91%BD%E4%BB%A4/" title="010Zookeeper的基本概念Zookeeper的集群搭建Zookeeper的shell命令">010Zookeeper的基本概念Zookeeper的集群搭建Zookeeper的shell命令</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/018dockerfileshell/" title="018DockerfileSHELL">018DockerfileSHELL</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/01shell%E5%85%A5%E9%97%A801bashshell%E7%89%B9%E6%80%A7/" title="01Shell入门01bashShell特性">01Shell入门01bashShell特性</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/01shell%E5%8F%98%E9%87%8F/" title="01Shell变量">01Shell变量</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/01shell%E5%9F%BA%E7%A1%80%E6%A6%82%E8%BF%B0%E8%84%9A%E6%9C%AC%E6%89%A7%E8%A1%8C%E6%96%B9%E5%BC%8Fbash%E5%9F%BA%E6%9C%AC%E5%8A%9F%E8%83%BD/" title="01Shell基础概述脚本执行方式Bash基本功能">01Shell基础概述脚本执行方式Bash基本功能</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/01shell%E7%BC%96%E7%A8%8Bhelloworld/" title="01shell编程helloworld">01shell编程helloworld</a>
    </li>
    
</ul>
    </section>

    

    <section class="widget">
        <h3 class="widget-title"><a href="/categories">分类</a></h3>
<ul class="widget-list">
    
</ul>
    </section>

    <section class="widget">
        <h3 class="widget-title"><a href="/tags">标签</a></h3>
<div class="tagcloud">
    
    <a href="https://zaina.newban.cn/tags/ruby/">ruby</a>
    
    <a href="https://zaina.newban.cn/tags/shell/">shell</a>
    
</div>
    </section>

    

    <section class="widget">
        <h3 class="widget-title">其它</h3>
        <ul class="widget-list">
            <li><a href="https://zaina.newban.cn/index.xml">文章 RSS</a></li>
        </ul>
    </section>
</div>
            </div>
        </div>
    </div>
</body>

</html>