<!doctype html>
<html lang="en-us">
<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">


    <title>shell中的条件判断与控制流程 | 开发者问答集锦</title>
    <meta property="og:title" content="shell中的条件判断与控制流程 - 开发者问答集锦">
    <meta property="og:type" content="article">
        
    <meta property="article:published_time" content='2020-09-02T00:00:00&#43;08:00'>
        
        
    <meta property="article:modified_time" content='2020-09-02T00:00:00&#43;08:00'>
        
    <meta name="Keywords" content="">
    <meta name="description" content="shell中的条件判断与控制流程">
        
    <meta name="author" content="">
    <meta property="og:url" content="https://zaina.newban.cn/posts/shell%E4%B8%AD%E7%9A%84%E6%9D%A1%E4%BB%B6%E5%88%A4%E6%96%AD%E4%B8%8E%E6%8E%A7%E5%88%B6%E6%B5%81%E7%A8%8B/">
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">

    <link rel="stylesheet" href='/css/normalize.css'>
    <link rel="stylesheet" href='/css/style.css'>
    <script type="text/javascript" src="//cdn.bootcdn.net/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

    
    
    
    
    
    
</head>


<body>
    <header id="header" class="clearfix">
    <div class="container">
        <div class="col-group">
            <div class="site-name ">
                
                    <a id="logo" href="https://zaina.newban.cn">
                        开发者问答集锦
                    </a>
                
                
            </div>
            <div>
                <nav id="nav-menu" class="clearfix">
                    <a class="" href="https://zaina.newban.cn">首页</a>
                    
                </nav>
            </div>
        </div>
    </div>
</header>

    <div id="body">
        <div class="container">
            <div class="col-group">

                <div class="col-8" id="main">
                    
<div class="res-cons">
    
    <article class="post">
        <header>
            <h1 class="post-title">shell中的条件判断与控制流程</h1>
        </header>
        <date class="post-meta meta-date">
            2020年9月2日
        </date>
        
        
        <div class="post-meta">
            <span id="busuanzi_container_page_pv">|<span id="busuanzi_value_page_pv"></span><span>
                    阅读</span></span>
        </div>
        
        
        <div class="post-content">
            

<h1 id="条件判断">条件判断</h1>

<p>1.按照文件类型进行判断</p>

<p>测试选项</p>

<p>|</p>

<p>作用</p>

<p>&mdash;|&mdash;</p>

<p>-b 文件</p>

<p>|</p>

<p>判断该文件是否存在，并且是否为块设备文件（是块设备文件则为真）</p>

<p>-c 文件</p>

<p>|</p>

<p>判断文件是否存在，并且是否为字符设备文件（是字符设备文件为真）</p>

<p>-d 文件</p>

<p>|</p>

<p>判断文件是否存在，并且是否为目录文件（是目录则为真）</p>

<p>-e 文件</p>

<p>|</p>

<p>判断文件是否存在（存在为真）</p>

<p>-f 文件</p>

<p>|</p>

<p>判断文件是否存在，并且是否为普通文件（是普通文件则为真）</p>

<p>-L 文件</p>

<p>|</p>

<p>判断文件是否存在，并且是否为符号链接文件（是符号链接文件为真）</p>

<p>-p 文件</p>

<p>|</p>

<p>判断文件是否存在，并且是否为管道文件（是管道文件则为真）</p>

<p>-s 文件</p>

<p>|</p>

<p>判断文件是否存在，并且是否为空（非空为真）</p>

<p>-S 文件</p>

<p>|</p>

<p>判断文件是否存在，且是否为套接字文件（是套接字文件为真）</p>

<p>判断式有两种格式(通常使用后一种)：</p>

<p>test -e /etc/profile</p>

<p>[ -e /etc/profile ]（中括号和条件判断式之间一定要有空格！）</p>

<p>例如，执行：</p>

<p>[ -e /etc/profile ] &amp;&amp; echo yes || echo no</p>

<p>执行结果为  yes</p>

<p>2.按文件权限判断</p>

<p>测试选项</p>

<p>|</p>

<p>作用</p>

<p>&mdash;|&mdash;</p>

<p>-r 文件</p>

<p>|</p>

<p>文件存在且拥有读权限为真</p>

<p>-w 文件</p>

<p>|</p>

<p>文件存在且有写权限为真</p>

<p>-x 文件</p>

<p>|</p>

<p>文件存在且拥有执行权限为真</p>

<p>-u 文件</p>

<p>|</p>

<p>文件存在且拥有SUID权限为真</p>

<p>-g 文件</p>

<p>|</p>

<p>文件存在且拥有SGID权限为真</p>

<p>-k 文件</p>

<p>|</p>

<p>文件存在且拥有SBIT权限为真</p>

<p>例如执行：</p>

<p>[ -w /etc/profile ] &amp;&amp; echo yes || echo no结果为yes</p>

<p>这里要注意：权限测试并不区分是哪一个用户的权限，只要存在一个用户有相应的权限即为真。</p>

<p>3.比较两个文件</p>

<p>测试选项</p>

<p>|</p>

<p>作用</p>

<p>&mdash;|&mdash;</p>

<p>文件1 -nt文件2</p>

<p>|</p>

<p>判断文件1的修改时间是否比文件2新（新，则为真）</p>

<p>文件1 -ot文件2</p>

<p>|</p>

<p>判断文件1的修改时间是否比文件2旧（旧，则为真）</p>

<p>文件1 -ef文件2</p>

<p>|</p>

<p>判断文件1是否和文件2的lnode号一致，可以理解为判断两个文件是否为同一个文件。这个判断可用于判断硬链接。</p>

<p>例如，执行：</p>

<p>ln /home/hunan/student.txt /home/hunan/bin/stu.txt</p>

<p>[ /home/hunan/student.txt -ef /home/hunan/bin/stu.txt ] &amp;&amp; echoyes || echo no</p>

<p>上述命令先是创建了一个硬链接，然后判断指向的文件是否相同，结果为：yes</p>

<p>4.比较两个整数</p>

<p>测试选项</p>

<p>|</p>

<p>作用</p>

<p>&mdash;|&mdash;</p>

<p>整数1 -eq整数2</p>

<p>|</p>

<p>整数1等于整数2为真</p>

<p>整数1 -ne整数2</p>

<p>|</p>

<p>整数1不等于整数2为真</p>

<p>整数1 -gt整数2</p>

<p>|</p>

<p>整数1大于整数2为真</p>

<p>整数1 -lt整数2</p>

<p>|</p>

<p>整数1小于整数2为真</p>

<p>整数1 -ge整数2</p>

<p>|</p>

<p>整数1大于等于整数2为真</p>

<p>整数1 -le整数2</p>

<p>|</p>

<p>整数1小于等于整数2为真</p>

<p>例如，执行：</p>

<p>$[ 23 -gt 22 ] &amp;&amp; echo yes || echo no</p>

<p>yes</p>

<p>$[ 23 -lt 22 ] &amp;&amp; echo yes || echo no</p>

<p>no</p>

<p>5.比较两个字符串</p>

<p>测试选项</p>

<p>|</p>

<p>作用</p>

<p>&mdash;|&mdash;</p>

<p>-z 字符串</p>

<p>|</p>

<p>字符串为空返回真</p>

<p>-n 字符串</p>

<p>|</p>

<p>字符串非空返回真</p>

<p>字符串1==字符串2</p>

<p>|</p>

<p>字符串1和字符串2相等返回真</p>

<p>字符串1！=字符串2</p>

<p>|</p>

<p>字符串1和字符串2不相等返回真</p>

<p>例如，执行：</p>

<p>$name=mike</p>

<p>$[ -z $name ] &amp;&amp; echo yes || echo no</p>

<p>no</p>

<p>$[ $name == mike ] &amp;&amp; echo yes || echo no</p>

<p>yes</p>

<p>6.shell中的与，或，非</p>

<p>测试选项</p>

<p>|</p>

<p>作用</p>

<p>&mdash;|&mdash;</p>

<p>判断式1 -a判断式2</p>

<p>|</p>

<p>逻辑与</p>

<p>判断式1 -o判断式2</p>

<p>|</p>

<p>逻辑或</p>

<p>！ 判断式</p>

<p>|</p>

<p>逻辑非</p>

<p>例如，执行：</p>

<p>$aa=11</p>

<p>$[ -n $aa -a &ldquo;$aa&rdquo; -gt 22 ] &amp;&amp; echo yes || echo no</p>

<p>no</p>

<p><strong>控制流程</strong></p>

<p>1.单分支if条件语句</p>

<pre><code>if [ 条件判断式 ];then
    程序
fi
</code></pre>

<p>或者</p>

<pre><code>if [ 条件判断式 ]
    then
        程序
fi
</code></pre>

<p>注意：</p>

<p>1.要记得以fi结尾/2.条件判断式和中括号之间必须有空格/3.如果then和if在同一行要以 ; 分隔。</p>

<p>示例1：判断当前用户是否为root用户。思路：用env输出所有环境变量，用grep提取出USER变量，用cut将USER=XXX以“=”为分隔符切分，取切分后的第二个字符串即为当前用户名。命令之间以管道连接。</p>

<p>脚本内容：</p>

<pre><code>#!/bin/bash
#提取出用户名赋值给test变量
test=$(env| grep USER | cut -d &quot;=&quot; -f 2)
if [ $test == &quot;root&quot; ];then
    echo &quot;this is root login.&quot;
fi
</code></pre>

<p>注意：要给脚本执行权限才能执行（ chmoda+x *.sh ）。</p>

<p>示例2：判断分区使用率。当根分区使用率大于某一阈值，给出警告。思路：</p>

<p>df -h | grep sda4 | awk &lsquo;{print $5}&rsquo;| cut -d &ldquo;%&rdquo; -f 1</p>

<p>df -h打印分区信息，我这里的根分区挂在在sda4，用grep过滤出这一行，用awk打印出第五部分，在用cut切掉%号。即可得到使用率数值。</p>

<p>脚本内容：</p>

<pre><code>#!/bin/bash
#提取出当前根分区的使用率
test=$(df -h | grep sda4 | awk '{print $5}' | cut -d &quot;%&quot; -f 1)
if [ &quot;$test&quot; -gt 30 ];then
    echo &quot;/ is full!&quot;
fi
</code></pre>

<p>（这里为了体现程序作用，阈值取 30%. ）</p>

<p>2.双分支if语句</p>

<pre><code>if[条件判断式 ]
    then
        条件成立时执行语句
    else
        条件不成立时执行语句
fi
</code></pre>

<p>示例3：用户输入一个路径，程序判断是否为一个目录。思路：用read命令读取用户输入，用-d判断是否为目录。</p>

<p>脚本内容：</p>

<pre><code>#!/bin/bash
read -t 30 -p &quot;请输入路径：&quot; path
if [ -d $path ];then
    echo &quot;is directory!&quot;
else
    echo &quot;not directory!&quot;
fi
</code></pre>

<p>示例4：判断apache服务是否启动。思路：用psaux列出所有进程，过滤出含有httpd但是不含grep的进程（因为grephttpd命令也会产生一个含有httpd的进程）</p>

<p>脚本内容：</p>

<pre><code>#！/bin/bash
test=$(ps aux | grep httpd | grep -v grep)
#如果字符串不为空
if [ -n $test ]
    then
        echo “$(date) httpd is ok” &gt;&gt; /tmp/autostart-acc.log
    else
        echo “$(date) restart httpd !!” &gt;&gt; /tmp/autostart-err.log
        /etc/rc.d/init.d/httpd start
fi
</code></pre>

<p>注意：这种方法，脚本名中不能含有httpd！</p>

<p>3.多分支if语句</p>

<pre><code>if [ 条件判断式1 ]
    then
        当条件判断式1成立，执行语句
elif [ 条件判断式2 ]
    then
        当条件判断式2成立，执行语句
             . . . 省略 . . .
else
    当所有条件判断式都不成立，执行语句
fi
</code></pre>

<p>示例 5 ：判断输入的文件类型</p>

<p>脚本内容：</p>

<pre><code>#!/bin/bash
#读入用户输入的路径
read -t 30 -p 请输入路径名: path
if [ -z $path ]
    then
        echo 请输入路径。
        exit 1
elif [ ! -e $path ]
    then
        echo 您输入的路径不存在！
        exit 2
elif [ -f $path ]
    then
        echo 您输入的是普通文件。
elif [ -d $path ]
    then
        echo 您输入的是目录。
else
    echo 您输入的是其它文件。
fi
</code></pre>

<ol>
<li><p>多分支 case 语句</p>

<p>case $变量名 in
    “值1”)
        如果变量的值等于值1，则执行程序1
        ;;
    “值2”)
        如果变量的值等于值2，则执行程序2
        ;;
    &hellip; 省略其它分支 &hellip;
    *)
        如果变量的值都不是以上的值，则执行此程序
    ;;
esac</p></li>
</ol>

<p>注意：每次选择之后都要加上“双分号”！除了最后的 * 其它的值都要被双引号引起来。</p>

<p>示例6：根据用户输入做出不同反应。</p>

<pre><code> #!/bin/bash
  read -t 30 -p '请输入你的选择 yes/no:' cho
  case $cho in
           &quot;yes&quot;)
                   echo 你的选择是yes
                   ;;
           &quot;no&quot;)
                   echo 你的选择是no
                   ;;
          *)
                  echo 你的选择是其它。
                  ;;
  esac
</code></pre>

<p>5.for循环</p>

<p>语法1：</p>

<pre><code>for  变量 in 值1 值2 值3...
    do
        程序
    done
</code></pre>

<p>示例 7 ：循环打印数字</p>

<pre><code>#!/bin/bash
for i in 1 2 3 4 5
    do
        echo $i
    done
</code></pre>

<p>示例 8 ：批量解压缩</p>

<pre><code>#!/bin/bash
cd /root/test
for i in $(ls *.tar.gz *.gz)
    do
        tar -zxf $i
    done
</code></pre>

<p>语法 2 ：</p>

<pre><code>for ((初始值; 循环空值条件; 变量变化))
    do
        程序
    done
</code></pre>

<p>示例 9 ：计算 1+2+&hellip;+100</p>

<pre><code>#!/bin/bash
   s=0
   for ((i=1; i&lt;=100; i=i+1))
           do
                   s=$(($s+$i))
           done
   echo $s
</code></pre>

<p>6.while循环</p>

<pre><code>while [ 条件判断式 ]
    do
        程序
    done
</code></pre>

<p>示例10：用while循环计算1+2+&hellip;+100</p>

<pre><code>#!/bin/bash
   s=0
   i=1
   while [ $i -le 100 ]
           do
                   s=$(($i+$s))
                   i=$(($i+1))
           done
   echo &quot;the sum is:&quot;$s
</code></pre>

<p>7.until 循环</p>

<p>until循环和while循环相反，until循环时只要条件判断式不成立则继续循环，一旦条件判断式成立则停止循环。</p>

<pre><code>until [ 条件判断式 ]
    do
        程序
    done
</code></pre>

<p>示例11：用until循环计算1+2+&hellip;+100</p>

<pre><code>   #!/bin/bash
   s=0
   i=1
   until [ $i -gt 100 ]
           do
                   s=$(($s+$i))
                   i=$(($i+1))
           done
   echo 'the sum is:'$s
</code></pre>

        </div>

        


        

<div class="post-archive">
    <h2>See Also</h2>
    <ul class="listing">
        
        <li><a href="/posts/007hadoop%E9%9B%86%E7%BE%A4%E9%85%8D%E7%BD%AEhadoop%E9%9B%86%E7%BE%A4%E7%9A%84%E5%90%AF%E5%8A%A8%E5%92%8C%E6%B5%8B%E8%AF%95ssh%E5%85%8D%E7%99%BB%E9%99%86%E9%85%8D%E7%BD%AEstartallshhdfs%E5%B8%B8%E7%94%A8%E7%9A%84shell/">007Hadoop集群配置Hadoop集群的启动和测试SSH免登陆配置startallshhdfs常用的shell</a></li>
        
        <li><a href="/posts/009shell%E8%84%9A%E6%9C%AC%E4%B8%8B%E6%9D%A1%E4%BB%B6%E6%B5%8B%E8%AF%95eqne/">009Shell脚本下条件测试eqne</a></li>
        
        <li><a href="/posts/00pythonmanagepyshell%E5%92%8Cpython%E7%9A%84%E5%88%86%E6%9E%90/">00Pythonmanagepyshell和Python的分析</a></li>
        
        <li><a href="/posts/010zookeeper%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5zookeeper%E7%9A%84%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BAzookeeper%E7%9A%84shell%E5%91%BD%E4%BB%A4/">010Zookeeper的基本概念Zookeeper的集群搭建Zookeeper的shell命令</a></li>
        
        <li><a href="/posts/018dockerfileshell/">018DockerfileSHELL</a></li>
        
    </ul>
</div>


        <div class="post-meta meta-tags">
            
            <ul class="clearfix">
                
                <li><a href='https://zaina.newban.cn/tags/shell'>shell</a></li>
                
            </ul>
            
        </div>
    </article>
    
    

    
    
</div>

                    <footer id="footer">
    <div>
        &copy; 2020 <a href="https://zaina.newban.cn">开发者问答集锦 By </a>
        
    </div>
    <br />
    <div>
        <div class="github-badge">
            <a href="https://gohugo.io/" target="_black" rel="nofollow"><span class="badge-subject">Powered by</span><span class="badge-value bg-blue">Hugo</span></a>
        </div>
        <div class="github-badge">
            <a href="https://www.flysnow.org/" target="_black"><span class="badge-subject">Design by</span><span class="badge-value bg-brightgreen">飞雪无情</span></a>
        </div>
        <div class="github-badge">
            <a href="https://github.com/flysnow-org/maupassant-hugo" target="_black"><span class="badge-subject">Theme</span><span class="badge-value bg-yellowgreen">Maupassant</span></a>
        </div>
    </div>
</footer>


    
    <script type="text/javascript">
        window.MathJax = {
            tex2jax: {
                inlineMath: [['$', '$']],
                processEscapes: true
                }
            };
    </script>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML' async></script>

<a id="rocket" href="#top"></a>
<script type="text/javascript" src='/js/totop.js?v=0.0.0' async=""></script>



    <script type="text/javascript" src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script>




                </div>

                <div id="secondary">
    <section class="widget">
        <form id="search" action='https://zaina.newban.cn/search/' method="get" accept-charset="utf-8" target="_blank" _lpchecked="1">
      
      <input type="text" name="q" maxlength="20" placeholder="Search">
      <input type="hidden" name="sitesearch" value="https://zaina.newban.cn">
      <button type="submit" class="submit icon-search"></button>
</form>
    </section>
    
    <section class="widget">
        <h3 class="widget-title">最近文章</h3>
<ul class="widget-list">
    
    <li>
        <a href="https://zaina.newban.cn/posts/001rubyruby%E4%B8%AD%E5%85%A8%E5%B1%80%E5%8F%98%E9%87%8F%E5%AE%9E%E4%BE%8B%E5%8F%98%E9%87%8F%E5%B1%80%E9%83%A8%E5%8F%98%E9%87%8F%E7%B1%BB%E5%8F%98%E9%87%8Fsymbol%E5%AF%B9%E6%AF%94/" title="001rubyRuby中全局变量实例变量局部变量类变量Symbol对比">001rubyRuby中全局变量实例变量局部变量类变量Symbol对比</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/007hadoop%E9%9B%86%E7%BE%A4%E9%85%8D%E7%BD%AEhadoop%E9%9B%86%E7%BE%A4%E7%9A%84%E5%90%AF%E5%8A%A8%E5%92%8C%E6%B5%8B%E8%AF%95ssh%E5%85%8D%E7%99%BB%E9%99%86%E9%85%8D%E7%BD%AEstartallshhdfs%E5%B8%B8%E7%94%A8%E7%9A%84shell/" title="007Hadoop集群配置Hadoop集群的启动和测试SSH免登陆配置startallshhdfs常用的shell">007Hadoop集群配置Hadoop集群的启动和测试SSH免登陆配置startallshhdfs常用的shell</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/009shell%E8%84%9A%E6%9C%AC%E4%B8%8B%E6%9D%A1%E4%BB%B6%E6%B5%8B%E8%AF%95eqne/" title="009Shell脚本下条件测试eqne">009Shell脚本下条件测试eqne</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/00pythonmanagepyshell%E5%92%8Cpython%E7%9A%84%E5%88%86%E6%9E%90/" title="00Pythonmanagepyshell和Python的分析">00Pythonmanagepyshell和Python的分析</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/010zookeeper%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5zookeeper%E7%9A%84%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BAzookeeper%E7%9A%84shell%E5%91%BD%E4%BB%A4/" title="010Zookeeper的基本概念Zookeeper的集群搭建Zookeeper的shell命令">010Zookeeper的基本概念Zookeeper的集群搭建Zookeeper的shell命令</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/018dockerfileshell/" title="018DockerfileSHELL">018DockerfileSHELL</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/01shell%E5%85%A5%E9%97%A801bashshell%E7%89%B9%E6%80%A7/" title="01Shell入门01bashShell特性">01Shell入门01bashShell特性</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/01shell%E5%8F%98%E9%87%8F/" title="01Shell变量">01Shell变量</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/01shell%E5%9F%BA%E7%A1%80%E6%A6%82%E8%BF%B0%E8%84%9A%E6%9C%AC%E6%89%A7%E8%A1%8C%E6%96%B9%E5%BC%8Fbash%E5%9F%BA%E6%9C%AC%E5%8A%9F%E8%83%BD/" title="01Shell基础概述脚本执行方式Bash基本功能">01Shell基础概述脚本执行方式Bash基本功能</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/01shell%E7%BC%96%E7%A8%8Bhelloworld/" title="01shell编程helloworld">01shell编程helloworld</a>
    </li>
    
</ul>
    </section>

    

    <section class="widget">
        <h3 class="widget-title"><a href="/categories">分类</a></h3>
<ul class="widget-list">
    
</ul>
    </section>

    <section class="widget">
        <h3 class="widget-title"><a href="/tags">标签</a></h3>
<div class="tagcloud">
    
    <a href="https://zaina.newban.cn/tags/ruby/">ruby</a>
    
    <a href="https://zaina.newban.cn/tags/shell/">shell</a>
    
</div>
    </section>

    

    <section class="widget">
        <h3 class="widget-title">其它</h3>
        <ul class="widget-list">
            <li><a href="https://zaina.newban.cn/index.xml">文章 RSS</a></li>
        </ul>
    </section>
</div>
            </div>
        </div>
    </div>
</body>

</html>