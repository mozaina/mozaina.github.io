<!doctype html>
<html lang="en-us">
<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">


    <title>linux之基础shell脚本编程4字符串操作变量赋值配置用户环境 | 开发者问答集锦</title>
    <meta property="og:title" content="linux之基础shell脚本编程4字符串操作变量赋值配置用户环境 - 开发者问答集锦">
    <meta property="og:type" content="article">
        
    <meta property="article:published_time" content='2020-09-02T00:00:00&#43;08:00'>
        
        
    <meta property="article:modified_time" content='2020-09-02T00:00:00&#43;08:00'>
        
    <meta name="Keywords" content="">
    <meta name="description" content="linux之基础shell脚本编程4字符串操作变量赋值配置用户环境">
        
    <meta name="author" content="">
    <meta property="og:url" content="https://zaina.newban.cn/posts/linux%E4%B9%8B%E5%9F%BA%E7%A1%80shell%E8%84%9A%E6%9C%AC%E7%BC%96%E7%A8%8B4%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%93%8D%E4%BD%9C%E5%8F%98%E9%87%8F%E8%B5%8B%E5%80%BC%E9%85%8D%E7%BD%AE%E7%94%A8%E6%88%B7%E7%8E%AF%E5%A2%83/">
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">

    <link rel="stylesheet" href='/css/normalize.css'>
    <link rel="stylesheet" href='/css/style.css'>
    <script type="text/javascript" src="//cdn.bootcdn.net/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

    
    
    
    
    
    
</head>


<body>
    <header id="header" class="clearfix">
    <div class="container">
        <div class="col-group">
            <div class="site-name ">
                
                    <a id="logo" href="https://zaina.newban.cn">
                        开发者问答集锦
                    </a>
                
                
            </div>
            <div>
                <nav id="nav-menu" class="clearfix">
                    <a class="" href="https://zaina.newban.cn">首页</a>
                    
                </nav>
            </div>
        </div>
    </div>
</header>

    <div id="body">
        <div class="container">
            <div class="col-group">

                <div class="col-8" id="main">
                    
<div class="res-cons">
    
    <article class="post">
        <header>
            <h1 class="post-title">linux之基础shell脚本编程4字符串操作变量赋值配置用户环境</h1>
        </header>
        <date class="post-meta meta-date">
            2020年9月2日
        </date>
        
        
        <div class="post-meta">
            <span id="busuanzi_container_page_pv">|<span id="busuanzi_value_page_pv"></span><span>
                    阅读</span></span>
        </div>
        
        
        <div class="post-content">
            <p>九 字符串</p>

<p>9.1 bash的字符串处理工具:</p>

<p>9.1.1 字符串切片:</p>

<p>${#var} :返回字符串变量 var 的长度</p>

<p>${var:offset} :返回字符串变量 var 中从第offset个字符后(不包括第offset个字符)的字符开始,到最后部分,offset的取值在
0 到 ${#var}-1 之间(bash4.2后，允许为负值)</p>

<p>${var:offset:number} :返回字符串变量var中第offset个字符后(不包括第offset个字符)的字符开始，长度为number的部分</p>

<p>${var: -lengh} :取字符串的最右侧几个字符 注意：冒号后必须有一空白字符</p>

<p>9.2 基于模式取字串</p>

<p>${var#*word} :其中word可以是指定的任意字符</p>

<p>功能：自左到右，查找var变量所存储的字符串中，第一次出现的word，删除字符串开头至第一次出现word字符之间的所有字符</p>

<p>${var##*word}: 自左到右，查找var变量所存储的字符串中，最后一次出现的word，删除字符串开头至最后一次由word指定的字符之间的所有内容</p>

<p>${var%word*} :其中word可以是指定的任意字符；</p>

<p>功能：自右到左，查找var变量所存储的字符串中，第一次出现的work，删除字符串最后一个字符向左至第一次出现word字符之间的所有字符</p>

<p>${var%%word*}:自右到左，查找var变量所存储的字符串中，最后一次出现的work，删除字符串最右侧的字符向左至最后一次出现word字符之间的所有字符</p>

<p>9.3 字符串处理</p>

<p>1 查找替换</p>

<p>${var/pattern/substi} :查找var所表示的字符串中，第一次被pattern所匹配到的字符串，以substi替换</p>

<p>${var//pattern/substi} :查找var所表示的字符串中，所有能被pattern所匹配到的字符串，以substi替换</p>

<p>${var/#pattern/substi} :查找var所表示的字符串中，行首被pattern所匹配到的字符串，以substi替换</p>

<p>${var/%pattern/substi} :查找var所表示的字符串中，行尾被pattern所匹配到的字符串，以substi替换</p>

<p>2 查找并删除 : 只需将以上四条中的 &lsquo;/substi&rsquo; 去掉，就可以实现删除功能</p>

<pre><code>[root@centos7 ~]# file=kkoiju8894juhhydliii22387dddad    #先定义一个字符串
[root@centos7 ~]# echo ${file/8/ooo}        # 第一次被 8 所匹配到的字符串，以 ooo 替换
kkoijuooo894juhhydliii22387dddad
[root@centos7 ~]# echo ${file//8/ooo}        # 所有被 8 所匹配到的字符串，以 ooo 替换
kkoijuoooooo94juhhydliii223ooo7dddad
[root@centos7 ~]# echo ${file/#k/ooo}        # 行首被 8 所匹配到的字符串，以 ooo 替换
oookoiju8894juhhydliii22387dddad
[root@centos7 ~]# echo ${file/%d/ooo}        # 行尾被 8 所匹配到的字符串，以 ooo 替换
kkoiju8894juhhydliii22387dddaooo
[root@centos7 ~]# echo ${file/#kk}            # 删除第一次被 8 所匹配到的字符串
oiju8894juhhydliii22387dddad
</code></pre>

<p>3 字符串大小写转换</p>

<p>${var^^} :把var中的所有小写字母转换为大写</p>

<p>${var,,} :把var中的所有大写字母转换为小写</p>

<p>9.4 变量赋值</p>

<p>${var:-value}:如果var为空或未设置，那么返回value；否则返回var的值</p>

<p>${var:+value}:如果var不空，则返回value</p>

<p>${var:=value}:如果var为空或未设置，那么返回value，并将value的值赋值给var；否则，返回var的值</p>

<p>${var:?error_info}:如果var为空或未设置，那么返回error_info;否则，则返回var的值</p>

<p>为脚本程序使用配置文件，实现变量赋值</p>

<p>首先，定义一个文本文件，每行定义&rdquo;name=value&rdquo; ;然后在脚本中 source 此文件即可</p>

<p>shell变量一般是无类型的，但是bash shell提供 了declare和typeset两个命令用于指定变量的类型，两个命令时完全等价的</p>

<p>declare [选项] 变量名</p>

<p>-r 将变量设置为只读属性</p>

<p>-i 将变量定义为整形数</p>

<p>-a 将变量定义为数组</p>

<p>-f 显示此脚本前定义过的所有函数名及其内容</p>

<p>-F 仅显示此脚本前定义过的所有函数名</p>

<p>-x 将变量声明为环境变量</p>

<p>-l 将变量值转为小写字母</p>

<p>-u 将变量值转为大写字母</p>

<p>如果第一个变量的值是第二个变量的名字，从第一个变量引用第二个变量的值就称为间接变量引用</p>

<p>var1=var2</p>

<p>var2=value</p>

<p>var1的值是var2 ,而var2又是变量名，var2的值为value,间接变量引用是指通过var1获得变量值value的行为</p>

<p>bash shell 提供了两种格式实现间接变量引用</p>

<p>eval var=\$$var2</p>

<p>var=${!var2}</p>

<p>比如：</p>

<pre><code>[root@centos7 ~]# var=nihao
[root@centos7 ~]# var1=var
[root@centos7 ~]# echo $var1
var
[root@centos7 ~]# echo ${!var1}
nihao
[root@centos7 ~]# eval var3=\$$var1
[root@centos7 ~]# echo $var3
nihao
</code></pre>

<p>eval命令将会首先扫描命令行进行所有的置换，然后在执行该命令。该命令适用于那些一次扫描无法实现其功能的变量，该命令对变量进行两次扫描</p>

<p>10，用户自定义设置</p>

<p>10.1 创建临时文件</p>

<p>命令： mktemp :创建的临时文件可避免冲突</p>

<p>Usage: mktemp [OPTION]&hellip; [TEMPLATE]</p>

<p>TEMPLATE: filename.XXX X至少要出现三个</p>

<p>10.2 安装复制文件</p>

<p>命令： install</p>

<p>Usage: install [OPTION]&hellip; [-T] SOURCE DEST 创建单文件</p>

<p>or: install [OPTION]&hellip; SOURCE&hellip; DIRECTORY</p>

<p>or: install [OPTION]&hellip; -t DIRECTORY SOURCE&hellip;</p>

<p>or: install [OPTION]&hellip; -d DIRECTORY&hellip; #创建空目录</p>

<p>选项：</p>

<p>-m MODE，默认755</p>

<p>-o OWNER</p>

<p>-g GROUP</p>

<p>10.3 bash如何展开命令行</p>

<p>把命令行分成单个命令词</p>

<p>展开别名</p>

<p>展开大括号种的声明（{}）</p>

<p>展开波浪符声明（~）</p>

<p>命令替换$() 和 ``）</p>

<p>再次把命令行分成命令词</p>

<p>展开文件通配（*、?、[abc]等等）</p>

<p>准备I/0重导向（）</p>

<p>运行命令</p>

<p>防止扩展</p>

<p>反斜线（\）会使随后的字符按原意解释 $ echo Your cost: \$5.00 Your cost: $5.00</p>

<p>加引号来防止扩展</p>

<p>单引号（’）防止所有扩展</p>

<p>双引号（”）也防止所有扩展，但是以下情况例外：</p>

<p>$（美元符号） － 变量扩展</p>

<p>`（反引号） － 命令替换</p>

<p>\（反斜线） － 禁止单个字符扩展</p>

<p>!（叹号） － 历史命令替换</p>

<p>11 bash的配置文件</p>

<p>按生效范围划分，分为两类：</p>

<p>全局配置：</p>

<p>/etc/profile</p>

<p>/etc/profile.d/*.sh</p>

<p>/etc/bashrc</p>

<p>个人配置：</p>

<p>~/.bash-profile</p>

<p>~/.bashrc</p>

<p>12 shell 登陆两种方式</p>

<p>交互是登陆：</p>

<p>1,直接通过终端输入账号密码登陆；</p>

<p>2,使用&rdquo;su -UserName&rdquo; 切换的用户</p>

<p>执行顺序：</p>

<p>/etc/profile &ndash;&gt; /etc/profile.d/*.sh &ndash;&gt; ~/.bash_profile &ndash;&gt; ~/.bashrc &ndash;&gt;
/etc/bashrc</p>

<p>非交互式登陆：</p>

<p>1,su UserName</p>

<p>2,图形界面下打开的终端</p>

<p>3,执行脚本</p>

<p>执行顺序：</p>

<p>~/.bashrc &ndash;&gt; /etc/bashrc &ndash;&gt; /etc/profile.d/*.sh</p>

<p>profile类：</p>

<p>按功能划分存在两类：</p>

<p>profile类和bashrc类</p>

<p>profile类：为交互式登陆的shell提供配置</p>

<p>全局： /etc/profile, /etc/profile.d/*.sh</p>

<p>个人： ~/.bash_profile</p>

<p>功用：</p>

<p>1，用于定义环境变量</p>

<p>2，运行命令或脚本</p>

<p>bashrc类</p>

<p>bashrc类：为非交互式和交互式登陆的shell提供配置</p>

<p>全局： /etc/bashrc</p>

<p>个人： ~/.bashrc</p>

<p>功用：</p>

<p>1,定义命令别名和函数</p>

<p>2，定义本地变量</p>

<p>编辑配置文件生效的方法</p>

<p>1，重新启动shell进程</p>

<p>2，重新载入配置文件 . 或 source</p>

<p>bash 退出任务</p>

<p>保存在 ~/.bash_logout文件中(用户)</p>

<p>在退出登陆shell时运行</p>

<p>用于创建自动备份和清除临时文件</p>

<hr />

<p>练习：</p>

<p>1、让用户（管理员或所有用户）的PATH环境变量的值多出 一个路径，例如多如/usr/local/apache2/bin</p>

<pre><code>[root@centos7 bin]# echo &quot;PATH=$PATH:/usr/local/apache/bin&quot; &gt;&gt; /etc/bashrc
[root@centos7 bin]# . /etc/bashrc
</code></pre>

<p>2、用户wang登录时自动启用别名rm=‘rm –i’</p>

<pre><code>[root@centos7 cent]# echo &quot;alias rm='rm -i'&quot; &gt;&gt; /home/cent/.bashihrc
[root@centos7 cent]# su cent
[cent@centos7 ~]$ alias rm
alias rm='rm -i'
</code></pre>

<p>3、用户登录时，显示红色字体的警示提醒信息 “hi,dangerous！”</p>

<pre><code>echo &quot;echo -e '\033[31m hi,dangerous! \033[0m'&quot; &gt;&gt; /etc/profile.d/hac.sh
</code></pre>

<hr />

<p>​</p>

        </div>

        


        

<div class="post-archive">
    <h2>See Also</h2>
    <ul class="listing">
        
        <li><a href="/posts/007hadoop%E9%9B%86%E7%BE%A4%E9%85%8D%E7%BD%AEhadoop%E9%9B%86%E7%BE%A4%E7%9A%84%E5%90%AF%E5%8A%A8%E5%92%8C%E6%B5%8B%E8%AF%95ssh%E5%85%8D%E7%99%BB%E9%99%86%E9%85%8D%E7%BD%AEstartallshhdfs%E5%B8%B8%E7%94%A8%E7%9A%84shell/">007Hadoop集群配置Hadoop集群的启动和测试SSH免登陆配置startallshhdfs常用的shell</a></li>
        
        <li><a href="/posts/009shell%E8%84%9A%E6%9C%AC%E4%B8%8B%E6%9D%A1%E4%BB%B6%E6%B5%8B%E8%AF%95eqne/">009Shell脚本下条件测试eqne</a></li>
        
        <li><a href="/posts/00pythonmanagepyshell%E5%92%8Cpython%E7%9A%84%E5%88%86%E6%9E%90/">00Pythonmanagepyshell和Python的分析</a></li>
        
        <li><a href="/posts/010zookeeper%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5zookeeper%E7%9A%84%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BAzookeeper%E7%9A%84shell%E5%91%BD%E4%BB%A4/">010Zookeeper的基本概念Zookeeper的集群搭建Zookeeper的shell命令</a></li>
        
        <li><a href="/posts/018dockerfileshell/">018DockerfileSHELL</a></li>
        
    </ul>
</div>


        <div class="post-meta meta-tags">
            
            <ul class="clearfix">
                
                <li><a href='https://zaina.newban.cn/tags/shell'>shell</a></li>
                
            </ul>
            
        </div>
    </article>
    
    

    
    
</div>

                    <footer id="footer">
    <div>
        &copy; 2020 <a href="https://zaina.newban.cn">开发者问答集锦 By </a>
        
    </div>
    <br />
    <div>
        <div class="github-badge">
            <a href="https://gohugo.io/" target="_black" rel="nofollow"><span class="badge-subject">Powered by</span><span class="badge-value bg-blue">Hugo</span></a>
        </div>
        <div class="github-badge">
            <a href="https://www.flysnow.org/" target="_black"><span class="badge-subject">Design by</span><span class="badge-value bg-brightgreen">飞雪无情</span></a>
        </div>
        <div class="github-badge">
            <a href="https://github.com/flysnow-org/maupassant-hugo" target="_black"><span class="badge-subject">Theme</span><span class="badge-value bg-yellowgreen">Maupassant</span></a>
        </div>
    </div>
</footer>


    
    <script type="text/javascript">
        window.MathJax = {
            tex2jax: {
                inlineMath: [['$', '$']],
                processEscapes: true
                }
            };
    </script>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML' async></script>

<a id="rocket" href="#top"></a>
<script type="text/javascript" src='/js/totop.js?v=0.0.0' async=""></script>



    <script type="text/javascript" src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script>




                </div>

                <div id="secondary">
    <section class="widget">
        <form id="search" action='https://zaina.newban.cn/search/' method="get" accept-charset="utf-8" target="_blank" _lpchecked="1">
      
      <input type="text" name="q" maxlength="20" placeholder="Search">
      <input type="hidden" name="sitesearch" value="https://zaina.newban.cn">
      <button type="submit" class="submit icon-search"></button>
</form>
    </section>
    
    <section class="widget">
        <h3 class="widget-title">最近文章</h3>
<ul class="widget-list">
    
    <li>
        <a href="https://zaina.newban.cn/posts/001rubyruby%E4%B8%AD%E5%85%A8%E5%B1%80%E5%8F%98%E9%87%8F%E5%AE%9E%E4%BE%8B%E5%8F%98%E9%87%8F%E5%B1%80%E9%83%A8%E5%8F%98%E9%87%8F%E7%B1%BB%E5%8F%98%E9%87%8Fsymbol%E5%AF%B9%E6%AF%94/" title="001rubyRuby中全局变量实例变量局部变量类变量Symbol对比">001rubyRuby中全局变量实例变量局部变量类变量Symbol对比</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/007hadoop%E9%9B%86%E7%BE%A4%E9%85%8D%E7%BD%AEhadoop%E9%9B%86%E7%BE%A4%E7%9A%84%E5%90%AF%E5%8A%A8%E5%92%8C%E6%B5%8B%E8%AF%95ssh%E5%85%8D%E7%99%BB%E9%99%86%E9%85%8D%E7%BD%AEstartallshhdfs%E5%B8%B8%E7%94%A8%E7%9A%84shell/" title="007Hadoop集群配置Hadoop集群的启动和测试SSH免登陆配置startallshhdfs常用的shell">007Hadoop集群配置Hadoop集群的启动和测试SSH免登陆配置startallshhdfs常用的shell</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/009shell%E8%84%9A%E6%9C%AC%E4%B8%8B%E6%9D%A1%E4%BB%B6%E6%B5%8B%E8%AF%95eqne/" title="009Shell脚本下条件测试eqne">009Shell脚本下条件测试eqne</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/00pythonmanagepyshell%E5%92%8Cpython%E7%9A%84%E5%88%86%E6%9E%90/" title="00Pythonmanagepyshell和Python的分析">00Pythonmanagepyshell和Python的分析</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/010zookeeper%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5zookeeper%E7%9A%84%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BAzookeeper%E7%9A%84shell%E5%91%BD%E4%BB%A4/" title="010Zookeeper的基本概念Zookeeper的集群搭建Zookeeper的shell命令">010Zookeeper的基本概念Zookeeper的集群搭建Zookeeper的shell命令</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/018dockerfileshell/" title="018DockerfileSHELL">018DockerfileSHELL</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/01shell%E5%85%A5%E9%97%A801bashshell%E7%89%B9%E6%80%A7/" title="01Shell入门01bashShell特性">01Shell入门01bashShell特性</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/01shell%E5%8F%98%E9%87%8F/" title="01Shell变量">01Shell变量</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/01shell%E5%9F%BA%E7%A1%80%E6%A6%82%E8%BF%B0%E8%84%9A%E6%9C%AC%E6%89%A7%E8%A1%8C%E6%96%B9%E5%BC%8Fbash%E5%9F%BA%E6%9C%AC%E5%8A%9F%E8%83%BD/" title="01Shell基础概述脚本执行方式Bash基本功能">01Shell基础概述脚本执行方式Bash基本功能</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/01shell%E7%BC%96%E7%A8%8Bhelloworld/" title="01shell编程helloworld">01shell编程helloworld</a>
    </li>
    
</ul>
    </section>

    

    <section class="widget">
        <h3 class="widget-title"><a href="/categories">分类</a></h3>
<ul class="widget-list">
    
</ul>
    </section>

    <section class="widget">
        <h3 class="widget-title"><a href="/tags">标签</a></h3>
<div class="tagcloud">
    
    <a href="https://zaina.newban.cn/tags/ruby/">ruby</a>
    
    <a href="https://zaina.newban.cn/tags/shell/">shell</a>
    
</div>
    </section>

    

    <section class="widget">
        <h3 class="widget-title">其它</h3>
        <ul class="widget-list">
            <li><a href="https://zaina.newban.cn/index.xml">文章 RSS</a></li>
        </ul>
    </section>
</div>
            </div>
        </div>
    </div>
</body>

</html>