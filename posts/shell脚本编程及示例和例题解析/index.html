<!doctype html>
<html lang="en-us">
<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">


    <title>Shell脚本编程及示例和例题解析 | 开发者问答集锦</title>
    <meta property="og:title" content="Shell脚本编程及示例和例题解析 - 开发者问答集锦">
    <meta property="og:type" content="article">
        
    <meta property="article:published_time" content='2020-09-02T00:00:00&#43;08:00'>
        
        
    <meta property="article:modified_time" content='2020-09-02T00:00:00&#43;08:00'>
        
    <meta name="Keywords" content="">
    <meta name="description" content="Shell脚本编程及示例和例题解析">
        
    <meta name="author" content="">
    <meta property="og:url" content="https://zaina.newban.cn/posts/shell%E8%84%9A%E6%9C%AC%E7%BC%96%E7%A8%8B%E5%8F%8A%E7%A4%BA%E4%BE%8B%E5%92%8C%E4%BE%8B%E9%A2%98%E8%A7%A3%E6%9E%90/">
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">

    <link rel="stylesheet" href='/css/normalize.css'>
    <link rel="stylesheet" href='/css/style.css'>
    <script type="text/javascript" src="//cdn.bootcdn.net/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

    
    
    
    
    
    
</head>


<body>
    <header id="header" class="clearfix">
    <div class="container">
        <div class="col-group">
            <div class="site-name ">
                
                    <a id="logo" href="https://zaina.newban.cn">
                        开发者问答集锦
                    </a>
                
                
            </div>
            <div>
                <nav id="nav-menu" class="clearfix">
                    <a class="" href="https://zaina.newban.cn">首页</a>
                    
                </nav>
            </div>
        </div>
    </div>
</header>

    <div id="body">
        <div class="container">
            <div class="col-group">

                <div class="col-8" id="main">
                    
<div class="res-cons">
    
    <article class="post">
        <header>
            <h1 class="post-title">Shell脚本编程及示例和例题解析</h1>
        </header>
        <date class="post-meta meta-date">
            2020年9月2日
        </date>
        
        
        <div class="post-meta">
            <span id="busuanzi_container_page_pv">|<span id="busuanzi_value_page_pv"></span><span>
                    阅读</span></span>
        </div>
        
        
        <div class="post-content">
            

<p><strong>sed及awk命令的总结地址：</strong></p>

<p><strong><a href="http://10267776.blog.51cto.com/10257776/1696869">http://10267776.blog.51cto.com/10257776/1696869</a></strong></p>

<p>**<br />
**</p>

<p><strong>Shell脚本的说明:</strong></p>

<p><strong>shell脚本编程,实际上就是用vim编辑器编辑一个以.sh为结尾的脚本文件,在此脚本文件中使用Linux内部的一个或多个命令,通过编程语言以脚本运行的方式,一次性运行一次一个、一次多个或多次多个命令进行运算，并输出结果，及添加直观的注释。</strong></p>

<p><strong>Shell脚本的编辑标准格式：</strong></p>

<p><strong>使用vim编辑器编辑一个自定义创建的文件名并以.sh格式结尾— &gt;</strong></p>

<p><strong>#!/bin/bash \\#！是一个约定的标记，他告诉系统这个脚本需要用什么解释权来执行。</strong></p>

<p><strong>#</strong></p>

<p><strong>脚本主体</strong></p>

<p><strong>\\脚本主体可直接编辑输入参数、命令、函数、shell编程语言等。且脚本主体所编辑的命令是依照顺序执行，即逐个执行。</strong></p>

<p><strong>\\ bash过程式编程：</strong></p>

<p><strong>顺序执行：逐个执行</strong></p>

<p><strong>选择执行：只执行其中一个分支</strong></p>

<p><strong>循环执行：一段代码要执行0,1或多遍</strong></p>

<p><strong>编程元素：变量、流程、函数</strong></p>

<p><strong>脚本编辑结束在末行输入：wq保存退出。</strong></p>

<p><strong>编辑结束首先要测试我们所编辑的脚本中是否有语法错误：</strong></p>

<p><strong>bash -n 脚本名；</strong></p>

<p><strong>测试语法无误，运行脚本：</strong></p>

<p><strong>bash -x 脚本名；</strong></p>

<p>-&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;</p>

<p>-&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;</p>

<p><strong>shell环境中的变量及参数：</strong></p>

<p>变量：可变化的量，命名内存空间，bash的变量使用特点：弱类型、无须事先声明；</p>

<p>bash环境：</p>

<p>本地变量：当前shell进程；</p>

<p>环境变量：当前shell进程及其子进程；</p>

<p>局部变量：某个函数执行过程；</p>

<p>位置参数变量：在脚本中引用传递给脚本的参数；在函数中引用传递给函数的参数；</p>

<p><strong>特殊变量：</strong></p>

<p>$$ **<br />
Shell本身的PID（ProcessID）<br />
** $! **<br />
Shell最后运行的后台Process的PID<br />
** $? **<br />
最后运行的命令的结束代码（返回值）<br />
** $- **<br />
使用Set命令设定的Flag一览<br />
** $* **<br />
所有参数列表。如&rdquo;$*&ldquo;用「&rdquo;」括起来的情况、以&rdquo;$1 $2 … $n&rdquo;的形式输出所有参数。<br />
** $@ **<br />
所有参数列表。如&rdquo;$@&ldquo;用「&rdquo;」括起来的情况、以&rdquo;$1&rdquo; &ldquo;$2&rdquo; … &ldquo;$n&rdquo; 的形式输出所有参数。<br />
** $# **<br />
添加到Shell的参数个数<br />
** $0 **<br />
Shell本身的文件名<br />
** $1～$n **<br />
添加到Shell的各参数值。$1是第1参数、$2是第2参数…。**</p>

<p>**<br />
**</p>

<p><strong>变量类型：</strong></p>

<p>变量类型的作用：存储空间、运算、存储格式</p>

<p>数值，字符；</p>

<p>数值：整数、浮点数；</p>

<p>字符：ASCII</p>

<p><strong>变量的具体说明：</strong></p>

<p><strong>本地变量：</strong></p>

<p>name=value；</p>

<p>name: 我们自定义的变量名—&gt;只能包含数字、字母和下划线；且不能以数字开头；</p>

<p>=：赋值符号；</p>

<p>value：我们需要给变量名赋予的值；</p>

<p>引用我们定义的变量：${name}在定义的变量名中含有下划线等特殊字符时必须使用{}来引用变量, $name</p>

<p>引用：</p>

<p>弱引用: &ldquo;&ldquo;双引号, 其内部的变量引用会被替换为变量值；</p>

<p>强引用：&rdquo;单引号，其变量的变量引用会保持原有字符；</p>

<p>命令引用：<code>COMMAND</code>反引号, 也可使用$(COMMAND)，引用命令的执行结果；</p>

<p>声明为整型：</p>

<p>declare -i name[=value]</p>

<p>let name=value</p>

<p>查看所有本地变量：set</p>

<p>变量的生命周期：</p>

<p>创建</p>

<p>销毁：</p>

<p>自动销毁：shell进程终止；</p>

<p>手动销毁：unset name</p>

<p>环境变量：</p>

<p>被“导出”的本地变量</p>

<p>export name[=value]</p>

<p>declare -x name[=value]</p>

<p>查看所有环境变量：env, printenv, export</p>

<p>销毁：</p>

<p>unset name</p>

<p><strong>脚本：文本文件标准命名— &gt;name.sh</strong></p>

<p>**<br />
**</p>

<p>运行脚本：事实上是运行一个bash进程，此进程负责从脚本文件中读取一个执行逻辑，而后由bash进程负责解析并运行此逻辑；</p>

<p>启动脚本：</p>

<p>(1) # bash /PATH/TO/SCRIPT_FILE</p>

<p>(2) 给脚本一个执行权限即可直接通过脚本路径运行脚本：</p>

<h1 id="path-to-script-file">./PATH/TO/SCRIPT_FILE</h1>

<p>脚本格式我们在开始已经提过了，可回到首部查看；</p>

<p>我们在开始说过如何执行脚本，那执行脚本就必然会有成功或失败，当我们执行脚本以后可以使用 $? 命令查看上一条命令执行状态结果：</p>

<p>命令状态结果：</p>

<p>bash进程用于追踪执行的命令成功与否的状态：</p>

<p>0: 成功</p>

<p>1-255：失败</p>

<p>$?：上一条命令的执行状态结果；</p>

<p>我们可在脚本中自定义脚本的状态结果：</p>

<p>在脚本中敲入命令exit [n]—&gt;n为我们想要输出的数字</p>

<p>注意：脚本中任何位置执行了exit命令即会终止当前shell进程；</p>

<p>条件测试：</p>

<p>界定程序执行环境；</p>

<p>(1) 根据运行的命令的状态结果；</p>

<p>(2) 测试表达式: EXPR 表达式</p>

<p>test EXPR</p>

<p>[ EXPR ]</p>

<p><code>EXPR</code></p>

<p><strong>整数测试：隐含着做数值大小比较，所以不要给变量引用加引用；</strong></p>

<p>$A -gt $B：是否大于；是则为“真”，否则为“假”；</p>

<p>$A -ge $B: 是否大于等于；</p>

<p>$A -lt $B：是否小于；</p>

<p>$A -le $B: 是否小于等于；</p>

<p>$A -eq $B: 是否等于；</p>

<p>$A -ne $B：是否不等于；</p>

<p>字符串测试：ASCII数值越大，字符比较时其值越大；</p>

<p>&rdquo;$A&rdquo; &gt; &ldquo;$B&rdquo;：是否大于；</p>

<p>&rdquo;$A&rdquo; &lt; &ldquo;$B&rdquo;：是否小于；</p>

<p>&rdquo;$A&rdquo; == &ldquo;$B&rdquo;：是否等于；</p>

<p>&rdquo;$A&rdquo; != &ldquo;$B&rdquo;：是否不等于；</p>

<p>-z &ldquo;$A&rdquo;：是否为空；空则为“真”，否则为“假”</p>

<p>-n &ldquo;$A&rdquo;：是否不空；不空则“真”，空则为“假”</p>

<p>注意：应该使用<code>EXPRESSION</code></p>

<p><strong>文件测试：测试文件的存在性以及属性；</strong></p>

<p>-e $file: 是否存在；存在则为“真”，否则为“假”；</p>

<p>-f $file：文件是否存在且为普通文件；</p>

<p>-d $file：文件是否存在且为目录；</p>

<p>-h $file：是否存在且为符号链接文件；</p>

<p>-b $file：是否存在且为块设备文件；</p>

<p>-c $file：是否存在且为字符设备文件；</p>

<p>-S $file：是否存在且为套接字文件；</p>

<p>-p $file: 是否存在且为管道文件；</p>

<p>-r $file: 当前用户对文件是否拥有读权限；</p>

<p>-w $file：当前用户对文件是否拥有写权限；</p>

<p>-x $file：当前用户对文件是否拥有执行权限；</p>

<p>-u $file：文件是否拥有SUID权限；</p>

<p>-g $file：文件是否拥有SGID权限；</p>

<p>-k $file：文件是否拥有sticky权限；</p>

<p><strong>注：SUID,SGID,sticky为文件特殊权限，如果有同学不熟悉，可以自行复习。为了方便理解，我们这里还是列出来：</strong></p>

<p><strong>sticky bit (粘贴位)就是：除非目录的属主和root用户有权限删除它，除此之外其它用户不能删除和修改这个目录。</strong></p>

<p><strong>suid就是：让普通用户拥有可以执行“只有root权限才能执行”的特殊权限，sgid同理指”组“</strong></p>

<p>-O $file: 当前用户是否为指定文件的属主；</p>

<p>-G $file: 当前用户是否为指定文件的属组；</p>

<p><strong>双目操作符：</strong></p>

<p>$file1 -nt $file2: file1是否新于file2, file1的最近一次的修改时间戳是否晚于file2的；</p>

<p>$file1 -ot $file2: file1是否旧于file2, file1的最近一次的修改时间戳是否早于file2的；</p>

<p>$file1 -ef $file2：file1与file2是否指向了同一个inode，</p>

<p>测试二者是否为同一个文件的硬链接；</p>

<p><strong>特殊设备：</strong></p>

<p>/dev/null: 空，bit buckets，吞下所有数据，并直接丢弃；</p>

<p>/dev/zero：吐出一堆0；</p>

<p>bash之条件判断(选择执行):</p>

<p>if/then ；case</p>

<p>if CONDITION; then</p>

<p>if-true-分支</p>

<p>fi</p>

<p>if CONDITION; then</p>

<p>if-true-分支</p>

<p>else</p>

<p>if-false-分支</p>

<p>fi</p>

<p>! CONDITION: 取反</p>

<p><strong>-&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;-</strong></p>

<p><strong>脚本参数(位置参数变量):</strong></p>

<p><strong># ./script.sh /etc/fstab /etc/grub2.cfg</strong></p>

<p><strong>$0 $1 $2</strong></p>

<p><strong>注：为了更易于理解，我们进行下面说明：</strong></p>

<p><strong>参数$0— &gt;shell自身文件，$1—&gt;shell中定义的第一个参数，$2—&gt;shell中定义的第二个参数，以此类推。</strong></p>

<p>特殊变量：</p>

<p>$?: 命令的状态结果；</p>

<p>$#: 传递给脚本或函数的参数的个数；</p>

<p>$*和$@: 引用传递给脚本或函数的参数列表；</p>

<p>为了更直观的理解这些特殊变量，我们来做一个脚本小测试：</p>

<p><a href="https://img.it610.com/image/info8/e9170154d5ee445da4fea683533587d5.jpg"><img src="https://img.it610.com/image/info8/e9170154d5ee445da4fea683533587d5.jpg" alt="Shell脚本编程及示例和例题解析_第1张图片" /></a></p>

<p><strong>与用户交互：</strong></p>

<p><strong>read命令：</strong></p>

<p><strong>read [options] VAR&hellip;</strong></p>

<p><strong>-p &ldquo;PROMPT&rdquo;</strong></p>

<p><strong>-t timeout</strong></p>

<p><strong>示例：-t5 5秒后超时退出交互。</strong></p>

<p><a href="https://img.it610.com/image/info8/544120e3c97146d2b05e41e760550775.jpg"><img src="https://img.it610.com/image/info8/544120e3c97146d2b05e41e760550775.jpg" alt="Shell脚本编程及示例和例题解析_第2张图片" /></a></p>

<p><strong>引用命令的执行结果；</strong></p>

<p><strong>(1) ls <code>which cat</code></strong></p>

<p><strong>(2) lines=$(wc -l /etc/fstab | cut -d&rsquo; &lsquo; -f1)</strong></p>

<p><a href="https://img.it610.com/image/info8/c5b8565746dd4c8ca41e47d94ad689f9.jpg"><img src="https://img.it610.com/image/info8/c5b8565746dd4c8ca41e47d94ad689f9.jpg" alt="Shell脚本编程及示例和例题解析_第3张图片" /></a></p>

<p>-&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;-</p>

<p><strong>循环语句：循环就是通过循环编程对循环体进行多次运行，直到结果匹配给定的退出循环条件。</strong></p>

<p>循环语句有：for, while, until</p>

<p>VARIABLE 定义的变量</p>

<p>for VARIABLE in LIST; do</p>

<p>循环体</p>

<p>done</p>

<p><strong>LIST：是由一个或多个空格或换行符分隔开的字符串组成；</strong></p>

<p><strong>即 可使用LIST 给一个变量进行多次逐个赋值；</strong></p>

<p><strong>LIST 不为空时进入循环，LIST逐个赋值直到最后一个结束后循环结束，即退出循环；</strong></p>

<p><strong>for username in user1 user2 user3; do</strong></p>

<p><strong>循环体</strong></p>

<p><strong>done</strong></p>

<p><strong>示例：</strong></p>

<p>添加10个用户，user1-user10；</p>

<p><a href="https://img.it610.com/image/info8/7090f30e2ece469aa42961db3f9f69d4.jpg"><img src="https://img.it610.com/image/info8/7090f30e2ece469aa42961db3f9f69d4.jpg" alt="Shell脚本编程及示例和例题解析_第4张图片" /></a></p>

<p><strong>LIST的生成方法：</strong></p>

<p>(1) 整数列表</p>

<p>(a) {start..end}</p>

<p>(b) $(seq [start <code>step</code> end)</p>

<p>(2) 直接给出列表</p>

<p>(3) glob</p>

<p>(4) 命令生成</p>

<p><strong>示例：数值列表</strong></p>

<p><a href="https://img.it610.com/image/info8/cb8f7019108e4df0bf20b713a6d690ff.jpg"><img src="https://img.it610.com/image/info8/cb8f7019108e4df0bf20b713a6d690ff.jpg" alt="Shell脚本编程及示例和例题解析_第5张图片" /></a></p>

<p>**<br />
**</p>

<p><strong>示例：glob，即定义参数变量为 绝对路径下的文件：</strong></p>

<p>#!/bin/bash</p>

<p>#</p>

<p>for filename in /var/log/*; do</p>

<p>file $filename</p>

<p>done</p>

<p><a href="https://img.it610.com/image/info8/c96f819b776c4456adcc2477bd2e067c.jpg"><img src="https://img.it610.com/image/info8/c96f819b776c4456adcc2477bd2e067c.jpg" alt="Shell脚本编程及示例和例题解析_第6张图片" /></a></p>

<p>**<br />
**</p>

<p><strong>示例：命令生成列表</strong></p>

<p>#!/bin/bash</p>

<p>#</p>

<p>for username in $(cut -d: -f1 /etc/passwd); do</p>

<p>echo &ldquo;$username primary group: $(id -n -g $username).&rdquo;</p>

<p>Done</p>

<p><a href="https://img.it610.com/image/info8/5acbf9b6362f432ba7a81b5b4cac45b1.jpg"><img src="https://img.it610.com/image/info8/5acbf9b6362f432ba7a81b5b4cac45b1.jpg" alt="Shell脚本编程及示例和例题解析_第7张图片" /></a></p>

<p><strong>Shell脚本中的算术运算：</strong></p>

<p>+, -, *, /, %, **</p>

<p>(1) $[$A+$B]</p>

<p>(2) $(($A+$B))</p>

<p>(3) let VARIABLE=$A+$B</p>

<p>(4) VARIABLE=$(expr $A + $B)</p>

<p><strong>示例：求100以内所以正整数之和；</strong></p>

<p><a href="https://img.it610.com/image/info8/d95294a7c34c4d0f83e869faa79bd8d0.jpg"><img src="https://img.it610.com/image/info8/d95294a7c34c4d0f83e869faa79bd8d0.jpg" alt="Shell脚本编程及示例和例题解析_第8张图片" /></a></p>

<p><strong>增强型赋值：</strong></p>

<p>+=</p>

<p>sum=$[$sum+$i]可写为：let sum+=$i</p>

<p>-=, *=, /=, %=</p>

<p>let count=$[$count+1] &ndash;&gt; let count+=1 &ndash;&gt; let count++</p>

<p>let count=$[$count-1] &ndash;&gt; let count-=1 &ndash;&gt; let count&ndash;</p>

<p><strong>示例：显示/etc目录下所有普通文件列表，而后统计一共有多少个文件；</strong></p>

<p><a href="https://img.it610.com/image/info8/fdf694c27e234fd6933668ac3b373af6.jpg"><img src="https://img.it610.com/image/info8/fdf694c27e234fd6933668ac3b373af6.jpg" alt="Shell脚本编程及示例和例题解析_第9张图片" /></a></p>

<p><strong>测试表达式：</strong></p>

<p>整数测试：-gt, -lt, -ge, -le, -eq, -ne</p>

<p>字符串测试：==, &gt;,</p>

<p>注意：</p>

<p>(1) 字符串等会比较测试：[ &ldquo;$hostname&rdquo; == &lsquo;localhost&rsquo; ]—&gt;
<strong>比较命令hostname的结果是否为localhost；</strong></p>

<p>(2) 模式匹配测试：[[ &ldquo;STRING&rdquo; =~ PATTERN ]]</p>

<p>组合测试条件：</p>

<p>条件间逻辑运算：</p>

<p>与：多个条件要同时满足；</p>

<p>或：多个条件满足其一即可；</p>

<p>非：对指定的条件取反；</p>

<p>表达式组合：</p>

<p>与：<code>CONDITION1 -a CONDITION2</code></p>

<p>或：<code>CONDITION1 -o CONDITION2</code></p>

<p>非：[ ! CONDITION ]</p>

<p>命令组合：</p>

<p>与：COMMAND1 &amp;&amp; COMMAND2</p>

<p>或：COMMAND1 || COMMAND2</p>

<p>非：! COMMAND</p>

<p>短路操作符：&amp;&amp;</p>

<p>false &amp;&amp; true = false</p>

<p>false &amp;&amp; false = false</p>

<p>第一个为假则不会运行第二个。</p>

<p>true &amp;&amp; false = false</p>

<p>true &amp;&amp; true = true</p>

<p>第一个为真则继续运行第二个，第二个为假则不会运行，为真则运行。</p>

<p>if COMMAND1; then</p>

<p>COMMAND2</p>

<p>fi</p>

<p>短路操作符：||</p>

<p>true || true = true</p>

<p>true || false = true</p>

<p>两个有一个为真则真；</p>

<p>false || true = true</p>

<p>false || false = false</p>

<p>两个全为假则假；</p>

<p>if ! COMMAND1; then \\如果命令1为 假则运行命令2.</p>

<p>COMMAND2</p>

<p>fi</p>

<p>COMMAND1 &amp;&amp; COMMAND2 || COMMAND3 与和或同时存在：</p>

<p>if COMMAND1; then \\如果命令1位真则运行命令2，否则运行命令3.</p>

<p>COMMAND2</p>

<p>else</p>

<p>COMMAND3</p>

<p>fi</p>

<p><strong>示例：写一个脚本实现如下功能；</strong></p>

<p><strong>获取当前主机的主机名；如果当前主机的主机名为空，或者为localhost，则将其修改为www.magedu.com</strong></p>

<p><a href="https://img.it610.com/image/info8/454482d80d7f4263bfcda82d95f91137.jpg"><img src="https://img.it610.com/image/info8/454482d80d7f4263bfcda82d95f91137.jpg" alt="Shell脚本编程及示例和例题解析_第10张图片" /></a></p>

<p><strong>练习：写一个脚本，打印九九乘法表；</strong></p>

<p>循环嵌套</p>

<p>1X1=1</p>

<p>1X2=2 2X2=4</p>

<p>1X3=3 2X3=6 3X3=9</p>

<p><strong>此练习的思路是：既然要打印99乘法表，是乘法就有被乘和乘两个变量，所以我们首先要定义两个变量的循环，其次进行两个变量的交叉循环运算，既然要打印为表，那么就要计算格式：</strong></p>

<p><a href="https://img.it610.com/image/info8/76bbcd1d29af40aebfdfa6e53858c90f.jpg"><img src="https://img.it610.com/image/info8/76bbcd1d29af40aebfdfa6e53858c90f.jpg" alt="Shell脚本编程及示例和例题解析_第11张图片" /></a></p>

<p><strong>多分支的if语句：</strong></p>

<p><strong>单分支：</strong></p>

<p><strong>if CONDITION; then</strong></p>

<p><strong>if-true-分支</strong></p>

<p><strong>fi</strong></p>

<p><strong>双分支：</strong></p>

<p><strong>if CONDITION; then</strong></p>

<p><strong>if-true-分支</strong></p>

<p><strong>else</strong></p>

<p><strong>if-false-分支</strong></p>

<p><strong>fi</strong></p>

<p><strong>多分支：</strong></p>

<p><strong>if CONDITION1; then</strong></p>

<p><strong>if-CONDITION1-true-分支</strong></p>

<p><strong>elif CONDTION2; then</strong></p>

<p><strong>if-CONDITIO2-true-分支</strong></p>

<p><strong>&hellip;</strong></p>

<p><strong>else</strong></p>

<p><strong>if-ALL-false-分支</strong></p>

<p><strong>fi</strong></p>

<p><strong>示例：通过脚本参数传递一个文件路径给脚本，判断其类型；</strong></p>

<p><a href="https://img.it610.com/image/info8/581cf30258574d68bb76f70805928ae9.jpg"><img src="https://img.it610.com/image/info8/581cf30258574d68bb76f70805928ae9.jpg" alt="Shell脚本编程及示例和例题解析_第12张图片" /></a></p>

<p><strong>由上面众多示例我们应该熟悉了怎么创建脚本及运行脚本、判断语法等，所以下面示例我们只给出脚本编程，不再进行运行测试；</strong></p>

<p><strong>示例：脚本可接受四个参数</strong></p>

<p><strong>start: 创建文件/var/lock/subsys/SCRIPT_NAME</strong></p>

<p><strong>stop: 删除此文件</strong></p>

<p><strong>restart: 删除此文件并重新创建</strong></p>

<p><strong>status: 如果文件存在，显示为&rdquo;running&rdquo;，否则，显示为&rdquo;stopped&rdquo;</strong></p>

<p><strong>basename命令：取得路径的基名；</strong></p>

<p><strong>elif：if的特殊使用，多分支判断；</strong></p>

<p>#!/bin/bash</p>

<p>#</p>

<p>prog=$(basename $0)</p>

<p>lockfile=&ldquo;/var/lock/subsys/$prog&rdquo;</p>

<p>#echo $lockfile</p>

<p>if [ $# -lt 1 ]; then</p>

<p>echo &ldquo;Usage: $prog start|stop|restart|status&rdquo;</p>

<p>exit 1</p>

<p>fi</p>

<p>if [ &ldquo;$1&rdquo; == &ldquo;start&rdquo; ]; then</p>

<p>if [ -f $lockfile ]; then</p>

<p>echo &ldquo;$prog is started yet.&rdquo;</p>

<p>else</p>

<p>touch $lockfile &amp;&amp; echo &ldquo;Starting $prog ok&hellip;&rdquo; || echo &ldquo;Starting $prog
failed&hellip;&rdquo;</p>

<p>fi</p>

<p>elif [ &ldquo;$1&rdquo; == &lsquo;stop&rsquo; ]; then</p>

<p>if [ -f $lockfile ]; then</p>

<p>rm -f $lockfile &amp;&amp; echo &ldquo;Stop $prog ok&hellip;.&rdquo; || echo &ldquo;Stop $prog failed&hellip;&rdquo;</p>

<p>else</p>

<p>echo &ldquo;$prog is stopped yet.&rdquo;</p>

<p>fi</p>

<p>elif [ &ldquo;$1&rdquo; == &lsquo;restart&rsquo; ]; then</p>

<p>if [ -f $lockfile ]; then</p>

<p>rm -f $lockfile &amp;&amp; touch $lockfile &amp;&amp; echo &ldquo;Restarting $porg ok&hellip;&rdquo;</p>

<p>else</p>

<p>touch $lockfile &amp;&amp; echo &ldquo;$prog is stopped, Starting $prog ok&hellip;.&rdquo;</p>

<p>fi</p>

<p>elif [ &ldquo;$1&rdquo; == &lsquo;status&rsquo; ]; then</p>

<p>if [ -f $lockfile ]; then</p>

<p>echo &ldquo;Running&hellip;&rdquo;</p>

<p>else</p>

<p>echo &ldquo;Stopped&hellip;&rdquo;</p>

<p>fi</p>

<p>else</p>

<p>echo &ldquo;Usage: $prog start|stop|restart|sttus&rdquo;</p>

<p>exit 1</p>

<p>fi</p>

<p><strong>case语句</strong></p>

<p><strong>简洁版多分支if语句；</strong></p>

<p><strong>使用场景：判断某变量的值是否为多种情形中的一种时使用；</strong></p>

<p><strong>语法：</strong></p>

<p>case $VARIABLE in</p>

<p>PATTERN1)</p>

<p>分支1</p>

<p>;;</p>

<p>PATTERN2)</p>

<p>分支2</p>

<p>;;</p>

<p>PATTERN3)</p>

<p>分支3</p>

<p>;;</p>

<p>&hellip;</p>

<p>*)</p>

<p>分支n</p>

<p>;;</p>

<p>esac</p>

<p><strong>\\PATTERN可使用glob模式的通配符：</strong></p>

<p>*<strong>: 任意长度的任意字符；</strong></p>

<p><strong>?: 任意单个字符；</strong></p>

<p><strong>[]: 指定范围内的任意单个字符；</strong></p>

<p><strong>a|b: 多选1；</strong></p>

<p><strong>示例：提示键入任意一个字符；判断其类型；</strong></p>

<p>#!/bin/bash</p>

<p>#</p>

<p>read -p &ldquo;Plz enter a character: &ldquo; char</p>

<p>case $char in</p>

<p>[a-z])</p>

<p>echo &ldquo;A character.&rdquo;</p>

<p>;;</p>

<p>[0-9])</p>

<p>echo &ldquo;A digit.&rdquo;</p>

<p>;;</p>

<p>*)</p>

<p>echo &ldquo;A special character.&rdquo;</p>

<p>;;</p>

<p>esac</p>

<p><strong>示例：脚本可接受四个参数</strong></p>

<p>start: 创建文件/var/lock/subsys/SCRIPT_NAME</p>

<p>stop: 删除此文件</p>

<p>restart: 删除此文件并重新创建</p>

<p>status: 如果文件存在，显示为&rdquo;running&rdquo;，否则，显示为&rdquo;stopped&rdquo;</p>

<p>#!/bin/bash</p>

<p>#</p>

<p>prog=$(basename $0)</p>

<p>lockfile=&ldquo;/var/lock/subsys/$prog&rdquo;</p>

<p>#echo $lockfile</p>

<p>if [ $# -lt 1 ]; then</p>

<p>echo &ldquo;Usage: $prog start|stop|restart|status&rdquo;</p>

<p>exit 1</p>

<p>fi</p>

<p>case $1 in</p>

<p>start)</p>

<p>if [ -f $lockfile ]; then</p>

<p>echo &ldquo;$prog is started yet.&rdquo;</p>

<p>else</p>

<p>touch $lockfile &amp;&amp; echo &ldquo;Starting $prog ok&hellip;&rdquo; || echo &ldquo;Starting $prog
failed&hellip;&rdquo;</p>

<p>fi</p>

<p>;;</p>

<p>stop)</p>

<p>if [ -f $lockfile ]; then</p>

<p>rm -f $lockfile &amp;&amp; echo &ldquo;Stop $prog ok&hellip;.&rdquo; || echo &ldquo;Stop $prog failed&hellip;&rdquo;</p>

<p>else</p>

<p>echo &ldquo;$prog is stopped yet.&rdquo;</p>

<p>fi</p>

<p>;;</p>

<p>restart)</p>

<p>if [ -f $lockfile ]; then</p>

<p>rm -f $lockfile &amp;&amp; touch $lockfile &amp;&amp; echo &ldquo;Restarting $porg ok&hellip;&rdquo;</p>

<p>else</p>

<p>touch $lockfile &amp;&amp; echo &ldquo;$prog is stopped, Starting $prog ok&hellip;.&rdquo;</p>

<p>fi</p>

<p>;;</p>

<p>status)</p>

<p>if [ -f $lockfile ]; then</p>

<p>echo &ldquo;Running&hellip;&rdquo;</p>

<p>else</p>

<p>echo &ldquo;Stopped&hellip;&rdquo;</p>

<p>fi</p>

<p>;;</p>

<p>*)</p>

<p>echo &ldquo;Usage: $prog start|stop|restart|sttus&rdquo;</p>

<p>exit 1</p>

<p>esac #注：case语句以esac结束</p>

<p>-&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;</p>

<p>-&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;</p>

<p><strong>shell中的流程控制语句：</strong></p>

<p><strong>循环语句：for, while, until</strong></p>

<p>while循环：</p>

<p>while CONDTION; do</p>

<p>循环体</p>

<p>done</p>

<p>进入条件：当CONDITION为“真”；</p>

<p>退出条件：当CONDITION为“假”；</p>

<p>while CONDITION; do</p>

<p>循环体</p>

<p>控制变量的修正表达式</p>

<p>done</p>

<p><strong>示例：求100以内所有正整数之和；</strong></p>

<p>#!/bin/bash</p>

<p>#</p>

<p>declare -i sum=0</p>

<p>declare -i i=1</p>

<p>while [ $i -le 100 ]; do</p>

<p>let sum+=$i</p>

<p>let i++</p>

<p>done</p>

<p>echo &ldquo;Sum: $sum.&rdquo;</p>

<p><strong>示例：打印九九乘法表</strong></p>

<p>#!/bin/bash</p>

<p>#</p>

<p>declare -i i=1</p>

<p>declare -i j=1</p>

<p>while [ $j -le 9 ]; do</p>

<p>while [ $i -le $j ]; do</p>

<p>echo -e -n &ldquo;${i}X${j}=$[$i*$j]\t&rdquo;</p>

<p>let i++</p>

<p>done</p>

<p>echo</p>

<p>let i=1</p>

<p>let j++</p>

<p>done</p>

<p><strong>unitl循环：</strong></p>

<p>until CONDITION; do</p>

<p>循环体</p>

<p>循环控制变量的修正表达式</p>

<p>done</p>

<p>进入条件：当CONDITION为“假”时</p>

<p>退出条件：当CONDITION为“真”时</p>

<p><strong>示例：求100以内所有正整数之和</strong></p>

<p>#!/bin/bash</p>

<p>#</p>

<p>declare -i sum=0</p>

<p>declare -i i=1</p>

<p>until [ $i -gt 100 ]; do</p>

<p>let sum+=$i</p>

<p>let i++</p>

<p>done</p>

<p>echo &ldquo;Sum: $sum.&rdquo;</p>

<p><strong>循环控制：</strong></p>

<p><strong>continue [n]：提前结束本轮循环，而直接进入下一轮；</strong></p>

<p><strong>break [n]：提前结束循环；</strong></p>

<p><strong>while循环：</strong></p>

<p>while CONDITION; do</p>

<p>&hellip;&hellip;.</p>

<p>if CONDITION2; then</p>

<p>break [n]</p>

<p>fi</p>

<p>done</p>

<p>while CONDITION; do</p>

<p>&hellip;&hellip;</p>

<p>if CONDITION2; then</p>

<p>continue [n]</p>

<p>fi</p>

<p>&hellip;&hellip;</p>

<p>done</p>

<p><strong>示例：求100以内所有偶数之和；</strong></p>

<p>#!/bin/bash</p>

<p>#</p>

<p>declare -i sum=0</p>

<p>declare -i i=0</p>

<p>while [ $i -le 100 ]; do</p>

<p>let i++</p>

<p>if [ $[$i%2] -eq 1 ]; then</p>

<p>echo &ldquo;$i is a odd.&rdquo;</p>

<p>continue</p>

<p>fi</p>

<p>let sum+=$i</p>

<p>done</p>

<p>echo &ldquo;Sum: $sum.&rdquo;</p>

<p>死循环：</p>

<p>while true; do</p>

<p>循环体</p>

<p>if CONDTION; then</p>

<p>break</p>

<p>fi</p>

<p>done</p>

<p>until false; do</p>

<p>循环体</p>

<p>if CONDITION; then</p>

<p>break</p>

<p>fi</p>

<p>done</p>

<p><strong>示例：每隔3秒钟查看当前系统上是否有名为“gentoo”的用户登录；</strong></p>

<p><strong>如果某次查看gentoo登录了，则显示gentoo已经登录；</strong></p>

<p><strong>如果未登录，就显示仍然未来，并显示这是已经是第多少次查看了；</strong></p>

<p>#!/bin/bash</p>

<p>#</p>

<p>username=$1</p>

<p>declare -i count=0</p>

<p>while true; do</p>

<p>if who | grep &ldquo;^$username&rdquo; &amp;&gt; /dev/null; then</p>

<p>echo &ldquo;$username is logged.&rdquo;</p>

<p>break</p>

<p>else</p>

<p>let count++</p>

<p>echo &ldquo;$count $username is not login.&rdquo;</p>

<p>fi</p>

<p>sleep 3</p>

<p>done</p>

<p>#!/bin/bash</p>

<p>#</p>

<p>declare -i count=0</p>

<p>username=$1</p>

<p>if [ $# -lt 1 ]; then</p>

<p>echo &ldquo;At lease one argument.&rdquo;</p>

<p>exit 1</p>

<p>fi</p>

<p>if ! id $username &amp;&gt; /dev/null; then</p>

<p>echo &ldquo;No such user.&rdquo;</p>

<p>exit 2</p>

<p>fi</p>

<p>until who | grep &ldquo;^$username&rdquo; &amp;&gt; /dev/null; do</p>

<p>let count++</p>

<p>echo &ldquo;$count $username is not login.&rdquo;</p>

<p>sleep 3</p>

<p>done</p>

<p>echo &ldquo;$username is logged on.&rdquo;</p>

<p><strong>while循环的特殊用法：</strong></p>

<p>遍历文件的每一行：</p>

<p>while read VARIABLE; do</p>

<p>循环体</p>

<p>done &lt; /PATH/FROM/SOME_FILE</p>

<p>示例：找出UID为偶数的所有用户，显示其用户名和ID号；</p>

<p>#!/bin/bash</p>

<p>#</p>

<p>while read line; do</p>

<p>userid=$(echo $line | cut -d: -f3)</p>

<p>if [ $[$userid%2] -eq 0 ]; then</p>

<p>echo $line | cut -d: -f1,3</p>

<p>fi</p>

<p>done &lt; /etc/passwd</p>

<p><strong>for循环的特殊用法：</strong></p>

<p>for ((expr1;expr2;expr3)); do</p>

<p>循环体</p>

<p>done</p>

<p>expr1: 定义控制变量，并初始赋值；</p>

<p>expr2: 循环控制条件；</p>

<p>进入条件：控制条件为“真”</p>

<p>退出条件：控制条件为“假”</p>

<p>expr3: 修正控制变量</p>

<p><strong>示例：求100以内所有正整数之和；</strong></p>

<p>#!/bin/bash</p>

<p>#</p>

<p>declare -i sum=0</p>

<p>for ((i=1;i&lt;=100;i++)); do</p>

<p>let sum+=$i</p>

<p>done</p>

<p>echo &ldquo;Sum: $sum.&rdquo;</p>

<p><strong>函数：</strong></p>

<p>function: 功能</p>

<p>把一段具有独立功能代码封装在一起，并给予命名；后续用到时，可直接通过给定函数名来调用整体代码；</p>

<p>函数作用：</p>

<p>代码重用；</p>

<p>模块化编程；</p>

<p><strong>函数的使用方法：</strong></p>

<p><strong>先定义：编写函数代码</strong></p>

<p><strong>后调用：给出函数名，还可按需传递参数</strong></p>

<p>定义方法：</p>

<p>(1) function f_name {</p>

<p>函数体</p>

<p>}</p>

<p>(2) f_name() {</p>

<p>函数体</p>

<p>}</p>

<p>调用函数：</p>

<p>f_name [argu1, argu2, &hellip;]</p>

<p>自定义函数状态返回值：</p>

<p>return [#]</p>

<p>0: 成功</p>

<p>1-255：失败</p>

<p><strong>注意：函数代码执行时，一旦遇到return，函数代码终止运行，函数返回；</strong></p>

<p>示例：此前的服务脚本</p>

<p>#!/bin/bash</p>

<p>#</p>

<p>prog=$(basename $0) #获取目录根路径</p>

<p>lockfile=&ldquo;/var/lock/subsys/$prog&rdquo;</p>

<p>#echo $lockfile</p>

<p>if [ $# -lt 1 ]; then</p>

<p>echo &ldquo;Usage: $prog start|stop|restart|status&rdquo;</p>

<p>exit 1</p>

<p>fi</p>

<p>start() {</p>

<p>if [ -f $lockfile ]; then</p>

<p>echo &ldquo;$prog is started yet.&rdquo;</p>

<p>else</p>

<p>touch $lockfile &amp;&amp; echo &ldquo;Starting $prog ok&hellip;&rdquo; || echo &ldquo;Starting $prog
failed&hellip;&rdquo;</p>

<p>fi</p>

<p>}</p>

<p>stop() {</p>

<p>if [ -f $lockfile ]; then</p>

<p>rm -f $lockfile &amp;&amp; echo &ldquo;Stop $prog ok&hellip;.&rdquo; || echo &ldquo;Stop $prog failed&hellip;&rdquo;</p>

<p>else</p>

<p>echo &ldquo;$prog is stopped yet.&rdquo;</p>

<p>fi</p>

<p>}</p>

<p>restart() {</p>

<p>if [ -f $lockfile ]; then</p>

<p>rm -f $lockfile &amp;&amp; touch $lockfile &amp;&amp; echo &ldquo;Restarting $porg ok&hellip;&rdquo;</p>

<p>else</p>

<p>touch $lockfile &amp;&amp; echo &ldquo;$prog is stopped, Starting $prog ok&hellip;.&rdquo;</p>

<p>fi</p>

<p>}</p>

<p>status() {</p>

<p>if [ -f $lockfile ]; then</p>

<p>echo &ldquo;Running&hellip;&rdquo;</p>

<p>else</p>

<p>echo &ldquo;Stopped&hellip;&rdquo;</p>

<p>fi</p>

<p>}</p>

<p>case $1 in</p>

<p>start)</p>

<p>start</p>

<p>;;</p>

<p>stop)</p>

<p>stop</p>

<p>;;</p>

<p>restart)</p>

<p>restart</p>

<p>;;</p>

<p>status)</p>

<p>status</p>

<p>;;</p>

<p>*)</p>

<p>echo &ldquo;Usage: $prog start|stop|restart|sttus&rdquo;</p>

<p>exit 1</p>

<p>esac</p>

<p>示例：判断用户的ID号的奇偶性；</p>

<p>#!/bin/bash</p>

<p>#</p>

<p>evenid() {</p>

<p>if [ $# -lt 1 ]; then</p>

<p>return 1</p>

<p>fi</p>

<p>if ! id $1 &amp;&gt; /dev/null; then</p>

<p>return 2</p>

<p>fi</p>

<p>userid=$(id -u $1)</p>

<p>if [ $[$userid%2] -eq 0 ]; then</p>

<p>echo &ldquo;$1, Even user ID.&rdquo;</p>

<p>else</p>

<p>echo &ldquo;$1, Odd user ID.&rdquo;</p>

<p>fi</p>

<p>}</p>

<p>evenid root</p>

<p>evenid</p>

<p>echo $?</p>

<p>evenid rooooooooooooot</p>

<p>echo $?</p>

<p>-&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;</p>

<p>模块化编程</p>

<p>功能：把脚本文件中的代码分隔为多段，放在不同的文件中</p>

<p>假设/root/bin/srv目录有两个文件：</p>

<p>(1) 函数文件</p>

<p>(2) 脚本文件</p>

<p>为脚本使用配置文件</p>

<p>一个文件中只定义变量</p>

<p>脚本文件source此变量定义的文件</p>

<p><strong>可将脚本分为两个文件，在运行的文件中使用source PATH引用另一个配置文件；</strong></p>

<p>变量的作用域：</p>

<p><strong>局部变量：在当脚本中存在其他变量与函数中定义的变量重复时时，需要使用local命令来使函数中的变量变为局部变量：</strong></p>

<p>local VARIABLE=value</p>

<p>局部变量存活时间：</p>

<p>函数执行开始，至函数返回结束；</p>

<p>-&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;</p>

<p>-&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;</p>

<p><strong>作业：</strong></p>

<p><strong>1写一个脚本</strong></p>

<p><strong>如果某路径不存在，则将其创建为目录；否则显示其存在，并显示内容类型；</strong></p>

<p><a href="https://img.it610.com/image/info8/f5d47e585b99462c968b04b2235fefc1.jpg"><img src="https://img.it610.com/image/info8/f5d47e585b99462c968b04b2235fefc1.jpg" alt="Shell脚本编程及示例和例题解析_第13张图片" /></a></p>

<p><strong>2 写一个脚本，完成如下功能；判断给定的两个数值，孰大孰小；给定数值的方法：脚本参数，命令交互；</strong></p>

<p><a href="https://img.it610.com/image/info8/7de35180b0e44b759fcf3a6fa38fe0d5.jpg"><img src="https://img.it610.com/image/info8/7de35180b0e44b759fcf3a6fa38fe0d5.jpg" alt="Shell脚本编程及示例和例题解析_第14张图片" /></a></p>

<p><strong>3．求100以内所有偶数之和；</strong></p>

<p><strong>使用至少三种方法实现；</strong></p>

<p>1）.seq语法表示0 2 100:0-100 每次隔2.</p>

<p><a href="https://img.it610.com/image/info8/ca5d24f5286844ed82a5ad635133d3d0.jpg"><img src="https://img.it610.com/image/info8/ca5d24f5286844ed82a5ad635133d3d0.jpg" alt="Shell脚本编程及示例和例题解析_第15张图片" /></a></p>

<p>2）.与上个方法不同的就是变量i的赋值方式不同：</p>

<p><a href="https://img.it610.com/image/info8/0a1cae61dd624ea6b55270dccbeeabbd.jpg"><img src="https://img.it610.com/image/info8/0a1cae61dd624ea6b55270dccbeeabbd.jpg" alt="Shell脚本编程及示例和例题解析_第16张图片" /></a></p>

<p>3）.此方法使用函数调用法：</p>

<p><a href="https://img.it610.com/image/info8/9696c563e8914c2f8f318388e832a47f.jpg"><img src="https://img.it610.com/image/info8/9696c563e8914c2f8f318388e832a47f.jpg" alt="Shell脚本编程及示例和例题解析_第17张图片" /></a></p>

<p><strong>4.写一个脚本(1) 传递两个文本文件路径给脚本；</strong></p>

<p><strong>(2) 显示两个文件中空白行数较多的文件及其空白行的个数；</strong></p>

<p><strong>(3) 显示两个文件中总行数较多的文件及其总行数；</strong></p>

<p><a href="https://img.it610.com/image/info8/76e7f7f89f454e899bb35ee2baab02a5.jpg"><img src="https://img.it610.com/image/info8/76e7f7f89f454e899bb35ee2baab02a5.jpg" alt="Shell脚本编程及示例和例题解析_第18张图片" /></a></p>

<p><strong>5.写一个脚本</strong></p>

<p><strong>(1) 提示用户输入一个字符串；</strong> ****</p>

<p><strong>(2) 判断：</strong> ****</p>

<p><strong>如果输入的是quit，则退出脚本；</strong> ****</p>

<p><strong>否则，则显示其输入的字符串内容；</strong> **** **** **** **** **** ****</p>

<p><a href="https://img.it610.com/image/info8/bba10ce9812c44788ab18f2cc197ddf5.jpg"><img src="https://img.it610.com/image/info8/bba10ce9812c44788ab18f2cc197ddf5.jpg" alt="Shell脚本编程及示例和例题解析_第19张图片" /></a></p>

<p><strong>6.写一个脚本，打印2^n表；n等于一个用户输入的值；</strong></p>

<p><strong>Resolution:这题主要思路就是首先定义一个循环变量i，然后使用read读取交互输入的$num，接着进行循环运算，定义退出循环条件：使循环变量$i小于$num，i从0开始赋值，然后进行数值运算：2</strong>$i。**</p>

<p><a href="https://img.it610.com/image/info8/543060a4b3b249c08014f984684ea8e1.jpg"><img src="https://img.it610.com/image/info8/543060a4b3b249c08014f984684ea8e1.jpg" alt="Shell脚本编程及示例和例题解析_第20张图片" /></a></p>

<p><strong>7.写一个脚本，写这么几个函数：函数1、实现给定的两个数值的之和；函数2、取给定两个数值的最大公约数；函数3、取给定两个数值的最小公倍数；关于函数的选定、两个数值的大小都将通过交互式输入来提供。</strong></p>

<p><strong>由于此处脚本过长，所以此处给出编程代码，并附上脚本运行结果：</strong></p>

<p><strong>此处本人写出两套方案，一个简单易懂，一个细化分类：</strong></p>

<p>#!/bin/bash</p>

<p>#</p>

<p>if [[ $# -le 2 ]];then</p>

<p>echo &ldquo;plz input two number and use space to isolation them!&rdquo;</p>

<p>fi</p>

<p>function add() {</p>

<p>echo &ldquo;The two num sum:$1+$2=<code>expr $1 + $2</code>&ldquo;</p>

<p>}</p>

<p>add $1 $2</p>

<p>declare -i big</p>

<p>declare -i sma</p>

<p>if [ $1 -gt $2 ];then</p>

<p>big=$1</p>

<p>sma=$2</p>

<p>else</p>

<p>big=$2</p>

<p>sma=$1</p>

<p>fi</p>

<p>gcdlcm(){</p>

<p>i=1 #定义一个循环变量</p>

<p>GCD=1 #定义最大公约数</p>

<p>LCM=1 #定义最小公倍数</p>

<p>btmp=1 #定义用户输入的较大的一个变量除以循环变量的值</p>

<p>stmp=1 #定义用户输入的较小的一个变量除以循环变量的值</p>

<p>while [ $i -le $sma ];do #定义循环条件，循环变量小于或等于用户输入的较小的变量</p>

<p>btmp=<code>expr $big % $i</code> #求值</p>

<p>stmp=<code>expr $sma % $i</code> #求值</p>

<p>if [ $btmp -eq 0 ];then #判断值得余数是否为0</p>

<p>if [ $stmp -eq 0 ];then #同上</p>

<p>gcd=$i #如果值得余数为0，则获取最大公约数的值</p>

<p>fi #判断结束</p>

<p>fi</p>

<p>i=<code>expr $i + 1</code> #i变量循环，直到i等于用户输入的较小的数为止退出循环。</p>

<p>done #当i=$sma，退出循环</p>

<p>lcm=<code>expr $sma / $gcd</code> #根据最小公倍数公式求值</p>

<p>lcm=<code>expr $lcm \\* $big</code> #同上，求最小公倍数公式为：lcm=$sma*$big%gcd</p>

<p>echo &ldquo;lcm:$lcm&rdquo; #输出lcm值</p>

<p>echo &ldquo;gcd:$gcd&rdquo; #输出gcd值</p>

<p>}</p>

<p><strong>第二种方法：</strong></p>

<p>#!/bin/bash</p>

<p>#</p>

<p>if [[ $1 -eq &ldquo;&rdquo; ]];then</p>

<p>echo &lsquo;plz input the first number&rsquo;</p>

<p>exit 1</p>

<p>fi</p>

<p>if [[ $2 -eq &ldquo;&rdquo; ]];then</p>

<p>echo &lsquo;plz input the second number&rsquo;</p>

<p>exit 2</p>

<p>fi</p>

<p>function add() {</p>

<p>sum=$[$1+$2]</p>

<p>echo &ldquo;the sum is $sum&rdquo;</p>

<p>}</p>

<p>add $1 $2</p>

<p>declare -i max</p>

<p>declare -i min</p>

<p>if [[ $1 -gt $2 ]];then</p>

<p>max=$1</p>

<p>min=$2</p>

<p>elif [[ $1 -lt $2 ]];then</p>

<p>max=$2</p>

<p>min=$1</p>

<p>else</p>

<p>max=$1</p>

<p>min=$2</p>

<p>fi</p>

<p>function gong() {</p>

<p>r=$[$max%$min]</p>

<p>temp=$min</p>

<p>declare -i a</p>

<p>declare -i b</p>

<p>if [[ $r -eq 0 ]];then</p>

<p>echo &ldquo;gongyue is $min&rdquo;</p>

<p>echo &ldquo;gongbei is $max&rdquo;</p>

<p>else</p>

<p>while [[ $r -ne 0 ]];do</p>

<p>a=$2</p>

<p>b=$r</p>

<p>r=$[$a%$b]</p>

<p>done</p>

<p>gongyue=$b</p>

<p>gongbei=$[$1*$2/$b]</p>

<p>echo &ldquo;gongyue is $gongyue&rdquo;</p>

<p>echo &ldquo;gongbei is $gongbei&rdquo;</p>

<p>fi</p>

<p>}</p>

<p>gong $1 $2</p>

<p><a href="https://img.it610.com/image/info8/cb236b632dbc4a3c8a38ed16ea28ef92.jpg"><img src="https://img.it610.com/image/info8/cb236b632dbc4a3c8a38ed16ea28ef92.jpg" alt="Shell脚本编程及示例和例题解析_第21张图片" /></a></p>

<p>转载于:<a href="https://blog.51cto.com/summer37/1695093">https://blog.51cto.com/summer37/1695093</a></p>

        </div>

        


        

<div class="post-archive">
    <h2>See Also</h2>
    <ul class="listing">
        
        <li><a href="/posts/007hadoop%E9%9B%86%E7%BE%A4%E9%85%8D%E7%BD%AEhadoop%E9%9B%86%E7%BE%A4%E7%9A%84%E5%90%AF%E5%8A%A8%E5%92%8C%E6%B5%8B%E8%AF%95ssh%E5%85%8D%E7%99%BB%E9%99%86%E9%85%8D%E7%BD%AEstartallshhdfs%E5%B8%B8%E7%94%A8%E7%9A%84shell/">007Hadoop集群配置Hadoop集群的启动和测试SSH免登陆配置startallshhdfs常用的shell</a></li>
        
        <li><a href="/posts/009shell%E8%84%9A%E6%9C%AC%E4%B8%8B%E6%9D%A1%E4%BB%B6%E6%B5%8B%E8%AF%95eqne/">009Shell脚本下条件测试eqne</a></li>
        
        <li><a href="/posts/00pythonmanagepyshell%E5%92%8Cpython%E7%9A%84%E5%88%86%E6%9E%90/">00Pythonmanagepyshell和Python的分析</a></li>
        
        <li><a href="/posts/010zookeeper%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5zookeeper%E7%9A%84%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BAzookeeper%E7%9A%84shell%E5%91%BD%E4%BB%A4/">010Zookeeper的基本概念Zookeeper的集群搭建Zookeeper的shell命令</a></li>
        
        <li><a href="/posts/018dockerfileshell/">018DockerfileSHELL</a></li>
        
    </ul>
</div>


        <div class="post-meta meta-tags">
            
            <ul class="clearfix">
                
                <li><a href='https://zaina.newban.cn/tags/shell'>shell</a></li>
                
            </ul>
            
        </div>
    </article>
    
    

    
    
</div>

                    <footer id="footer">
    <div>
        &copy; 2020 <a href="https://zaina.newban.cn">开发者问答集锦 By </a>
        
    </div>
    <br />
    <div>
        <div class="github-badge">
            <a href="https://gohugo.io/" target="_black" rel="nofollow"><span class="badge-subject">Powered by</span><span class="badge-value bg-blue">Hugo</span></a>
        </div>
        <div class="github-badge">
            <a href="https://www.flysnow.org/" target="_black"><span class="badge-subject">Design by</span><span class="badge-value bg-brightgreen">飞雪无情</span></a>
        </div>
        <div class="github-badge">
            <a href="https://github.com/flysnow-org/maupassant-hugo" target="_black"><span class="badge-subject">Theme</span><span class="badge-value bg-yellowgreen">Maupassant</span></a>
        </div>
    </div>
</footer>


    
    <script type="text/javascript">
        window.MathJax = {
            tex2jax: {
                inlineMath: [['$', '$']],
                processEscapes: true
                }
            };
    </script>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML' async></script>

<a id="rocket" href="#top"></a>
<script type="text/javascript" src='/js/totop.js?v=0.0.0' async=""></script>



    <script type="text/javascript" src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script>




                </div>

                <div id="secondary">
    <section class="widget">
        <form id="search" action='https://zaina.newban.cn/search/' method="get" accept-charset="utf-8" target="_blank" _lpchecked="1">
      
      <input type="text" name="q" maxlength="20" placeholder="Search">
      <input type="hidden" name="sitesearch" value="https://zaina.newban.cn">
      <button type="submit" class="submit icon-search"></button>
</form>
    </section>
    
    <section class="widget">
        <h3 class="widget-title">最近文章</h3>
<ul class="widget-list">
    
    <li>
        <a href="https://zaina.newban.cn/posts/001rubyruby%E4%B8%AD%E5%85%A8%E5%B1%80%E5%8F%98%E9%87%8F%E5%AE%9E%E4%BE%8B%E5%8F%98%E9%87%8F%E5%B1%80%E9%83%A8%E5%8F%98%E9%87%8F%E7%B1%BB%E5%8F%98%E9%87%8Fsymbol%E5%AF%B9%E6%AF%94/" title="001rubyRuby中全局变量实例变量局部变量类变量Symbol对比">001rubyRuby中全局变量实例变量局部变量类变量Symbol对比</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/007hadoop%E9%9B%86%E7%BE%A4%E9%85%8D%E7%BD%AEhadoop%E9%9B%86%E7%BE%A4%E7%9A%84%E5%90%AF%E5%8A%A8%E5%92%8C%E6%B5%8B%E8%AF%95ssh%E5%85%8D%E7%99%BB%E9%99%86%E9%85%8D%E7%BD%AEstartallshhdfs%E5%B8%B8%E7%94%A8%E7%9A%84shell/" title="007Hadoop集群配置Hadoop集群的启动和测试SSH免登陆配置startallshhdfs常用的shell">007Hadoop集群配置Hadoop集群的启动和测试SSH免登陆配置startallshhdfs常用的shell</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/009shell%E8%84%9A%E6%9C%AC%E4%B8%8B%E6%9D%A1%E4%BB%B6%E6%B5%8B%E8%AF%95eqne/" title="009Shell脚本下条件测试eqne">009Shell脚本下条件测试eqne</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/00pythonmanagepyshell%E5%92%8Cpython%E7%9A%84%E5%88%86%E6%9E%90/" title="00Pythonmanagepyshell和Python的分析">00Pythonmanagepyshell和Python的分析</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/010zookeeper%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5zookeeper%E7%9A%84%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BAzookeeper%E7%9A%84shell%E5%91%BD%E4%BB%A4/" title="010Zookeeper的基本概念Zookeeper的集群搭建Zookeeper的shell命令">010Zookeeper的基本概念Zookeeper的集群搭建Zookeeper的shell命令</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/018dockerfileshell/" title="018DockerfileSHELL">018DockerfileSHELL</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/01shell%E5%85%A5%E9%97%A801bashshell%E7%89%B9%E6%80%A7/" title="01Shell入门01bashShell特性">01Shell入门01bashShell特性</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/01shell%E5%8F%98%E9%87%8F/" title="01Shell变量">01Shell变量</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/01shell%E5%9F%BA%E7%A1%80%E6%A6%82%E8%BF%B0%E8%84%9A%E6%9C%AC%E6%89%A7%E8%A1%8C%E6%96%B9%E5%BC%8Fbash%E5%9F%BA%E6%9C%AC%E5%8A%9F%E8%83%BD/" title="01Shell基础概述脚本执行方式Bash基本功能">01Shell基础概述脚本执行方式Bash基本功能</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/01shell%E7%BC%96%E7%A8%8Bhelloworld/" title="01shell编程helloworld">01shell编程helloworld</a>
    </li>
    
</ul>
    </section>

    

    <section class="widget">
        <h3 class="widget-title"><a href="/categories">分类</a></h3>
<ul class="widget-list">
    
</ul>
    </section>

    <section class="widget">
        <h3 class="widget-title"><a href="/tags">标签</a></h3>
<div class="tagcloud">
    
    <a href="https://zaina.newban.cn/tags/ruby/">ruby</a>
    
    <a href="https://zaina.newban.cn/tags/shell/">shell</a>
    
</div>
    </section>

    

    <section class="widget">
        <h3 class="widget-title">其它</h3>
        <ul class="widget-list">
            <li><a href="https://zaina.newban.cn/index.xml">文章 RSS</a></li>
        </ul>
    </section>
</div>
            </div>
        </div>
    </div>
</body>

</html>