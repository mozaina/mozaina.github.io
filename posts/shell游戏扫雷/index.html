<!doctype html>
<html lang="en-us">
<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">


    <title>shell游戏扫雷 | 开发者问答集锦</title>
    <meta property="og:title" content="shell游戏扫雷 - 开发者问答集锦">
    <meta property="og:type" content="article">
        
    <meta property="article:published_time" content='2020-09-02T00:00:00&#43;08:00'>
        
        
    <meta property="article:modified_time" content='2020-09-02T00:00:00&#43;08:00'>
        
    <meta name="Keywords" content="">
    <meta name="description" content="shell游戏扫雷">
        
    <meta name="author" content="">
    <meta property="og:url" content="https://zaina.newban.cn/posts/shell%E6%B8%B8%E6%88%8F%E6%89%AB%E9%9B%B7/">
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">

    <link rel="stylesheet" href='/css/normalize.css'>
    <link rel="stylesheet" href='/css/style.css'>
    <script type="text/javascript" src="//cdn.bootcdn.net/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

    
    
    
    
    
    
</head>


<body>
    <header id="header" class="clearfix">
    <div class="container">
        <div class="col-group">
            <div class="site-name ">
                
                    <a id="logo" href="https://zaina.newban.cn">
                        开发者问答集锦
                    </a>
                
                
            </div>
            <div>
                <nav id="nav-menu" class="clearfix">
                    <a class="" href="https://zaina.newban.cn">首页</a>
                    
                </nav>
            </div>
        </div>
    </div>
</header>

    <div id="body">
        <div class="container">
            <div class="col-group">

                <div class="col-8" id="main">
                    
<div class="res-cons">
    
    <article class="post">
        <header>
            <h1 class="post-title">shell游戏扫雷</h1>
        </header>
        <date class="post-meta meta-date">
            2020年9月2日
        </date>
        
        
        <div class="post-meta">
            <span id="busuanzi_container_page_pv">|<span id="busuanzi_value_page_pv"></span><span>
                    阅读</span></span>
        </div>
        
        
        <div class="post-content">
            

<p><a href="http://bbs.chinaunix.net/thread-634271-1-1.html">http://bbs.chinaunix.net/thread-634271-1-1.html</a></p>

<p>shell游戏:扫雷</p>

<p>期待各位帮忙测试,如有BUG,请及时告知,谢谢<br />
转载请保持版权声明完整,十分感谢</p>

<p>下载代码:<br />
<a href="http://bitbull.cn/works/mine.sh">http://bitbull.cn/works/mine.sh</a></p>

<p>屏幕截图:<br />
*</p>

<p>运行环境:<br />
bash<br />
80x24终端</p>

<p>usage:<br />
$chmod 755 mine.sh<br />
$./mine.sh</p>

<p>按1-3选择对应难度,4退出</p>

<p>方向:<br />
上:w 下:s 左:a 右:d<br />
标识地雷:<br />
FLAG:f<br />
挖:<br />
DIG:j<br />
重玩<br />
NEWGAME:n<br />
退出<br />
EXIT:x</p>

<p>规则:<br />
玩家可用方向键移动指针,按j挖雷,若挖到地雷,则游戏结束.否则,游戏将在你所挖方块内显示该方块周围8个方块内所有地雷数.若怀疑某方块为地雷,可按f键进行标识,以避免误挖.挖开地图内所有非雷方块则获胜.</p>

<p>代码:</p>

<ol>
<li><p>#!/bin/bash</p></li>

<li><p>#&mdash;&mdash;&mdash;&mdash;-CopyRight&mdash;&mdash;&mdash;&mdash;-</p></li>

<li><h1 id="name-mine-sweeping">Name:Mine Sweeping</h1></li>

<li><h1 id="version-number-1-00">Version Number:1.00</h1></li>

<li><h1 id="type-game">Type:game</h1></li>

<li><h1 id="language-bash-shell">Language:bash shell</h1></li>

<li><h1 id="date-2005-10-26">Date:2005-10-26</h1></li>

<li><h1 id="author-bitbull">Author:BitBull</h1></li>

<li><h1 id="email-bitbull-cn-at-gmail-com">Email:BitBull.cn(at)gmail.com</h1></li>

<li><p>#&mdash;&mdash;&mdash;&mdash;Environment&mdash;&mdash;&mdash;&mdash;</p></li>

<li><h1 id="terminal-column-80-line-24">Terminal: column 80 line 24</h1></li>

<li><h1 id="linux-2-6-9-i686">Linux 2.6.9 i686</h1></li>

<li><h1 id="gnu-bash-3-00-15">GNU Bash 3.00.15</h1></li>

<li><p>#&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;</p></li>

<li></li>

<li><p>#&mdash;&mdash;&mdash;&mdash;&mdash;Define&mdash;&mdash;&mdash;&mdash;&ndash;</p></li>

<li><p>ECHO=&ldquo;echo -ne&rdquo;</p></li>

<li><p>ESC=&rdquo;\033[&rdquo;</p></li>

<li></li>

<li><p>OK=0</p></li>

<li><p>FALSE=1</p></li>

<li><p>#&mdash;&mdash;&mdash;&mdash;&ndash;Variable&mdash;&mdash;&mdash;&mdash;&ndash;</p></li>

<li><p>#ANSI ESC action</p></li>

<li><p>FLASH=5</p></li>

<li><p>REV=7</p></li>

<li></li>

<li><p>#color</p></li>

<li><p>NULL=0</p></li>

<li><p>BLACK=30</p></li>

<li><p>RED=31</p></li>

<li><p>GREEN=32</p></li>

<li><p>ORANGE=33</p></li>

<li><p>BLUE=34</p></li>

<li><p>PURPLE=35</p></li>

<li><p>SBLUE=36</p></li>

<li><p>GREY=37</p></li>

<li></li>

<li><p>#back color</p></li>

<li><p>BBLACK=40</p></li>

<li><p>BRED=41</p></li>

<li><p>BGREEN=42</p></li>

<li><p>BORANGE=43</p></li>

<li><p>BBLUE=44</p></li>

<li><p>BPURPLE=45</p></li>

<li><p>BSBLUE=46</p></li>

<li><p>BGREY=47</p></li>

<li></li>

<li><p>MINE=&lsquo;@&rsquo;</p></li>

<li><p>FLAG=&lsquo;F&rsquo;</p></li>

<li><p>NUL=&rsquo; &lsquo;</p></li>

<li><p>SHADOW=&lsquo;X&rsquo;</p></li>

<li></li>

<li><p>X=0</p></li>

<li><p>Y=0</p></li>

<li><p>CurX=1 #cur&rsquo;s X</p></li>

<li><p>CurY=1 #cur&rsquo;s Y</p></li>

<li><p>OCurX=1 #old cur&rsquo;s X</p></li>

<li><p>OCurY=1 #old cur&rsquo;s Y</p></li>

<li><p>MCount=0 #count mine</p></li>

<li><p>FCount=0 #count flag</p></li>

<li><p>SCount=0 #count shadow</p></li>

<li><p>MXYp=0 #MXY Array&rsquo;s ptr</p></li>

<li><p>#&mdash;&mdash;&mdash;&mdash;&mdash;Array&mdash;&mdash;&mdash;&mdash;&mdash;-</p></li>

<li></li>

<li><p>#if ${XY[]} == M { mine }</p></li>

<li><p>#if ${XY[]} == F { flag }</p></li>

<li><p>#if ${XY[]} == N { null }</p></li>

<li><p>#if ${XY[]} == S { shadow }</p></li>

<li><p>#if ${XY[]} == [1-8] { tip_num }</p></li>

<li><p>#${XY[]} init in XYInit(i)</p></li>

<li></li>

<li><p>MXY[0]=&ldquo;&rdquo;</p></li>

<li></li>

<li><p>#&mdash;&mdash;&mdash;&mdash;&ndash;Function&mdash;&mdash;&mdash;&mdash;&ndash;</p></li>

<li></li>

<li><p>function SttyInit ()</p></li>

<li><p>{</p></li>

<li><p>stty_save=$(stty -g) #backup stty</p></li>

<li></li>

<li><p>clear</p></li>

<li><p>trap &ldquo;GameExit;&rdquo; 2 15</p></li>

<li><p>stty -echo</p></li>

<li></li>

<li><p>$ECHO &ldquo;${ESC}?25l&rdquo; #hidden cursor</p></li>

<li></li>

<li><p>return $OK</p></li>

<li><p>}</p></li>

<li></li>

<li><p>function GameExit ()</p></li>

<li><p>{</p></li>

<li><p>stty $stty_save</p></li>

<li><p>stty echo</p></li>

<li><p>clear</p></li>

<li><p>trap 2 15</p></li>

<li><p>$ECHO &ldquo;${ESC}?25h${ESC}0;0H${ESC}0m&rdquo;</p></li>

<li></li>

<li><p>exit $OK</p></li>

<li><p>}</p></li>

<li></li>

<li><p>#print help</p></li>

<li><p>function Help ()</p></li>

<li><p>{</p></li>

<li><p>msg=&ldquo;Move:w s a d Dig:j Flag:f NewGame:n Exit:x &ndash;CopyRight&ndash; -2005-10-28 BitBull&ndash;&rdquo;</p></li>

<li><p>$ECHO &ldquo;${ESC}${REV};${RED}m${ESC}24;1H${msg}${ESC}${NULL}m&rdquo;</p></li>

<li></li>

<li><p>return $OK</p></li>

<li><p>}</p></li>

<li></li>

<li><p>#print dialog window in screen</p></li>

<li><p>function PMsg ()</p></li>

<li><p>{</p></li>

<li><p>local title=&ldquo;$1&rdquo; content=&ldquo;$2&rdquo; greeting=&ldquo;$3&rdquo;</p></li>

<li></li>

<li><p>$ECHO &ldquo;${ESC}${RED}m&rdquo;</p></li>

<li><p>$ECHO &ldquo;${ESC}11;20H &mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;- &ldquo;</p></li>

<li><p>$ECHO &ldquo;${ESC}12;20H| ======&gt;$title&lt;====== |&rdquo;</p></li>

<li><p>$ECHO &ldquo;${ESC}13;20H| $content |&rdquo;</p></li>

<li><p>$ECHO &ldquo;${ESC}14;20H| ======&gt;$greeting&lt;====== |&rdquo;</p></li>

<li><p>$ECHO &ldquo;${ESC}15;20H &mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;- &ldquo;</p></li>

<li><p>$ECHO &ldquo;${ESC}${NULL}m&rdquo;</p></li>

<li></li>

<li><p>return $OK</p></li>

<li><p>}</p></li>

<li></li>

<li><p>#print menu and player choose level,then ${X,Y,MCount,FCount,SCount} init</p></li>

<li><p>function Menu ()</p></li>

<li><p>{</p></li>

<li><p>local key</p></li>

<li></li>

<li><p>$ECHO &ldquo;${ESC}6;1H${ESC}${RED}m&rdquo;</p></li>

<li><p>cat&lt;</p></li>

<li><p>+++++++++++++++++++++++++++++</p></li>

<li><p>+ (1) Easy +</p></li>

<li><p>+ (2) Normal +</p></li>

<li><p>+ (3) Hardly +</p></li>

<li><p>+ (4) Exit +</p></li>

<li><p>+++++++++++++++++++++++++++++</p></li>

<li><p>MENUEND</p></li>

<li><p>$ECHO &ldquo;${ESC}${NULL}m&rdquo;</p></li>

<li></li>

<li><p>while read -s -n 1 key</p></li>

<li><p>do</p></li>

<li><p>case $key in</p></li>

<li><p>1) X=10;Y=10;MCount=10;FCount=10;SCount=100;break</p></li>

<li><p>;;</p></li>

<li><p>2) X=20;Y=14;MCount=28;FCount=28;SCount=280;break</p></li>

<li><p>;;</p></li>

<li><p>3) X=36;Y=18;MCount=65;FCount=65;SCount=648;break</p></li>

<li><p>;;</p></li>

<li><p>4) GameExit</p></li>

<li><p>;;</p></li>

<li><p>esac</p></li>

<li><p>done</p></li>

<li></li>

<li><p>return $OK</p></li>

<li><p>}</p></li>

<li></li>

<li><p>#receive CurX CurY,put it into XY[CurX+X*(CurY-1))]</p></li>

<li><p>#if $# == 3;write into XY[]</p></li>

<li><p>#if $# == 2;read from XY[]</p></li>

<li><p>function XYFormat ()</p></li>

<li><p>{</p></li>

<li><p>local XTmp=$1 YTmp=$2</p></li>

<li></li>

<li><p>if [[ $# -eq 3 ]]</p></li>

<li><p>then XY[$XTmp+$X*($YTmp-1)]=$3</p></li>

<li><p>else echo ${XY[$XTmp+$X*($YTmp-1)]}</p></li>

<li><p>fi</p></li>

<li></li>

<li><p>return $OK</p></li>

<li><p>}</p></li>

<li></li>

<li><p>function DrawInit ()</p></li>

<li><p>{</p></li>

<li><p>local DIline DIline2</p></li>

<li></li>

<li><p>DIline=$( for (( i=1; i</p></li>

<li><p>DIline2=$( for (( i=0; i</p></li>

<li></li>

<li><p>clear</p></li>

<li><p>Help</p></li>

<li></li>

<li><p>$ECHO &ldquo;${ESC}1;1H+${DIline}+&rdquo;</p></li>

<li><p>for (( i=0; i</p></li>

<li><p>do</p></li>

<li><p>$ECHO &ldquo;${ESC}$((i+2));1H${DIline2}|&rdquo;</p></li>

<li><p>done</p></li>

<li><p>$ECHO &ldquo;${ESC}$((Y+2));1H+${DIline}+&rdquo;</p></li>

<li></li>

<li><p>return $OK</p></li>

<li><p>}</p></li>

<li></li>

<li><p>#${XY[*]}=S</p></li>

<li><p>function XYInit ()</p></li>

<li><p>{</p></li>

<li><p>for (( i=1; i&lt;=$X; i++ ))</p></li>

<li><p>do</p></li>

<li><p>for (( j=1; j&lt;=$Y; j++ ))</p></li>

<li><p>do</p></li>

<li><p>XYFormat $i $j S</p></li>

<li><p>done</p></li>

<li><p>done</p></li>

<li><p>return $OK</p></li>

<li><p>}</p></li>

<li></li>

<li><p>#check X Y</p></li>

<li><p>function CheckXY ()</p></li>

<li><p>{</p></li>

<li><p>local XYTmp=&ldquo;$1 $2&rdquo;</p></li>

<li></li>

<li><p>for(( i=0; i</p></li>

<li><p>do</p></li>

<li><p>if [[ &ldquo;${MXY[i]}&rdquo; == &ldquo;$XYTmp&rdquo; ]]</p></li>

<li><p>then return $FALSE</p></li>

<li><p>fi</p></li>

<li><p>done</p></li>

<li></li>

<li><p>return $OK</p></li>

<li><p>}</p></li>

<li></li>

<li><p>#RANDOM mine&rsquo;s X Y</p></li>

<li><p>function XYRand ()</p></li>

<li><p>{</p></li>

<li><p>local XTmp YTmp</p></li>

<li></li>

<li><p>for(( i=0; i</p></li>

<li><p>do</p></li>

<li><p>while :</p></li>

<li><p>do</p></li>

<li><p>XTmp=$(( RANDOM % ( X - 1 ) + 1 ))</p></li>

<li><p>YTmp=$(( RANDOM % ( Y - 1 ) + 1 ))</p></li>

<li><p>CheckXY $XTmp $YTmp</p></li>

<li></li>

<li><p>if [[ &ldquo;$?&rdquo; == &ldquo;$OK&rdquo; ]]</p></li>

<li><p>then</p></li>

<li><p>XYFormat $XTmp $YTmp M</p></li>

<li><p>MXY[i]=&ldquo;$XTmp $YTmp&rdquo;</p></li>

<li><p>(( ++MXYp ))</p></li>

<li><p>break</p></li>

<li><p>else continue</p></li>

<li><p>fi</p></li>

<li><p>done</p></li>

<li><p>done</p></li>

<li></li>

<li><p>return $OK</p></li>

<li><p>}</p></li>

<li></li>

<li><p>#DEBUG</p></li>

<li><h1 id="print-xy-into-mine-tmp">print ${XY[*]} into ./mine.tmp</h1></li>

<li><p>#you can read mine.tmp to know where is mine,xixi~~:)</p></li>

<li><p>#M is mine</p></li>

<li><p>function DEBUGPXY ()</p></li>

<li><p>{</p></li>

<li><p>rm mine.tmp&gt;/dev/null 2&gt;&amp;1</p></li>

<li><p>for(( i=1; i&lt;=$Y; i++ ))</p></li>

<li><p>do</p></li>

<li><p>for(( j=1; j&lt;=$X; j++))</p></li>

<li><p>do</p></li>

<li><p>$ECHO &ldquo;$(XYFormat $j $i)&rdquo;&gt;&gt;mine.tmp</p></li>

<li><p>done</p></li>

<li><p>$ECHO &ldquo;\n&rdquo;&gt;&gt;mine.tmp</p></li>

<li><p>done</p></li>

<li></li>

<li><p>return $OK</p></li>

<li><p>}</p></li>

<li></li>

<li><p>#move cur</p></li>

<li><p>#usage:CurMov [UP|DOWN|LEFT|RIGHT]</p></li>

<li><p>function CurMov ()</p></li>

<li><p>{</p></li>

<li><p>local direction=$1 Xmin=1 Ymin=1 Xmax=$X Ymax=$Y</p></li>

<li></li>

<li><p>OCurX=$CurX</p></li>

<li><p>OCurY=$CurY</p></li>

<li></li>

<li><p>case $direction in</p></li>

<li><p>&ldquo;UP&rdquo;) if [[ $CurY -gt $Ymin ]];then (( CurY&ndash; ));fi</p></li>

<li><p>;;</p></li>

<li><p>&ldquo;DOWN&rdquo;) if [[ $CurY -lt $Ymax ]];then (( CurY++ ));fi</p></li>

<li><p>;;</p></li>

<li><p>&ldquo;LEFT&rdquo;) if [[ $CurX -gt $Xmin ]];then (( CurX&ndash; ));fi</p></li>

<li><p>;;</p></li>

<li><p>&ldquo;RIGHT&rdquo;)if [[ $CurX -lt $Xmax ]];then (( CurX++ ));fi</p></li>

<li><p>;;</p></li>

<li><p>esac</p></li>

<li></li>

<li><p>if [[ $CurX != $OCurX || $CurY != $OCurY ]]</p></li>

<li><p>then DrawPoint $CurX $CurY CUR</p></li>

<li><p>fi</p></li>

<li></li>

<li><p>return $OK</p></li>

<li><p>}</p></li>

<li></li>

<li><p>#display point</p></li>

<li><p>#include cur,flag,mine,shadow,nul,tip [1-8]</p></li>

<li><p>function DrawPoint ()</p></li>

<li><p>{</p></li>

<li><p>local TCurX=$(( $1 * 2 )) TCurY=$(( $2 + 1 )) Type=$3</p></li>

<li><p>local TOCurX=$(( OCurX * 2 )) TOCurY=$(( OCurY + 1 ))</p></li>

<li><p>local colr=0 osign=0 sign=0</p></li>

<li></li>

<li><p>case $Type in</p></li>

<li><p>&ldquo;CUR&rdquo;)</p></li>

<li><p>case $(XYFormat $OCurX $OCurY) in</p></li>

<li><p>F) colr=$PURPLE;osign=$FLAG;;</p></li>

<li><p>N) colr=$NULL;osign=$NUL;;</p></li>

<li><p>[1-8]) colr=$ORANGE;osign=$(XYFormat $OCurX $OCurY);;</p></li>

<li><p>[SM]) colr=$SBLUE;osign=$SHADOW;;</p></li>

<li><p>esac</p></li>

<li></li>

<li><p>case $(XYFormat $CurX $CurY) in</p></li>

<li><p>F) sign=$FLAG;;</p></li>

<li><p>N) sign=$NUL;;</p></li>

<li><p>[1-8]) sign=$(XYFormat $CurX $CurY);;</p></li>

<li><p>[SM]) sign=$SHADOW;;</p></li>

<li><p>esac</p></li>

<li></li>

<li><p>$ECHO &ldquo;${ESC}${colr}m${ESC}${TOCurY};${TOCurX}H${osign}${ESC}${NULL}m&rdquo;</p></li>

<li><p>$ECHO &ldquo;${ESC}${REV};${FLASH};${ORANGE}m${ESC}${TCurY};${TCurX}H${sign}${ESC}${NULL}m&rdquo;</p></li>

<li><p>;;</p></li>

<li><p>&ldquo;SHADOW&rdquo;)</p></li>

<li><p>$ECHO &ldquo;${ESC}${SBLUE}m${ESC}${TCurY};${TCurX}H${SHADOW}${ESC}${NULL}m&rdquo;</p></li>

<li><p>;;</p></li>

<li><p>&ldquo;MINE&rdquo;)</p></li>

<li><p>$ECHO &ldquo;${ESC}${REV};${RED}m${ESC}${TCurY};${TCurX}H${MINE}${ESC}${NULL}m&rdquo;</p></li>

<li><p>;;</p></li>

<li><p>&ldquo;FLAG&rdquo;)</p></li>

<li><p>$ECHO &ldquo;${ESC}${TCurY};${TCurX}H${ESC}${PURPLE}m${FLAG}${ESC}${NULL}m&rdquo;</p></li>

<li><p>;;</p></li>

<li><p>[1-8])</p></li>

<li><p>$ECHO &ldquo;${ESC}${TCurY};${TCurX}H${ESC}${ORANGE}m${Type}${ESC}${NULL}m&rdquo;</p></li>

<li><p>;;</p></li>

<li><p>&ldquo;NUL&rdquo;)</p></li>

<li><p>$ECHO &ldquo;${ESC}${TCurY};${TCurX}H${NUL}&rdquo;</p></li>

<li><p>esac</p></li>

<li></li>

<li><p>return $OK</p></li>

<li><p>}</p></li>

<li></li>

<li><p>#check xy</p></li>

<li><p>function Loop ()</p></li>

<li><p>{</p></li>

<li><p>local XYTmp=&ldquo;$1 $2&rdquo;</p></li>

<li></li>

<li><p>for (( i=0; i</p></li>

<li><p>do</p></li>

<li><p>if [[ &ldquo;$XYTmp&rdquo; == &ldquo;${MXY[i]}&rdquo; ]]</p></li>

<li><p>then $ECHO 1</p></li>

<li><p>fi</p></li>

<li><p>done</p></li>

<li></li>

<li><p>return $OK</p></li>

<li><p>}</p></li>

<li></li>

<li><p>#count around mine</p></li>

<li><p>#A B C</p></li>

<li><p>#D X E</p></li>

<li><p>#F G H</p></li>

<li><p>#return mine&rsquo;s number</p></li>

<li><p>function CountM ()</p></li>

<li><p>{</p></li>

<li><p>local Xmin=1 Ymin=1 Xmax=$X Ymax=$Y minecount=0 n=0</p></li>

<li><p>#A</p></li>

<li><p>if [[ ( $CurX -gt $Xmin ) &amp;&amp; ( $CurY -gt $Ymin ) ]]</p></li>

<li><p>then</p></li>

<li><p>n=$( Loop $((CurX-1)) $((CurY-1)) )</p></li>

<li><p>(( minecount += n ))</p></li>

<li><p>n=0</p></li>

<li><p>fi</p></li>

<li><p>#B</p></li>

<li><p>if [[ $CurY -gt $Ymin ]]</p></li>

<li><p>then</p></li>

<li><p>n=$( Loop $CurX $((CurY-1)) )</p></li>

<li><p>(( minecount += n ))</p></li>

<li><p>n=0</p></li>

<li><p>fi</p></li>

<li><p>#C</p></li>

<li><p>if [[ ( $CurX -lt $Xmax ) &amp;&amp; ( $CurY -gt $Ymin ) ]]</p></li>

<li><p>then</p></li>

<li><p>n=$( Loop $((CurX+1)) $((CurY-1)) )</p></li>

<li><p>(( minecount += n ))</p></li>

<li><p>n=0</p></li>

<li><p>fi</p></li>

<li><p>#D</p></li>

<li><p>if [[ $CurX -gt $Xmin ]]</p></li>

<li><p>then</p></li>

<li><p>n=$( Loop $((CurX-1)) $CurY )</p></li>

<li><p>(( minecount += n ))</p></li>

<li><p>n=0</p></li>

<li><p>fi</p></li>

<li><p>#E</p></li>

<li><p>if [[ $CurX -lt $Xmax ]]</p></li>

<li><p>then</p></li>

<li><p>n=$( Loop $((CurX+1)) $CurY )</p></li>

<li><p>(( minecount += n ))</p></li>

<li><p>n=0</p></li>

<li><p>fi</p></li>

<li><p>#F</p></li>

<li><p>if [[ ( $CurX -gt $Xmin ) &amp;&amp; ( $CurY -lt $Ymax ) ]]</p></li>

<li><p>then</p></li>

<li><p>n=$( Loop $((CurX-1)) $((CurY+1)) )</p></li>

<li><p>(( minecount += n ))</p></li>

<li><p>n=0</p></li>

<li><p>fi</p></li>

<li><p>#G</p></li>

<li><p>if [[ $CurY -lt $Ymax ]]</p></li>

<li><p>then</p></li>

<li><p>n=$( Loop $CurX $((CurY+1)) )</p></li>

<li><p>(( minecount += n ))</p></li>

<li><p>n=0</p></li>

<li><p>fi</p></li>

<li><p>#H</p></li>

<li><p>if [[ ( $CurX -lt $Xmax ) &amp;&amp; ( $CurY -lt $Ymax ) ]]</p></li>

<li><p>then</p></li>

<li><p>n=$( Loop $((CurX+1)) $((CurY+1)) )</p></li>

<li><p>(( minecount += n ))</p></li>

<li><p>n=0</p></li>

<li><p>fi</p></li>

<li></li>

<li><p>return $minecount</p></li>

<li><p>}</p></li>

<li></li>

<li><p>#dig</p></li>

<li><p>#if mine ,gameover</p></li>

<li><p>#else tip around mine&rsquo;s number</p></li>

<li><p>function Dig ()</p></li>

<li><p>{</p></li>

<li><p>local key minenum=0</p></li>

<li></li>

<li><p>case $(XYFormat $CurX $CurY) in</p></li>

<li><p>M)</p></li>

<li><p>DrawPoint $CurX $CurY MINE</p></li>

<li><p>read -s -n 1 key</p></li>

<li><p>GameOver &ldquo;Game Over&rdquo;</p></li>

<li><p>;;</p></li>

<li><p>S)</p></li>

<li><p>CountM</p></li>

<li><p>minenum=$?</p></li>

<li><p>if [[ $minenum -eq $NULL ]]</p></li>

<li><p>then</p></li>

<li><p>XYFormat $CurX $CurY N</p></li>

<li><p>DrawPoint $CurX $CurY NUL</p></li>

<li><p>else</p></li>

<li><p>XYFormat $CurX $CurY $minenum</p></li>

<li><p>DrawPoint $CurX $CurY $minenum</p></li>

<li><p>fi</p></li>

<li></li>

<li><p>(( SCount&ndash; ))</p></li>

<li><p>if [[ $SCount -eq $MCount ]]</p></li>

<li><p>then GameOver &ldquo;Well Done&rdquo;</p></li>

<li><p>fi</p></li>

<li><p>;;</p></li>

<li><p>esac</p></li>

<li><p>DrawPoint $CurX $CurY CUR</p></li>

<li></li>

<li><p>return $OK</p></li>

<li><p>}</p></li>

<li></li>

<li><p>#draw flag&rsquo;s number</p></li>

<li><p>function DrawFCount ()</p></li>

<li><p>{</p></li>

<li><p>$ECHO &ldquo;${ESC}22;34H${ESC};${PURPLE}mFLAG=${FCount} ${ESC}${NULL}m&rdquo;</p></li>

<li><p>}</p></li>

<li></li>

<li><p>#sign mine</p></li>

<li><p>function Flag ()</p></li>

<li><p>{</p></li>

<li><p>local XYTmp=&ldquo;$CurX $CurY&rdquo;;stat=$FALSE</p></li>

<li></li>

<li><p>case $(XYFormat $CurX $CurY) in</p></li>

<li><p>F)</p></li>

<li><p>for (( i=1; i</p></li>

<li><p>do</p></li>

<li><p>if [[ &ldquo;${MXY[i]}&rdquo; == &ldquo;$XYTmp&rdquo; ]]</p></li>

<li><p>then XYFormat $CurX $CurY M;stat=$OK;break</p></li>

<li><p>fi</p></li>

<li><p>done</p></li>

<li><p>if [[ $stat == $FALSE ]]</p></li>

<li><p>then XYFormat $CurX $CurY S</p></li>

<li><p>fi</p></li>

<li></li>

<li><p>DrawPoint $CurX $CurY SHADOW</p></li>

<li><p>(( FCount++ ))</p></li>

<li><p>DrawFCount</p></li>

<li><p>;;</p></li>

<li><p>[SM])</p></li>

<li><p>if [[ $FCount -eq $NULL ]]</p></li>

<li><p>then return $FALSE</p></li>

<li><p>fi</p></li>

<li></li>

<li><p>DrawPoint $CurX $CurY FLAG</p></li>

<li><p>XYFormat $CurX $CurY F</p></li>

<li><p>(( FCount&ndash; ))</p></li>

<li><p>DrawFCount</p></li>

<li><p>;;</p></li>

<li><p>esac</p></li>

<li><p>DrawPoint $CurX $CurY CUR</p></li>

<li></li>

<li><p>return $OK</p></li>

<li><p>}</p></li>

<li></li>

<li><p>function GameOver ()</p></li>

<li><p>{</p></li>

<li><p>local key msgtitle=$1</p></li>

<li></li>

<li><p>PMsg &ldquo;$msgtitle&rdquo; &ldquo;Do you want replay?&rdquo; &ldquo;Thank You&rdquo;</p></li>

<li><p>while read -s -n 1 key</p></li>

<li><p>do</p></li>

<li><p>case $key in</p></li>

<li><p>[yY]) exec $(dirname $0)/$(basename $0);;</p></li>

<li><p>[nN]) GameExit;;</p></li>

<li><p>*) continue;;</p></li>

<li><p>esac</p></li>

<li><p>done</p></li>

<li></li>

<li><p>return $OK</p></li>

<li><p>}</p></li>

<li></li>

<li><p>#main</p></li>

<li><p>#drawscreen and control</p></li>

<li><p>function Main ()</p></li>

<li><p>{</p></li>

<li><p>local key</p></li>

<li></li>

<li><p>XYInit</p></li>

<li><p>XYRand</p></li>

<li><p>############################</p></li>

<li><h1 id="if-you-enable-debugpxy">if you enable DEBUGPXY,</h1></li>

<li><p>#you can know where is mine</p></li>

<li><h1 id="debugpxy-delete-this-line-s">DEBUGPXY #delete this line&rsquo;s #</h1></li>

<li><p>#then cat ./mine.tmp</p></li>

<li><p>############################</p></li>

<li></li>

<li><p>DrawPoint $CurX $CurY CUR</p></li>

<li><p>DrawFCount</p></li>

<li></li>

<li><p>while read -s -n 1 key</p></li>

<li><p>do</p></li>

<li><p>case $key in</p></li>

<li><p>[wW]) CurMov UP;;</p></li>

<li><p>[sS]) CurMov DOWN;;</p></li>

<li><p>[aA]) CurMov LEFT;;</p></li>

<li><p>[dD]) CurMov RIGHT;;</p></li>

<li><p>[jJ]) Dig;;</p></li>

<li><p>[fF]) Flag;;</p></li>

<li><p>[nN]) exec $(dirname $0)/$(basename $0);;</p></li>

<li><p>[xX]) GameExit;;</p></li>

<li><p>esac</p></li>

<li><p>done</p></li>

<li></li>

<li><p>return $OK</p></li>

<li><p>}</p></li>

<li><p>#&mdash;&mdash;&mdash;&mdash;&mdash;Main&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;</p></li>

<li></li>

<li><p>SttyInit</p></li>

<li><p>Menu #X Y MCount FCount SCount OK!</p></li>

<li><p>DrawInit</p></li>

<li><p>Main</p></li>
</ol>

<p>__</p>

<p>++++++++++++++++++++++++++++++++++++++</p>

<p>#!/bin/bash<br />
#&mdash;&mdash;&mdash;&mdash;-CopyRight&mdash;&mdash;&mdash;&mdash;-</p>

<h1 id="name-mine-sweeping-1">Name:Mine Sweeping</h1>

<h1 id="version-number-1-00-1">Version Number:1.00</h1>

<h1 id="type-game-1">Type:game</h1>

<h1 id="language-bash-shell-1">Language:bash shell</h1>

<h1 id="date-2005-10-26-1">Date:2005-10-26</h1>

<h1 id="author-bitbull-1">Author:BitBull</h1>

<h1 id="email-bitbull-cn-at-gmail-com-1">Email:BitBull.cn(at)gmail.com</h1>

<p>#&mdash;&mdash;&mdash;&mdash;Environment&mdash;&mdash;&mdash;&mdash;</p>

<h1 id="terminal-column-80-line-24-1">Terminal: column 80 line 24</h1>

<h1 id="linux-2-6-9-i686-1">Linux 2.6.9 i686</h1>

<h1 id="gnu-bash-3-00-15-1">GNU Bash 3.00.15</h1>

<p>#&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;</p>

<p>#&mdash;&mdash;&mdash;&mdash;&mdash;Define&mdash;&mdash;&mdash;&mdash;&ndash;<br />
ECHO=&ldquo;echo -ne&rdquo;<br />
ESC=&rdquo;\033[&rdquo;</p>

<p>OK=0<br />
FALSE=1<br />
#&mdash;&mdash;&mdash;&mdash;&ndash;Variable&mdash;&mdash;&mdash;&mdash;&ndash;<br />
#ANSI ESC action<br />
FLASH=5<br />
REV=7</p>

<p>#color<br />
NULL=0<br />
BLACK=30<br />
RED=31<br />
GREEN=32<br />
ORANGE=33<br />
BLUE=34<br />
PURPLE=35<br />
SBLUE=36<br />
GREY=37</p>

<p>#back color<br />
BBLACK=40<br />
BRED=41<br />
BGREEN=42<br />
BORANGE=43<br />
BBLUE=44<br />
BPURPLE=45<br />
BSBLUE=46<br />
BGREY=47</p>

<p>MINE=&lsquo;@&rsquo;<br />
FLAG=&lsquo;F&rsquo;<br />
NUL=&rsquo; &lsquo;<br />
SHADOW=&lsquo;X&rsquo;</p>

<p>X=0<br />
Y=0<br />
CurX=1 #cur&rsquo;s X<br />
CurY=1 #cur&rsquo;s Y<br />
OCurX=1 #old cur&rsquo;s X<br />
OCurY=1 #old cur&rsquo;s Y<br />
MCount=0 #count mine<br />
FCount=0 #count flag<br />
SCount=0 #count shadow<br />
MXYp=0 #MXY Array&rsquo;s ptr<br />
#&mdash;&mdash;&mdash;&mdash;&mdash;Array&mdash;&mdash;&mdash;&mdash;&mdash;-</p>

<p>#if ${XY[]} == M { mine }<br />
#if ${XY[]} == F { flag }<br />
#if ${XY[]} == N { null }<br />
#if ${XY[]} == S { shadow }<br />
#if ${XY[]} == [1-8] { tip_num }<br />
#${XY[]} init in XYInit(i)</p>

<p>MXY[0]=&ldquo;&rdquo;</p>

<p>#&mdash;&mdash;&mdash;&mdash;&ndash;Function&mdash;&mdash;&mdash;&mdash;&ndash;</p>

<p>function SttyInit ()<br />
{<br />
stty_save=$(stty -g) #backup stty</p>

<p>clear<br />
trap &ldquo;GameExit;&rdquo; 2 15<br />
stty -echo</p>

<p>$ECHO &ldquo;${ESC}?25l&rdquo; #hidden cursor</p>

<p>return $OK<br />
}</p>

<p>function GameExit ()<br />
{<br />
stty $stty_save<br />
stty echo<br />
clear<br />
trap 2 15<br />
$ECHO &ldquo;${ESC}?25h${ESC}0;0H${ESC}0m&rdquo;</p>

<p>exit $OK<br />
}</p>

<p>#print help<br />
function Help ()<br />
{<br />
msg=&ldquo;Move:w s a d Dig:j Flag:f NewGame:n Exit:x &ndash;CopyRight&ndash; -2005-10-28
BitBull&ndash;&rdquo;<br />
$ECHO &ldquo;${ESC}${REV};${RED}m${ESC}24;1H${msg}${ESC}${NULL}m&rdquo;</p>

<p>return $OK<br />
}</p>

<p>#print dialog window in screen<br />
function PMsg ()<br />
{<br />
local title=&ldquo;$1&rdquo; content=&ldquo;$2&rdquo; greeting=&ldquo;$3&rdquo;</p>

<p>$ECHO &ldquo;${ESC}${RED}m&rdquo;<br />
$ECHO &ldquo;${ESC}11;20H &mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;- &rdquo;<br />
$ECHO &ldquo;${ESC}12;20H| ======&gt;$title&lt;====== |&rdquo;<br />
$ECHO &ldquo;${ESC}13;20H| $content |&rdquo;<br />
$ECHO &ldquo;${ESC}14;20H| ======&gt;$greeting&lt;====== |&rdquo;<br />
$ECHO &ldquo;${ESC}15;20H &mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;- &rdquo;<br />
$ECHO &ldquo;${ESC}${NULL}m&rdquo;</p>

<p>return $OK<br />
}</p>

<p>#print menu and player choose level,then ${X,Y,MCount,FCount,SCount} init<br />
function Menu ()<br />
{<br />
local key</p>

<p>$ECHO &ldquo;${ESC}6;1H${ESC}${RED}m&rdquo;<br />
cat&lt; +++++++++++++++++++++++++++++<br />
+ (1) Easy +<br />
+ (2) Normal +<br />
+ (3) Hardly +<br />
+ (4) Exit +<br />
+++++++++++++++++++++++++++++<br />
MENUEND<br />
$ECHO &ldquo;${ESC}${NULL}m&rdquo;</p>

<p>while read -s -n 1 key<br />
do<br />
case $key in<br />
1) X=10;Y=10;MCount=10;FCount=10;SCount=100;break<br />
;;<br />
2) X=20;Y=14;MCount=28;FCount=28;SCount=280;break<br />
;;<br />
3) X=36;Y=18;MCount=65;FCount=65;SCount=648;break<br />
;;<br />
4) GameExit<br />
;;<br />
esac<br />
done</p>

<p>return $OK<br />
}</p>

<p>#receive CurX CurY,put it into XY[CurX+X*(CurY-1))]<br />
#if $# == 3;write into XY[]<br />
#if $# == 2;read from XY[]<br />
function XYFormat ()<br />
{<br />
local XTmp=$1 YTmp=$2</p>

<p>if [[ $# -eq 3 ]]<br />
then XY[$XTmp+$X<em>($YTmp-1)]=$3<br />
else echo ${XY[$XTmp+$X</em>($YTmp-1)]}<br />
fi</p>

<p>return $OK<br />
}</p>

<p>function DrawInit ()<br />
{<br />
local DIline DIline2</p>

<p>DIline=$( for (( i=1; i DIline2=$( for (( i=0; i<br />
clear<br />
Help</p>

<p>$ECHO &ldquo;${ESC}1;1H+${DIline}+&rdquo;<br />
for (( i=0; i do<br />
$ECHO &ldquo;${ESC}$((i+2));1H${DIline2}|&rdquo;<br />
done<br />
$ECHO &ldquo;${ESC}$((Y+2));1H+${DIline}+&rdquo;</p>

<p>return $OK<br />
}</p>

<p>#${XY[*]}=S<br />
function XYInit ()<br />
{<br />
for (( i=1; i&lt;=$X; i++ ))<br />
do<br />
for (( j=1; j&lt;=$Y; j++ ))<br />
do<br />
XYFormat $i $j S<br />
done<br />
done<br />
return $OK<br />
}</p>

<p>#check X Y<br />
function CheckXY ()<br />
{<br />
local XYTmp=&ldquo;$1 $2&rdquo;</p>

<p>for(( i=0; i do<br />
if [[ &ldquo;${MXY[i]}&rdquo; == &ldquo;$XYTmp&rdquo; ]]<br />
then return $FALSE<br />
fi<br />
done</p>

<p>return $OK<br />
}</p>

<p>#RANDOM mine&rsquo;s X Y<br />
function XYRand ()<br />
{<br />
local XTmp YTmp</p>

<p>for(( i=0; i do<br />
while :<br />
do<br />
XTmp=$(( RANDOM % ( X - 1 ) + 1 ))<br />
YTmp=$(( RANDOM % ( Y - 1 ) + 1 ))<br />
CheckXY $XTmp $YTmp</p>

<p>if [[ &ldquo;$?&rdquo; == &ldquo;$OK&rdquo; ]]<br />
then<br />
XYFormat $XTmp $YTmp M<br />
MXY[i]=&ldquo;$XTmp $YTmp&rdquo;<br />
(( ++MXYp ))<br />
break<br />
else continue<br />
fi<br />
done<br />
done</p>

<p>return $OK<br />
}</p>

<p>#DEBUG</p>

<h1 id="print-xy-into-mine-tmp-1">print ${XY[*]} into ./mine.tmp</h1>

<p>#you can read mine.tmp to know where is mine,xixi~~:)<br />
#M is mine<br />
function DEBUGPXY ()<br />
{<br />
rm mine.tmp&gt;/dev/null 2&gt;&amp;1<br />
for(( i=1; i&lt;=$Y; i++ ))<br />
do<br />
for(( j=1; j&lt;=$X; j++))<br />
do<br />
$ECHO &ldquo;$(XYFormat $j $i)&rdquo;&gt;&gt;mine.tmp<br />
done<br />
$ECHO &ldquo;\n&rdquo;&gt;&gt;mine.tmp<br />
done</p>

<p>return $OK<br />
}</p>

<p>#move cur<br />
#usage:CurMov [UP|DOWN|LEFT|RIGHT]<br />
function CurMov ()<br />
{<br />
local direction=$1 Xmin=1 Ymin=1 Xmax=$X Ymax=$Y</p>

<p>OCurX=$CurX<br />
OCurY=$CurY</p>

<p>case $direction in<br />
&ldquo;UP&rdquo;) if [[ $CurY -gt $Ymin ]];then (( CurY&ndash; ));fi<br />
;;<br />
&ldquo;DOWN&rdquo;) if [[ $CurY -lt $Ymax ]];then (( CurY++ ));fi<br />
;;<br />
&ldquo;LEFT&rdquo;) if [[ $CurX -gt $Xmin ]];then (( CurX&ndash; ));fi<br />
;;<br />
&ldquo;RIGHT&rdquo;)if [[ $CurX -lt $Xmax ]];then (( CurX++ ));fi<br />
;;<br />
esac</p>

<p>if [[ $CurX != $OCurX || $CurY != $OCurY ]]<br />
then DrawPoint $CurX $CurY CUR<br />
fi</p>

<p>return $OK<br />
}</p>

<p>#display point<br />
#include cur,flag,mine,shadow,nul,tip [1-8]<br />
function DrawPoint ()<br />
{<br />
local TCurX=$(( $1 * 2 )) TCurY=$(( $2 + 1 )) Type=$3<br />
local TOCurX=$(( OCurX * 2 )) TOCurY=$(( OCurY + 1 ))<br />
local colr=0 osign=0 sign=0</p>

<p>case $Type in<br />
&ldquo;CUR&rdquo;)<br />
case $(XYFormat $OCurX $OCurY) in<br />
F) colr=$PURPLE;osign=$FLAG;;<br />
N) colr=$NULL;osign=$NUL;;<br />
[1-8]) colr=$ORANGE;osign=$(XYFormat $OCurX $OCurY);;<br />
[SM]) colr=$SBLUE;osign=$SHADOW;;<br />
esac</p>

<p>case $(XYFormat $CurX $CurY) in<br />
F) sign=$FLAG;;<br />
N) sign=$NUL;;<br />
[1-8]) sign=$(XYFormat $CurX $CurY);;<br />
[SM]) sign=$SHADOW;;<br />
esac</p>

<p>$ECHO &ldquo;${ESC}${colr}m${ESC}${TOCurY};${TOCurX}H${osign}${ESC}${NULL}m&rdquo;<br />
$ECHO
&ldquo;${ESC}${REV};${FLASH};${ORANGE}m${ESC}${TCurY};${TCurX}H${sign}${ESC}${NULL}m&rdquo;<br />
;;<br />
&ldquo;SHADOW&rdquo;)<br />
$ECHO &ldquo;${ESC}${SBLUE}m${ESC}${TCurY};${TCurX}H${SHADOW}${ESC}${NULL}m&rdquo;<br />
;;<br />
&ldquo;MINE&rdquo;)<br />
$ECHO &ldquo;${ESC}${REV};${RED}m${ESC}${TCurY};${TCurX}H${MINE}${ESC}${NULL}m&rdquo;<br />
;;<br />
&ldquo;FLAG&rdquo;)<br />
$ECHO &ldquo;${ESC}${TCurY};${TCurX}H${ESC}${PURPLE}m${FLAG}${ESC}${NULL}m&rdquo;<br />
;;<br />
[1-8])<br />
$ECHO &ldquo;${ESC}${TCurY};${TCurX}H${ESC}${ORANGE}m${Type}${ESC}${NULL}m&rdquo;<br />
;;<br />
&ldquo;NUL&rdquo;)<br />
$ECHO &ldquo;${ESC}${TCurY};${TCurX}H${NUL}&rdquo;<br />
esac</p>

<p>return $OK<br />
}</p>

<p>#check xy<br />
function Loop ()<br />
{<br />
local XYTmp=&ldquo;$1 $2&rdquo;</p>

<p>for (( i=0; i do<br />
if [[ &ldquo;$XYTmp&rdquo; == &ldquo;${MXY[i]}&rdquo; ]]<br />
then $ECHO 1<br />
fi<br />
done</p>

<p>return $OK<br />
}</p>

<p>#count around mine<br />
#A B C<br />
#D X E<br />
#F G H<br />
#return mine&rsquo;s number<br />
function CountM ()<br />
{<br />
local Xmin=1 Ymin=1 Xmax=$X Ymax=$Y minecount=0 n=0<br />
#A<br />
if [[ ( $CurX -gt $Xmin ) &amp;&amp; ( $CurY -gt $Ymin ) ]]<br />
then<br />
n=$( Loop $((CurX-1)) $((CurY-1)) )<br />
(( minecount += n ))<br />
n=0<br />
fi<br />
#B<br />
if [[ $CurY -gt $Ymin ]]<br />
then<br />
n=$( Loop $CurX $((CurY-1)) )<br />
(( minecount += n ))<br />
n=0<br />
fi<br />
#C<br />
if [[ ( $CurX -lt $Xmax ) &amp;&amp; ( $CurY -gt $Ymin ) ]]<br />
then<br />
n=$( Loop $((CurX+1)) $((CurY-1)) )<br />
(( minecount += n ))<br />
n=0<br />
fi<br />
#D<br />
if [[ $CurX -gt $Xmin ]]<br />
then<br />
n=$( Loop $((CurX-1)) $CurY )<br />
(( minecount += n ))<br />
n=0<br />
fi<br />
#E<br />
if [[ $CurX -lt $Xmax ]]<br />
then<br />
n=$( Loop $((CurX+1)) $CurY )<br />
(( minecount += n ))<br />
n=0<br />
fi<br />
#F<br />
if [[ ( $CurX -gt $Xmin ) &amp;&amp; ( $CurY -lt $Ymax ) ]]<br />
then<br />
n=$( Loop $((CurX-1)) $((CurY+1)) )<br />
(( minecount += n ))<br />
n=0<br />
fi<br />
#G<br />
if [[ $CurY -lt $Ymax ]]<br />
then<br />
n=$( Loop $CurX $((CurY+1)) )<br />
(( minecount += n ))<br />
n=0<br />
fi<br />
#H<br />
if [[ ( $CurX -lt $Xmax ) &amp;&amp; ( $CurY -lt $Ymax ) ]]<br />
then<br />
n=$( Loop $((CurX+1)) $((CurY+1)) )<br />
(( minecount += n ))<br />
n=0<br />
fi</p>

<p>return $minecount<br />
}</p>

<p>#dig<br />
#if mine ,gameover<br />
#else tip around mine&rsquo;s number<br />
function Dig ()<br />
{<br />
local key minenum=0</p>

<p>case $(XYFormat $CurX $CurY) in<br />
M)<br />
DrawPoint $CurX $CurY MINE<br />
read -s -n 1 key<br />
GameOver &ldquo;Game Over&rdquo;<br />
;;<br />
S)<br />
CountM<br />
minenum=$?<br />
if [[ $minenum -eq $NULL ]]<br />
then<br />
XYFormat $CurX $CurY N<br />
DrawPoint $CurX $CurY NUL<br />
else<br />
XYFormat $CurX $CurY $minenum<br />
DrawPoint $CurX $CurY $minenum<br />
fi</p>

<p>(( SCount&ndash; ))<br />
if [[ $SCount -eq $MCount ]]<br />
then GameOver &ldquo;Well Done&rdquo;<br />
fi<br />
;;<br />
esac<br />
DrawPoint $CurX $CurY CUR</p>

<p>return $OK<br />
}</p>

<p>#draw flag&rsquo;s number<br />
function DrawFCount ()<br />
{<br />
$ECHO &ldquo;${ESC}22;34H${ESC};${PURPLE}mFLAG=${FCount} ${ESC}${NULL}m&rdquo;<br />
}</p>

<p>#sign mine<br />
function Flag ()<br />
{<br />
local XYTmp=&ldquo;$CurX $CurY&rdquo;;stat=$FALSE</p>

<p>case $(XYFormat $CurX $CurY) in<br />
F)<br />
for (( i=1; i do<br />
if [[ &ldquo;${MXY[i]}&rdquo; == &ldquo;$XYTmp&rdquo; ]]<br />
then XYFormat $CurX $CurY M;stat=$OK;break<br />
fi<br />
done<br />
if [[ $stat == $FALSE ]]<br />
then XYFormat $CurX $CurY S<br />
fi</p>

<p>DrawPoint $CurX $CurY SHADOW<br />
(( FCount++ ))<br />
DrawFCount<br />
;;<br />
[SM])<br />
if [[ $FCount -eq $NULL ]]<br />
then return $FALSE<br />
fi</p>

<p>DrawPoint $CurX $CurY FLAG<br />
XYFormat $CurX $CurY F<br />
(( FCount&ndash; ))<br />
DrawFCount<br />
;;<br />
esac<br />
DrawPoint $CurX $CurY CUR</p>

<p>return $OK<br />
}</p>

<p>function GameOver ()<br />
{<br />
local key msgtitle=$1</p>

<p>PMsg &ldquo;$msgtitle&rdquo; &ldquo;Do you want replay?&rdquo; &ldquo;Thank You&rdquo;<br />
while read -s -n 1 key<br />
do<br />
case $key in<br />
[yY]) exec $(dirname $0)/$(basename $0);;<br />
[nN]) GameExit;;<br />
*) continue;;<br />
esac<br />
done</p>

<p>return $OK<br />
}</p>

<p>#main<br />
#drawscreen and control<br />
function Main ()<br />
{<br />
local key</p>

<p>XYInit<br />
XYRand<br />
############################</p>

<h1 id="if-you-enable-debugpxy-1">if you enable DEBUGPXY,</h1>

<p>#you can know where is mine</p>

<h1 id="debugpxy-delete-this-line-s-1">DEBUGPXY #delete this line&rsquo;s #</h1>

<p>#then cat ./mine.tmp<br />
############################</p>

<p>DrawPoint $CurX $CurY CUR<br />
DrawFCount</p>

<p>while read -s -n 1 key<br />
do<br />
case $key in<br />
[wW]) CurMov UP;;<br />
[sS]) CurMov DOWN;;<br />
[aA]) CurMov LEFT;;<br />
[dD]) CurMov RIGHT;;<br />
[jJ]) Dig;;<br />
[fF]) Flag;;<br />
[nN]) exec $(dirname $0)/$(basename $0);;<br />
[xX]) GameExit;;<br />
esac<br />
done</p>

<p>return $OK<br />
}<br />
#&mdash;&mdash;&mdash;&mdash;&mdash;Main&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;</p>

<p>SttyInit<br />
Menu #X Y MCount FCount SCount OK!<br />
DrawInit<br />
Main</p>

<p>阅读(512) | 评论(0) | 转发(2) |</p>

<p>0</p>

<p>上一篇：sed awk 替换 多个 文件 字符串</p>

<p>下一篇： 一个扫雷小游戏（高手请指教）</p>

<p>相关热门文章</p>

<ul>
<li>linux 常见服务端口</li>
<li>xmanager 2.0 for linux配置</li>
<li>【ROOTFS搭建】busybox的httpd&hellip;</li>
<li>openwrt中luci学习笔记</li>

<li><p>什么是shell</p></li>

<li><p>linux dhcp peizhi roc</p></li>

<li><p>关于Unix文件的软链接</p></li>

<li><p>求教这个命令什么意思，我是新&hellip;</p></li>

<li><p>sed -e &ldquo;/grep/d&rdquo; 是什么意思&hellip;</p></li>

<li><p>谁能够帮我解决LINUX 2.6 10&hellip;</p></li>
</ul>

<p>给主人留下些什么吧！~~</p>

<p>评论热议</p>

        </div>

        


        

<div class="post-archive">
    <h2>See Also</h2>
    <ul class="listing">
        
        <li><a href="/posts/007hadoop%E9%9B%86%E7%BE%A4%E9%85%8D%E7%BD%AEhadoop%E9%9B%86%E7%BE%A4%E7%9A%84%E5%90%AF%E5%8A%A8%E5%92%8C%E6%B5%8B%E8%AF%95ssh%E5%85%8D%E7%99%BB%E9%99%86%E9%85%8D%E7%BD%AEstartallshhdfs%E5%B8%B8%E7%94%A8%E7%9A%84shell/">007Hadoop集群配置Hadoop集群的启动和测试SSH免登陆配置startallshhdfs常用的shell</a></li>
        
        <li><a href="/posts/009shell%E8%84%9A%E6%9C%AC%E4%B8%8B%E6%9D%A1%E4%BB%B6%E6%B5%8B%E8%AF%95eqne/">009Shell脚本下条件测试eqne</a></li>
        
        <li><a href="/posts/00pythonmanagepyshell%E5%92%8Cpython%E7%9A%84%E5%88%86%E6%9E%90/">00Pythonmanagepyshell和Python的分析</a></li>
        
        <li><a href="/posts/010zookeeper%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5zookeeper%E7%9A%84%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BAzookeeper%E7%9A%84shell%E5%91%BD%E4%BB%A4/">010Zookeeper的基本概念Zookeeper的集群搭建Zookeeper的shell命令</a></li>
        
        <li><a href="/posts/018dockerfileshell/">018DockerfileSHELL</a></li>
        
    </ul>
</div>


        <div class="post-meta meta-tags">
            
            <ul class="clearfix">
                
                <li><a href='https://zaina.newban.cn/tags/shell'>shell</a></li>
                
            </ul>
            
        </div>
    </article>
    
    

    
    
</div>

                    <footer id="footer">
    <div>
        &copy; 2020 <a href="https://zaina.newban.cn">开发者问答集锦 By </a>
        
    </div>
    <br />
    <div>
        <div class="github-badge">
            <a href="https://gohugo.io/" target="_black" rel="nofollow"><span class="badge-subject">Powered by</span><span class="badge-value bg-blue">Hugo</span></a>
        </div>
        <div class="github-badge">
            <a href="https://www.flysnow.org/" target="_black"><span class="badge-subject">Design by</span><span class="badge-value bg-brightgreen">飞雪无情</span></a>
        </div>
        <div class="github-badge">
            <a href="https://github.com/flysnow-org/maupassant-hugo" target="_black"><span class="badge-subject">Theme</span><span class="badge-value bg-yellowgreen">Maupassant</span></a>
        </div>
    </div>
</footer>


    
    <script type="text/javascript">
        window.MathJax = {
            tex2jax: {
                inlineMath: [['$', '$']],
                processEscapes: true
                }
            };
    </script>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML' async></script>

<a id="rocket" href="#top"></a>
<script type="text/javascript" src='/js/totop.js?v=0.0.0' async=""></script>



    <script type="text/javascript" src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script>




                </div>

                <div id="secondary">
    <section class="widget">
        <form id="search" action='https://zaina.newban.cn/search/' method="get" accept-charset="utf-8" target="_blank" _lpchecked="1">
      
      <input type="text" name="q" maxlength="20" placeholder="Search">
      <input type="hidden" name="sitesearch" value="https://zaina.newban.cn">
      <button type="submit" class="submit icon-search"></button>
</form>
    </section>
    
    <section class="widget">
        <h3 class="widget-title">最近文章</h3>
<ul class="widget-list">
    
    <li>
        <a href="https://zaina.newban.cn/posts/001rubyruby%E4%B8%AD%E5%85%A8%E5%B1%80%E5%8F%98%E9%87%8F%E5%AE%9E%E4%BE%8B%E5%8F%98%E9%87%8F%E5%B1%80%E9%83%A8%E5%8F%98%E9%87%8F%E7%B1%BB%E5%8F%98%E9%87%8Fsymbol%E5%AF%B9%E6%AF%94/" title="001rubyRuby中全局变量实例变量局部变量类变量Symbol对比">001rubyRuby中全局变量实例变量局部变量类变量Symbol对比</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/007hadoop%E9%9B%86%E7%BE%A4%E9%85%8D%E7%BD%AEhadoop%E9%9B%86%E7%BE%A4%E7%9A%84%E5%90%AF%E5%8A%A8%E5%92%8C%E6%B5%8B%E8%AF%95ssh%E5%85%8D%E7%99%BB%E9%99%86%E9%85%8D%E7%BD%AEstartallshhdfs%E5%B8%B8%E7%94%A8%E7%9A%84shell/" title="007Hadoop集群配置Hadoop集群的启动和测试SSH免登陆配置startallshhdfs常用的shell">007Hadoop集群配置Hadoop集群的启动和测试SSH免登陆配置startallshhdfs常用的shell</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/009shell%E8%84%9A%E6%9C%AC%E4%B8%8B%E6%9D%A1%E4%BB%B6%E6%B5%8B%E8%AF%95eqne/" title="009Shell脚本下条件测试eqne">009Shell脚本下条件测试eqne</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/00pythonmanagepyshell%E5%92%8Cpython%E7%9A%84%E5%88%86%E6%9E%90/" title="00Pythonmanagepyshell和Python的分析">00Pythonmanagepyshell和Python的分析</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/010zookeeper%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5zookeeper%E7%9A%84%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BAzookeeper%E7%9A%84shell%E5%91%BD%E4%BB%A4/" title="010Zookeeper的基本概念Zookeeper的集群搭建Zookeeper的shell命令">010Zookeeper的基本概念Zookeeper的集群搭建Zookeeper的shell命令</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/018dockerfileshell/" title="018DockerfileSHELL">018DockerfileSHELL</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/01shell%E5%85%A5%E9%97%A801bashshell%E7%89%B9%E6%80%A7/" title="01Shell入门01bashShell特性">01Shell入门01bashShell特性</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/01shell%E5%8F%98%E9%87%8F/" title="01Shell变量">01Shell变量</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/01shell%E5%9F%BA%E7%A1%80%E6%A6%82%E8%BF%B0%E8%84%9A%E6%9C%AC%E6%89%A7%E8%A1%8C%E6%96%B9%E5%BC%8Fbash%E5%9F%BA%E6%9C%AC%E5%8A%9F%E8%83%BD/" title="01Shell基础概述脚本执行方式Bash基本功能">01Shell基础概述脚本执行方式Bash基本功能</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/01shell%E7%BC%96%E7%A8%8Bhelloworld/" title="01shell编程helloworld">01shell编程helloworld</a>
    </li>
    
</ul>
    </section>

    

    <section class="widget">
        <h3 class="widget-title"><a href="/categories">分类</a></h3>
<ul class="widget-list">
    
</ul>
    </section>

    <section class="widget">
        <h3 class="widget-title"><a href="/tags">标签</a></h3>
<div class="tagcloud">
    
    <a href="https://zaina.newban.cn/tags/ruby/">ruby</a>
    
    <a href="https://zaina.newban.cn/tags/shell/">shell</a>
    
</div>
    </section>

    

    <section class="widget">
        <h3 class="widget-title">其它</h3>
        <ul class="widget-list">
            <li><a href="https://zaina.newban.cn/index.xml">文章 RSS</a></li>
        </ul>
    </section>
</div>
            </div>
        </div>
    </div>
</body>

</html>