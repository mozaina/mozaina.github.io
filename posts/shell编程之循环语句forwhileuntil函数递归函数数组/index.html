<!doctype html>
<html lang="en-us">
<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">


    <title>Shell编程之循环语句forwhileuntil函数递归函数数组 | 开发者问答集锦</title>
    <meta property="og:title" content="Shell编程之循环语句forwhileuntil函数递归函数数组 - 开发者问答集锦">
    <meta property="og:type" content="article">
        
    <meta property="article:published_time" content='2020-09-02T00:00:00&#43;08:00'>
        
        
    <meta property="article:modified_time" content='2020-09-02T00:00:00&#43;08:00'>
        
    <meta name="Keywords" content="">
    <meta name="description" content="Shell编程之循环语句forwhileuntil函数递归函数数组">
        
    <meta name="author" content="">
    <meta property="og:url" content="https://zaina.newban.cn/posts/shell%E7%BC%96%E7%A8%8B%E4%B9%8B%E5%BE%AA%E7%8E%AF%E8%AF%AD%E5%8F%A5forwhileuntil%E5%87%BD%E6%95%B0%E9%80%92%E5%BD%92%E5%87%BD%E6%95%B0%E6%95%B0%E7%BB%84/">
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">

    <link rel="stylesheet" href='/css/normalize.css'>
    <link rel="stylesheet" href='/css/style.css'>
    <script type="text/javascript" src="//cdn.bootcdn.net/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

    
    
    
    
    
    
</head>


<body>
    <header id="header" class="clearfix">
    <div class="container">
        <div class="col-group">
            <div class="site-name ">
                
                    <a id="logo" href="https://zaina.newban.cn">
                        开发者问答集锦
                    </a>
                
                
            </div>
            <div>
                <nav id="nav-menu" class="clearfix">
                    <a class="" href="https://zaina.newban.cn">首页</a>
                    
                </nav>
            </div>
        </div>
    </div>
</header>

    <div id="body">
        <div class="container">
            <div class="col-group">

                <div class="col-8" id="main">
                    
<div class="res-cons">
    
    <article class="post">
        <header>
            <h1 class="post-title">Shell编程之循环语句forwhileuntil函数递归函数数组</h1>
        </header>
        <date class="post-meta meta-date">
            2020年9月2日
        </date>
        
        
        <div class="post-meta">
            <span id="busuanzi_container_page_pv">|<span id="busuanzi_value_page_pv"></span><span>
                    阅读</span></span>
        </div>
        
        
        <div class="post-content">
            

<h3 id="shell编程之循环语句-for-while-until-函数-递归函数-数组">Shell编程之循环语句[for、while、until]、函数（递归函数）、数组</h3>

<ul>
<li>一：循环语句

<ul>
<li>1.1：for循环语句

<ul>
<li>1.1.1：for语句结构</li>
</ul></li>
<li>1.2：for语句应用示例

<ul>
<li>1.2.1：批量添加/删除用户</li>
<li>1.2.2：根据IP地址检查主机状态</li>
<li>1.2.3：用循环语句输出1-10的数字的方式</li>
<li>1.2.4：shell中let命令</li>
<li>1.2.5：计算1-10偶数/奇数的和</li>
</ul></li>
<li>1.3：while循环语句

<ul>
<li>1.3.1：while语句结构</li>
<li>1.3.2：while语句应用示例</li>
<li>1.3.3：while死循环</li>
<li>1.3.4：使用while批量添加用户</li>
<li>1.3.5：猜商品价格游戏</li>
</ul></li>
<li>1.4：continue和break

<ul>
<li>1.4.1：continue</li>
<li>1.4.2：break</li>
<li>1.4.3：break、continue和exit的区别</li>
<li>1.4.4：幸运抽奖</li>
</ul></li>
<li>1.5：untli循环语句

<ul>
<li>1.5.1：until语句的结构</li>
<li>1.5.2：until语句应用</li>
</ul></li>
</ul></li>
<li>二：Shell函数

<ul>
<li>2.1：shell函数概述</li>
<li>2.2：shell函数定义</li>
<li>2.3：调用函数的方法</li>
<li>2.4：函数的作用范围</li>
<li>2.5：shell函数应用</li>
<li>2.6：函数的参数

<ul>
<li>2.6.1：参数的用法</li>
<li>2.6.2：参数的表示方法</li>
</ul></li>
<li>2.7：递归函数</li>
</ul></li>
<li>三：Shell数组

<ul>
<li>3.1：数组应用场景</li>
<li>3.2：数组定义方法</li>
<li>3.3：数组包括的数据类型与数组操作

<ul>
<li>3.3.1：数组包括的数据类型</li>
<li>3.3.2：数组操作</li>
</ul></li>
<li>3.4：数组的应用</li>
<li>3.5：Shell脚本调试</li>
</ul></li>
</ul>

<h1 id="一-循环语句">一：循环语句</h1>

<h2 id="1-1-for循环语句">1.1：for循环语句</h2>

<h3 id="1-1-1-for语句结构">1.1.1：for语句结构</h3>

<ul>
<li><p>读取不同的变量值，用来逐个执行同一组命令</p>

<p>语句结构
for 变量名 in 取值列表
do
​           命令序列
done</p>

<p>语句结构举例
for 收件人 in 邮件地址列表
do
​            发送邮件
done</p></li>
</ul>

<p><a href="https://img.it610.com/image/info8/0e8efa65b26b45d79d711a3a113e2129.jpg"><img src="https://img.it610.com/image/info8/0e8efa65b26b45d79d711a3a113e2129.jpg" alt="Shell编程之循环语句\(for、while、until\)、函数（递归函数）、数组_第1张图片" /></a></p>

<h2 id="1-2-for语句应用示例">1.2：for语句应用示例</h2>

<h3 id="1-2-1-批量添加-删除用户">1.2.1：批量添加/删除用户</h3>

<p>添加需求描述：</p>

<ul>
<li>用户名存放再users.txt文件中，每行一个</li>
<li>初始密码均设为123456</li>

<li><p>验证脚本</p>

<p>[root@localhost ~]# vim /opt/users.txt
tom
zhangsan
lisi
wangwu</p>

<p>[root@localhost ~]# vim users.sh
#!/bin/bash
#定义
list=<code>cat /opt/users.txt</code>
#遍历集合
for user in $list
do
    #添加用户
    useradd  $user
    #设置密码
    echo &ldquo;123456&rdquo; |passwd &ndash;stdin $user
    echo &ldquo;设置${user}用户成功&rdquo;
done
[root@localhost ~]# sh users.sh
更改用户 tom 的密码 。
passwd：所有的身份验证令牌已经成功更新。
设置tom用户成功
更改用户 zhangsan 的密码 。
passwd：所有的身份验证令牌已经成功更新。
设置zhangsan用户成功
更改用户 lisi 的密码 。
passwd：所有的身份验证令牌已经成功更新。
设置lisi用户成功
更改用户 wangwu 的密码 。
passwd：所有的身份验证令牌已经成功更新。
设置wangwu用户成功</p></li>
</ul>

<p>删除需求描述：</p>

<ul>
<li><p>删除上面添加的用户</p>

<p>[root@localhost ~]# vim users.sh
#!/bin/bash
#定义
list=<code>cat /opt/users.txt</code>
#遍历集合
for user in $list
do
    #删除用户
    userdel  $user
    #设置密码
    #echo &ldquo;123456&rdquo; |passwd &ndash;stdin $user
    echo &ldquo;删除${user}用户成功&rdquo;
done
[root@localhost ~]# sh users.sh
删除tom用户成功
删除zhangsan用户成功
删除lisi用户成功
删除wangwu用户成功</p></li>
</ul>

<h3 id="1-2-2-根据ip地址检查主机状态">1.2.2：根据IP地址检查主机状态</h3>

<p>需求描述：</p>

<ul>
<li>IP地址存放再hosts.txt文件中，每行一个</li>

<li><p>使用ping命令检测各主机的连通性</p>

<p>[root@localhost opt]# vim hosts.txt
20.0.0.1
192.168.100.100
20.0.0.2</p>

<p>[root@localhost opt]# vim pingip.sh
#!/bin/bash
#定义集合
list=<code>cat /opt/hosts.txt</code>
#遍历集合
for IP in $list
do
    ping -c 3 -i 0.2 -W 3 $IP &gt; /dev/null
    #条件判断
    if [ $? -eq 0 ];then
       echo &ldquo;$IP is on&rdquo;
    else
       echo &ldquo;$IP is down&rdquo;
    fi
done
[root@localhost opt]# sh pingip.sh
20.0.0.1 is down
192.168.100.100 is down
20.0.0.2 is on</p></li>
</ul>

<h3 id="1-2-3-用循环语句输出1-10的数字的方式">1.2.3：用循环语句输出1-10的数字的方式</h3>

<ul>
<li><p>方式一：</p>

<p>#!/bin/bash
for ((i=1;i&lt;=10;i++))
do<br />
​       echo &ldquo;$i&rdquo;
done</p></li>

<li><p>方式二：</p>

<p>#!/bin/bash
i=1
for ((;i&lt;=10;i++))
do<br />
​          echo &ldquo;$i&rdquo;
done</p></li>

<li><p>方式三：</p>

<p>#!/bin/bash
i=1
for ((;i&lt;=10;))
do<br />
​             echo &ldquo;$i&rdquo;<br />
let i++ done</p></li>

<li><p>方式四：</p>

<p>#!/bin/bash
i=1
for ((;;))
do<br />
​     if [ $i -le 10 ]；then<br />
​            echo &ldquo;$i&rdquo;<br />
​            let i++<br />
​      else<br />
​              exit 0<br />
​      fi
done</p></li>

<li><p>四种方式输出结果都是一样的</p>

<p>[root@localhost opt]# ./number.sh<br />
1
2
3
4
5
6
7
8
9
10</p></li>
</ul>

<h3 id="1-2-4-shell中let命令">1.2.4：shell中let命令</h3>

<ul>
<li><p>let 对整数进行数学运算</p></li>

<li><p>let和双小括号 (( )) 一样，let 命令也只能进行整数运算，不能对小数（浮点数）或者字符串进行运算。</p>

<p>语法格式
let 表达式
或
let &ldquo;表达式&rdquo;
 或
let &lsquo;表达式&rsquo;</p></li>
</ul>

<p>以上方式都等价于 ((表达式))</p>

<ul>
<li>当表达式中含有 Shell 特殊字符（例如 |）时，需要用双引号<code>&quot; &quot;</code>或者单引号<code>' '</code>将表达式包围起来。</li>
<li>和 (( )) 类似，let 命令也支持一次性计算多个表达式，并且以最后一个表达式的值作为整个 let 命令的执行结果。</li>
</ul>

<h3 id="1-2-5-计算1-10偶数-奇数的和">1.2.5：计算1-10偶数/奇数的和</h3>

<p>方式一：计算偶数的和</p>

<pre><code>#!/bin/bash
sum=0
#循环
for ((i=0;i&lt;=10;i+=2))
do
    let sum+=$i
done
echo &quot;和为：${sum}&quot;
[root@localhost opt]# sh oushuhe.sh 
和为：30
</code></pre>

<p>计算奇数的和</p>

<pre><code>#!/bin/bash
sum=0
#循环
for ((i=1;i&lt;=10;i+=2))
do
    let sum+=$i
done
echo &quot;和为：${sum}&quot;

[root@localhost opt]# sh oushuhe.sh 
和为：25
</code></pre>

<p>方式二：求偶数和</p>

<pre><code>#!/bin/bash
sum=0
for((i=0;i&lt;=10;i+=2))
  do
        if [ `expr $i % 2` -eq 0 ]
         then
           let sum+=$i
        fi
  done
        echo &quot;总和为：$sum&quot;
</code></pre>

<p>求奇数和</p>

<pre><code>#!/bin/bash
sum=0
for((i=1;i&lt;=10;i+=2))
  do
        if [ `expr $i % 2` -eq 1 ]
         then
           let sum+=$i
        fi
  done
        echo &quot;总和为：$sum&quot;
</code></pre>

<h2 id="1-3-while循环语句">1.3：while循环语句</h2>

<h3 id="1-3-1-while语句结构">1.3.1：while语句结构</h3>

<ul>
<li><p>重复测试某个条件，只要条件成立则反复执行</p>

<p>语句结构
while 条件测试操作
do
​         命令序列
done
语句结构示例
while 未猜中正确的价格
do
​             反复猜测商品价格
done</p></li>
</ul>

<p><a href="https://img.it610.com/image/info8/e7562fff5ae745f590880939b3036124.jpg"><img src="https://img.it610.com/image/info8/e7562fff5ae745f590880939b3036124.jpg" alt="Shell编程之循环语句\(for、while、until\)、函数（递归函数）、数组_第2张图片" /></a></p>

<h3 id="1-3-2-while语句应用示例">1.3.2：while语句应用示例</h3>

<ul>
<li><p>使用while循环语句输出1-10数字</p>

<p>#!/bin/bash
i=0
while [ $i -le 10 ]
do
  echo &ldquo;$i&rdquo;
  let i++
done
[root@localhost opt]# sh oushuhe.sh
0
1
2
3
4
5
6
7
8
9
10</p></li>
</ul>

<h3 id="1-3-3-while死循环">1.3.3：while死循环</h3>

<p>while true：死循环有时候也有奇效，可与用户交互</p>

<pre><code>[root@localhost opt]# vim sixunhuan.sh
#!/bin/bash
while true
do
  read -p &quot;输入yes继续/no退出：&quot; way
  if [ $way = no ];then
      break
  fi
done
echo &quot;正常退出&quot;
[root@localhost opt]# sh sixunhuan.sh 
输入yes继续/no退出：yes
输入yes继续/no退出：yse
输入yes继续/no退出：no
正常退出
</code></pre>

<h3 id="1-3-4-使用while批量添加用户">1.3.4：使用while批量添加用户</h3>

<p>需求描述：</p>

<ul>
<li>用户名称以stu开头，按数字顺序进行编号</li>
<li>一共添加20个用户，即stu1，stu2…stu20</li>

<li><p>初始密码设置为123456</p>

<p>[root@localhost opt]# vim stu.sh
#!/bin/bash
i=1
while [ $i -le 20 ]
do
   useradd stu$i
   echo &ldquo;123456&rdquo; | passwd &ndash;stdin stu$i &amp;&gt; /dev/null
   echo &ldquo;设置stu${i}用户成功&rdquo;
   let i++
done
[root@localhost opt]# sh stu.sh
设置stu1用户成功
设置stu2用户成功
设置stu3用户成功
设置stu4用户成功
设置stu5用户成功
设置stu6用户成功
设置stu7用户成功
设置stu8用户成功
设置stu9用户成功
设置stu10用户成功
设置stu11用户成功
设置stu12用户成功
设置stu13用户成功
设置stu14用户成功
设置stu15用户成功
设置stu16用户成功
设置stu17用户成功
设置stu18用户成功
设置stu19用户成功
设置stu20用户成功</p></li>
</ul>

<h3 id="1-3-5-猜商品价格游戏">1.3.5：猜商品价格游戏</h3>

<ul>
<li>通过变量RANDOM获得随机数</li>

<li><p>提示用户猜测并记录次数，猜中后退出循环</p>

<p>[root@localhost opt]# vim price.sh
#!/bin/bash
price=<code>expr $RANDOM % 100</code>
i=0
while true
do
read -p &ldquo;请输入你认为的价格(1~100)：&rdquo; num
   let i++
   if [ $num -eq $price ];then
     echo &ldquo;恭喜你，猜对了&rdquo;
     echo &ldquo;你输入的次数为：$i&rdquo;
     break
   elif [ $num  -gt $price ];then
     echo &ldquo;高了&rdquo;
     continue
   else
     echo &ldquo;低了&rdquo;
    continue
   fi
done
[root@localhost opt]# sh price.sh
请输入你认为的价格(1~100)：50
低了
请输入你认为的价格(1~100)：75
高了
请输入你认为的价格(1~100)：65
高了
请输入你认为的价格(1~100)：55
低了
请输入你认为的价格(1~100)：60
低了
请输入你认为的价格(1~100)：63
高了
请输入你认为的价格(1~100)：62
恭喜你，猜对了
你输入的次数为：7</p></li>
</ul>

<h2 id="1-4-continue和break">1.4：continue和break</h2>

<h3 id="1-4-1-continue">1.4.1：continue</h3>

<pre><code>命令格式
continue n
</code></pre>

<p>n 表示循环的层数：<br />
如果省略 n，则表示 continue 只对当前层次的循环语句有效，遇到 continue 会跳过本次循环，忽略本次循环的剩余代码，直接进入下一次循环。<br />
如果带上 n，比如 n 的值为 2，那么 continue
对内层和外层循环语句都有效，不但内层会跳过本次循环，外层也会跳过本次循环，其效果相当于内层循环和外层循环同时执行了不带 n 的
continue。这么说可能有点难以理解，稍后我们通过代码来演示。<br />
continue 关键字也通常和 if 语句一起使用，即满足条件时便跳出循环。<br />
<a href="https://img.it610.com/image/info8/9790d1a90bd6406a877aba5982647ac6.jpg"><img src="https://img.it610.com/image/info8/9790d1a90bd6406a877aba5982647ac6.jpg" alt="Shell编程之循环语句\(for、while、until\)、函数（递归函数）、数组_第3张图片" /></a></p>

<h3 id="1-4-2-break">1.4.2：break</h3>

<p>命令格式</p>

<p>break n</p>

<p>n 表示跳出循环的层数，如果省略 n，则表示跳出当前的整个循环。</p>

<p>break 关键字通常和 if 语句一起使用，即满足条件时便跳出循环。<br />
<a href="https://img.it610.com/image/info8/f7cc3dbc2e914cb7b07fb8872b01de07.jpg"><img src="https://img.it610.com/image/info8/f7cc3dbc2e914cb7b07fb8872b01de07.jpg" alt="Shell编程之循环语句\(for、while、until\)、函数（递归函数）、数组_第4张图片" /></a></p>

<h3 id="1-4-3-break-continue和exit的区别">1.4.3：break、continue和exit的区别</h3>

<p>break 用来结束所有循环，循环语句不再有执行的机会；continue
用来结束本次循环，直接跳到下一次循环，如果循环条件成立，还会继续循环；exit用来突出应用程序。</p>

<h3 id="1-4-4-幸运抽奖">1.4.4：幸运抽奖</h3>

<p>需求描述：</p>

<ul>
<li>奖池观众：zhangsan，lisi，wangwu</li>
<li>奖池观众名单在name.txt中</li>

<li><p>共10次投票，使用随机数的方法挑选幸运观众，票数最多获胜</p>

<p>[root@localhost opt]# vim name.txt
1:zhangsan
2:lisi
3:wangwu
[root@localhost opt]# vim choujiang.sh
#!/bin/bash
B=0
C=0
D=0
for ((i=1;i&lt;=10;i++))
do
 A=$(expr $[RANDOM%3+1])
 list=$(cat /opt/name.txt|grep &ldquo;$A&rdquo; |awk -F: &lsquo;{print $2}&rsquo;)
 case $list in
 zhangsan)
        let B++
 ;;
 lisi)
        let C++
 ;;
 *)
        let D++
  esac
  echo &ldquo;$list&rdquo;
done
[root@localhost opt]# sh choujiang.sh
zhangsan
lisi
wangwu
lisi
zhangsan
lisi
wangwu
zhangsan
wangwu
wangwu</p></li>
</ul>

<h2 id="1-5-untli循环语句">1.5：untli循环语句</h2>

<h3 id="1-5-1-until语句的结构">1.5.1：until语句的结构</h3>

<p>重复测试某个条件，只要条件不成立则反复执行</p>

<pre><code>until 条件测试操作 
do 
​        命令序列 
done
while 未超过 10 
do 
​          数字依次增加 
done
</code></pre>

<p><a href="https://img.it610.com/image/info8/8bebe9d38f054b1cbc0522923839c78e.jpg"><img src="https://img.it610.com/image/info8/8bebe9d38f054b1cbc0522923839c78e.jpg" alt="Shell编程之循环语句\(for、while、until\)、函数（递归函数）、数组_第5张图片" /></a></p>

<h3 id="1-5-2-until语句应用">1.5.2：until语句应用</h3>

<p>示例一：计算1–50的和</p>

<p>需求描述：</p>

<ul>
<li><p>通过循环累加的方式计算1–50的和</p>

<p>[root@localhost opt]# vim he.sh
#!/bin/bash
i=1
sum=0
until [ $i -eq 51 ]
do
   let sum+=$i
   let i++
done
echo $sum
[root@localhost opt]# sh he.sh
1275</p></li>
</ul>

<p>示例二：为指定用户发送在线消息</p>

<p>需求描述：</p>

<ul>
<li>若指定用户不在线（未登陆系统），则每10分钟（实验中为了测试效果，可改为3s）试一次，直至用户登录系统后再发送信息</li>
<li>用户名与消息通过为止参数传递给脚本</li>
</ul>

<p>分析：</p>

<p>1.位置参数个数大于1</p>

<p>2.姓名属于系统用户 /etc/passwd</p>

<p>3.用户是否在线 until who</p>

<p>4.发送消息 echo&rdquo;消息&rdquo; | write 用户名</p>

<pre><code>[root@localhost opt]# vim xiaoxi.sh
#!/bin/bash
username=$1
#格式参数不能为空
if [ $# -lt 1 ];then
  echo &quot;Usage:`basename $0`  []&quot;
  exit 1
fi
#验证是否属于系统用户
if grep &quot;^$username&quot; /etc/passwd &gt; /dev/null;then :
else
   echo &quot;no user&quot;
   exit 2
fi
#测试用户是否在线，如果不在线，每5s联系一次
until who | grep &quot;$usrename&quot; &gt; /dev/null
do
   echo &quot;user not login&quot;
   sleep 5
done
#发送消息
echo &quot;$2&quot; | write &quot;$username&quot;
echo &quot;${username}发送成功&quot;
[root@localhost opt]# sh xiaoxi.sh kevin hello
kevin发送成功
</code></pre>

<h1 id="二-shell函数">二：Shell函数</h1>

<h2 id="2-1-shell函数概述">2.1：shell函数概述</h2>

<ul>
<li><p>shell一个非常重要的特性是它可作为一种编程语言来使用。</p></li>

<li><p>因为shell是一个解释器，所以它不能对为它编写的程序进行编译，而是在每次从磁盘加载这些程序时对它们进行解释。而程序的加载和解释都是非常耗时的。</p></li>

<li><p>针对此问题，许多shell（如BourneAgainShell）都包含shell函数，shell把这些函数放在内存中，这样每次需要执行它们时就不必再从磁盘读入。</p></li>

<li><p>shell还以一种内部格式来存放这些函数，这样就不必耗费大量的时间来解释它们</p></li>

<li><p>shell函数将命令序列按格式写在一起</p></li>

<li><p>可以方便重复使用命令序列</p></li>
</ul>

<h2 id="2-2-shell函数定义">2.2：shell函数定义</h2>

<pre><code>[ function ] 函数名(){
​     命令序列
​      [return x]                                      使用return或exit可以显式地结束函数
}
</code></pre>

<p>其中，return返回的是状态码，需要使用$?调取</p>

<p>echo 返回的是值，使用变量调用</p>

<p>传参：指位置变量</p>

<p>可以带function fun() 定义，也可以直接fun() 定义,不带任何参数。</p>

<p>参数返回，可以显示加：return 返回，如果不加，将以最后一条命令运行结果，作为返回值。 return后跟数值n(0-255）</p>

<h2 id="2-3-调用函数的方法">2.3：调用函数的方法</h2>

<ul>
<li><p>函数名 [参数1($1)] [参数2($2)]</p></li>

<li><p>在Shell中，调用函数时可以向其传递参数。在函数体内部，通过 $n 的形式来获取参数的值，例如，$1表示第一个参数，$2表示第二个参数…</p></li>

<li><p>10不能获取第十个参数，获取第十个参数需要10 不能获取第十个参数，获取第十个参数需要10不能获取第十个参数，获取第十个参数需要{10}。当n&gt;=10时，需要使用${n}来获取参数。</p></li>
</ul>

<h2 id="2-4-函数的作用范围">2.4：函数的作用范围</h2>

<ul>
<li>函数在Shell脚本中仅在当前Shell环境中有效</li>
<li>Shell脚本中变量默认全局有效</li>
<li>将变量限定在函数内部使用local命令</li>
</ul>

<p>示例</p>

<p>函数内部变量通过local来实现</p>

<ul>
<li>通过定义score函数，在期内部设置局部变量i</li>

<li><p>函数内部和外部分别赋值，进行结果验证</p>

<p>#!/bin/bash
#求和函数体
function sum(){
  #命令序列
  read -p &ldquo;请输入第一个整数：&rdquo; num1
  read -p &ldquo;请输入第二个整数：&rdquo; num2
  SUM=$(($num1+$num2))
  #echo 返回的是处理结果值
  local score=100
  echo &ldquo;函数内$score&rdquo;
  echo &ldquo;和：$SUM&rdquo;
}
sum
echo &ldquo;函数外$score&rdquo;</p></li>
</ul>

<h2 id="2-5-shell函数应用">2.5：shell函数应用</h2>

<p>示例一：两个数字求和</p>

<p>需求描述：</p>

<ul>
<li>通过sum(){}定义函数</li>

<li><p>使用read命令交互输入两个数并求和</p>

<p>[root@localhost opt]# vim he.sh
#!/bin/bash
function sum(){
read -p &ldquo;请输入第一个数字：&rdquo; num1
read -p &ldquo;请输入第二个数字：&rdquo; num2
SUM=$[${num1}+${num2}]
echo &ldquo;和为：$SUM&rdquo;
}
sum
[root@localhost opt]# sh he.sh
请输入第一个数字：10
请输入第二个数字：20
和为：30</p></li>
</ul>

<p>示例二：编写登陆系统后便可使用的用户自定义函数</p>

<p>需求描述：</p>

<ul>
<li><p>编辑用户自定义函数文件/root/function</p></li>

<li><p>在当前ShelIl中加载可执行的函数文件/root/function</p></li>

<li><p>在~/.bashrc文件中添加source /root/function命令</p>

<p>[root@localhost ~]# vim ~/.bashrc</p>

<h1 id="bashrc">.bashrc</h1>

<h1 id="user-specific-aliases-and-functions">User specific aliases and functions</h1>

<p>alias rm=&lsquo;rm -i&rsquo;
alias cp=&lsquo;cp -i&rsquo;
alias mv=&lsquo;mv -i&rsquo;</p>

<h1 id="source-global-definitions">Source global definitions</h1>

<p>if [ -f /etc/bashrc ]; then
        . /etc/bashrc
fi
function sum(){
    #命令序列
    read -p &ldquo;请输入第一个整数：&rdquo; num1
    read -p &ldquo;请输入第二个整数：&rdquo; num2
    SUM=$[$num1+$num2]
    #echo返回的是处理结果值
    echo &ldquo;和：$SUM&rdquo;
[root@localhost ~]# source ~/.bashrc
[root@localhost ~]# sum
请输入第一个整数：10
请输入第二个整数：320
和：330</p></li>
</ul>

<h2 id="2-6-函数的参数">2.6：函数的参数</h2>

<h3 id="2-6-1-参数的用法">2.6.1：参数的用法</h3>

<p>函数名称 参数1 参数2 参数3 …</p>

<h3 id="2-6-2-参数的表示方法">2.6.2：参数的表示方法</h3>

<p>$1 $2  3&hellip;&hellip;. 3 &hellip;&hellip;. 3&hellip;&hellip;.{10} ${11}…</p>

<h2 id="2-7-递归函数">2.7：递归函数</h2>

<ul>
<li>调用自己本身的函数</li>
</ul>

<p>示例：递归遍历目录</p>

<p>需求描述：</p>

<ul>
<li><p>通过定义递归函数list_files来实现</p>

<p>[root@localhost opt]# vim files.sh
#!/bin/bash
function list_files(){
   for f in <code>ls $1</code>
   do
    #判断是否为目录
    if [ -d &ldquo;$1/$f&rdquo; ];then
       echo &ldquo;$2$f&rdquo;
       #递归调用
       list_files &ldquo;$1/$f&rdquo;  &ldquo; $2&rdquo;
    else
       echo &ldquo;$2$f&rdquo;
    fi
   done
}
list_files &ldquo;/var/log&rdquo; &ldquo;&rdquo;
[root@localhost opt]# sh files.sh
anaconda
 anaconda.log
 ifcfg.log
 journal.log
 ks-script-E3s5jr.log
 packaging.log
 program.log
 storage.log
 syslog
 X.log
audit
 audit.log
boot.log
boot.log-20200609
boot.log-20200610
boot.log-20200611
boot.log-20200719
boot.log-20200720
boot.log-20200721
boot.log-20200722
btmp
btmp-20200719
chrony
cron
cron-20200609
cron-20200719
&hellip;&hellip;</p></li>
</ul>

<h1 id="三-shell数组">三：Shell数组</h1>

<h2 id="3-1-数组应用场景">3.1：数组应用场景</h2>

<ul>
<li>获取数组长度</li>
</ul>

<p>使用for循环获取具体信息，使用下标或索引标记数组中数据的位置</p>

<p>可以存放多种数据，如：整型，长整形，浮点型（单精度，双精度），字符串等</p>

<p>获取元素长度</p>

<ul>
<li><p>遍历元素</p></li>

<li><p>元素切片</p></li>

<li><p>元素替换</p></li>

<li><p>元素删除</p></li>

<li><p>…</p></li>
</ul>

<p>注意，忌讳数组越界，</p>

<p>数组下标从0开始算</p>

<p>数组长度从1开始算</p>

<p>长度为4，数组长度表示为1,2,3,4；数组下标表示为0,1,2,3</p>

<p>shell中数组是可变长的</p>

<h2 id="3-2-数组定义方法">3.2：数组定义方法</h2>

<p>方法一：（推荐）</p>

<p>基本格式</p>

<p>数组名=（value0 value1 value2…）</p>

<p>例如</p>

<p>ABC=（11 22 33…）</p>

<p>方法二：</p>

<p>基本格式</p>

<p>数组名=（[0]=value [1]=value [2]=value…）</p>

<p>例如</p>

<p>ABC=（[0]=11 [1]=22 [2]=33…)</p>

<p>方法三：数组元素之间使用空格隔开</p>

<p>基本格式</p>

<p>列表名=“value0 value1 value2” 数组名=（$列表名）</p>

<p>例如</p>

<p>AAA=“11 22 33…”</p>

<p>ABC=($列表名)</p>

<p>方法四：（多用于替换）</p>

<p>基本格式</p>

<p>数组名[0]=“value”</p>

<p>数组名[1]=“value”</p>

<p>数组名[2]=“value” …</p>

<p>例如 AAA[0]=“11”</p>

<p>AAA[1]=“22”</p>

<p>AAA[2]=“33”</p>

<p>…</p>

<h2 id="3-3-数组包括的数据类型与数组操作">3.3：数组包括的数据类型与数组操作</h2>

<h3 id="3-3-1-数组包括的数据类型">3.3.1：数组包括的数据类型</h3>

<ul>
<li><p>数值类型</p></li>

<li><p>字符类型</p>

<ul>
<li>使用“”或‘’定义</li>
</ul></li>
</ul>

<p>数组只可存放数值或字符</p>

<h3 id="3-3-2-数组操作">3.3.2：数组操作</h3>

<ul>
<li><p>获取数组长度</p>

<p>基本格式
${#数组名[@/<em>]}
例如
[root@localhost opt]# abc=(10 20 30)
[root@localhost opt]# echo ${abc[</em>]}
10 20 30
[root@localhost opt]# echo ${#abc[*]}
3</p></li>

<li><p>读取某下标赋值</p>

<p>基本格式
${数组名[下标]}
例如
[root@localhost opt]# echo ${abc[1]}
20
[root@localhost opt]# echo ${abc[0]}
10
[root@localhost opt]# echo ${abc[1]}
20
[root@localhost opt]# echo ${abc[2]}
30</p></li>
</ul>

<p>数组遍历</p>

<pre><code>[root@localhost opt]# for v in ${arr_number[@]}
&gt; do
&gt;   echo $v
&gt; done
&gt;
&gt; 1
&gt;
&gt; 2
&gt;
&gt; 3
&gt;
&gt; 4
&gt;
&gt; 5
</code></pre>

<h2 id="3-4-数组的应用">3.4：数组的应用</h2>

<p>示例一：创建存放1~100奇数的数组</p>

<pre><code>[root@localhost opt]# vim a.sh
#!/bin/bash
j=0
k=1
for ((i=0;i&lt;=99;i++))
do
    j=$[$i+$k]
    let k++
    if [ $j -lt 100 ];then
       arr[$i]=$j
    fi
done
echo ${arr[*]}
[root@localhost opt]# sh a.sh 
1 3 5 7 9 11 13 15 17 19 21 23 25 27 29 31 33 35 37 39 41 43 45 47 49 51 53 55 57 59 61 63 65 67 69 71 73 75 77 79 81 83 85 87 89 91 93 95 97 99
</code></pre>

<p>示例二：创建任意数字及长度的数组，根据客户需求加入元素</p>

<pre><code>#!/bin/bash
#存入元素
i=0
while true
do
    read -p &quot;请输入第$[$i+1]元素：&quot; j
    arr[$i]=$j
    read -p &quot;请输入y/n：&quot; guess
    if [ $guess = y ];then
    let i++
    else
    break
    fi
done
echo ${arr[*]}
</code></pre>

<p>示例三：全班学生成绩未达到60分的，通过数组加到60分</p>

<pre><code>#!/bin/bash
score=(48 59 60 68 90 78 86 56 98 56)
j=0
for ((i=0;i&lt;${#score[*]};i++))
do
     if [ ${score[$i]} -lt 60 ];then
     new[$j]=60
     else
     new[$j]=${score[$i]}
     let j++
     fi
done
echo ${new[*]}
[root@localhost opt]# sh score.sh 
60 68 90 78 86 98 60
</code></pre>

<p>示例四：根据示例三中分数，比较出最大值</p>

<pre><code>#!/bin/bash
score=(48 59 60 68 90 78 86 56 98 56)
temp=0
for ((i=0;i&lt;${#score[*]};i++))
do
     if [ ${score[$i]} -gt $temp ];then
     temp=${score[$i]}
     fi
done
echo $temp
[root@localhost opt]# sh score.sh 
98
</code></pre>

<p>示例五：根据示例三进行排序，由低到高</p>

<pre><code>方法一：对比下标
#!/bin/bash
score=(48 59 60 68 90 78 86 56 98 56)
temp=0
for ((i=0;i&lt;${#score[*]};i++))
do
    for  ((j=$i+1;j&lt;${#score[*]};j++))
    do
    if [ ${score[$i]} -gt ${score[$j]} ];then
    temp=${score[$i]}
    let score[$i]=${score[$j]}
    let score[$j]=temp
    fi
    done
done
echo ${score[*]}
</code></pre>

<p>方法二：找相对关系</p>

<pre><code>#!/bin/bash
score=(48 59 60 68 90 78 86 56 98 56)
#外层为轮
for ((i=1;i&lt;${#score[*]};i++))
do
   #内存为次
   for  ((j=0;j&lt;${#score[*]}-i;j++))
   do   #两数交换
      if [ ${score[$j]} -gt ${score[`expr $j + 1` ]} ];then
          tem=${score[`expr $j + 1`]}
          score[`expr $j + 1`]=${score[$j]}
          score[$j]=$tem
      fi
    done
done
echo ${score[*]}
[root@localhost opt]# sh score.sh 
48 56 56 59 60 68 78 86 90 98
</code></pre>

<h2 id="3-5-shell脚本调试">3.5：Shell脚本调试</h2>

<pre><code>- echo命令
- bash命令
命令语法
sh [-nvx] 脚本名
常用选项
-n：不执行
-v：输出
-x：执行
</code></pre>

<ul>
<li>set命令<br />
set -x：开启调节模式<br />
set +x：关闭调节模式</li>
</ul>

        </div>

        


        

<div class="post-archive">
    <h2>See Also</h2>
    <ul class="listing">
        
        <li><a href="/posts/007hadoop%E9%9B%86%E7%BE%A4%E9%85%8D%E7%BD%AEhadoop%E9%9B%86%E7%BE%A4%E7%9A%84%E5%90%AF%E5%8A%A8%E5%92%8C%E6%B5%8B%E8%AF%95ssh%E5%85%8D%E7%99%BB%E9%99%86%E9%85%8D%E7%BD%AEstartallshhdfs%E5%B8%B8%E7%94%A8%E7%9A%84shell/">007Hadoop集群配置Hadoop集群的启动和测试SSH免登陆配置startallshhdfs常用的shell</a></li>
        
        <li><a href="/posts/009shell%E8%84%9A%E6%9C%AC%E4%B8%8B%E6%9D%A1%E4%BB%B6%E6%B5%8B%E8%AF%95eqne/">009Shell脚本下条件测试eqne</a></li>
        
        <li><a href="/posts/00pythonmanagepyshell%E5%92%8Cpython%E7%9A%84%E5%88%86%E6%9E%90/">00Pythonmanagepyshell和Python的分析</a></li>
        
        <li><a href="/posts/010zookeeper%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5zookeeper%E7%9A%84%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BAzookeeper%E7%9A%84shell%E5%91%BD%E4%BB%A4/">010Zookeeper的基本概念Zookeeper的集群搭建Zookeeper的shell命令</a></li>
        
        <li><a href="/posts/018dockerfileshell/">018DockerfileSHELL</a></li>
        
    </ul>
</div>


        <div class="post-meta meta-tags">
            
            <ul class="clearfix">
                
                <li><a href='https://zaina.newban.cn/tags/shell'>shell</a></li>
                
            </ul>
            
        </div>
    </article>
    
    

    
    
</div>

                    <footer id="footer">
    <div>
        &copy; 2020 <a href="https://zaina.newban.cn">开发者问答集锦 By </a>
        
    </div>
    <br />
    <div>
        <div class="github-badge">
            <a href="https://gohugo.io/" target="_black" rel="nofollow"><span class="badge-subject">Powered by</span><span class="badge-value bg-blue">Hugo</span></a>
        </div>
        <div class="github-badge">
            <a href="https://www.flysnow.org/" target="_black"><span class="badge-subject">Design by</span><span class="badge-value bg-brightgreen">飞雪无情</span></a>
        </div>
        <div class="github-badge">
            <a href="https://github.com/flysnow-org/maupassant-hugo" target="_black"><span class="badge-subject">Theme</span><span class="badge-value bg-yellowgreen">Maupassant</span></a>
        </div>
    </div>
</footer>


    
    <script type="text/javascript">
        window.MathJax = {
            tex2jax: {
                inlineMath: [['$', '$']],
                processEscapes: true
                }
            };
    </script>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML' async></script>

<a id="rocket" href="#top"></a>
<script type="text/javascript" src='/js/totop.js?v=0.0.0' async=""></script>



    <script type="text/javascript" src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script>




                </div>

                <div id="secondary">
    <section class="widget">
        <form id="search" action='https://zaina.newban.cn/search/' method="get" accept-charset="utf-8" target="_blank" _lpchecked="1">
      
      <input type="text" name="q" maxlength="20" placeholder="Search">
      <input type="hidden" name="sitesearch" value="https://zaina.newban.cn">
      <button type="submit" class="submit icon-search"></button>
</form>
    </section>
    
    <section class="widget">
        <h3 class="widget-title">最近文章</h3>
<ul class="widget-list">
    
    <li>
        <a href="https://zaina.newban.cn/posts/001rubyruby%E4%B8%AD%E5%85%A8%E5%B1%80%E5%8F%98%E9%87%8F%E5%AE%9E%E4%BE%8B%E5%8F%98%E9%87%8F%E5%B1%80%E9%83%A8%E5%8F%98%E9%87%8F%E7%B1%BB%E5%8F%98%E9%87%8Fsymbol%E5%AF%B9%E6%AF%94/" title="001rubyRuby中全局变量实例变量局部变量类变量Symbol对比">001rubyRuby中全局变量实例变量局部变量类变量Symbol对比</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/007hadoop%E9%9B%86%E7%BE%A4%E9%85%8D%E7%BD%AEhadoop%E9%9B%86%E7%BE%A4%E7%9A%84%E5%90%AF%E5%8A%A8%E5%92%8C%E6%B5%8B%E8%AF%95ssh%E5%85%8D%E7%99%BB%E9%99%86%E9%85%8D%E7%BD%AEstartallshhdfs%E5%B8%B8%E7%94%A8%E7%9A%84shell/" title="007Hadoop集群配置Hadoop集群的启动和测试SSH免登陆配置startallshhdfs常用的shell">007Hadoop集群配置Hadoop集群的启动和测试SSH免登陆配置startallshhdfs常用的shell</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/009shell%E8%84%9A%E6%9C%AC%E4%B8%8B%E6%9D%A1%E4%BB%B6%E6%B5%8B%E8%AF%95eqne/" title="009Shell脚本下条件测试eqne">009Shell脚本下条件测试eqne</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/00pythonmanagepyshell%E5%92%8Cpython%E7%9A%84%E5%88%86%E6%9E%90/" title="00Pythonmanagepyshell和Python的分析">00Pythonmanagepyshell和Python的分析</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/010zookeeper%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5zookeeper%E7%9A%84%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BAzookeeper%E7%9A%84shell%E5%91%BD%E4%BB%A4/" title="010Zookeeper的基本概念Zookeeper的集群搭建Zookeeper的shell命令">010Zookeeper的基本概念Zookeeper的集群搭建Zookeeper的shell命令</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/018dockerfileshell/" title="018DockerfileSHELL">018DockerfileSHELL</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/01shell%E5%85%A5%E9%97%A801bashshell%E7%89%B9%E6%80%A7/" title="01Shell入门01bashShell特性">01Shell入门01bashShell特性</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/01shell%E5%8F%98%E9%87%8F/" title="01Shell变量">01Shell变量</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/01shell%E5%9F%BA%E7%A1%80%E6%A6%82%E8%BF%B0%E8%84%9A%E6%9C%AC%E6%89%A7%E8%A1%8C%E6%96%B9%E5%BC%8Fbash%E5%9F%BA%E6%9C%AC%E5%8A%9F%E8%83%BD/" title="01Shell基础概述脚本执行方式Bash基本功能">01Shell基础概述脚本执行方式Bash基本功能</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/01shell%E7%BC%96%E7%A8%8Bhelloworld/" title="01shell编程helloworld">01shell编程helloworld</a>
    </li>
    
</ul>
    </section>

    

    <section class="widget">
        <h3 class="widget-title"><a href="/categories">分类</a></h3>
<ul class="widget-list">
    
</ul>
    </section>

    <section class="widget">
        <h3 class="widget-title"><a href="/tags">标签</a></h3>
<div class="tagcloud">
    
    <a href="https://zaina.newban.cn/tags/ruby/">ruby</a>
    
    <a href="https://zaina.newban.cn/tags/shell/">shell</a>
    
</div>
    </section>

    

    <section class="widget">
        <h3 class="widget-title">其它</h3>
        <ul class="widget-list">
            <li><a href="https://zaina.newban.cn/index.xml">文章 RSS</a></li>
        </ul>
    </section>
</div>
            </div>
        </div>
    </div>
</body>

</html>