<!doctype html>
<html lang="en-us">
<head>
	<meta name="generator" content="Hugo 0.59.1" />

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">


    <title>开发者问答集锦 | </title>
    <meta property="og:title" content="开发者问答集锦 | ">
    <meta property="og:type" content="website">
    <meta name="Keywords" content="">
    <meta name="description" content="">
    <meta property="og:url" content="https://zaina.newban.cn/">
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">

    <link rel="stylesheet" href='/css/normalize.css'>
    <link rel="stylesheet" href='/css/style.css'>
    <link rel="alternate" type="application/rss+xml+xml" href="https://zaina.newban.cn/index.xml" title="开发者问答集锦" />
    <script type="text/javascript" src="//cdn.bootcdn.net/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

    
    
    
    
    
    
</head>


<body>
    <header id="header" class="clearfix">
    <div class="container">
        <div class="col-group">
            <div class="site-name ">
                
                    <h1>
                        <a id="logo" href="https://zaina.newban.cn">
                            开发者问答集锦
                        </a>
                    </h1>
                
                
            </div>
            <div>
                <nav id="nav-menu" class="clearfix">
                    <a class="current" href="https://zaina.newban.cn">首页</a>
                    
                </nav>
            </div>
        </div>
    </div>
</header>

    <div id="body">
        <div class="container">
            <div class="col-group">

                <div class="col-8" id="main">
                    
<div class="res-cons">
    
    <article class="post">
        <header>
            <h1 class="post-title">
                <a href="https://zaina.newban.cn/posts/java%E4%BB%A3%E7%A0%81%E8%B0%83%E7%94%A8%E6%9C%AC%E5%9C%B0shell%E5%91%BD%E4%BB%A4%E6%88%96shell%E8%84%9A%E6%9C%AC/" title="Java代码调用本地shell命令或shell脚本">Java代码调用本地shell命令或shell脚本</a>
            </h1>
        </header>
        <date class="post-meta meta-date">
            2020年9月2日
        </date>
        
        <div class="post-content">
            1. 概述： java.lang包下有一个Runtime类，是一个封装了JVM进程的类。每一个JAVA程序实际上都是启动了一个JVM进程，那么每一个进程都是对应这一个Runtime实例，其实例是由JVM为其初始化的。该类有一个方法，exec()，我们就是使用该方法来调用shell命令的。
2. exec方法的说明： Runtime.getRuntime().exec（）方法主要用于执行外部的程序或命令。
Runtime.getRuntime().exec共有六个重载方法：
1.public Process exec(String command)
在单独的进程中执行指定的字符串命令。
2.public Process exec(String [] cmdArray)
在单独的进程中执行指定命令和变量
3.public Process exec(String command, String [] envp)
在指定环境的独立进程中执行指定命令和变量
4.public Process exec(String [] cmdArray, String [] envp)
在指定环境的独立进程中执行指定的命令和变量
5.public Process exec(String command,String[] envp,File dir)
在有指定环境和工作目录的独立进程中执行指定的字符串命令
6.public Process exec(String[] cmdarray,String[] envp,File dir)
在指定环境和工作目录的独立进程中执行指定的命令和变量
参数说明：
cmdarray - 包含所调用命令及其参数的数组。
envp - 字符串数组，其中每个元素的环境变量的设置格式为 name=value，如果子进程应该继承当前进程的环境，或该参数为 null。
dir - 子进程的工作目录；如果子进程应该继承当前进程的工作目录，则该参数为 null。
3. exec(String command)与exec(String[] cmdArray) exec(String command)有很大的局限性，不能执行重定向或者管道命令
 String cmd = &quot;lsof -i:8080 &gt;&gt;/home/user/log.……
        </div>
        <p class="readmore"><a href="https://zaina.newban.cn/posts/java%E4%BB%A3%E7%A0%81%E8%B0%83%E7%94%A8%E6%9C%AC%E5%9C%B0shell%E5%91%BD%E4%BB%A4%E6%88%96shell%E8%84%9A%E6%9C%AC/">阅读全文</a></p>
    </article>
    
    <article class="post">
        <header>
            <h1 class="post-title">
                <a href="https://zaina.newban.cn/posts/java%E4%BB%A3%E7%A0%81%E9%80%9A%E8%BF%87ssh%E5%85%8D%E5%AF%86%E6%93%8D%E4%BD%9C%E8%BF%9C%E7%A8%8B%E6%9C%8D%E5%8A%A1%E5%99%A8shell/" title="java代码通过ssh免密操作远程服务器shell">java代码通过ssh免密操作远程服务器shell</a>
            </h1>
        </header>
        <date class="post-meta meta-date">
            2020年9月2日
        </date>
        
        <div class="post-content">
            环境 操作系统：win10
虚拟机：centos7
步骤 一般我们都是通过CRT这样的工具来连接并操作服务器。但是最近由于业务需求，需要通过java代码来操作远程服务器。其实也就是操作shell。
思路：
①使用java两个相关类Runtime和Process
1.Runtime：该类封装了运行时的环境。每个Java应用程序都有一个Runtime类实例，是应用程序能够与其运行的环境环境相链接。在多线程的操作系统中，可以使用Runtime类来运行其他的线程。
2.Process：该类是一个抽象类，封装了一个进程。Runtime.exec和ProcessBuilder.start都会启动一个进程，并返回该Process子类的一个实例。
网上相关的资料中，没有关于免密的解决方案，所以我也就没有参数这种方式。
②使用框架jsch
这个框架提供了好多好多的解决方案。
官网：http://www.jcraft.com/jsch/

我参考的是UserAuthPubKey这个类的例子。
我自己测试成功的代码,如下：
（代码相对于例子是有所删减，因为官网的例子中使用了java的swing类，也就是java的图形界面，那些页面，明显我是不需要的）
import java.io.BufferedReader; import java.io.IOException; import java.io.InputStream; import java.io.InputStreamReader; import com.jcraft.jsch.Channel; import com.jcraft.jsch.ChannelExec; import com.jcraft.jsch.JSch; import com.jcraft.jsch.JSchException; import com.jcraft.jsch.Session; public class ConnectionSSH { public static void main(String[] args) throws JSchException, IOException { JSch jsch = new JSch(); String pubKeyPath = &quot;C:\\Users\\yutao\\.ssh\\id_rsa&quot;; jsch.addIdentity(pubKeyPath); String username = &quot;yutao&quot;; String host = &quot;192.168.116.131&quot;; Session session=jsch.getSession(username, host, 22);//为了连接做准备 session.……
        </div>
        <p class="readmore"><a href="https://zaina.newban.cn/posts/java%E4%BB%A3%E7%A0%81%E9%80%9A%E8%BF%87ssh%E5%85%8D%E5%AF%86%E6%93%8D%E4%BD%9C%E8%BF%9C%E7%A8%8B%E6%9C%8D%E5%8A%A1%E5%99%A8shell/">阅读全文</a></p>
    </article>
    
    <article class="post">
        <header>
            <h1 class="post-title">
                <a href="https://zaina.newban.cn/posts/java%E4%BD%BF%E7%94%A8shelltop%E5%91%BD%E4%BB%A4%E6%9F%A5%E7%9C%8B%E6%8C%87%E5%AE%9A%E8%BF%9B%E7%A8%8Bcpu%E5%92%8C%E5%86%85%E5%AD%98%E4%BD%BF%E7%94%A8%E6%83%85%E5%86%B5/" title="java使用shelltop命令查看指定进程CPU和内存使用情况">java使用shelltop命令查看指定进程CPU和内存使用情况</a>
            </h1>
        </header>
        <date class="post-meta meta-date">
            2020年9月2日
        </date>
        
        <div class="post-content">
            注意:
1.如果pro.waitFor()返回1，j即使根据java文档，是operation not permited，但其实基本就是写的shell命令有问题，有时候在linux上可以执行，但放到了java shell中还不是不能执行，比如top命令，要多加个-b才能执行。
2.有时候对于不太活跃的进程进行top命令，会经常得到CPU使用率0，其实可以多次top后再平均。
import java.io.BufferedReader; import java.io.InputStream; import java.io.InputStreamReader; import java.lang.management.ManagementFactory; import java.math.BigDecimal; public class SystemInfoUtil { public static void getCurrentProcessInfo_linux() { //获取当前进程id String jvmName = ManagementFactory.getRuntimeMXBean().getName(); String pid = jvmName.split(&quot;@&quot;)[0]; int monitorcount = 4; String cmd = &quot;top -b -d 5 -p &quot;+pid+&quot; -n &quot;+monitorcount+&quot;|grep java|awk '{print $9\&quot; \&quot;$6}'&quot;; String[] cmds = new String[] { &quot;/bin/sh&quot;, &quot;-c&quot;, cmd }; InputStream in=null; BufferedReader read=null; try { Process pro = Runtime.……
        </div>
        <p class="readmore"><a href="https://zaina.newban.cn/posts/java%E4%BD%BF%E7%94%A8shelltop%E5%91%BD%E4%BB%A4%E6%9F%A5%E7%9C%8B%E6%8C%87%E5%AE%9A%E8%BF%9B%E7%A8%8Bcpu%E5%92%8C%E5%86%85%E5%AD%98%E4%BD%BF%E7%94%A8%E6%83%85%E5%86%B5/">阅读全文</a></p>
    </article>
    
    <article class="post">
        <header>
            <h1 class="post-title">
                <a href="https://zaina.newban.cn/posts/java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E5%9C%A8%E5%8F%97%E9%99%90%E7%8E%AF%E5%A2%83%E4%B8%AD%E4%BB%8E%E6%BC%8F%E6%B4%9E%E5%8F%91%E7%8E%B0%E5%88%B0%E8%8E%B7%E5%8F%96%E5%8F%8D%E5%90%91shell/" title="Java反序列化漏洞在受限环境中从漏洞发现到获取反向Shell">Java反序列化漏洞在受限环境中从漏洞发现到获取反向Shell</a>
            </h1>
        </header>
        <date class="post-meta meta-date">
            2020年9月2日
        </date>
        
        <div class="post-content">
            前言
Java反序列化漏洞可以说是Java安全的一块心病，近年来更是在安全界“出尽风头”。其实说到Java反序列化的问题，早在2015年年初的在AppSecCali大会上，两名安全研究人员Chris Frohoff 和 Gabriel Lawrence发表了一篇题为《Marshalling Pickles》的报告，就详细描述了Java反序列化漏洞可以利用Apache Commons Collections这个常用的Java库来实现任意代码执行，甚至还提供了相应的Payload生成工具ysoserial。
通过对象序列化，开发人员可将内存中对象转换为二进制和文本数据格式进行存储或传输。但是，从不受信任的数据反序列化对象可能会导致攻击者实现远程代码执行。
本文我将以WebGoat 8中的反序列化挑战（部署在Docker上）为例，向大家展示完成该挑战并进一步获取目标反向shell的完整过程。
漏洞发现
正如挑战中所提到的，易受攻击的页面从用户输入中获取Base64格式的序列化Java对象，并不加过滤的对其进行反序列化操作。我们将通过提供一个序列化对象来利用这个漏洞，该对象将触发面向属性的编程链（POP链）以在反序列化期间实现远程命令执行。
启动Burp并安装一个名为Java-Deserialization- Scanner的插件。该插件主要包括2个功能：扫描以及基于ysoserial生成exploit。

扫描远程端点后，Burp插件将向我们返回以下报告内容：
Hibernate 5 (Sleep): Potentially VULNERABLE!!!
是个好消息！
漏洞利用
现在，让我们继续下一步操作。点击exploitation选项卡以实现任意命令执行。
从提示信息来看，这个错误应该来自ysoserial。我们回到控制台看看究竟是什么问题。
通过观察ysoserial，我看到有两种不同的POP链可用于Hibernate。但使用这些payload后，我发现它们都没有在目标系统上成功执行。

那么，插件又是如何生成payload来触发sleep命令的呢？
我决定查看插件的源码：
https://github.com/federicodotta/Java-Deserialization- Scanner/blob/master/src/burp/BurpExtender.java
经过一番仔细查看，我发现原来payload在插件的源码中是硬编码的。因此，我们需要找到一种方法来生成相同的payload以使其正常工作。

基于一些研究和帮助我发现，通过修改当前版本的ysoserial可以使我们的payload正常工作。我下载了ysoserial的源码，并决定使用Hibernate 5重新对其进行编译。想要使用Hibernate 5成功构建ysoserial，我们还需要将javax.el包添加到pom.xml文件中。
此外，我还向原始项目发送了一个Pull请求，以便在选择hibernate5配置文件时修复构建。

现在，我们就可以使用以下命令开始重新构建ysoserial了：
mvn clean package -DskipTests -Dhibernate5
然后，我们使用以下命令来生成payload：
java -Dhibernate5 -jar target/ysoserial-0.0.6-SNAPSHOT-all.jar Hibernate1 “touch /tmp/test” | base64 -w0

我们可以通过以下命令访问docker容器，来验证我们的命令是否已成功执行：
docker exec -it /bin/bash
可以看到我们的payload已在目标机器上成功执行了！

我们继续枚举目标机器上的二进制文件。
webgoat@1d142ccc69ec:/$ which php
webgoat@1d142ccc69ec:/$ which python……
        </div>
        <p class="readmore"><a href="https://zaina.newban.cn/posts/java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E5%9C%A8%E5%8F%97%E9%99%90%E7%8E%AF%E5%A2%83%E4%B8%AD%E4%BB%8E%E6%BC%8F%E6%B4%9E%E5%8F%91%E7%8E%B0%E5%88%B0%E8%8E%B7%E5%8F%96%E5%8F%8D%E5%90%91shell/">阅读全文</a></p>
    </article>
    
    <article class="post">
        <header>
            <h1 class="post-title">
                <a href="https://zaina.newban.cn/posts/java%E5%90%8E%E5%8F%B0%E5%AE%9E%E7%8E%B0usb%E8%AE%BE%E5%A4%87%E8%BF%9E%E6%8E%A5%E8%8E%B7%E5%8F%96%E8%AE%BE%E5%A4%87%E5%8F%B7id%E5%AE%9E%E7%8E%B0adbshell%E5%91%BD%E4%BB%A4/" title="java后台实现USB设备连接获取设备号ID实现adbshell命令">java后台实现USB设备连接获取设备号ID实现adbshell命令</a>
            </h1>
        </header>
        <date class="post-meta meta-date">
            2020年9月2日
        </date>
        
        <div class="post-content">
            第一步：

第二步：
javax.usb.services = org.usb4java.javax.Services
第三步：
pom.xml:
org.usb4java
usb4java-javax
1.2.0
第四部：
/**获取设备信息(连接状态、序列号、产品名、型号、名称、系统版本号)
* @return
* @throws Exception
/
public List getAllDevices(int tag) throws Exception {
List map = null;
ArrayList list = null;
Process process;
BufferedReader reader;
String line = null;
String device_tpye;
try {
list = new ArrayList();
map = new ArrayList();
//设置adb.exe存放路径，如果设置了环境变量，直接输入adb即可
String adb_path = &ldquo;adb&rdquo;;
//执行adb device操作，查看pc当前连接手机或模拟器设备列表
//注意：一定要先配置好sdk环境变量，否则无法直接执行adb命令
process = excuteShell(adb_path + &ldquo; devices -l&rdquo;);
if(process !……
        </div>
        <p class="readmore"><a href="https://zaina.newban.cn/posts/java%E5%90%8E%E5%8F%B0%E5%AE%9E%E7%8E%B0usb%E8%AE%BE%E5%A4%87%E8%BF%9E%E6%8E%A5%E8%8E%B7%E5%8F%96%E8%AE%BE%E5%A4%87%E5%8F%B7id%E5%AE%9E%E7%8E%B0adbshell%E5%91%BD%E4%BB%A4/">阅读全文</a></p>
    </article>
    
    <article class="post">
        <header>
            <h1 class="post-title">
                <a href="https://zaina.newban.cn/posts/java%E5%90%8E%E5%8F%B0%E6%89%A7%E8%A1%8Cshell%E8%84%9A%E6%9C%ACjava%E6%96%B9%E6%B3%95%E4%B8%8D%E7%94%A8%E7%AD%89%E5%BE%85shell%E7%A8%8B%E5%BA%8F%E6%89%A7%E8%A1%8C%E5%AE%8C%E6%88%90%E5%B9%B6%E4%BF%9D%E8%AF%81%E5%85%B3%E6%8E%89java%E7%A8%8B%E5%BA%8Fshell%E8%84%9A%E6%9C%AC%E6%AD%A3%E5%B8%B8%E8%BF%90%E8%A1%8C/" title="Java后台执行Shell脚本Java方法不用等待Shell程序执行完成并保证关掉Java程序Shell脚本正常运行">Java后台执行Shell脚本Java方法不用等待Shell程序执行完成并保证关掉Java程序Shell脚本正常运行</a>
            </h1>
        </header>
        <date class="post-meta meta-date">
            2020年9月2日
        </date>
        
        <div class="post-content">
            首先说明，我现在要解决的两个问题：
1、如果要调用的Shell脚本是常驻内存，也就是说里面有循环不会结束的脚本，我用Java方法调用，但是不能等Shell执行完成，即调用执行一下后，我的Java方法要结束，同时还要保证Shell已经运行了；
2、用Java调用后，把Java程序杀掉，这时由Java执行的Shell脚本要保证正常运行，不能随Java程序的关闭而停止。
这里涉及到两个问题，一个是后台执行Shell脚本，一个是设置为孤立进程。后台执行Shell脚本的方法有好多种，比如直接加&amp;，或使用Ctr+Z，也或者bg等等，还有一个就是设置为孤立进程，我查到的有这样的说法，使用setsid，nohup等等，这样的文章很多，在这我就不多说了。下面是我的解决方法：
Java后台执行Shell脚本，在关掉Java程序时保证Shell脚本正常运行，同时让JAVA方法不用等待程序执行完成就返回，使用如下 命令：
nohup ./test.sh &gt;test.out 2&gt;&amp;1 &amp;
Java程序运行就是这样：Runtime.getRuntime().exec(&ldquo;nohup /home/test/test.sh &gt;/del/nul 2&gt;&amp;1 &amp;&ldquo;);……
        </div>
        <p class="readmore"><a href="https://zaina.newban.cn/posts/java%E5%90%8E%E5%8F%B0%E6%89%A7%E8%A1%8Cshell%E8%84%9A%E6%9C%ACjava%E6%96%B9%E6%B3%95%E4%B8%8D%E7%94%A8%E7%AD%89%E5%BE%85shell%E7%A8%8B%E5%BA%8F%E6%89%A7%E8%A1%8C%E5%AE%8C%E6%88%90%E5%B9%B6%E4%BF%9D%E8%AF%81%E5%85%B3%E6%8E%89java%E7%A8%8B%E5%BA%8Fshell%E8%84%9A%E6%9C%AC%E6%AD%A3%E5%B8%B8%E8%BF%90%E8%A1%8C/">阅读全文</a></p>
    </article>
    
    <article class="post">
        <header>
            <h1 class="post-title">
                <a href="https://zaina.newban.cn/posts/java%E5%90%AF%E5%8A%A8shell%E8%84%9A%E6%9C%AC/" title="java启动shell脚本">java启动shell脚本</a>
            </h1>
        </header>
        <date class="post-meta meta-date">
            2020年9月2日
        </date>
        
        <div class="post-content">
            i#!/bin/sh #gameserver.sh #To start or stop gameserver. #base dir of the application APP_BASE=`pwd` echo $APP_BASE #��ʼ��, ����, �����, ÿ���̵߳Ķ�ջ��С, ��ʼ�־ô�, �־ô����ֵ�ڴ��С JDK_OPTS=&quot;-Xms3072m -Xmx3072m -Xmn1024m -Xss1m -XX:PermSize=128M -XX:MaxPermSize=128M -XX:+HeapDumpOnOutOfMemoryError -XX:HeapDumpPath=/game/server/app/castleserver/log/outmem.log&quot; #Eden����Survivor��Ĵ�С��ֵ #JDK_OPTS=$JDK_OPTS&quot; -XX:SurvivorRatio=1&quot; #���������Ϊ�����ռ� JDK_OPTS=$JDK_OPTS&quot; -XX:+UseParNewGC&quot; #ʹ��CMS�ڴ��ռ� JDK_OPTS=$JDK_OPTS&quot; -XX:+UseConcMarkSweepGC&quot; #���ٴκ�����ڴ�ѹ�� JDK_OPTS=$JDK_OPTS&quot; -XX:CMSFullGCsBeforeCompaction=5&quot; #��FULL GC��ʱ��, �����ϴ�ѹ�� JDK_OPTS=$JDK_OPTS&quot; -XX:+UseCMSCompactAtFullCollection&quot; #�����������ʱ��ռ�������е�ʱ��ٷֱ� 1/(1 + n) JDK_OPTS=$JDK_OPTS&quot; -XX:GCTimeRatio=19&quot; #������������� JDK_OPTS=$JDK_OPTS&quot; -Xnoclassgc&quot; #���ٰٷֱȺ�ʼʹ��cms�ռ���Ϊ�������, ����(Xmx - Xmn) * (100 - CMSInitiatingOccupancyFraction) / 100 &gt;= Xmn JDK_OPTS=$JDK_OPTS&quot; -XX:CMSInitiatingOccupancyFraction=60&quot; #ÿ�׶ѿ��пռ���SoftReference�Ĵ��ʱ�� JDK_OPTS=$JDK_OPTS&quot; -XX:SoftRefLRUPolicyMSPerMB=0&quot; #JMXԶ�̼���˿����� JDK_OPTS=$JDK_OPTS&quot; -Dcom.……
        </div>
        <p class="readmore"><a href="https://zaina.newban.cn/posts/java%E5%90%AF%E5%8A%A8shell%E8%84%9A%E6%9C%AC/">阅读全文</a></p>
    </article>
    
    <article class="post">
        <header>
            <h1 class="post-title">
                <a href="https://zaina.newban.cn/posts/java%E5%9B%9B%E7%A7%8D%E5%9F%BA%E6%9C%AC%E6%8E%92%E5%BA%8F%E5%8C%85%E6%8B%AC%E5%86%92%E6%B3%A1%E6%B3%95%E6%8F%92%E5%85%A5%E6%B3%95%E9%80%89%E6%8B%A9%E6%B3%95shell%E6%8E%92%E5%BA%8F%E6%B3%95/" title="JAVA四种基本排序包括冒泡法插入法选择法SHELL排序法">JAVA四种基本排序包括冒泡法插入法选择法SHELL排序法</a>
            </h1>
        </header>
        <date class="post-meta meta-date">
            2020年9月2日
        </date>
        
        <div class="post-content">
            ……
        </div>
        <p class="readmore"><a href="https://zaina.newban.cn/posts/java%E5%9B%9B%E7%A7%8D%E5%9F%BA%E6%9C%AC%E6%8E%92%E5%BA%8F%E5%8C%85%E6%8B%AC%E5%86%92%E6%B3%A1%E6%B3%95%E6%8F%92%E5%85%A5%E6%B3%95%E9%80%89%E6%8B%A9%E6%B3%95shell%E6%8E%92%E5%BA%8F%E6%B3%95/">阅读全文</a></p>
    </article>
    
    <article class="post">
        <header>
            <h1 class="post-title">
                <a href="https://zaina.newban.cn/posts/java%E5%9C%A8linux%E6%9C%AC%E5%9C%B0%E6%89%A7%E8%A1%8Cshell%E5%91%BD%E4%BB%A4/" title="java在linux本地执行shell命令">java在linux本地执行shell命令</a>
            </h1>
        </header>
        <date class="post-meta meta-date">
            2020年9月2日
        </date>
        
        <div class="post-content">
            一.以springboot为例,建立代码 1.IExecCommandServer:
public interface IExecCommandServer { void execCommand(String cmd); }  2.ExecCommandServerImp:
@Service public class ExecCommandServerImp implements IExecCommandServer { @Override public void execCommand(String cmd){ try{ Runtime rt = Runtime.getRuntime(); Process proc = rt.exec(cmd,null,null); InputStream stderr = proc.getInputStream(); InputStreamReader isr = new InputStreamReader(stderr,&quot;GBK&quot;); BufferedReader br = new BufferedReader(isr); String line=&quot;&quot;; while ((line = br.readLine()) != null) { System.out.println(line); } }catch (Exception e){ e.printStackTrace(); } } }  3.ExecCommandController:
@CrossOrigin @RestController @RequestMapping(&quot;/linux&quot;) public class ExecCommandController { @Autowired private IExecCommandServer execCommandServer; @GetMapping(&quot;/exec&quot;) public ResultMap execCommand(String cmd) throws Exception { execCommandServer.……
        </div>
        <p class="readmore"><a href="https://zaina.newban.cn/posts/java%E5%9C%A8linux%E6%9C%AC%E5%9C%B0%E6%89%A7%E8%A1%8Cshell%E5%91%BD%E4%BB%A4/">阅读全文</a></p>
    </article>
    
    <article class="post">
        <header>
            <h1 class="post-title">
                <a href="https://zaina.newban.cn/posts/java%E5%A6%82%E4%BD%95%E6%93%8D%E4%BD%9Candroid%E7%9A%84adbshell/" title="Java如何操作Android的adbshell">Java如何操作Android的adbshell</a>
            </h1>
        </header>
        <date class="post-meta meta-date">
            2020年9月2日
        </date>
        
        <div class="post-content">
            Android在操作一些命令的时候需要进入到adb shell，然后才可以执行其他的命令，那么如何做到这一点呢？就要把adb shell按一个Process执行，然后再去操作这个Process的输入和输出流。
代码如下：
这段代码是操作 cmd.exe的
try {
Process process = Runtime.getRuntime().exec(&ldquo;cmd.exe&rdquo;);
OutputStream outputStream = process.getOutputStream();
final InputStream inputStream = process.getInputStream();
new Thread(new Runnable(){
byte[] cache = new byte[1024];
public void run() {
System.out.println(&ldquo;listener started&rdquo;);
try {
while(inputStream.read(cache)!=-1){
System.out.println(new String(cache));
}
} catch (IOException e) {
//e.printStackTrace();
}
}
}).start();
outputStream.write(new byte[]{&rsquo;d&rsquo;,&lsquo;i&rsquo;,&lsquo;r&rsquo;,&rsquo;\n&rsquo;});
//inputStream.
int i = process.waitFor();
System.out.println(&ldquo;i=&rdquo; + i);
} catch (Exception e) {
e.printStackTrace();
}
这段代码是操作Android adb shell 的……
        </div>
        <p class="readmore"><a href="https://zaina.newban.cn/posts/java%E5%A6%82%E4%BD%95%E6%93%8D%E4%BD%9Candroid%E7%9A%84adbshell/">阅读全文</a></p>
    </article>
    
    



<ol class="page-navigator">
    
    <li class="prev">
        <a href="https://zaina.newban.cn/page/193/">上一页</a>
    </li>
    

    

    
        
        
    
    

    
        
        
        <li >
            <a href="https://zaina.newban.cn/">1</a>
        </li>
        
    
        
        <li>
            <span>...</span>
        </li>
        
    
        
        
        <li >
            <a href="https://zaina.newban.cn/page/192/">192</a>
        </li>
        
    
        
        
        <li >
            <a href="https://zaina.newban.cn/page/193/">193</a>
        </li>
        
    
        
        
        <li  class="current">
            <a href="https://zaina.newban.cn/page/194/">194</a>
        </li>
        
    
        
        
        <li >
            <a href="https://zaina.newban.cn/page/195/">195</a>
        </li>
        
    
        
        
        <li >
            <a href="https://zaina.newban.cn/page/196/">196</a>
        </li>
        
    
        
        <li>
            <span>...</span>
        </li>
        
    
        
        
        <li >
            <a href="https://zaina.newban.cn/page/1960/">1960</a>
        </li>
        
    

    
    

    <li class="next">
        <a href="https://zaina.newban.cn/page/195/">下一页</a>
    </li>
    
</ol>




</div>

                    <footer id="footer">
    <div>
        &copy; 2020 <a href="https://zaina.newban.cn">开发者问答集锦 By </a>
        
    </div>
    <br />
    <div>
        <div class="github-badge">
            <a href="https://gohugo.io/" target="_black" rel="nofollow"><span class="badge-subject">Powered by</span><span class="badge-value bg-blue">Hugo</span></a>
        </div>
        <div class="github-badge">
            <a href="https://www.flysnow.org/" target="_black"><span class="badge-subject">Design by</span><span class="badge-value bg-brightgreen">飞雪无情</span></a>
        </div>
        <div class="github-badge">
            <a href="https://github.com/flysnow-org/maupassant-hugo" target="_black"><span class="badge-subject">Theme</span><span class="badge-value bg-yellowgreen">Maupassant</span></a>
        </div>
    </div>
</footer>



<a id="rocket" href="#top"></a>
<script type="text/javascript" src='/js/totop.js?v=0.0.0' async=""></script>



    <script type="text/javascript" src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script>




                </div>

                <div id="secondary">
    <section class="widget">
        <form id="search" action='https://zaina.newban.cn/search/' method="get" accept-charset="utf-8" target="_blank" _lpchecked="1">
      
      <input type="text" name="q" maxlength="20" placeholder="Search">
      <input type="hidden" name="sitesearch" value="https://zaina.newban.cn">
      <button type="submit" class="submit icon-search"></button>
</form>
    </section>
    
    <section class="widget">
        <h3 class="widget-title">最近文章</h3>
<ul class="widget-list">
    
    <li>
        <a href="https://zaina.newban.cn/posts/001rubyruby%E4%B8%AD%E5%85%A8%E5%B1%80%E5%8F%98%E9%87%8F%E5%AE%9E%E4%BE%8B%E5%8F%98%E9%87%8F%E5%B1%80%E9%83%A8%E5%8F%98%E9%87%8F%E7%B1%BB%E5%8F%98%E9%87%8Fsymbol%E5%AF%B9%E6%AF%94/" title="001rubyRuby中全局变量实例变量局部变量类变量Symbol对比">001rubyRuby中全局变量实例变量局部变量类变量Symbol对比</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/007hadoop%E9%9B%86%E7%BE%A4%E9%85%8D%E7%BD%AEhadoop%E9%9B%86%E7%BE%A4%E7%9A%84%E5%90%AF%E5%8A%A8%E5%92%8C%E6%B5%8B%E8%AF%95ssh%E5%85%8D%E7%99%BB%E9%99%86%E9%85%8D%E7%BD%AEstartallshhdfs%E5%B8%B8%E7%94%A8%E7%9A%84shell/" title="007Hadoop集群配置Hadoop集群的启动和测试SSH免登陆配置startallshhdfs常用的shell">007Hadoop集群配置Hadoop集群的启动和测试SSH免登陆配置startallshhdfs常用的shell</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/009shell%E8%84%9A%E6%9C%AC%E4%B8%8B%E6%9D%A1%E4%BB%B6%E6%B5%8B%E8%AF%95eqne/" title="009Shell脚本下条件测试eqne">009Shell脚本下条件测试eqne</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/00pythonmanagepyshell%E5%92%8Cpython%E7%9A%84%E5%88%86%E6%9E%90/" title="00Pythonmanagepyshell和Python的分析">00Pythonmanagepyshell和Python的分析</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/010zookeeper%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5zookeeper%E7%9A%84%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BAzookeeper%E7%9A%84shell%E5%91%BD%E4%BB%A4/" title="010Zookeeper的基本概念Zookeeper的集群搭建Zookeeper的shell命令">010Zookeeper的基本概念Zookeeper的集群搭建Zookeeper的shell命令</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/018dockerfileshell/" title="018DockerfileSHELL">018DockerfileSHELL</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/01shell%E5%85%A5%E9%97%A801bashshell%E7%89%B9%E6%80%A7/" title="01Shell入门01bashShell特性">01Shell入门01bashShell特性</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/01shell%E5%8F%98%E9%87%8F/" title="01Shell变量">01Shell变量</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/01shell%E5%9F%BA%E7%A1%80%E6%A6%82%E8%BF%B0%E8%84%9A%E6%9C%AC%E6%89%A7%E8%A1%8C%E6%96%B9%E5%BC%8Fbash%E5%9F%BA%E6%9C%AC%E5%8A%9F%E8%83%BD/" title="01Shell基础概述脚本执行方式Bash基本功能">01Shell基础概述脚本执行方式Bash基本功能</a>
    </li>
    
    <li>
        <a href="https://zaina.newban.cn/posts/01shell%E7%BC%96%E7%A8%8Bhelloworld/" title="01shell编程helloworld">01shell编程helloworld</a>
    </li>
    
</ul>
    </section>

    

    <section class="widget">
        <h3 class="widget-title"><a href="/categories">分类</a></h3>
<ul class="widget-list">
    
</ul>
    </section>

    <section class="widget">
        <h3 class="widget-title"><a href="/tags">标签</a></h3>
<div class="tagcloud">
    
    <a href="https://zaina.newban.cn/tags/ruby/">ruby</a>
    
    <a href="https://zaina.newban.cn/tags/shell/">shell</a>
    
</div>
    </section>

    

    <section class="widget">
        <h3 class="widget-title">其它</h3>
        <ul class="widget-list">
            <li><a href="https://zaina.newban.cn/index.xml">文章 RSS</a></li>
        </ul>
    </section>
</div>
            </div>
        </div>
    </div>
</body>

</html>